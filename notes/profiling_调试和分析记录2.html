
<!DOCTYPE HTML>
<html lang="zh-hans" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>调试和分析记录2 · My Notes</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        <meta name="author" content="Bai Yingjie">
        
        
    
    
    <link rel="stylesheet" href="../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-search-plus/search.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-prism/prism.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-code/plugin.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-chapter-fold/chapter-fold.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-splitter/splitter.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-wide-page/wide.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-hide-navigation-buttons/index.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-anchor-navigation-ex/style/plugin.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-mermaid-gb3/mermaid/mermaid.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-theme-comscore/test.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    


    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="as_title_perf_tools.html" />
    
    
    <link rel="prev" href="profiling_调试和分析记录3.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="输入并搜索" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../">
            
                <a href="../">
            
                    
                    简介
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="as_title_kaiyuan.html">
            
                <a href="as_title_kaiyuan.html">
            
                    
                    开源
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1" data-path="my_opensource.html">
            
                <a href="my_opensource.html">
            
                    
                    我的开源项目
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2" data-path="my_upstream.html">
            
                <a href="my_upstream.html">
            
                    
                    我的upstream commit
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="as_title_system.html">
            
                <a href="as_title_system.html">
            
                    
                    系统分析和性能
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1" data-path="as_title_perf_misc.html">
            
                <a href="as_title_perf_misc.html">
            
                    
                    调试和分析记录系列
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1.1" data-path="profiling_调试和分析记录5.html">
            
                <a href="profiling_调试和分析记录5.html">
            
                    
                    调试和分析记录5
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.1.2" data-path="profiling_调试和分析记录4.html">
            
                <a href="profiling_调试和分析记录4.html">
            
                    
                    调试和分析记录4
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.1.3" data-path="profiling_调试和分析记录3.html">
            
                <a href="profiling_调试和分析记录3.html">
            
                    
                    调试和分析记录3
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="1.3.1.4" data-path="profiling_调试和分析记录2.html">
            
                <a href="profiling_调试和分析记录2.html">
            
                    
                    调试和分析记录2
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3.2" data-path="as_title_perf_tools.html">
            
                <a href="as_title_perf_tools.html">
            
                    
                    profiling工具相关
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.2.1" data-path="profiling_perf命令备忘录.html">
            
                <a href="profiling_perf命令备忘录.html">
            
                    
                    perf命令备忘录
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2.2" data-path="profiling_ftrace和trace-cmd记录.html">
            
                <a href="profiling_ftrace和trace-cmd记录.html">
            
                    
                    ftrace和trace-cmd记录
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2.3" data-path="profiling_ftrace使用实例.html">
            
                <a href="profiling_ftrace使用实例.html">
            
                    
                    ftrace使用实例
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2.4" data-path="profiling_systemtap实例.html">
            
                <a href="profiling_systemtap实例.html">
            
                    
                    systemtap实例
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2.5" data-path="system_analysis_bcc和ebpf.html">
            
                <a href="system_analysis_bcc和ebpf.html">
            
                    
                    bcc和ebpf(starting)
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3.3" data-path="as_title_app_perf.html">
            
                <a href="as_title_app_perf.html">
            
                    
                    应用profiling和优化
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.3.1" data-path="performance_ovs进程调查.html">
            
                <a href="performance_ovs进程调查.html">
            
                    
                    OVS进程调查
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3.2" data-path="performance_ping流程和函数调用解析.html">
            
                <a href="performance_ping流程和函数调用解析.html">
            
                    
                    ping流程和函数调用解析
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3.4" data-path="as_title_os_perf.html">
            
                <a href="as_title_os_perf.html">
            
                    
                    系统profiling和优化
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.4.1" data-path="profiling_VM互相ping场景下的延迟分析.html">
            
                <a href="profiling_VM互相ping场景下的延迟分析.html">
            
                    
                    VM互相ping场景下的延迟分析
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.4.2" data-path="CentOS_系统性能优化配置.html">
            
                <a href="CentOS_系统性能优化配置.html">
            
                    
                    CentOS 性能优化系统配置
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3.5" data-path="as_title_arch_perf.html">
            
                <a href="as_title_arch_perf.html">
            
                    
                    CPU ARCH相关
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.5.1" data-path="performance_CPU_microarchiteture_pmu.html">
            
                <a href="performance_CPU_microarchiteture_pmu.html">
            
                    
                    Top-down Microarchitecture Analysis Method(网摘)
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="as_title_cloud.html">
            
                <a href="as_title_cloud.html">
            
                    
                    Cloud和容器相关
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1" data-path="cloud_杂记.html">
            
                <a href="cloud_杂记.html">
            
                    
                    云杂记
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2" data-path="container_当代容器读书笔记.html">
            
                <a href="container_当代容器读书笔记.html">
            
                    
                    当代容器读书笔记
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="as_title_vdevice.html">
            
                <a href="as_title_vdevice.html">
            
                    
                    CPU和device虚拟化
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.1" data-path="as_title_gvisor.html">
            
                <a href="as_title_gvisor.html">
            
                    
                    gvisor
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.1.1" data-path="golang_gvisor代码_KVM.html">
            
                <a href="golang_gvisor代码_KVM.html">
            
                    
                    gvisor KVM模式代码
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.1.2" data-path="golang_gvisor调试.html">
            
                <a href="golang_gvisor调试.html">
            
                    
                    gvisor调试
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.1.3" data-path="golang_gvisor_ptrace.html">
            
                <a href="golang_gvisor_ptrace.html">
            
                    
                    gvisor ptrace模式介绍(网摘)
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5.2" data-path="rust_vmm_brief.html">
            
                <a href="rust_vmm_brief.html">
            
                    
                    rust VMM(virtual machine monitor)
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.2.1" data-path="rust_vmm_简介.html">
            
                <a href="rust_vmm_简介.html">
            
                    
                    rust-vmm简介
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2.2" data-path="rust_firecracker_代码.html">
            
                <a href="rust_firecracker_代码.html">
            
                    
                    firecracker代码
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2.3" data-path="rust_firecracker_使用.html">
            
                <a href="rust_firecracker_使用.html">
            
                    
                    firecracker使用
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2.4" data-path="rust_cloud-hypervisor_代码.html">
            
                <a href="rust_cloud-hypervisor_代码.html">
            
                    
                    cloud hypervisor代码
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2.5" data-path="rust_cloud-hypervisor_使用.html">
            
                <a href="rust_cloud-hypervisor_使用.html">
            
                    
                    cloud hypervisor使用
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2.6" data-path="rust_cloud-hypervisor_问题与解决.html">
            
                <a href="rust_cloud-hypervisor_问题与解决.html">
            
                    
                    cloud hypervisor问题与解决
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5.3" data-path="virtualization_virtio规范阅读笔记.html">
            
                <a href="virtualization_virtio规范阅读笔记.html">
            
                    
                    virtio规范阅读笔记.md
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.4" data-path="qemu_ovs_虚拟化环境.html">
            
                <a href="qemu_ovs_虚拟化环境.html">
            
                    
                    qemu OVS 虚拟化环境准备
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.5" data-path="qemu使用.html">
            
                <a href="qemu使用.html">
            
                    
                    Qemu使用(old)
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.6" data-path="as_title_networking.html">
            
                <a href="as_title_networking.html">
            
                    
                    计算机网络相关
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.6.1" data-path="networking_杂记1.html">
            
                <a href="networking_杂记1.html">
            
                    
                    networking杂记1
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.2" data-path="as_title_qemu_ovs.html">
            
                <a href="as_title_qemu_ovs.html">
            
                    
                    Qemu OVS和DPDK
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.6.2.1" data-path="OVS_DPDK_编译运行.html">
            
                <a href="OVS_DPDK_编译运行.html">
            
                    
                    OVS-DPDK编译运行
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.2.2" data-path="OVS_架构和代码.html">
            
                <a href="OVS_架构和代码.html">
            
                    
                    OVS架构和代码
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.2.3" data-path="OVS_DPDK_performance_HXT_ARM_server.html">
            
                <a href="OVS_DPDK_performance_HXT_ARM_server.html">
            
                    
                    OVS-DPDK for ARM server 性能测试环境
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.2.4" data-path="DPDK_Mellanox.html">
            
                <a href="DPDK_Mellanox.html">
            
                    
                    DPDK Mellanox
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.2.5" data-path="OVS_phy-vm-phy.html">
            
                <a href="OVS_phy-vm-phy.html">
            
                    
                    OVS PHY-VM-PHY
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.2.6" data-path="networking_网络虚拟化用例记录.html">
            
                <a href="networking_网络虚拟化用例记录.html">
            
                    
                    网络虚拟化用例记录
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.2.7" data-path="networking_网络虚拟化操作记录.html">
            
                <a href="networking_网络虚拟化操作记录.html">
            
                    
                    网络虚拟化操作记录
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.6.3" data-path="as_title_virtnet.html">
            
                <a href="as_title_virtnet.html">
            
                    
                    虚拟化网络
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.6.3.1" data-path="networking_tc_filter_连接veth和tap.html">
            
                <a href="networking_tc_filter_连接veth和tap.html">
            
                    
                    Connecting a veth device to tap
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.3.2" data-path="networking_multicast_vxlan_flannel.html">
            
                <a href="networking_multicast_vxlan_flannel.html">
            
                    
                    multicast vxlan和flannel
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.3.3" data-path="networking_virtio网络介绍.html">
            
                <a href="networking_virtio网络介绍.html">
            
                    
                    virtio网络介绍(网摘): vhost-net virtio-net vhost-user SRIOV
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.3.4" data-path="networking_virtualization_杂记.html">
            
                <a href="networking_virtualization_杂记.html">
            
                    
                    虚拟化网络杂记
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.3.5" data-path="networking_linux虚拟网络接口.html">
            
                <a href="networking_linux虚拟网络接口.html">
            
                    
                    linux虚拟网络接口(网摘)
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.7" data-path="as_title_arm_server.html">
            
                <a href="as_title_arm_server.html">
            
                    
                    ARM server
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.7.1" data-path="arm_server_杂记.html">
            
                <a href="arm_server_杂记.html">
            
                    
                    Arm server 杂记
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.8" data-path="as_title_embedded.html">
            
                <a href="as_title_embedded.html">
            
                    
                    嵌入式系统开发调试
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.8.1" data-path="embedded_debugging.html">
            
                <a href="embedded_debugging.html">
            
                    
                    嵌入式调试杂记
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.2" data-path="uboot_杂记.html">
            
                <a href="uboot_杂记.html">
            
                    
                    uboot杂记
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.3" data-path="buildroot_杂记.html">
            
                <a href="buildroot_杂记.html">
            
                    
                    buildroot杂记
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.4" data-path="toolchain_升级gcc问题解决.html">
            
                <a href="toolchain_升级gcc问题解决.html">
            
                    
                    升级GCC7.3问题解决
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.9" data-path="as_title_linuxdaily.html">
            
                <a href="as_title_linuxdaily.html">
            
                    
                    Linux工程实践
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.9.1" data-path="linux_日常使用.html">
            
                <a href="linux_日常使用.html">
            
                    
                    日常linux使用
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.2" data-path="git_日常使用.html">
            
                <a href="git_日常使用.html">
            
                    
                    日常git使用
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.3" data-path="向kernel提交补丁.html">
            
                <a href="向kernel提交补丁.html">
            
                    
                    向kernel提交补丁
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.4" data-path="linux_ssh_relay.html">
            
                <a href="linux_ssh_relay.html">
            
                    
                    ssh relay
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.5" data-path="gitlab_ci.html">
            
                <a href="gitlab_ci.html">
            
                    
                    gitlab CI
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.6" data-path="docker_操作记录.html">
            
                <a href="docker_操作记录.html">
            
                    
                    docker操作记录
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.7" data-path="centos_操作记录.html">
            
                <a href="centos_操作记录.html">
            
                    
                    centos操作记录
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.10" data-path="as_title_golang.html">
            
                <a href="as_title_golang.html">
            
                    
                    Golang
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.10.1" data-path="as_title_golang1.html">
            
                <a href="as_title_golang1.html">
            
                    
                    入门
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.10.1.1" data-path="golang_语法基础.html">
            
                <a href="golang_语法基础.html">
            
                    
                    Golang 语法基础
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.1.2" data-path="golang_json性能.html">
            
                <a href="golang_json性能.html">
            
                    
                    Golang json性能比较
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.10.2" data-path="golang_原理.html">
            
                <a href="golang_原理.html">
            
                    
                    Golang 原理相关
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.10.2.1" data-path="golang_interface原理.html">
            
                <a href="golang_interface原理.html">
            
                    
                    Golang interface原理(网摘)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.2.2" data-path="golang_内存分配.html">
            
                <a href="golang_内存分配.html">
            
                    
                    Golang 内存分配(网摘)
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.10.3" data-path="golang_标准库.html">
            
                <a href="golang_标准库.html">
            
                    
                    Golang 标准库
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.4" data-path="golang_我的反射代码.html">
            
                <a href="golang_我的反射代码.html">
            
                    
                    Golang 我的反射代码
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.5" data-path="golang_问答.html">
            
                <a href="golang_问答.html">
            
                    
                    Golang 问答
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.6" data-path="golang_高效go.html">
            
                <a href="golang_高效go.html">
            
                    
                    Golang 高效go
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.7" data-path="golang_进阶.html">
            
                <a href="golang_进阶.html">
            
                    
                    Golang 进阶
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.8" data-path="as_title_golang2.html">
            
                <a href="as_title_golang2.html">
            
                    
                    Golang 杂记
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.10.8.1" data-path="golang_杂记1.html">
            
                <a href="golang_杂记1.html">
            
                    
                    Golang 杂记1
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.8.2" data-path="golang_杂记2.html">
            
                <a href="golang_杂记2.html">
            
                    
                    Golang 杂记2
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.8.3" data-path="golang_杂记3.html">
            
                <a href="golang_杂记3.html">
            
                    
                    Golang 杂记3
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.8.4" data-path="golang_lib选型.html">
            
                <a href="golang_lib选型.html">
            
                    
                    Golang lib选型
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.8.5" data-path="golang_mod_proxy.html">
            
                <a href="golang_mod_proxy.html">
            
                    
                    go mod和go proxy
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.8.6" data-path="golang_汇编_arm64.html">
            
                <a href="golang_汇编_arm64.html">
            
                    
                    Golang 汇编语法和arm64小知识
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.8.7" data-path="golang_cgo_swig.html">
            
                <a href="golang_cgo_swig.html">
            
                    
                    go调用c可以用swig
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.10.9" data-path="as_title_golang3.html">
            
                <a href="as_title_golang3.html">
            
                    
                    Golang 环境和工具链生成
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.10.9.1" data-path="golang_toolchain_ppc.html">
            
                <a href="golang_toolchain_ppc.html">
            
                    
                    go tools增加ppc32支持.md
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.9.2" data-path="golang_toolchain_compile_gccgo.html">
            
                <a href="golang_toolchain_compile_gccgo.html">
            
                    
                    编译gccgo
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.9.3" data-path="golang_go_on_mips.html">
            
                <a href="golang_go_on_mips.html">
            
                    
                    go on mips boards(not so updated)
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.10.9.3.1" data-path="golang_go_on_mips_part1.html">
            
                <a href="golang_go_on_mips_part1.html">
            
                    
                    part 1: cross compile go
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.9.3.2" data-path="golang_go_on_mips_part2.html">
            
                <a href="golang_go_on_mips_part2.html">
            
                    
                    part 2: build native go compiler
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.9.3.3" data-path="golang_go_on_mips_part3.html">
            
                <a href="golang_go_on_mips_part3.html">
            
                    
                    part 3: gccgo experiments
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.9.3.4" data-path="golang_go_on_mips_part4.html">
            
                <a href="golang_go_on_mips_part4.html">
            
                    
                    part 4: Golang json performance
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.9.3.5" data-path="golang_gentoo_on_mips_board_and_build_go.html">
            
                <a href="golang_gentoo_on_mips_board_and_build_go.html">
            
                    
                    Gentoo on mips board and build go
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.10.10" data-path="as_title_golang4.html">
            
                <a href="as_title_golang4.html">
            
                    
                    微服务
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.10.10.1" data-path="golang_micro.html">
            
                <a href="golang_micro.html">
            
                    
                    go-micro和micro
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.10.2" data-path="golang_微服务概念.html">
            
                <a href="golang_微服务概念.html">
            
                    
                    微服务概念
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.10.11" data-path="as_title_golang5.html">
            
                <a href="as_title_golang5.html">
            
                    
                    解释器和编解码
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.10.11.1" data-path="golang_yeagi.html">
            
                <a href="golang_yeagi.html">
            
                    
                    解释器yeagi
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.11.2" data-path="golang_tengo.html">
            
                <a href="golang_tengo.html">
            
                    
                    解释器tengo
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.11.3" data-path="golang_govaluate.html">
            
                <a href="golang_govaluate.html">
            
                    
                    解释器govaluate
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.11.4" data-path="golang_encoding_gotiny.html">
            
                <a href="golang_encoding_gotiny.html">
            
                    
                    gotiny编解码
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.11.5" data-path="golang_abs.html">
            
                <a href="golang_abs.html">
            
                    
                    解释器abs
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.10.12" data-path="as_title_golang6.html">
            
                <a href="as_title_golang6.html">
            
                    
                    调试和性能
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.10.12.1" data-path="golang_调试记录.html">
            
                <a href="golang_调试记录.html">
            
                    
                    Golang 调试记录
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.12.2" data-path="golang_topid性能优化.html">
            
                <a href="golang_topid性能优化.html">
            
                    
                    Golang topid性能优化
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.12.3" data-path="golang_gshell性能调试.html">
            
                <a href="golang_gshell性能调试.html">
            
                    
                    Golang gshell性能调试
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.10.13" data-path="as_title_golang7.html">
            
                <a href="as_title_golang7.html">
            
                    
                    网络和消息中间件
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.10.13.1" data-path="golang_zmq.html">
            
                <a href="golang_zmq.html">
            
                    
                    消息中间件基本概念和zero mq
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.13.2" data-path="golang_mango.html">
            
                <a href="golang_mango.html">
            
                    
                    消息中间件mango
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.13.3" data-path="golang_libp2p.html">
            
                <a href="golang_libp2p.html">
            
                    
                    Golang p2p网络
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.11" data-path="as_title_rust.html">
            
                <a href="as_title_rust.html">
            
                    
                    Rust
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.11.1" data-path="rust_入门_brief.html">
            
                <a href="rust_入门_brief.html">
            
                    
                    Rust 入门系列
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.11.1.1" data-path="rust_books.html">
            
                <a href="rust_books.html">
            
                    
                    Rust reference books
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11.1.2" data-path="rust_入门1.html">
            
                <a href="rust_入门1.html">
            
                    
                    Rust 安装和基础语法
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11.1.3" data-path="rust_入门2.html">
            
                <a href="rust_入门2.html">
            
                    
                    Rust 泛型和内存所有权
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11.1.4" data-path="rust_入门3.html">
            
                <a href="rust_入门3.html">
            
                    
                    Rust 闭包 容器 迭代器 生成器 线程
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11.1.5" data-path="rust_工程构建.html">
            
                <a href="rust_工程构建.html">
            
                    
                    Rust 工程构建
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.11.2" data-path="rust_coding_brief.html">
            
                <a href="rust_coding_brief.html">
            
                    
                    Rust 代码积累
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.11.2.1" data-path="rust_序列化.html">
            
                <a href="rust_序列化.html">
            
                    
                    Rust 序列化原理
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11.2.2" data-path="rust_知识点积累.html">
            
                <a href="rust_知识点积累.html">
            
                    
                    Rust 知识点更新
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11.2.3" data-path="rust_adaptiveservice.html">
            
                <a href="rust_adaptiveservice.html">
            
                    
                    rust版本的adaptiveservice探索
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11.2.4" data-path="rust_常用设施.html">
            
                <a href="rust_常用设施.html">
            
                    
                    Rust 常用设施
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11.2.5" data-path="rust_代码小段.html">
            
                <a href="rust_代码小段.html">
            
                    
                    Rust 代码小段
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.11.3" data-path="others.html">
            
                <a href="others.html">
            
                    
                    其他
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.11.3.1" data-path="rust_mdbook_使用.html">
            
                <a href="rust_mdbook_使用.html">
            
                    
                    Rust 使用mdbook
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.12" data-path="as_title_scripts.html">
            
                <a href="as_title_scripts.html">
            
                    
                    脚本
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.12.1" data-path="shell_变量.html">
            
                <a href="shell_变量.html">
            
                    
                    shell变量
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.2" data-path="shell_基础篇.html">
            
                <a href="shell_基础篇.html">
            
                    
                    shell命令和脚本记录-基础篇
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.3" data-path="shell_高级篇.html">
            
                <a href="shell_高级篇.html">
            
                    
                    shell命令和脚本记录-高级篇
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.4" data-path="shell_脚本片段.html">
            
                <a href="shell_脚本片段.html">
            
                    
                    shell脚本片段
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.5" data-path="python_记录.html">
            
                <a href="python_记录.html">
            
                    
                    python记录
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.6" data-path="lua_记录.html">
            
                <a href="lua_记录.html">
            
                    
                    lua记录
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.7" data-path="shell_rds脚本阅读.html">
            
                <a href="shell_rds脚本阅读.html">
            
                    
                    RDS脚本阅读
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.8" data-path="Project_Euler.html">
            
                <a href="Project_Euler.html">
            
                    
                    Project Euler
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.13" data-path="as_title_app.html">
            
                <a href="as_title_app.html">
            
                    
                    应用相关
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.13.1" data-path="app_sysbench代码分析.html">
            
                <a href="app_sysbench代码分析.html">
            
                    
                    sysbench代码分析
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.14" data-path="as_title_cos.html">
            
                <a href="as_title_cos.html">
            
                    
                    C和Operating System
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.14.1" data-path="system_libc_part1.html">
            
                <a href="system_libc_part1.html">
            
                    
                    libc概览1
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.14.2" data-path="system_libc_part2.html">
            
                <a href="system_libc_part2.html">
            
                    
                    libc概览2
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.14.3" data-path="system_libc_part3.html">
            
                <a href="system_libc_part3.html">
            
                    
                    libc概览3
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.14.4" data-path="system_原理杂记.html">
            
                <a href="system_原理杂记.html">
            
                    
                    系统原理杂记
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.14.5" data-path="system_alpine.html">
            
                <a href="system_alpine.html">
            
                    
                    Alpine Linux
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.14.6" data-path="system_进程间通信.html">
            
                <a href="system_进程间通信.html">
            
                    
                    进程间通信
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.14.7" data-path="system_特殊功能fd.html">
            
                <a href="system_特殊功能fd.html">
            
                    
                    eventfd timerfd signalfd和fd共享
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.14.8" data-path="c_automake_autoconf.html">
            
                <a href="c_automake_autoconf.html">
            
                    
                    automake autoconf
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.14.9" data-path="makefile_原理和实践.html">
            
                <a href="makefile_原理和实践.html">
            
                    
                    makefile
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.14.10" data-path="c_编程杂记高级篇.html">
            
                <a href="c_编程杂记高级篇.html">
            
                    
                    C编程杂记高级篇
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.14.11" data-path="c_编程杂记基础篇.html">
            
                <a href="c_编程杂记基础篇.html">
            
                    
                    C编程杂记基础篇
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.14.12" data-path="c_networking_socket高阶用法.html">
            
                <a href="c_networking_socket高阶用法.html">
            
                    
                    网络编程: Advanced Socket Topics(网摘)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.14.13" data-path="c_protobuf介绍.html">
            
                <a href="c_protobuf介绍.html">
            
                    
                    序列化: protobuf介绍
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.14.14" data-path="c_进程间通信_共享文件和共享内存.html">
            
                <a href="c_进程间通信_共享文件和共享内存.html">
            
                    
                    进程间通信: 共享文件和共享内存(网摘)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.14.15" data-path="c_pthread_condition和mutex.html">
            
                <a href="c_pthread_condition和mutex.html">
            
                    
                    并发 任务 事件 和锁.md
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.14.16" data-path="kernel_user_space_howto.html">
            
                <a href="kernel_user_space_howto.html">
            
                    
                    kernel space和user space交互(网摘, linux2.6)
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.15" data-path="as_title_driver.html">
            
                <a href="as_title_driver.html">
            
                    
                    内核 设备和驱动相关
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.15.1" data-path="platform_device_driver.html">
            
                <a href="platform_device_driver.html">
            
                    
                    平台驱动杂记
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.15.2" data-path="device_driver_杂记.html">
            
                <a href="device_driver_杂记.html">
            
                    
                    驱动调试杂记
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.15.3" data-path="device_localbus_16bit读写.html">
            
                <a href="device_localbus_16bit读写.html">
            
                    
                    CPLD做8bit到16bit转换
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.15.4" data-path="as_title_driver1.html">
            
                <a href="as_title_driver1.html">
            
                    
                    nand
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.15.4.1" data-path="device_driver_octeon_nand.html">
            
                <a href="device_driver_octeon_nand.html">
            
                    
                    octeon nand flash驱动
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.15.4.2" data-path="device_driver_nand概率写失败问题分析.html">
            
                <a href="device_driver_nand概率写失败问题分析.html">
            
                    
                    Nand flash概率写失败问题分析
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.15.5" data-path="octeon_remote_pci.html">
            
                <a href="octeon_remote_pci.html">
            
                    
                    octeon remote-pci.c阅读
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.15.6" data-path="Device_VFIO_notes.html">
            
                <a href="Device_VFIO_notes.html">
            
                    
                    VFIO简介
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.15.7" data-path="as_title_driver2.html">
            
                <a href="as_title_driver2.html">
            
                    
                    智能网卡和DPDK
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.15.7.1" data-path="smartNIC_智能网卡对比.html">
            
                <a href="smartNIC_智能网卡对比.html">
            
                    
                    智能网卡对比
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.15.7.2" data-path="octeon_pci_NIC.html">
            
                <a href="octeon_pci_NIC.html">
            
                    
                    octeon PCI NIC
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.15.7.3" data-path="as_title_driver3.html">
            
                <a href="as_title_driver3.html">
            
                    
                    octeon liquidIO
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.15.7.3.1" data-path="smartNIC_liquidIO_代码阅读app篇.html">
            
                <a href="smartNIC_liquidIO_代码阅读app篇.html">
            
                    
                    PCI-NIC 代码阅读 --app篇
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.15.7.3.2" data-path="smartNIC_liquidIO_代码阅读api篇.html">
            
                <a href="smartNIC_liquidIO_代码阅读api篇.html">
            
                    
                    PCI-NIC 代码阅读 --api篇
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.15.7.3.3" data-path="smartNIC_liquidIO_代码阅读driver篇之结构体.html">
            
                <a href="smartNIC_liquidIO_代码阅读driver篇之结构体.html">
            
                    
                    PCI-NIC 代码阅读 --driver篇之结构体
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.15.7.3.4" data-path="smartNIC_liquidIO_代码阅读driver篇.html">
            
                <a href="smartNIC_liquidIO_代码阅读driver篇.html">
            
                    
                    PCI-NIC 代码阅读 --driver篇
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.15.7.3.5" data-path="smartNIC_liquidIO_代码阅读真NIC篇.html">
            
                <a href="smartNIC_liquidIO_代码阅读真NIC篇.html">
            
                    
                    PCI-NIC 代码阅读 --真NIC篇
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.15.7.4" data-path="networking_dpdk使用_2014.html">
            
                <a href="networking_dpdk使用_2014.html">
            
                    
                    DPDK使用(2014)
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.15.8" data-path="device_nvme要点介绍.html">
            
                <a href="device_nvme要点介绍.html">
            
                    
                    nvme要点介绍
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.16" data-path="as_title_cpu.html">
            
                <a href="as_title_cpu.html">
            
                    
                    CPU Arch相关
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.16.1" data-path="cache_CPU和cache一致性原理.html">
            
                <a href="cache_CPU和cache一致性原理.html">
            
                    
                    CPU和cache一致性原理
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.16.2" data-path="as_title_cpu1.html">
            
                <a href="as_title_cpu1.html">
            
                    
                    ARM64
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.16.2.1" data-path="CPU_ARM64_thunder_overview.html">
            
                <a href="CPU_ARM64_thunder_overview.html">
            
                    
                    thunder 概览
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.16.2.2" data-path="CPU_ARM64_thunder_开发板操作记录.html">
            
                <a href="CPU_ARM64_thunder_开发板操作记录.html">
            
                    
                    thunder 开发板操作记录
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.16.2.3" data-path="CPU_ARM64_thunder_bdk.html">
            
                <a href="CPU_ARM64_thunder_bdk.html">
            
                    
                    thunder BDK
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.16.2.4" data-path="CPU_ARM64_thunder_efi_rtc.html">
            
                <a href="CPU_ARM64_thunder_efi_rtc.html">
            
                    
                    thunder RTC时间和efi
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.16.2.5" data-path="CPU_ARM64_thunder_uefi_fdt.html">
            
                <a href="CPU_ARM64_thunder_uefi_fdt.html">
            
                    
                    thunder uefi和fdt
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.16.2.6" data-path="CPU_ARM64_thunder_atf.html">
            
                <a href="CPU_ARM64_thunder_atf.html">
            
                    
                    thunder atf
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.16.2.7" data-path="CPU_ARM64_thunder_kernel_boot.html">
            
                <a href="CPU_ARM64_thunder_kernel_boot.html">
            
                    
                    thunder kernel启动打印流程
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.16.3" data-path="as_title_cpu2.html">
            
                <a href="as_title_cpu2.html">
            
                    
                    PPC
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.16.3.1" data-path="CPU_PPC启动多核Linux_流程和内存映射.html">
            
                <a href="CPU_PPC启动多核Linux_流程和内存映射.html">
            
                    
                    PPC启动多核linux: 流程和内存映射
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.16.3.2" data-path="CPU_PPC_kernel升级记录.html">
            
                <a href="CPU_PPC_kernel升级记录.html">
            
                    
                    PPC kernel升级记录
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.16.4" data-path="as_title_cpu3.html">
            
                <a href="as_title_cpu3.html">
            
                    
                    MIPS
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.16.4.1" data-path="CPU_MIPS_octeon地址空间和寄存器访问.html">
            
                <a href="CPU_MIPS_octeon地址空间和寄存器访问.html">
            
                    
                    octeon 地址空间和寄存器访问
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.16.4.2" data-path="CPU_MIPS_octeon操作记录.html">
            
                <a href="CPU_MIPS_octeon操作记录.html">
            
                    
                    octeon 操作记录
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.16.4.3" data-path="CPU_MIPS_octeon_包处理性能.html">
            
                <a href="CPU_MIPS_octeon_包处理性能.html">
            
                    
                    octeon 系列处理器包处理性能
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.16.4.4" data-path="CPU_MIPS_octeon_ddr调试记录.html">
            
                <a href="CPU_MIPS_octeon_ddr调试记录.html">
            
                    
                    octeon DDR调试
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.16.4.5" data-path="CPU_MIPS_octeon_BDK.html">
            
                <a href="CPU_MIPS_octeon_BDK.html">
            
                    
                    octeon CN78xx BDK
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.16.4.6" data-path="kernel_增加ECC中断.html">
            
                <a href="kernel_增加ECC中断.html">
            
                    
                    octeon 增加ECC中断
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.16.4.7" data-path="CPU_MIPS_octeon_hw-ddr2代码走读.html">
            
                <a href="CPU_MIPS_octeon_hw-ddr2代码走读.html">
            
                    
                    octeon hw-ddr2代码走读
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.16.4.8" data-path="CPU_MIPS_octeon_reboot调试和ddr中断.html">
            
                <a href="CPU_MIPS_octeon_reboot调试和ddr中断.html">
            
                    
                    octeon reboot调试和DDR中断
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.16.4.9" data-path="CPU_MIPS_octeon中断.html">
            
                <a href="CPU_MIPS_octeon中断.html">
            
                    
                    octeon 中断
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.16.4.10" data-path="CPU_MIPS_octeon原子操作.html">
            
                <a href="CPU_MIPS_octeon原子操作.html">
            
                    
                    octeon 原子操作
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.16.4.11" data-path="CPU_MIPS_octeon网口代码分析.html">
            
                <a href="CPU_MIPS_octeon网口代码分析.html">
            
                    
                    octeon 网口代码分析
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            本书使用 GitBook 发布
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".." >调试和分析记录2</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div class="search-plus" id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <div id="anchor-navigation-ex-navbar"><i class="fa fa-navicon"></i><ul><li><span class="title-icon "></span><a href="#&#x67E5;&#x770B;pci&#x7684;msi&#x4E2D;&#x65AD;"><b>1. </b>&#x67E5;&#x770B;PCI&#x7684;MSI&#x4E2D;&#x65AD;</a></li><li><span class="title-icon "></span><a href="#&#x4E00;&#x6B21;&#x4E2D;&#x65AD;&#x6267;&#x884C;&#x8BB0;&#x5F55;&#x548C;kvm&#x865A;&#x62DF;&#x673A;&#x76F8;&#x5173;&#x7684;trace"><b>2. </b>&#x4E00;&#x6B21;&#x4E2D;&#x65AD;&#x6267;&#x884C;&#x8BB0;&#x5F55;&#x548C;KVM&#x865A;&#x62DF;&#x673A;&#x76F8;&#x5173;&#x7684;trace</a></li><ul><li><span class="title-icon "></span><a href="#&#x4E2D;&#x65AD;&#x53D1;&#x751F;&#x5728;core-42&#x4E0A;"><b>2.1. </b>&#x4E2D;&#x65AD;&#x53D1;&#x751F;&#x5728;core 42&#x4E0A;</a></li><li><span class="title-icon "></span><a href="#core-42&#x7684;&#x6B63;&#x5E38;&#x6D41;&#x7A0B;"><b>2.2. </b>core 42&#x7684;&#x6B63;&#x5E38;&#x6D41;&#x7A0B;</a></li><li><span class="title-icon "></span><a href="#perf-sched&#x865A;&#x62DF;&#x673A;"><b>2.3. </b>perf sched&#x865A;&#x62DF;&#x673A;</a></li></ul><li><span class="title-icon "></span><a href="#lmbench&#x7684;latmemrd&#x600E;&#x4E48;&#x7B97;cache&#x8BBF;&#x95EE;&#x5EF6;&#x8FDF;"><b>3. </b>lmbench&#x7684;lat_mem_rd&#x600E;&#x4E48;&#x7B97;cache&#x8BBF;&#x95EE;&#x5EF6;&#x8FDF;</a></li><li><span class="title-icon "></span><a href="#pstack&#x770B;qemu&#x7684;&#x8FDB;&#x7A0B;"><b>4. </b>pstack&#x770B;qemu&#x7684;&#x8FDB;&#x7A0B;</a></li><li><span class="title-icon "></span><a href="#lsof&#x8BE6;&#x7EC6;&#x8F93;&#x51FA;"><b>5. </b>lsof&#x8BE6;&#x7EC6;&#x8F93;&#x51FA;</a></li><li><span class="title-icon "></span><a href="#&#x5173;&#x4E8E;&#x5171;&#x4EAB;cluster&#x7684;2core"><b>6. </b>&#x5173;&#x4E8E;&#x5171;&#x4EAB;cluster&#x7684;2core</a></li><li><span class="title-icon "></span><a href="#&#x5173;&#x4E8E;latency&#x548C;throughput"><b>7. </b>&#x5173;&#x4E8E;latency&#x548C;throughput</a></li><li><span class="title-icon "></span><a href="#&#x5173;&#x4E8E;timer"><b>8. </b>&#x5173;&#x4E8E;timer</a></li><li><span class="title-icon "></span><a href="#cache&#x9884;&#x53D6;"><b>9. </b>cache&#x9884;&#x53D6;</a></li><li><span class="title-icon "></span><a href="#&#x5FEB;&#x901F;&#x627E;&#x5230;&#x4E00;&#x4E2A;&#x8FDB;&#x7A0B;&#x7684;log"><b>10. </b>&#x5FEB;&#x901F;&#x627E;&#x5230;&#x4E00;&#x4E2A;&#x8FDB;&#x7A0B;&#x7684;log</a></li><li><span class="title-icon "></span><a href="#&#x7F16;&#x8BD1;&#x8C03;&#x8BD5;&#x624B;&#x6BB5;"><b>11. </b>&#x7F16;&#x8BD1;&#x8C03;&#x8BD5;&#x624B;&#x6BB5;</a></li><ul><li><span class="title-icon "></span><a href="#&#x52A0;&#x5E27;&#x6307;&#x9488;"><b>11.1. </b>&#x52A0;&#x5E27;&#x6307;&#x9488;</a></li><li><span class="title-icon "></span><a href="#&#x5F3A;&#x5236;&#x4E0D;&#x4F18;&#x5316;-c&#x8BED;&#x8A00;-attribute"><b>11.2. </b>&#x5F3A;&#x5236;&#x4E0D;&#x4F18;&#x5316;, C&#x8BED;&#x8A00; __attribute__</a></li></ul><li><span class="title-icon "></span><a href="#&#x5173;&#x4E8E;no-hz"><b>12. </b>&#x5173;&#x4E8E;no hz</a></li><ul><li><span class="title-icon "></span><a href="#&#x53EA;&#x52A0;isolcpus"><b>12.1. </b>&#x53EA;&#x52A0;isolcpus</a></li><li><span class="title-icon "></span><a href="#&#x5728;isolcpus&#x57FA;&#x7840;&#x4E0A;-&#x52A0;nohzfull&#x548C;rcunocbs"><b>12.2. </b>&#x5728;isolcpus&#x57FA;&#x7840;&#x4E0A;, &#x52A0;nohz_full&#x548C;rcu_nocbs</a></li><li><span class="title-icon "></span><a href="#ipi&#x4E2D;&#x65AD;&#x548C;archtimer"><b>12.3. </b>IPI&#x4E2D;&#x65AD;&#x548C;arch_timer</a></li><li><span class="title-icon "></span><a href="#&#x7ED3;&#x8BBA;"><b>12.4. </b>&#x7ED3;&#x8BBA;</a></li></ul><li><span class="title-icon "></span><a href="#&#x52A8;&#x6001;&#x8C03;&#x9891;&#x548C;&#x4E2D;&#x65AD;"><b>13. </b>&#x52A8;&#x6001;&#x8C03;&#x9891;&#x548C;&#x4E2D;&#x65AD;</a></li><li><span class="title-icon "></span><a href="#&#x8C03;&#x8BD5;testpmd"><b>14. </b>&#x8C03;&#x8BD5;testpmd</a></li><ul><li><span class="title-icon "></span><a href="#&#x73B0;&#x8C61;"><b>14.1. </b>&#x73B0;&#x8C61;</a></li><li><span class="title-icon "></span><a href="#&#x6253;&#x5F00;coredump&#x5E76;&#x7528;gdb&#x8C03;&#x8BD5;"><b>14.2. </b>&#x6253;&#x5F00;coredump&#x5E76;&#x7528;gdb&#x8C03;&#x8BD5;</a></li><li><span class="title-icon "></span><a href="#&#x662F;&#x6570;&#x7EC4;&#x8D8A;&#x754C;&#x5417;----&#x7B2C;&#x4E00;&#x6B21;&#x95EE;"><b>14.3. </b>&#x662F;&#x6570;&#x7EC4;&#x8D8A;&#x754C;&#x5417;? -- &#x7B2C;&#x4E00;&#x6B21;&#x95EE;</a></li><li><span class="title-icon "></span><a href="#&#x770B;&#x6C47;&#x7F16;"><b>14.4. </b>&#x770B;&#x6C47;&#x7F16;</a></li><li><span class="title-icon "></span><a href="#&#x6269;&#x5927;&#x6808;"><b>14.5. </b>&#x6269;&#x5927;&#x6808;</a></li><li><span class="title-icon "></span><a href="#&#x68C0;&#x67E5;&#x5185;&#x5B58;&#x5206;&#x5E03;"><b>14.6. </b>&#x68C0;&#x67E5;&#x5185;&#x5B58;&#x5206;&#x5E03;</a></li><li><span class="title-icon "></span><a href="#&#x8FD8;&#x662F;&#x56DE;&#x5230;&#x6570;&#x7EC4;&#x8D8A;&#x754C;"><b>14.7. </b>&#x8FD8;&#x662F;&#x56DE;&#x5230;&#x6570;&#x7EC4;&#x8D8A;&#x754C;</a></li><li><span class="title-icon "></span><a href="#&#x8BB0;&#x5F55;&#x4E00;&#x4E0B;gdb&#x7528;&#x5230;&#x7684;&#x547D;&#x4EE4;"><b>14.8. </b>&#x8BB0;&#x5F55;&#x4E00;&#x4E0B;gdb&#x7528;&#x5230;&#x7684;&#x547D;&#x4EE4;</a></li></ul><li><span class="title-icon "></span><a href="#&#x8C03;&#x8BD5;testpmd&#x7EED;"><b>15. </b>&#x8C03;&#x8BD5;testpmd&#x7EED;</a></li><ul><li><span class="title-icon "></span><a href="#macswap&#x6BB5;&#x9519;&#x8BEF;"><b>15.1. </b>macswap&#x6BB5;&#x9519;&#x8BEF;</a></li></ul><li><span class="title-icon "></span><a href="#&#x4FEE;&#x6539;&#x6808;&#x5927;&#x5C0F;"><b>16. </b>&#x4FEE;&#x6539;&#x6808;&#x5927;&#x5C0F;</a></li><li><span class="title-icon "></span><a href="#objdump&#x6C47;&#x7F16;&#x548C;c&#x6DF7;&#x5408;&#x663E;&#x793A;"><b>17. </b>objdump&#x6C47;&#x7F16;&#x548C;C&#x6DF7;&#x5408;&#x663E;&#x793A;</a></li><li><span class="title-icon "></span><a href="#coredump&#x548C;gdb"><b>18. </b>coredump&#x548C;GDB</a></li><li><span class="title-icon "></span><a href="#&#x67E5;&#x770B;&#x4F18;&#x5316;level&#x7684;&#x8BE6;&#x7EC6;&#x5F00;&#x5173;"><b>19. </b>&#x67E5;&#x770B;&#x4F18;&#x5316;level&#x7684;&#x8BE6;&#x7EC6;&#x5F00;&#x5173;</a></li></ul></div><a href="#&#x67E5;&#x770B;pci&#x7684;msi&#x4E2D;&#x65AD;" id="anchorNavigationExGoTop"><i class="fa fa-arrow-up"></i></a><ul>
<li><a href="#&#x67E5;&#x770B;pci&#x7684;msi&#x4E2D;&#x65AD;">&#x67E5;&#x770B;PCI&#x7684;MSI&#x4E2D;&#x65AD;</a></li>
<li><a href="#&#x4E00;&#x6B21;&#x4E2D;&#x65AD;&#x6267;&#x884C;&#x8BB0;&#x5F55;&#x548C;kvm&#x865A;&#x62DF;&#x673A;&#x76F8;&#x5173;&#x7684;trace">&#x4E00;&#x6B21;&#x4E2D;&#x65AD;&#x6267;&#x884C;&#x8BB0;&#x5F55;&#x548C;KVM&#x865A;&#x62DF;&#x673A;&#x76F8;&#x5173;&#x7684;trace</a><ul>
<li><a href="#&#x4E2D;&#x65AD;&#x53D1;&#x751F;&#x5728;core-42&#x4E0A;">&#x4E2D;&#x65AD;&#x53D1;&#x751F;&#x5728;core 42&#x4E0A;</a></li>
<li><a href="#core-42&#x7684;&#x6B63;&#x5E38;&#x6D41;&#x7A0B;">core 42&#x7684;&#x6B63;&#x5E38;&#x6D41;&#x7A0B;</a></li>
<li><a href="#perf-sched&#x865A;&#x62DF;&#x673A;">perf sched&#x865A;&#x62DF;&#x673A;</a></li>
</ul>
</li>
<li><a href="#lmbench&#x7684;lat_mem_rd&#x600E;&#x4E48;&#x7B97;cache&#x8BBF;&#x95EE;&#x5EF6;&#x8FDF;">lmbench&#x7684;lat_mem_rd&#x600E;&#x4E48;&#x7B97;cache&#x8BBF;&#x95EE;&#x5EF6;&#x8FDF;</a></li>
<li><a href="#pstack&#x770B;qemu&#x7684;&#x8FDB;&#x7A0B;">pstack&#x770B;qemu&#x7684;&#x8FDB;&#x7A0B;</a></li>
<li><a href="#lsof&#x8BE6;&#x7EC6;&#x8F93;&#x51FA;">lsof&#x8BE6;&#x7EC6;&#x8F93;&#x51FA;</a></li>
<li><a href="#&#x5173;&#x4E8E;&#x5171;&#x4EAB;cluster&#x7684;2core">&#x5173;&#x4E8E;&#x5171;&#x4EAB;cluster&#x7684;2core</a></li>
<li><a href="#&#x5173;&#x4E8E;latency&#x548C;throughput">&#x5173;&#x4E8E;latency&#x548C;throughput</a></li>
<li><a href="#&#x5173;&#x4E8E;timer">&#x5173;&#x4E8E;timer</a></li>
<li><a href="#cache&#x9884;&#x53D6;">cache&#x9884;&#x53D6;</a></li>
<li><a href="#&#x5FEB;&#x901F;&#x627E;&#x5230;&#x4E00;&#x4E2A;&#x8FDB;&#x7A0B;&#x7684;log">&#x5FEB;&#x901F;&#x627E;&#x5230;&#x4E00;&#x4E2A;&#x8FDB;&#x7A0B;&#x7684;log</a></li>
<li><a href="#&#x7F16;&#x8BD1;&#x8C03;&#x8BD5;&#x624B;&#x6BB5;">&#x7F16;&#x8BD1;&#x8C03;&#x8BD5;&#x624B;&#x6BB5;</a><ul>
<li><a href="#&#x52A0;&#x5E27;&#x6307;&#x9488;">&#x52A0;&#x5E27;&#x6307;&#x9488;</a></li>
<li><a href="#&#x5F3A;&#x5236;&#x4E0D;&#x4F18;&#x5316;-c&#x8BED;&#x8A00;-__attribute__">&#x5F3A;&#x5236;&#x4E0D;&#x4F18;&#x5316;, C&#x8BED;&#x8A00; <code>__attribute__</code></a></li>
</ul>
</li>
<li><a href="#&#x5173;&#x4E8E;no-hz">&#x5173;&#x4E8E;no hz</a><ul>
<li><a href="#&#x53EA;&#x52A0;isolcpus">&#x53EA;&#x52A0;isolcpus</a></li>
<li><a href="#&#x5728;isolcpus&#x57FA;&#x7840;&#x4E0A;-&#x52A0;nohz_full&#x548C;rcu_nocbs">&#x5728;isolcpus&#x57FA;&#x7840;&#x4E0A;, &#x52A0;nohz_full&#x548C;rcu_nocbs</a></li>
<li><a href="#ipi&#x4E2D;&#x65AD;&#x548C;arch_timer">IPI&#x4E2D;&#x65AD;&#x548C;arch_timer</a></li>
<li><a href="#&#x7ED3;&#x8BBA;">&#x7ED3;&#x8BBA;</a></li>
</ul>
</li>
<li><a href="#&#x52A8;&#x6001;&#x8C03;&#x9891;&#x548C;&#x4E2D;&#x65AD;">&#x52A8;&#x6001;&#x8C03;&#x9891;&#x548C;&#x4E2D;&#x65AD;</a></li>
<li><a href="#&#x8C03;&#x8BD5;testpmd">&#x8C03;&#x8BD5;testpmd</a><ul>
<li><a href="#&#x73B0;&#x8C61;">&#x73B0;&#x8C61;</a></li>
<li><a href="#&#x6253;&#x5F00;coredump&#x5E76;&#x7528;gdb&#x8C03;&#x8BD5;">&#x6253;&#x5F00;coredump&#x5E76;&#x7528;gdb&#x8C03;&#x8BD5;</a></li>
<li><a href="#&#x662F;&#x6570;&#x7EC4;&#x8D8A;&#x754C;&#x5417;----&#x7B2C;&#x4E00;&#x6B21;&#x95EE;">&#x662F;&#x6570;&#x7EC4;&#x8D8A;&#x754C;&#x5417;? -- &#x7B2C;&#x4E00;&#x6B21;&#x95EE;</a></li>
<li><a href="#&#x770B;&#x6C47;&#x7F16;">&#x770B;&#x6C47;&#x7F16;</a></li>
<li><a href="#&#x6269;&#x5927;&#x6808;">&#x6269;&#x5927;&#x6808;</a></li>
<li><a href="#&#x68C0;&#x67E5;&#x5185;&#x5B58;&#x5206;&#x5E03;">&#x68C0;&#x67E5;&#x5185;&#x5B58;&#x5206;&#x5E03;</a></li>
<li><a href="#&#x8FD8;&#x662F;&#x56DE;&#x5230;&#x6570;&#x7EC4;&#x8D8A;&#x754C;">&#x8FD8;&#x662F;&#x56DE;&#x5230;&#x6570;&#x7EC4;&#x8D8A;&#x754C;</a></li>
<li><a href="#&#x8BB0;&#x5F55;&#x4E00;&#x4E0B;gdb&#x7528;&#x5230;&#x7684;&#x547D;&#x4EE4;">&#x8BB0;&#x5F55;&#x4E00;&#x4E0B;gdb&#x7528;&#x5230;&#x7684;&#x547D;&#x4EE4;</a></li>
</ul>
</li>
<li><a href="#&#x8C03;&#x8BD5;testpmd&#x7EED;">&#x8C03;&#x8BD5;testpmd&#x7EED;</a><ul>
<li><a href="#macswap&#x6BB5;&#x9519;&#x8BEF;">macswap&#x6BB5;&#x9519;&#x8BEF;</a></li>
</ul>
</li>
<li><a href="#&#x4FEE;&#x6539;&#x6808;&#x5927;&#x5C0F;">&#x4FEE;&#x6539;&#x6808;&#x5927;&#x5C0F;</a></li>
<li><a href="#objdump&#x6C47;&#x7F16;&#x548C;c&#x6DF7;&#x5408;&#x663E;&#x793A;">objdump&#x6C47;&#x7F16;&#x548C;C&#x6DF7;&#x5408;&#x663E;&#x793A;</a></li>
<li><a href="#coredump&#x548C;gdb">coredump&#x548C;GDB</a></li>
<li><a href="#&#x67E5;&#x770B;&#x4F18;&#x5316;level&#x7684;&#x8BE6;&#x7EC6;&#x5F00;&#x5173;">&#x67E5;&#x770B;&#x4F18;&#x5316;level&#x7684;&#x8BE6;&#x7EC6;&#x5F00;&#x5173;</a></li>
</ul>
<h1 id="&#x67E5;&#x770B;pci&#x7684;msi&#x4E2D;&#x65AD;"><a name="&#x67E5;&#x770B;pci&#x7684;msi&#x4E2D;&#x65AD;" class="anchor-navigation-ex-anchor" href="#&#x67E5;&#x770B;pci&#x7684;msi&#x4E2D;&#x65AD;"><i class="fa fa-link" aria-hidden="true"></i></a>1. &#x67E5;&#x770B;PCI&#x7684;MSI&#x4E2D;&#x65AD;</h1>
<p><code>/proc/interrupts</code>&#x91CC;&#x80FD;&#x663E;&#x793A;&#x4E2D;&#x65AD;&#x7684;&#x4FE1;&#x606F;, &#x4F46;&#x4E0D;&#x80FD;&#x5F88;&#x65B9;&#x4FBF;&#x7684;&#x5BF9;&#x5E94;&#x5230;&#x662F;&#x54EA;&#x4E2A;&#x8BBE;&#x5907;&#x7684;&#x4E2D;&#x65AD;.</p>
<p>&#x6BD4;&#x5982;&#x5728;&#x6211;&#x7684;VM&#x91CC;, &#x6709;:</p>
<pre class="language-"><code class="lang-sh">$ <span class="token function">cat</span> /proc/interrupts
           CPU0       CPU1       CPU2       CPU3
  <span class="token number">2</span>:    <span class="token number">1020348</span>     <span class="token number">924296</span>     <span class="token number">763104</span>     <span class="token number">823621</span>     GICv3  <span class="token number">27</span> Level     arch_timer
  <span class="token number">4</span>:        <span class="token number">116</span>          <span class="token number">0</span>          <span class="token number">0</span>          <span class="token number">0</span>     GICv3  <span class="token number">33</span> Level     uart-pl011
 <span class="token number">42</span>:          <span class="token number">0</span>          <span class="token number">0</span>          <span class="token number">0</span>          <span class="token number">0</span>     GICv3  <span class="token number">23</span> Level     arm-pmu
 <span class="token number">43</span>:          <span class="token number">0</span>          <span class="token number">0</span>          <span class="token number">0</span>          <span class="token number">0</span>     pl061   <span class="token number">3</span> Edge      ACPI:Event
 <span class="token number">44</span>:          <span class="token number">1</span>          <span class="token number">0</span>          <span class="token number">0</span>          <span class="token number">0</span>   ITS-MSI <span class="token number">16384</span> Edge      aerdrv, PCIe PME, pciehp
 <span class="token number">45</span>:          <span class="token number">1</span>          <span class="token number">0</span>          <span class="token number">0</span>          <span class="token number">0</span>   ITS-MSI <span class="token number">18432</span> Edge      aerdrv, PCIe PME, pciehp
 <span class="token number">46</span>:          <span class="token number">1</span>          <span class="token number">0</span>          <span class="token number">0</span>          <span class="token number">0</span>   ITS-MSI <span class="token number">20480</span> Edge      aerdrv, PCIe PME, pciehp
 <span class="token number">47</span>:          <span class="token number">1</span>          <span class="token number">0</span>          <span class="token number">0</span>          <span class="token number">0</span>   ITS-MSI <span class="token number">22528</span> Edge      aerdrv, PCIe PME, pciehp
 <span class="token number">48</span>:          <span class="token number">1</span>          <span class="token number">0</span>          <span class="token number">0</span>          <span class="token number">0</span>   ITS-MSI <span class="token number">24576</span> Edge      aerdrv, PCIe PME, pciehp
 <span class="token number">49</span>:          <span class="token number">0</span>          <span class="token number">0</span>          <span class="token number">0</span>          <span class="token number">0</span>   ITS-MSI <span class="token number">1572864</span> Edge      virtio1-config
 <span class="token number">50</span>:          <span class="token number">0</span>          <span class="token number">0</span>          <span class="token number">0</span>          <span class="token number">0</span>   ITS-MSI <span class="token number">1572865</span> Edge      virtio1-control
 <span class="token number">51</span>:          <span class="token number">0</span>          <span class="token number">0</span>          <span class="token number">0</span>          <span class="token number">0</span>   ITS-MSI <span class="token number">1572866</span> Edge      virtio1-event
 <span class="token number">52</span>:      <span class="token number">95112</span>          <span class="token number">0</span>          <span class="token number">0</span>          <span class="token number">0</span>   ITS-MSI <span class="token number">1572867</span> Edge      virtio1-request
 <span class="token number">53</span>:          <span class="token number">0</span>          <span class="token number">0</span>          <span class="token number">0</span>          <span class="token number">0</span>   ITS-MSI <span class="token number">524288</span> Edge      virtio0-config
 <span class="token number">54</span>:          <span class="token number">0</span>      <span class="token number">29863</span>      <span class="token number">59165</span>          <span class="token number">0</span>   ITS-MSI <span class="token number">524289</span> Edge      virtio0-input.0
 <span class="token number">55</span>:          <span class="token number">0</span>          <span class="token number">0</span>          <span class="token number">0</span>          <span class="token number">1</span>   ITS-MSI <span class="token number">524290</span> Edge      virtio0-output.0
 <span class="token number">56</span>:          <span class="token number">2</span>          <span class="token number">0</span>          <span class="token number">0</span>          <span class="token number">0</span>   ITS-MSI <span class="token number">2097152</span> Edge      virtio2-config
 <span class="token number">57</span>:     <span class="token number">186776</span>          <span class="token number">0</span>          <span class="token number">0</span>          <span class="token number">0</span>   ITS-MSI <span class="token number">2097153</span> Edge      virtio2-input.0
 <span class="token number">58</span>:          <span class="token number">0</span>          <span class="token number">1</span>          <span class="token number">0</span>          <span class="token number">0</span>   ITS-MSI <span class="token number">2097154</span> Edge      virtio2-output.0
 <span class="token number">59</span>:          <span class="token number">0</span>          <span class="token number">0</span>          <span class="token number">0</span>          <span class="token number">0</span>   ITS-MSI <span class="token number">1048576</span> Edge      xhci_hcd
 <span class="token number">60</span>:          <span class="token number">0</span>          <span class="token number">0</span>          <span class="token number">0</span>          <span class="token number">0</span>   ITS-MSI <span class="token number">1048577</span> Edge      xhci_hcd
 <span class="token number">61</span>:          <span class="token number">0</span>          <span class="token number">0</span>          <span class="token number">0</span>          <span class="token number">0</span>   ITS-MSI <span class="token number">1048578</span> Edge      xhci_hcd
 <span class="token number">62</span>:          <span class="token number">0</span>          <span class="token number">0</span>          <span class="token number">0</span>          <span class="token number">0</span>   ITS-MSI <span class="token number">1048579</span> Edge      xhci_hcd
 <span class="token number">63</span>:          <span class="token number">0</span>          <span class="token number">0</span>          <span class="token number">0</span>          <span class="token number">0</span>   ITS-MSI <span class="token number">1048580</span> Edge      xhci_hcd
IPI0:     <span class="token number">35739</span>      <span class="token number">68329</span>      <span class="token number">56984</span>      <span class="token number">48197</span>       Rescheduling interrupts
IPI1:         <span class="token number">5</span>          <span class="token number">4</span>          <span class="token number">3</span>          <span class="token number">3</span>       Function call interrupts
IPI2:         <span class="token number">0</span>          <span class="token number">0</span>          <span class="token number">0</span>          <span class="token number">0</span>       CPU stop interrupts
IPI3:         <span class="token number">0</span>          <span class="token number">0</span>          <span class="token number">0</span>          <span class="token number">0</span>       CPU stop <span class="token punctuation">(</span>for crash dump<span class="token punctuation">)</span> interrupts
IPI4:         <span class="token number">0</span>          <span class="token number">0</span>          <span class="token number">0</span>          <span class="token number">0</span>       Timer broadcast interrupts
IPI5:         <span class="token number">2</span>          <span class="token number">0</span>          <span class="token number">0</span>          <span class="token number">0</span>       IRQ work interrupts
IPI6:         <span class="token number">0</span>          <span class="token number">0</span>          <span class="token number">0</span>          <span class="token number">0</span>       CPU wake-up interrupts
</code></pre>
<p>&#x6709;&#x51E0;&#x4E2A;&#x4E2D;&#x65AD;&#x60F3;&#x77E5;&#x9053;&#x5BF9;&#x5E94;&#x7684;&#x8BBE;&#x5907;&#x662F;&#x4EC0;&#x4E48;</p>
<ol>
<li>&#x67E5;pci, &#x6211;&#x8FD9;&#x91CC;&#x60F3;&#x627E;eth1<pre class="language-"><code class="lang-bash">$ lspci
01:00.0 Ethernet controller: Red Hat, Inc Virtio network device <span class="token punctuation">(</span>rev 01<span class="token punctuation">)</span>
03:00.0 SCSI storage controller: Red Hat, Inc Virtio SCSI <span class="token punctuation">(</span>rev 01<span class="token punctuation">)</span>
04:00.0 Ethernet controller: Red Hat, Inc Virtio network device <span class="token punctuation">(</span>rev 01<span class="token punctuation">)</span>
</code></pre>
</li>
<li>&#x770B;&#x770B;eth1&#x7684;pci<pre class="language-"><code class="lang-bash">$ <span class="token function">ethtool</span> <span class="token parameter variable">-i</span> eth1
bus-info: 0000:04:00.0
</code></pre>
</li>
<li>&#x5230;/sys/bus&#x4E0B;&#x627E;pci&#x53F7;<pre class="language-"><code class="lang-bash">bai@localhost /sys/bus/pci/devices/0000:04:00.0
</code></pre>
</li>
<li>&#x627E;&#x5230;&#x5BF9;&#x5E94;&#x7684;&#x4E2D;&#x65AD;&#x53F7;<pre class="language-"><code class="lang-bash">$ <span class="token function">ls</span> msi_irqs/
<span class="token number">56</span>  <span class="token number">57</span>  <span class="token number">58</span>
</code></pre>
</li>
<li>&#x53EF;&#x4EE5;&#x4FEE;&#x6539;&#x4E00;&#x4E0B;&#x4E2D;&#x65AD;route&#x5230;&#x54EA;&#x4E2A;CPU, &#x6BD4;&#x5982;&#x4E0B;&#x9762;&#x628A;&#x5904;&#x7406;&#x4E2D;&#x65AD;&#x7684;CPU&#x4ECE;0&#x6539;&#x4E3A;1<pre class="language-"><code class="lang-bash">bai@localhost /proc/irq/57
$ <span class="token function">cat</span> effective_affinity
<span class="token number">1</span>
bai@localhost /proc/irq/57
$ <span class="token function">cat</span> smp_affinity_list
<span class="token number">0</span>
<span class="token punctuation">[</span>root@localhost <span class="token number">57</span><span class="token punctuation">]</span><span class="token comment"># echo 1 &gt; smp_affinity_list</span>
<span class="token punctuation">[</span>root@localhost <span class="token number">57</span><span class="token punctuation">]</span><span class="token comment"># cat smp_affinity_list</span>
<span class="token number">1</span>
<span class="token punctuation">[</span>root@localhost <span class="token number">57</span><span class="token punctuation">]</span><span class="token comment"># cat smp_affinity</span>
<span class="token number">2</span>
</code></pre>
</li>
</ol>
<h1 id="&#x4E00;&#x6B21;&#x4E2D;&#x65AD;&#x6267;&#x884C;&#x8BB0;&#x5F55;&#x548C;kvm&#x865A;&#x62DF;&#x673A;&#x76F8;&#x5173;&#x7684;trace"><a name="&#x4E00;&#x6B21;&#x4E2D;&#x65AD;&#x6267;&#x884C;&#x8BB0;&#x5F55;&#x548C;kvm&#x865A;&#x62DF;&#x673A;&#x76F8;&#x5173;&#x7684;trace" class="anchor-navigation-ex-anchor" href="#&#x4E00;&#x6B21;&#x4E2D;&#x65AD;&#x6267;&#x884C;&#x8BB0;&#x5F55;&#x548C;kvm&#x865A;&#x62DF;&#x673A;&#x76F8;&#x5173;&#x7684;trace"><i class="fa fa-link" aria-hidden="true"></i></a>2. &#x4E00;&#x6B21;&#x4E2D;&#x65AD;&#x6267;&#x884C;&#x8BB0;&#x5F55;&#x548C;KVM&#x865A;&#x62DF;&#x673A;&#x76F8;&#x5173;&#x7684;trace</h1>
<p>&#x7528;ftrace&#x7684;function_graph&#x6293;&#x5230;&#x7684;&#x4E00;&#x6B21;&#x4E2D;&#x65AD;&#x8FC7;&#x7A0B;.</p>
<pre class="language-"><code class="lang-bash"><span class="token comment">#&#x7CFB;&#x7EDF;&#x901A;&#x8FC7;isolcpus=2-23,26-47 &#x53EA;&#x4FDD;&#x7559;4&#x4E2A;&#x6838;&#x7ED9;&#x7CFB;&#x7EDF;(centos 7.5)&#x4F7F;&#x7528;.</span>
HOST: <span class="token number">0</span> <span class="token number">1</span> <span class="token number">24</span> <span class="token number">25</span>
<span class="token comment">#OVS&#x7684;pmd&#x8FDB;&#x7A0B;&#x8DD1;&#x5728;&#x56DB;&#x4E2A;&#x6838;&#x4E0A;</span>
OVS: <span class="token number">12</span> <span class="token number">13</span> <span class="token number">14</span> <span class="token number">15</span>
<span class="token comment">#&#x4E24;&#x4E2A;VM&#x5206;&#x522B;pin&#x4E86;4&#x4E2A;CPU</span>
VM1: <span class="token number">26</span> <span class="token number">27</span> <span class="token number">28</span> <span class="token number">29</span>
VM2: <span class="token number">40</span> <span class="token number">41</span> <span class="token number">42</span> <span class="token number">43</span>
</code></pre>
<h2 id="&#x4E2D;&#x65AD;&#x53D1;&#x751F;&#x5728;core-42&#x4E0A;"><a name="&#x4E2D;&#x65AD;&#x53D1;&#x751F;&#x5728;core-42&#x4E0A;" class="anchor-navigation-ex-anchor" href="#&#x4E2D;&#x65AD;&#x53D1;&#x751F;&#x5728;core-42&#x4E0A;"><i class="fa fa-link" aria-hidden="true"></i></a>2.1. &#x4E2D;&#x65AD;&#x53D1;&#x751F;&#x5728;core 42&#x4E0A;</h2>
<pre class="language-"><code class="lang-c"><span class="token function">gic_handle_irq</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token function">__handle_domain_irq</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 44 us</span>
    <span class="token function">irq_enter</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token function">rcu_irq_enter</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token function">tick_irq_enter</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token function">_local_bh_enable</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token function">irq_find_mapping</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token function">generic_handle_irq</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token function">handle_percpu_devid_irq</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token function">arch_timer_handler_phys</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
          <span class="token function">hrtimer_interrupt</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token function">gic_eoimode1_eoi_irq</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token function">irq_exit</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token function">idle_cpu</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token function">tick_nohz_irq_exit</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token function">rcu_irq_exit</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token function">__handle_domain_irq</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 120 us</span>
    <span class="token function">irq_enter</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token function">irq_find_mapping</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token function">generic_handle_irq</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token function">handle_percpu_devid_irq</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token function">arch_timer_handler_phys</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
          <span class="token function">hrtimer_interrupt</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token function">__hrtimer_run_queues</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
              <span class="token function">__remove_hrtimer</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
              <span class="token function">kvm_timer_expire</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token function">kvm_timer_earliest_exp</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token function">queue_work_on</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                  <span class="token function">__queue_work</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                    <span class="token function">get_work_pool</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                    <span class="token function">insert_work</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                      <span class="token function">wake_up_worker</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                        <span class="token function">wake_up_process</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                          <span class="token function">try_to_wake_up</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                            <span class="token function">update_rq_clock</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                            <span class="token function">ttwu_do_activate</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                              <span class="token function">activate_task</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                                <span class="token function">enqueue_task_fair</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                                  <span class="token function">enqueue_entity</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                                    <span class="token function">update_curr</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                                    <span class="token function">update_cfs_shares</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                                    <span class="token function">account_entity_enqueue</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                                    <span class="token function">__enqueue_entity</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                              <span class="token function">wq_worker_waking_up</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                              <span class="token function">ttwu_do_wakeup</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token function">__hrtimer_get_next_event</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token function">tick_program_event</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
              <span class="token function">clockevents_program_event</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token function">gic_eoimode1_eoi_irq</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token function">irq_exit</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token function">idle_cpu</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token function">tick_nohz_irq_exit</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token function">rcu_irq_exit</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">//&#x4E2D;&#x65AD;&#x5904;&#x7406;&#x7ED3;&#x675F;</span>
</code></pre>
<h2 id="core-42&#x7684;&#x6B63;&#x5E38;&#x6D41;&#x7A0B;"><a name="core-42&#x7684;&#x6B63;&#x5E38;&#x6D41;&#x7A0B;" class="anchor-navigation-ex-anchor" href="#core-42&#x7684;&#x6B63;&#x5E38;&#x6D41;&#x7A0B;"><i class="fa fa-link" aria-hidden="true"></i></a>2.2. core 42&#x7684;&#x6B63;&#x5E38;&#x6D41;&#x7A0B;</h2>
<pre class="language-"><code class="lang-c"><span class="token function">cpu_pm_exit</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token function">cpu_pm_notify</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token function">rcu_irq_enter_irqson</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token function">__atomic_notifier_call_chain</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token function">notifier_call_chain</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token function">gic_cpu_pm_notifier</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token function">arch_timer_cpu_pm_notify</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token function">fpsimd_cpu_pm_notifier</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token function">cpu_pm_pmu_notify</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token function">hyp_init_cpu_pm_notifier</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
          <span class="token function">cpu_hyp_reinit</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
          <span class="token function">kvm_get_idmap_vector</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
          <span class="token function">kvm_mmu_get_httbr</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
          <span class="token function">kvm_arm_init_debug</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
          <span class="token function">kvm_vgic_init_cpu_hardware</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token function">rcu_irq_exit_irqson</span><span class="token punctuation">(</span><span class="token punctuation">)</span>      
      <span class="token function">rcu_irq_exit</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token function">sched_idle_set_state</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token function">cpuidle_reflect</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token function">rcu_idle_exit</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token function">arch_cpu_idle_exit</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token function">tick_nohz_idle_exit</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token function">ktime_get</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token function">arch_counter_read</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token function">tick_nohz_restart_sched_tick</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token function">account_idle_ticks</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token function">sched_ttwu_pending</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token function">schedule_idle</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">//&#x5207;&#x6362;&#x5230;kworker-332&#x524D;&#x7684;&#x51C6;&#x5907;</span>
  <span class="token function">rcu_note_context_switch</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token function">update_rq_clock</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token function">pick_next_task_fair</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token function">put_prev_task_idle</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token function">pick_next_entity</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token function">set_next_entity</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token function">fpsimd_thread_switch</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token function">hw_breakpoint_thread_switch</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token function">uao_thread_switch</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token function">qqos_sched_in</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token operator">&lt;</span>idle<span class="token operator">&gt;</span><span class="token operator">-</span><span class="token number">0</span>    <span class="token operator">=</span><span class="token operator">&gt;</span>  kworker<span class="token operator">-</span><span class="token number">332</span> <span class="token comment">//idle&#x8FDB;&#x7A0B;&#x5DF2;&#x7ECF;&#x5207;&#x6362;&#x5230;kworker</span>

<span class="token function">finish_task_switch</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token function">_raw_spin_lock_irq</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token function">process_one_work</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">//kworker&#x4EE3;&#x7801; -- 84 us</span>
  <span class="token function">find_worker_executing_work</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token function">set_work_pool_and_clear_pending</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token function">kvm_timer_inject_irq_work</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token function">kvm_vcpu_wake_up</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token function">swake_up</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token function">swake_up_locked</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
          <span class="token function">wake_up_process</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token function">try_to_wake_up</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token function">_cond_resched</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token function">rcu_all_qs</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token function">pwq_dec_nr_in_flight</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token function">worker_enter_idle</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token function">schedule</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token function">rcu_note_context_switch</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token function">update_rq_clock</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token function">deactivate_task</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token function">dequeue_task_fair</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token function">dequeue_entity</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    
      <span class="token function">hrtick_update</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token function">wq_worker_sleeping</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token function">pick_next_task_fair</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token function">check_cfs_rq_runtime</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token function">pick_next_entity</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token function">set_next_entity</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token function">fpsimd_thread_switch</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token function">hw_breakpoint_thread_switch</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token function">uao_thread_switch</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token function">qqos_sched_in</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

kworker<span class="token operator">-</span><span class="token number">332</span>   <span class="token operator">=</span><span class="token operator">&gt;</span>  CPU <span class="token number">2</span><span class="token operator">/</span>K<span class="token operator">-</span><span class="token number">6915</span> <span class="token comment">//kworker&#x5DF2;&#x7ECF;&#x5207;&#x6362;&#x5230;CPU 2/K, &#x540E;&#x8005;&#x662F;qemu&#x7684;VCPU&#x8FDB;&#x7A0B;</span>

<span class="token function">finish_task_switch</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token function">kvm_sched_in</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token function">kvm_arch_vcpu_load</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token function">kvm_vgic_load</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token function">prepare_to_swait</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token function">kvm_vcpu_check_block</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token function">kvm_arch_vcpu_runnable</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token function">kvm_cpu_has_pending_timer</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token function">finish_swait</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  
<span class="token function">ktime_get</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token function">kvm_arch_vcpu_unblocking</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">//-- 11 us</span>
  <span class="token function">kvm_timer_unschedule</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">//&#x4ECE;&#x8FD9;&#x91CC;&#x5F00;&#x59CB;&#x7684;&#x51E0;&#x4E2A;&#x9876;&#x7EA7;&#x51FD;&#x6570;, &#x662F;&#x5728;kvm_arch_vcpu_ioctl_run()&#x91CC;&#x8C03;&#x7528;&#x7684;, &#x540E;&#x8005;&#x662F;&#x7528;&#x6237;&#x6001;&#x901A;&#x8FC7;VCPU_RUN ioctl&#x8C03;&#x7528;&#x7684;, &#x5B83;&#x5728;&#x4E00;&#x4E2A;&#x5FAA;&#x73AF;&#x91CC;&#x6267;&#x884C;VM&#x7684;&#x4EE3;&#x7801;&#x76F4;&#x5230;&#x65F6;&#x95F4;&#x7247;&#x7ED3;&#x675F;.</span>
<span class="token function">_cond_resched</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token function">kvm_pmu_flush_hwstate</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token function">kvm_pmu_update_state</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token function">kvm_timer_flush_hwstate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">//20 us</span>
  <span class="token function">kvm_timer_update_state</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    kvm_timer_should_fire<span class="token punctuation">.</span>part<span class="token punctuation">.</span><span class="token number">9</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    kvm_timer_update_irq<span class="token punctuation">.</span>isra<span class="token punctuation">.</span><span class="token number">5</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token function">kvm_vgic_inject_irq</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token function">vgic_lazy_init</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token function">vgic_get_irq</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token function">vgic_queue_irq_unlock</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
          <span class="token function">vgic_target_oracle</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
          <span class="token function">kvm_vcpu_kick</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">//&#x5947;&#x602A;&#x7684;&#x662F;&#x51FD;&#x6570;&#x91CC;&#x7684;if (kvm_vcpu_wake_up(vcpu))&#x4E3A;&#x4EC0;&#x4E48;&#x6CA1;&#x51FA;&#x73B0;?</span>
  <span class="token function">irq_set_irqchip_state</span><span class="token punctuation">(</span><span class="token punctuation">)</span>        
<span class="token function">kvm_vgic_flush_hwstate</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  
<span class="token function">kvm_timer_should_notify_user</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token function">kvm_pmu_should_notify_user</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token function">kvm_pmu_sync_hwstate</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token function">kvm_timer_sync_hwstate</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token function">kvm_vgic_sync_hwstate</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token function">kvm_arm_setup_debug</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">//trace_kvm_entry(*vcpu_pc(vcpu)); &#x6211;&#x81EA;&#x5DF1;&#x770B;&#x4EE3;&#x7801;&#x52A0;&#x7684;, &#x8FDB;&#x5165;VM</span>
<span class="token comment">//guest_enter_irqoff()</span>
<span class="token comment">//&#x5BF9;rcu&#x6765;&#x8BF4;, &#x6267;&#x884C;guest&#x4EE3;&#x7801;&#x548C;&#x5207;&#x6362;&#x5230;user&#x4EE3;&#x7801;&#x5DEE;&#x4E0D;&#x591A;</span>
<span class="token function">rcu_note_context_switch</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token function">kvm_arm_clear_debug</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token function">handle_exit</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token function">kvm_handle_wfx</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token function">kvm_vcpu_block</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token function">ktime_get</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token function">kvm_arch_vcpu_blocking</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token function">prepare_to_swait</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token function">kvm_vcpu_check_block</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token function">schedule</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">//&#x8C03;&#x5EA6;&#x5230;idle&#x8FDB;&#x7A0B;</span>

CPU <span class="token number">2</span><span class="token operator">/</span>K<span class="token operator">-</span><span class="token number">6915</span>  <span class="token operator">=</span><span class="token operator">&gt;</span>    <span class="token operator">&lt;</span>idle<span class="token operator">&gt;</span><span class="token operator">-</span><span class="token number">0</span> <span class="token comment">//&#x5207;&#x6362;&#x56DE;idle</span>

<span class="token function">finish_task_switch</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">//&#x63A5;&#x7740;&#x6267;&#x884C;&#x7B2C;40&#x884C;idle&#x8FDB;&#x7A0B;&#x672A;&#x5B8C;&#x6210;&#x7684;schedule_idle(), &#x65F6;&#x95F4;&#x8FC7;&#x53BB;&#x4E86;467 us, idle&#x88AB;&#x6362;&#x51FA;&#x4E86;467 us</span>
<span class="token function">do_idle</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token function">quiet_vmstat</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token function">tick_nohz_idle_enter</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token function">set_cpu_sd_state_idle</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token function">__tick_nohz_idle_enter</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token function">arch_cpu_idle_enter</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token function">tick_check_broadcast_expired</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token function">cpuidle_get_cpu_driver</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token function">rcu_idle_enter</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token function">cpuidle_not_available</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token function">cpuidle_select</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token function">call_cpuidle</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token function">cpuidle_enter</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token function">cpuidle_enter_state</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token function">sched_idle_set_state</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token function">acpi_idle_lpi_enter</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token function">cpu_pm_enter</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token function">psci_cpu_suspend_enter</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
              <span class="token function">psci_cpu_suspend</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token function">__invoke_psci_fn_smc</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">//&#x9677;&#x5165;&#x5230;EL3</span>
<span class="token comment">//@ 585311.6 us idle&#x4E86;585ms</span>

<span class="token comment">//&#x4ECE;&#x6B64;&#x5F00;&#x59CB;&#x65B0;&#x7684;&#x4E00;&#x8F6E;</span>
<span class="token function">cpu_pm_exit</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre>
<h2 id="perf-sched&#x865A;&#x62DF;&#x673A;"><a name="perf-sched&#x865A;&#x62DF;&#x673A;" class="anchor-navigation-ex-anchor" href="#perf-sched&#x865A;&#x62DF;&#x673A;"><i class="fa fa-link" aria-hidden="true"></i></a>2.3. perf sched&#x865A;&#x62DF;&#x673A;</h2>
<p>&#x5728;&#x51FA;&#x73B0;ping&#x5EF6;&#x8FDF;&#x9AD8;&#x7684;&#x60C5;&#x51B5;&#x65F6;, &#x6BD4;&#x5982;VM1 ping VM2&#x5EF6;&#x8FDF;&#x9AD8;, &#x5728;VM1&#x4E0A;&#x7528;tcpdump&#x770B;&#x65F6;&#x95F4;&#x6233;&#x662F;&#x770B;&#x4E0D;&#x51FA;&#x6765;&#x7684;, &#x90FD;&#x662F;&#x6B63;&#x5E38;&#x7684;. &#x4F46;&#x5728;VM2&#x4E0A;&#x6267;&#x884C;tcpdump, &#x4F1A;&#x9A6C;&#x4E0A;&#x7834;&#x574F;&#x6389;&#x95EE;&#x9898;&#x7684;&#x590D;&#x73B0;, ping&#x5EF6;&#x8FDF;&#x4F1A;&#x9A6C;&#x4E0A;&#x53D8;&#x4F4E;.</p>
<p>&#x5728;VM&#x6267;&#x884C;ping&#x7684;&#x8FC7;&#x7A0B;&#x4E2D;, &#x5728;VM&#x91CC;&#x9762;&#x6536;&#x96C6;&#x8C03;&#x5EA6;&#x7684;&#x4FE1;&#x606F;, &#x770B;&#x770B;&#x662F;&#x4E0D;&#x662F;VM&#x91CC;&#x9762;&#x7684;&#x8C03;&#x5EA6;&#x95EE;&#x9898;, 2&#x4E2A;VM&#x90FD;&#x6267;&#x884C;:<br><code>sudo perf sched record -a</code><br>&#x7528;&#x8FD9;&#x4E2A;&#x65B9;&#x6CD5;&#x57FA;&#x672C;&#x4E0A;&#x662F;&#x770B;&#x4E0D;&#x51FA;&#x4EC0;&#x4E48;&#x6765;&#x7684;.</p>
<h1 id="lmbench&#x7684;latmemrd&#x600E;&#x4E48;&#x7B97;cache&#x8BBF;&#x95EE;&#x5EF6;&#x8FDF;"><a name="lmbench&#x7684;latmemrd&#x600E;&#x4E48;&#x7B97;cache&#x8BBF;&#x95EE;&#x5EF6;&#x8FDF;" class="anchor-navigation-ex-anchor" href="#lmbench&#x7684;latmemrd&#x600E;&#x4E48;&#x7B97;cache&#x8BBF;&#x95EE;&#x5EF6;&#x8FDF;"><i class="fa fa-link" aria-hidden="true"></i></a>3. lmbench&#x7684;lat_mem_rd&#x600E;&#x4E48;&#x7B97;cache&#x8BBF;&#x95EE;&#x5EF6;&#x8FDF;</h1>
<p>&#x5728;&#x56FA;&#x5B9A;&#x65F6;&#x95F4;&#x5185;, &#x9ED8;&#x8BA4;100ms, &#x9664;&#x4EE5;iteration&#x7684;&#x6B21;&#x6570;; &#x4E00;&#x6B21;iteration&#x662F;N&#x6B21;&#x5185;&#x5B58;&#x64CD;&#x4F5C;&#x7684;&#x5FAA;&#x73AF;, N&#x662F;&#x8BBE;&#x8BA1;&#x597D;&#x7684;, &#x73B0;&#x5728;&#x662F;100.</p>
<p>&#x8FD9;&#x6837;&#x7684;&#x8BDD;, &#x65F6;&#x95F4;&#x5DF2;&#x77E5;, &#x64CD;&#x4F5C;&#x6570;&#x5DF2;&#x77E5;, &#x90A3;&#x4E48;&#x6BCF;&#x6B21;&#x64CD;&#x4F5C;&#x7684;&#x5EF6;&#x8FDF;&#x5C31;&#x77E5;&#x9053;&#x4E86;.</p>
<p>&#x6700;&#x540E;&#x4E00;&#x9879;&#x662F;iteration&#x6570;, lmbench&#x6709;&#x4E2A;<code>benchmp_interval()</code>&#x51FD;&#x6570;, &#x7528;&#x6765;&#x5728;&#x8FED;&#x4EE3;&#x4E2D;&quot;&#x63D0;&#x524D;&quot;&#x7B97;&#x51FA;iteration&#x6570;. </p>
<pre class="language-"><code class="lang-bash"><span class="token comment"># fprintf(stderr, &quot;%.5f %.3f %.2f %ld %.2f\n&quot;, range / (1024. * 1024.), result, (double)gettime(), count, (double)get_n());</span>
$ taskset <span class="token parameter variable">-c</span> <span class="token number">9</span> ./lat_mem_rd <span class="token number">1</span> <span class="token number">8192</span>
&quot;stride<span class="token operator">=</span><span class="token number">8192</span>
<span class="token number">0.00781</span> <span class="token number">1.154</span> <span class="token number">1076726.00</span> <span class="token number">100</span> <span class="token number">9328365.00</span>
<span class="token number">0.01172</span> <span class="token number">1.154</span> <span class="token number">1099508.00</span> <span class="token number">100</span> <span class="token number">9525582.00</span>
<span class="token number">0.01562</span> <span class="token number">1.154</span> <span class="token number">1101837.00</span> <span class="token number">100</span> <span class="token number">9545763.00</span>
<span class="token number">0.02344</span> <span class="token number">1.154</span> <span class="token number">1099507.00</span> <span class="token number">100</span> <span class="token number">9525582.00</span>
<span class="token number">0.03125</span> <span class="token number">1.154</span> <span class="token number">1099505.00</span> <span class="token number">100</span> <span class="token number">9525582.00</span>
<span class="token number">0.04688</span> <span class="token number">1.154</span> <span class="token number">1101850.00</span> <span class="token number">100</span> <span class="token number">9545763.00</span>
<span class="token number">0.06250</span> <span class="token number">1.154</span> <span class="token number">1099507.00</span> <span class="token number">100</span> <span class="token number">9525582.00</span>
<span class="token number">0.09375</span> <span class="token number">5.771</span> <span class="token number">1101823.00</span> <span class="token number">100</span> <span class="token number">1909153.00</span>
<span class="token number">0.12500</span> <span class="token number">5.771</span> <span class="token number">1098107.00</span> <span class="token number">100</span> <span class="token number">1902703.00</span>
<span class="token number">0.18750</span> <span class="token number">5.771</span> <span class="token number">1098104.00</span> <span class="token number">100</span> <span class="token number">1902703.00</span>
<span class="token number">0.25000</span> <span class="token number">5.771</span> <span class="token number">1101823.00</span> <span class="token number">100</span> <span class="token number">1909153.00</span>
<span class="token number">0.37500</span> <span class="token number">5.771</span> <span class="token number">1098120.00</span> <span class="token number">100</span> <span class="token number">1902703.00</span>
<span class="token number">0.50000</span> <span class="token number">5.772</span> <span class="token number">1098255.00</span> <span class="token number">100</span> <span class="token number">1902703.00</span>
<span class="token number">0.75000</span> <span class="token number">45.280</span> <span class="token number">1099220.00</span> <span class="token number">100</span> <span class="token number">242759.00</span>
<span class="token number">1.00000</span> <span class="token number">45.281</span> <span class="token number">1099246.00</span> <span class="token number">200</span> <span class="token number">121380.00</span>
</code></pre>
<h1 id="pstack&#x770B;qemu&#x7684;&#x8FDB;&#x7A0B;"><a name="pstack&#x770B;qemu&#x7684;&#x8FDB;&#x7A0B;" class="anchor-navigation-ex-anchor" href="#pstack&#x770B;qemu&#x7684;&#x8FDB;&#x7A0B;"><i class="fa fa-link" aria-hidden="true"></i></a>4. pstack&#x770B;qemu&#x7684;&#x8FDB;&#x7A0B;</h1>
<p>&#x5728;&#x8C03;&#x8BD5;&#x4E24;&#x4E2A;VM&#x4E92;&#x76F8;ping&#x9AD8;&#x5EF6;&#x8FDF;&#x7684;&#x95EE;&#x9898;. &#x4E24;&#x4E2A;VM&#x901A;&#x8FC7;OVS&#x7684;vhost-user&#x8FDE;&#x63A5;</p>
<pre class="language-"><code class="lang-bash"><span class="token comment">#pstack&#x5982;&#x679C;&#x6CA1;&#x8BB0;&#x9519;&#x5E94;&#x8BE5;&#x662F;&#x8C03;&#x7528;gdb&#x7136;&#x540E;bt&#x51FA;&#x8C03;&#x7528;&#x6808;&#x7684;, &#x6240;&#x4EE5;&#x4F1A;&#x505C;&#x4F4F;&#x8FDB;&#x7A0B;&#x91CC;&#x7684;&#x6240;&#x6709;&#x7EBF;&#x7A0B;&#x4E00;&#x5C0F;&#x4F1A;</span>
$ <span class="token function">sudo</span> pstack <span class="token number">42084</span>
Thread <span class="token number">9</span> <span class="token punctuation">(</span>Thread 0xffff8afeede0 <span class="token punctuation">(</span>LWP <span class="token number">42085</span><span class="token punctuation">))</span>:
<span class="token comment">#0  0x0000ffff8b46ac40 in syscall () from /lib64/libc.so.6</span>
<span class="token comment">#1  0x0000000000a91054 in qemu_futex_wait (f=0x1699390 &lt;rcu_call_ready_event&gt;, val=4294967295) at /home/bai/share/repo/hxt/qemu/include/qemu/futex.h:29</span>
<span class="token comment">#2  0x0000000000a912b8 in qemu_event_wait (ev=0x1699390 &lt;rcu_call_ready_event&gt;) at util/qemu-thread-posix.c:445</span>
<span class="token comment">#3  0x0000000000aab7b0 in call_rcu_thread (opaque=0x0) at util/rcu.c:261</span>
<span class="token comment">#4  0x0000ffff8b527bb8 in start_thread () from /lib64/libpthread.so.0</span>
<span class="token comment">#5  0x0000ffff8b46fb50 in thread_start () from /lib64/libc.so.6</span>
Thread <span class="token number">8</span> <span class="token punctuation">(</span>Thread 0xffff8a7dede0 <span class="token punctuation">(</span>LWP <span class="token number">42086</span><span class="token punctuation">))</span>:
<span class="token comment">#0  0x0000ffff8b5307e8 in sigwait () from /lib64/libpthread.so.0</span>
<span class="token comment">#1  0x0000000000a8e1d4 in sigwait_compat (opaque=0x2794f970) at util/compatfd.c:36</span>
<span class="token comment">#2  0x0000ffff8b527bb8 in start_thread () from /lib64/libpthread.so.0</span>
<span class="token comment">#3  0x0000ffff8b46fb50 in thread_start () from /lib64/libc.so.6</span>
Thread <span class="token number">7</span> <span class="token punctuation">(</span>Thread 0xffff88e7ede0 <span class="token punctuation">(</span>LWP <span class="token number">42096</span><span class="token punctuation">))</span>:
<span class="token comment">#0  0x0000ffff8b465460 in ppoll () from /lib64/libc.so.6</span>
<span class="token comment">#1  0x0000000000a8a9d8 in qemu_poll_ns (fds=0xfffd780008c0, nfds=1, timeout=-1) at util/qemu-timer.c:322</span>
<span class="token comment">#2  0x0000000000a8ddbc in aio_poll (ctx=0x279953b0, blocking=true) at util/aio-posix.c:629</span>
<span class="token comment">#3  0x0000000000694388 in iothread_run (opaque=0x279950e0) at iothread.c:64</span>
<span class="token comment">#4  0x0000000000a91468 in qemu_thread_start (args=0x27995780) at util/qemu-thread-posix.c:504</span>
<span class="token comment">#5  0x0000ffff8b527bb8 in start_thread () from /lib64/libpthread.so.0</span>
<span class="token comment">#6  0x0000ffff8b46fb50 in thread_start () from /lib64/libc.so.6</span>
Thread <span class="token number">6</span> <span class="token punctuation">(</span>Thread 0xffff8968ede0 <span class="token punctuation">(</span>LWP <span class="token number">42098</span><span class="token punctuation">))</span>:
<span class="token comment">#0  0x0000ffff8b4665bc in ioctl () from /lib64/libc.so.6</span>
<span class="token comment">#1  0x0000000000498f30 in kvm_vcpu_ioctl (cpu=0xffff876f0010, type=44672) at /home/bai/share/repo/hxt/qemu/accel/kvm/kvm-all.c:2093</span>
<span class="token comment">#2  0x0000000000498828 in kvm_cpu_exec (cpu=0xffff876f0010) at /home/bai/share/repo/hxt/qemu/accel/kvm/kvm-all.c:1930</span>
<span class="token comment">#3  0x0000000000460b74 in qemu_kvm_cpu_thread_fn (arg=0xffff876f0010) at /home/bai/share/repo/hxt/qemu/cpus.c:1215</span>
<span class="token comment">#4  0x0000000000a91468 in qemu_thread_start (args=0x279f03e0) at util/qemu-thread-posix.c:504</span>
<span class="token comment">#5  0x0000ffff8b527bb8 in start_thread () from /lib64/libpthread.so.0</span>
<span class="token comment">#6  0x0000ffff8b46fb50 in thread_start () from /lib64/libc.so.6</span>
Thread <span class="token number">5</span> <span class="token punctuation">(</span>Thread 0xffff89e9ede0 <span class="token punctuation">(</span>LWP <span class="token number">42100</span><span class="token punctuation">))</span>:
<span class="token comment">#0  0x0000ffff8b4665bc in ioctl () from /lib64/libc.so.6</span>
<span class="token comment">#1  0x0000000000498f30 in kvm_vcpu_ioctl (cpu=0xffff876a0010, type=44672) at /home/bai/share/repo/hxt/qemu/accel/kvm/kvm-all.c:2093</span>
<span class="token comment">#2  0x0000000000498828 in kvm_cpu_exec (cpu=0xffff876a0010) at /home/bai/share/repo/hxt/qemu/accel/kvm/kvm-all.c:1930</span>
<span class="token comment">#3  0x0000000000460b74 in qemu_kvm_cpu_thread_fn (arg=0xffff876a0010) at /home/bai/share/repo/hxt/qemu/cpus.c:1215</span>
<span class="token comment">#4  0x0000000000a91468 in qemu_thread_start (args=0x27a0d0d0) at util/qemu-thread-posix.c:504</span>
<span class="token comment">#5  0x0000ffff8b527bb8 in start_thread () from /lib64/libpthread.so.0</span>
<span class="token comment">#6  0x0000ffff8b46fb50 in thread_start () from /lib64/libc.so.6</span>
Thread <span class="token number">4</span> <span class="token punctuation">(</span>Thread 0xffff8764ede0 <span class="token punctuation">(</span>LWP <span class="token number">42101</span><span class="token punctuation">))</span>:
<span class="token comment">#0  0x0000ffff8b4665bc in ioctl () from /lib64/libc.so.6</span>
<span class="token comment">#1  0x0000000000498f30 in kvm_vcpu_ioctl (cpu=0xffff87650010, type=44672) at /home/bai/share/repo/hxt/qemu/accel/kvm/kvm-all.c:2093</span>
<span class="token comment">#2  0x0000000000498828 in kvm_cpu_exec (cpu=0xffff87650010) at /home/bai/share/repo/hxt/qemu/accel/kvm/kvm-all.c:1930</span>
<span class="token comment">#3  0x0000000000460b74 in qemu_kvm_cpu_thread_fn (arg=0xffff87650010) at /home/bai/share/repo/hxt/qemu/cpus.c:1215</span>
<span class="token comment">#4  0x0000000000a91468 in qemu_thread_start (args=0x27a24e60) at util/qemu-thread-posix.c:504</span>
<span class="token comment">#5  0x0000ffff8b527bb8 in start_thread () from /lib64/libpthread.so.0</span>
<span class="token comment">#6  0x0000ffff8b46fb50 in thread_start () from /lib64/libc.so.6</span>
Thread <span class="token number">3</span> <span class="token punctuation">(</span>Thread 0xffff86deede0 <span class="token punctuation">(</span>LWP <span class="token number">42102</span><span class="token punctuation">))</span>:
<span class="token comment">#0  0x0000ffff8b4665bc in ioctl () from /lib64/libc.so.6</span>
<span class="token comment">#1  0x0000000000498f30 in kvm_vcpu_ioctl (cpu=0xffff86df0010, type=44672) at /home/bai/share/repo/hxt/qemu/accel/kvm/kvm-all.c:2093</span>
<span class="token comment">#2  0x0000000000498828 in kvm_cpu_exec (cpu=0xffff86df0010) at /home/bai/share/repo/hxt/qemu/accel/kvm/kvm-all.c:1930</span>
<span class="token comment">#3  0x0000000000460b74 in qemu_kvm_cpu_thread_fn (arg=0xffff86df0010) at /home/bai/share/repo/hxt/qemu/cpus.c:1215</span>
<span class="token comment">#4  0x0000000000a91468 in qemu_thread_start (args=0x27a3ce50) at util/qemu-thread-posix.c:504</span>
<span class="token comment">#5  0x0000ffff8b527bb8 in start_thread () from /lib64/libpthread.so.0</span>
<span class="token comment">#6  0x0000ffff8b46fb50 in thread_start () from /lib64/libc.so.6</span>
Thread <span class="token number">2</span> <span class="token punctuation">(</span>Thread 0xfffd50e0ede0 <span class="token punctuation">(</span>LWP <span class="token number">43789</span><span class="token punctuation">))</span>:
<span class="token comment">#0  0x0000ffff8b52e4bc in do_futex_wait () from /lib64/libpthread.so.0</span>
<span class="token comment">#1  0x0000ffff8b52e59c in __new_sem_wait_slow () from /lib64/libpthread.so.0</span>
<span class="token comment">#2  0x0000ffff8b52e690 in sem_timedwait () from /lib64/libpthread.so.0</span>
<span class="token comment">#3  0x0000000000a90eb0 in qemu_sem_timedwait (sem=0x279a8610, ms=10000) at util/qemu-thread-posix.c:292</span>
<span class="token comment">#4  0x0000000000a8969c in worker_thread (opaque=0x279a8590) at util/thread-pool.c:92</span>
<span class="token comment">#5  0x0000000000a91468 in qemu_thread_start (args=0x27cbb660) at util/qemu-thread-posix.c:504</span>
<span class="token comment">#6  0x0000ffff8b527bb8 in start_thread () from /lib64/libpthread.so.0</span>
<span class="token comment">#7  0x0000ffff8b46fb50 in thread_start () from /lib64/libc.so.6</span>
Thread <span class="token number">1</span> <span class="token punctuation">(</span>Thread 0xffff8bf3cf40 <span class="token punctuation">(</span>LWP <span class="token number">42084</span><span class="token punctuation">))</span>:
<span class="token comment">#0  0x0000ffff8b465460 in ppoll () from /lib64/libc.so.6</span>
<span class="token comment">#1  0x0000000000a8a9d8 in qemu_poll_ns (fds=0x27fc1180, nfds=10, timeout=-1) at util/qemu-timer.c:322</span>
<span class="token comment">#2  0x0000000000a8bd70 in os_host_main_loop_wait (timeout=-1) at util/main-loop.c:258</span>
<span class="token comment">#3  0x0000000000a8be44 in main_loop_wait (nonblocking=0) at util/main-loop.c:522</span>
<span class="token comment">#4  0x000000000069ce94 in main_loop () at vl.c:1943</span>
<span class="token comment">#5  0x00000000006a4f6c in main (argc=79, argv=0xffffc24fcdf8, envp=0xffffc24fd078) at vl.c:4734</span>
</code></pre>
<h1 id="lsof&#x8BE6;&#x7EC6;&#x8F93;&#x51FA;"><a name="lsof&#x8BE6;&#x7EC6;&#x8F93;&#x51FA;" class="anchor-navigation-ex-anchor" href="#lsof&#x8BE6;&#x7EC6;&#x8F93;&#x51FA;"><i class="fa fa-link" aria-hidden="true"></i></a>5. lsof&#x8BE6;&#x7EC6;&#x8F93;&#x51FA;</h1>
<pre class="language-"><code class="lang-bash"><span class="token comment">#&#x628A;&#x8FDB;&#x7A0B;5923&#x7684;&#x6240;&#x6709;&#x7EBF;&#x7A0B;&#x7684;fd&#x90FD;&#x663E;&#x793A;&#x51FA;&#x6765;, &#x7528;-K; -a&#x662F;&#x6307;&#x9009;&#x9879;&#x4E0A;&#x7684;&quot;and&quot;, &#x8FD9;&#x91CC;&#x662F;&#x8BF4;-K&#x548C;-p&#x4E24;&#x4E2A;&#x9009;&#x9879;&#x8FDE;&#x7528;</span>
<span class="token comment">#&#x611F;&#x89C9;&#x548C;&#x53EA;&#x770B;&#x8FDB;&#x7A0B;&#x7684;&#x5DEE;&#x4E0D;&#x591A;, &#x591A;&#x4E2A;&#x7EBF;&#x7A0B;&#x53EA;&#x662F;&#x91CD;&#x590D;&#x5217;&#x4E86;&#x4E00;&#x904D;&#x800C;&#x5DF2;</span>
<span class="token function">sudo</span> <span class="token function">lsof</span> <span class="token parameter variable">-Ka</span> <span class="token parameter variable">-p</span> <span class="token number">5923</span>
<span class="token comment">#&#x6CE8;: &#x5728;centos&#x4E0A;&#x597D;&#x50CF;&#x4E0D;&#x884C;</span>
</code></pre>
<h1 id="&#x5173;&#x4E8E;&#x5171;&#x4EAB;cluster&#x7684;2core"><a name="&#x5173;&#x4E8E;&#x5171;&#x4EAB;cluster&#x7684;2core" class="anchor-navigation-ex-anchor" href="#&#x5173;&#x4E8E;&#x5171;&#x4EAB;cluster&#x7684;2core"><i class="fa fa-link" aria-hidden="true"></i></a>6. &#x5173;&#x4E8E;&#x5171;&#x4EAB;cluster&#x7684;2core</h1>
<p>AW&#x662F;2core&#x5171;&#x4EAB;&#x4E00;&#x4E2A;512K&#x7684;L2 cache, &#x7528;<code>lscpu -p | column -ts,</code>&#x53EF;&#x4EE5;&#x770B;&#x5230;</p>
<p>&#x6BD4;&#x5982;, core 10&#x548C;core 33&#x662F;&#x5171;&#x4EAB;&#x4E00;&#x4E2A;L2 cache&#x7684;.</p>
<p>&#x5728;&#x8DD1;DPDK pmd(pull mode driver)&#x7684;&#x65F6;&#x5019;, &#x5C3D;&#x91CF;&#x4E0D;&#x8981;&#x7528;&#x540C;&#x4E2A;cluster&#x7684;2&#x4E2A;core</p>
<p>&#x6BD4;&#x5982;&#x8FD9;&#x4E2A;&#x547D;&#x4EE4;&#x5C31;&#x5F3A;&#x5236;&#x8FD0;&#x884C;pmd&#x5728;core 10&#x548C;core33:<br><code>sudo arm64-armv8a-linuxapp-gcc/app/testpmd -w 0004:01:00.0 --master-lcore 30 -c 0x240000400 -n 6 -- -a --txq=2 --rxq=2 --mbcache=512 --rxd=4096 --txd=4096 --forward-mode=macswap --nb-cores=2 --stat 2</code><br>RFC2544&#x6D4B;&#x8BD5;0&#x4E22;&#x5305;, &#x6700;&#x5927;throughput&#x53EA;&#x6709;10G&#x7EBF;&#x901F;&#x7684;85.037%</p>
<p>&#x800C;&#x4F5C;&#x4E3A;&#x5BF9;&#x6BD4;, &#x7528;&#x5206;&#x5C5E;&#x4E8E;&#x4E0D;&#x901A;cluster&#x7684;2&#x4E2A;core&#x6765;&#x8DD1;pmd, &#x6B64;&#x65F6;pmd&#x8FD0;&#x884C;&#x5728;core32&#x548C;core33<br><code>sudo arm64-armv8a-linuxapp-gcc/app/testpmd -w 0004:01:00.0 -l 31-43 -n 6 -- -a --txq=2 --rxq=2 --mbcache=512 --rxd=4096 --txd=4096 --forward-mode=macswap --nb-cores=2 --stat 2</code><br>&#x540C;&#x6837;&#x8DD1;RFC2544&#x6D4B;&#x8BD5;0&#x4E22;&#x5305;&#x6D4B;&#x8BD5;, &#x6700;&#x5927;&#x80FD;&#x5230;&#x5728;10G&#x7EBF;&#x901F;&#x7684;97%.</p>
<p>&#x800C;&#x5355;&#x6838;&#x8DD1;pmd&#x7684;&#x6027;&#x80FD;, &#x4E5F;&#x80FD;&#x5230;&#x7EBF;&#x901F;&#x7684;97%.</p>
<p>&#x4EE5;&#x4E0A;&#x6D4B;&#x8BD5;&#x90FD;&#x8FDB;&#x884C;&#x4E86;&#x81F3;&#x5C11;3&#x904D;, &#x73B0;&#x8C61;&#x4E00;&#x81F4;.</p>
<p>&#x7ED3;&#x8BBA;:</p>
<ul>
<li>&#x5728;&#x8DD1;dpdk testpmd&#x7684;macswap&#x8F6C;&#x53D1;&#x65F6;, <ul>
<li>2core@2cluster&#x548C;&#x5355;&#x6838;&#x6BD4;&#x6027;&#x80FD;&#x7565;&#x597D;.</li>
<li>2core@1cluster&#x6BD4;&#x5355;&#x6838;&#x5DEE;, 10%&#x5DE6;&#x53F3;.</li>
</ul>
</li>
<li>&#x5BF9;&#x4E8E;&#x7C7B;&#x4F3C;PMD&#x7684;&#x7A0B;&#x5E8F;, &#x4E24;&#x4E2A;core&#x8DD1;&#x7684;&#x4E1C;&#x897F;&#x5B8C;&#x5168;&#x72EC;&#x7ACB;, &#x5C3D;&#x91CF;&#x5B89;&#x6392;2&#x4E2A;core&#x5230;&#x4E0D;&#x540C;&#x7684;cluster. </li>
<li>1&#x4E2A;cluster&#x91CC;&#x9762;&#x7684;2&#x4E2A;core, &#x4ECE;&#x5BB9;&#x91CF;&#x4E0A;&#x5171;&#x4EAB;512K L2 cache, &#x540C;&#x65F6;&#x4E5F;&#x5171;&#x4EAB;L2&#x5230;Ring Bus&#x4E0A;&#x7684;&#x5E26;&#x5BBD;.</li>
</ul>
<h1 id="&#x5173;&#x4E8E;latency&#x548C;throughput"><a name="&#x5173;&#x4E8E;latency&#x548C;throughput" class="anchor-navigation-ex-anchor" href="#&#x5173;&#x4E8E;latency&#x548C;throughput"><i class="fa fa-link" aria-hidden="true"></i></a>7. &#x5173;&#x4E8E;latency&#x548C;throughput</h1>
<p>&#x6BD4;&#x5982;IP forwarding &#x5355;&#x6838;&#x5904;&#x7406;&#x901F;&#x5EA6;&#x662F;3.3M pps </p>
<p>&#x62A5;&#x6587;&#x8FD9;&#x4E2A;&#x4E1C;&#x897F;&#x7684;&#x5904;&#x7406;&#x6D41;&#x7A0B;&#x53EF;&#x4EE5;&#x60F3;&#x8C61;&#x6210;&#x6C7D;&#x8F66;&#x7EC4;&#x88C5;&#x6D41;&#x6C34;&#x7EBF;, 3.3M pps&#x8BF4;&#x7684;&#x662F;&#x8FD9;&#x4E2A;&#x6D41;&#x6C34;&#x7EBF;0.3us&#x5C31;&#x80FD;&#x51FA;&#x4E00;&#x8F86;&#x6574;&#x8F66;.<br>0.3us&#x8BF4;&#x7684;&#x662F;&#x5728;&#x4E0A;&#x767E;&#x4E2A;&#x6D41;&#x6C34;&#x7EBF;&#x8282;&#x70B9;&#x6700;&#x6162;&#x7684;&#x8282;&#x70B9;&#x9700;&#x8981;&#x7684;&#x65F6;&#x95F4;, &#x4ED6;&#x662F;&#x6574;&#x4E2A;&#x7CFB;&#x7EDF;&#x7684;&#x74F6;&#x9888;, &#x51B3;&#x5B9A;&#x4E86;&#x51FA;&#x6574;&#x8F66;&#x7684;&#x901F;&#x5EA6;.<br>&#x4F46;&#x4ECE;0&#x5F00;&#x59CB;&#x7B97;&#x5230;&#x7B2C;&#x4E00;&#x4E2A;&#x6574;&#x8F66;&#x51FA;&#x6765;, &#x6574;&#x4E2A;&#x8FC7;&#x7A0B;&#x9700;&#x8981;&#x7684;&#x65F6;&#x95F4;&#x662F;latency.&#x8FD9;&#x4E2A;latency&#x5E94;&#x8BE5;&#x8FDC;&#x8FDC;&#x5927;&#x4E8E;0.3us(&#x6D41;&#x6C34;&#x7EBF;&#x6DF1;&#x5EA6;&#x8D8A;&#x6DF1;, &#x8FD9;&#x4E2A;&#x5DEE;&#x8DDD;&#x5E94;&#x8BE5;&#x8D8A;&#x5927;)</p>
<p>&#x636E;&#x53CD;&#x9988;&#x4E00;&#x4E2A;&#x62A5;&#x6587;&#x7684;latency&#x5728;100us&#x5DE6;&#x53F3;. </p>
<p>&#x53E6;&#x5916;, &#x4ECE;&#x5355;&#x6838;&#x7684;throughput&#x4E5F;&#x4E0D;&#x80FD;&#x7B80;&#x5355;&#x7B97;&#x51FA;latency, &#x6BD4;&#x5982;&#x80AF;&#x5FB7;&#x57FA;&#x6392;&#x961F;, &#x4E00;&#x4E2A;&#x5E97;&#x5458;&#x670D;&#x52A1;&#x4E00;&#x4E2A;&#x4EBA;&#x8981;5&#x5206;&#x949F;, &#x90A3;&#x4E48;&#x8FD9;&#x4E2A;&#x5E97;&#x5458;&#x4E00;&#x4E2A;&#x5C0F;&#x65F6;&#x7684;throughput&#x662F;20&#x4EBA;, &#x4F46;&#x5982;&#x679C;&#x6392;&#x961F;&#x4EBA;&#x6570;&#x591A;, &#x5BF9;&#x5728;&#x961F;&#x5C3E;&#x7684;&#x4EBA;&#x6765;&#x8BF4;, &#x4ECE;&#x4ED6;&#x6392;&#x961F;&#x5F00;&#x59CB;&#x7B97;, &#x5230;&#x5F97;&#x5230;&#x670D;&#x52A1;&#x7ED3;&#x675F;,latency&#x4E0D;&#x6B62;5&#x5206;&#x949F;, &#x6BD4;&#x5982;&#x4ED6;&#x524D;&#x9762;10&#x4E2A;&#x4EBA;, &#x4ED6;&#x7684;latency&#x662F;<code>10*5+5</code>&#x5206;&#x949F;.</p>
<p>&#x6240;&#x4EE5;&#x5355;&#x6838;&#x7684;latency, &#x5305;&#x62EC;&#x4E86;&#x6838;&#x5904;&#x7406;&#x7684;&#x65F6;&#x95F4;, &#x548C;&#x6392;&#x961F;&#x7684;&#x65F6;&#x95F4;, &#x8981;&#x51CF;&#x5C0F;latency, &#x8981;&#x51CF;&#x5C0F;&#x961F;&#x5217;.</p>
<h1 id="&#x5173;&#x4E8E;timer"><a name="&#x5173;&#x4E8E;timer" class="anchor-navigation-ex-anchor" href="#&#x5173;&#x4E8E;timer"><i class="fa fa-link" aria-hidden="true"></i></a>8. &#x5173;&#x4E8E;timer</h1>
<blockquote>
<p>If I&#x2019;m not wrong timer counter is a system-wide64-bit count, which counts up from zero, giving a consistent view of time across cores. Each core can then manage its own comparators, typically to generate per-core timer interrupt.</p>
</blockquote>
<ul>
<li>The CNTFRQ_EL0 register reports the frequency of the system timer.</li>
<li>The CNTPCT_EL0 register reports the current count value.</li>
<li>CNTKCTL_EL1 controls whether EL0 can access the system timer.</li>
</ul>
<h1 id="cache&#x9884;&#x53D6;"><a name="cache&#x9884;&#x53D6;" class="anchor-navigation-ex-anchor" href="#cache&#x9884;&#x53D6;"><i class="fa fa-link" aria-hidden="true"></i></a>9. cache&#x9884;&#x53D6;</h1>
<p>&#x5728;&#x6D4B;&#x8BD5;OVS&#x6027;&#x80FD;&#x7684;&#x65F6;&#x5019;, &#x53D1;&#x73B0;&#x70ED;&#x70B9;&#x51FD;&#x6570;rte<em>vhost_dequeue_burst&#x6709;&#x4E24;&#x6761;&#x6307;&#x4EE4;&#x5360;&#x6BD4;&#x6BD4;&#x8F83;&#x9AD8;:<br>![](img/profiling</em>&#x8C03;&#x8BD5;&#x548C;&#x5206;&#x6790;&#x8BB0;&#x5F55;2_20221017235829.png)  </p>
<p>&#x8FD9;&#x4E2A;pmd&#x8FDB;&#x7A0B;, &#x7528;rte_vhost_dequeue_burst&#x4ECE;vhost&#x7684;vring&#x91CC;&#x9762;&#x53D6;&#x62A5;&#x6587;, &#x7136;&#x540E;&#x53D1;&#x7ED9;&#x7269;&#x7406;&#x53E3;.<br>&#x8FD9;&#x65F6;&#x7528;perf stat&#x5BF9;&#x8FD9;&#x4E2A;&#x6838;&#x67E5;&#x4E00;&#x4E0B;&#x6027;&#x80FD;&#x7EDF;&#x8BA1;<br><code>sudo perf stat -a -d -d -e cycles -e cpu-clock -e instructions -e stalled-cycles-backend -e stalled-cycles-frontend -e branch-misses -e branch-loads -e l2cache_0/total-requests/ -C 32 -r 6 -- sleep 10</code>  </p>
<p>&#x53D1;&#x73B0;&#x6709;43%&#x7684;backed stall, &#x8BF4;&#x660E;CPU&#x5728;&#x7B49;&#x5F85;data cache, IPC&#x662F;1.66</p>
<pre class="language-"><code>43,015,925,614      instructions              #    1.66  insn per cycle
                                              #    0.26  stalled cycles per insn
11,282,848,844      stalled-cycles-backend    #   43.42% backend cycles idle
</code></pre><p>&#x901A;&#x8FC7;gdb&#x8DDF;&#x8E2A;&#x8FD9;&#x4E2A;&#x8FDB;&#x7A0B;, &#x7ED3;&#x5408;&#x4EE3;&#x7801;, &#x95EE;&#x9898;&#x51FA;&#x5728;&#x7B2C;1144&#x884C;&#x9644;&#x8FD1;<br><img src="img/profiling_&#x8C03;&#x8BD5;&#x548C;&#x5206;&#x6790;&#x8BB0;&#x5F55;2_20221017235959.png" alt="">  </p>
<p>&#x8FD9;&#x65F6;&#x6CE8;&#x610F;&#x5230;&#x53EF;&#x80FD;&#x662F;desc&#x8FD9;&#x4E2A;&#x5730;&#x5740;&#x6CA1;&#x6709;cache, &#x800C;&#x8FD9;&#x4E2A;&#x5730;&#x5740;&#x662F;descs&#x6570;&#x7EC4;&#x6839;&#x636E;&#x504F;&#x79FB;&#x91CF;&#x800C;&#x6765;<br><code>desc = &amp;descs[desc_idx];</code></p>
<p>&#x7ED3;&#x5408;gdb, &#x6709;:</p>
<pre class="language-"><code class="lang-bash"><span class="token comment">#dev&#x7ED3;&#x6784;&#x4F53;</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> p *dev
<span class="token variable">$2</span> <span class="token operator">=</span> <span class="token punctuation">{</span>mem <span class="token operator">=</span> 0xbcd670480, features <span class="token operator">=</span> <span class="token number">5637144576</span>, protocol_features <span class="token operator">=</span> <span class="token number">55</span>, vid <span class="token operator">=</span> <span class="token number">0</span>, flags <span class="token operator">=</span> <span class="token number">3</span>,
  vhost_hlen <span class="token operator">=</span> <span class="token number">12</span>, broadcast_rarp <span class="token operator">=</span> <span class="token punctuation">{</span>cnt <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">}</span>, nr_vring <span class="token operator">=</span> <span class="token number">2</span>, dequeue_zero_copy <span class="token operator">=</span> <span class="token number">0</span>, virtqueue <span class="token operator">=</span> <span class="token punctuation">{</span>
    0xbcd6cca80, 0xbcd6c4080, 0x0 <span class="token operator">&lt;</span>repeats <span class="token number">254</span> times<span class="token operator">&gt;</span><span class="token punctuation">}</span>,
  ifname <span class="token operator">=</span> <span class="token string">&quot;/tmp/dpdkvhostuser0&quot;</span>, <span class="token string">&apos;\000&apos;</span> <span class="token operator">&lt;</span>repeats <span class="token number">4076</span> times<span class="token operator">&gt;</span>, log_size <span class="token operator">=</span> <span class="token number">0</span>, log_base <span class="token operator">=</span> <span class="token number">0</span>,
  log_addr <span class="token operator">=</span> <span class="token number">0</span>, mac <span class="token operator">=</span> <span class="token punctuation">{</span>addr_bytes <span class="token operator">=</span> <span class="token string">&quot;<span class="token entity" title="\000">\000</span><span class="token entity" title="\000">\000</span><span class="token entity" title="\000">\000</span><span class="token entity" title="\000">\000</span><span class="token entity" title="\000">\000</span>&quot;</span><span class="token punctuation">}</span>, mtu <span class="token operator">=</span> <span class="token number">0</span>,
  notify_ops <span class="token operator">=</span> 0x94afb8 <span class="token operator">&lt;</span>virtio_net_device_ops<span class="token operator">&gt;</span>, nr_guest_pages <span class="token operator">=</span> <span class="token number">0</span>, max_guest_pages <span class="token operator">=</span> <span class="token number">8</span>,
  guest_pages <span class="token operator">=</span> 0xfffdf8000900, slave_req_fd <span class="token operator">=</span> <span class="token number">112</span><span class="token punctuation">}</span>
<span class="token comment">#&#x8C03;&#x7528;copy_desc_to_mbuf&#x4F20;&#x53C2;&#x5982;&#x4E0B;, &#x6CE8;&#x610F;&#x6B64;&#x65F6;desc&#x5C31;&#x662F;descs&#x6570;&#x7EC4;&#x7684;&#x5730;&#x5740;</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> p desc
<span class="token variable">$4</span> <span class="token operator">=</span> <span class="token punctuation">(</span>struct vring_desc *<span class="token punctuation">)</span> 0x40007ff98000
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> p sz
<span class="token variable">$6</span> <span class="token operator">=</span> <span class="token number">300</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> p idx
<span class="token variable">$7</span> <span class="token operator">=</span> <span class="token number">290</span>
<span class="token comment">#&#x7A0B;&#x5E8F;&#x8D70;&#x5230;copy_desc_to_mbuf&#x91CC;&#x9762;, &#x6839;&#x636E;1137&#x884C;&#x7B97;&#x51FA;&#x6765;&#x7684;desc&#x5730;&#x5740;</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> p desc
<span class="token variable">$14</span> <span class="token operator">=</span> <span class="token punctuation">(</span>struct vring_desc *<span class="token punctuation">)</span> 0x40007ff99220

<span class="token comment">#vring_desc&#x7ED3;&#x6784;&#x4F53;&#x6709;16&#x4E2A;&#x5B57;&#x8282;, descs&#x6570;&#x7EC4;&#x7B2C;290&#x4E2A;&#x5143;&#x7D20;&#x7684;&#x5730;&#x5740;&#x5C31;&#x662F;0x40007ff99220</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> p/x 0x40007ff98000+16*290
<span class="token variable">$7</span> <span class="token operator">=</span> 0x40007ff99220
</code></pre>
<p>&#x6240;&#x4EE5;&#x8C03;&#x7528;<code>copy_desc_to_mbuf</code>&#x7684;&#x4EE3;&#x7801;&#x5982;&#x4E0B;, &#x6211;&#x52A0;&#x4E86;cache&#x9884;&#x53D6;&#x6307;&#x4EE4;, 1659&#x884C;<br><img src="img/profiling_&#x8C03;&#x8BD5;&#x548C;&#x5206;&#x6790;&#x8BB0;&#x5F55;2_20221018000045.png" alt="">  </p>
<h1 id="&#x5FEB;&#x901F;&#x627E;&#x5230;&#x4E00;&#x4E2A;&#x8FDB;&#x7A0B;&#x7684;log"><a name="&#x5FEB;&#x901F;&#x627E;&#x5230;&#x4E00;&#x4E2A;&#x8FDB;&#x7A0B;&#x7684;log" class="anchor-navigation-ex-anchor" href="#&#x5FEB;&#x901F;&#x627E;&#x5230;&#x4E00;&#x4E2A;&#x8FDB;&#x7A0B;&#x7684;log"><i class="fa fa-link" aria-hidden="true"></i></a>10. &#x5FEB;&#x901F;&#x627E;&#x5230;&#x4E00;&#x4E2A;&#x8FDB;&#x7A0B;&#x7684;log</h1>
<pre class="language-"><code class="lang-sh"><span class="token function">sudo</span> <span class="token function">lsof</span> <span class="token parameter variable">-p</span> <span class="token variable"><span class="token variable">`</span>pgrep ovs-vswitchd<span class="token variable">`</span></span> <span class="token operator">|</span> <span class="token function">grep</span> log
</code></pre>
<h1 id="&#x7F16;&#x8BD1;&#x8C03;&#x8BD5;&#x624B;&#x6BB5;"><a name="&#x7F16;&#x8BD1;&#x8C03;&#x8BD5;&#x624B;&#x6BB5;" class="anchor-navigation-ex-anchor" href="#&#x7F16;&#x8BD1;&#x8C03;&#x8BD5;&#x624B;&#x6BB5;"><i class="fa fa-link" aria-hidden="true"></i></a>11. &#x7F16;&#x8BD1;&#x8C03;&#x8BD5;&#x624B;&#x6BB5;</h1>
<h2 id="&#x52A0;&#x5E27;&#x6307;&#x9488;"><a name="&#x52A0;&#x5E27;&#x6307;&#x9488;" class="anchor-navigation-ex-anchor" href="#&#x52A0;&#x5E27;&#x6307;&#x9488;"><i class="fa fa-link" aria-hidden="true"></i></a>11.1. &#x52A0;&#x5E27;&#x6307;&#x9488;</h2>
<pre class="language-"><code class="lang-c"><span class="token operator">-</span>fno<span class="token operator">-</span>omit<span class="token operator">-</span>frame<span class="token operator">-</span>pointer
</code></pre>
<h2 id="&#x5F3A;&#x5236;&#x4E0D;&#x4F18;&#x5316;-c&#x8BED;&#x8A00;-attribute"><a name="&#x5F3A;&#x5236;&#x4E0D;&#x4F18;&#x5316;-c&#x8BED;&#x8A00;-attribute" class="anchor-navigation-ex-anchor" href="#&#x5F3A;&#x5236;&#x4E0D;&#x4F18;&#x5316;-c&#x8BED;&#x8A00;-attribute"><i class="fa fa-link" aria-hidden="true"></i></a>11.2. &#x5F3A;&#x5236;&#x4E0D;&#x4F18;&#x5316;, C&#x8BED;&#x8A00; __attribute__</h2>
<pre class="language-"><code class="lang-c"><span class="token keyword">__attribute__</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token function">optimize</span><span class="token punctuation">(</span><span class="token string">&quot;O0&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> 
<span class="token comment">//&#x6BD4;&#x5982;: </span>
<span class="token keyword">void</span> <span class="token keyword">__attribute__</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token function">optimize</span><span class="token punctuation">(</span><span class="token string">&quot;O0&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">char</span> data<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// unmodifiable compiler code</span>
<span class="token punctuation">}</span>
</code></pre>
<p>&#x5B9E;&#x6D4B;&#x6709;&#x6548;</p>
<p>&#x6709;&#x5173;attribute&#x8BF7;&#x53C2;&#x8003;:
<a href="https://gcc.gnu.org/onlinedocs/gcc/Attribute-Syntax.html" target="_blank">https://gcc.gnu.org/onlinedocs/gcc/Attribute-Syntax.html</a></p>
<h1 id="&#x5173;&#x4E8E;no-hz"><a name="&#x5173;&#x4E8E;no-hz" class="anchor-navigation-ex-anchor" href="#&#x5173;&#x4E8E;no-hz"><i class="fa fa-link" aria-hidden="true"></i></a>12. &#x5173;&#x4E8E;no hz</h1>
<p><a href="https://www.kernel.org/doc/Documentation/timers/NO_HZ.txt" target="_blank">https://www.kernel.org/doc/Documentation/timers/NO_HZ.txt</a></p>
<ul>
<li>CONFIG_HZ_PERIODIC=y&#x6216;CONFIG_NO_HZ=n(&#x8001;&#x5185;&#x6838;), &#x4F20;&#x7EDF;&#x6A21;&#x5F0F;, &#x5468;&#x671F;tick&#x89E6;&#x53D1;&#x8C03;&#x5EA6;</li>
<li>CONFIG_NO_HZ_IDLE=y&#x6216;CONFIG_NO_HZ=y(&#x8001;&#x5185;&#x6838;), idle&#x7684;CPU&#x5FFD;&#x7565;&#x8C03;&#x5EA6;, &#x4E5F;&#x79F0;dyntick-idle&#x6A21;&#x5F0F;</li>
<li>CONFIG_NO_HZ_FULL=y, &#x5982;&#x679C;&#x4E00;&#x4E2A;CPU&#x53EA;run&#x4E00;&#x4E2A;&#x8FDB;&#x7A0B;, &#x5C31;&#x4E0D;&#x9700;&#x8981;&#x8C03;&#x5EA6;, &#x8FDB;&#x5165;&#x8FD9;&#x79CD;&#x6A21;&#x5F0F;&#x7684;CPU&#x4E5F;&#x79F0;adaptive-ticks CPUs<br>&#x9ED8;&#x8BA4;no CPU&#x662F;&#x8FD9;&#x79CD;&#x6A21;&#x5F0F;, &#x4F46;&#x5728;kernel cmdline&#x91CC;&#x9762;&#x53EF;&#x4EE5;&#x52A0;<code>nohz_full=4,5,30,31</code>&#x6765;&#x6307;&#x5B9A;adaptive-ticks CPU, &#x540C;&#x65F6;&#x8FD8;&#x5E94;&#x52A0;&#x5165;<code>rcu_nocbs=4,5,30,31</code>&#x542F;&#x52A8;&#x53C2;&#x6570;</li>
<li>NO_HZ=y&#x548C;NO_HZ_FULL=y&#x53EF;&#x4EE5;&#x5171;&#x5B58;</li>
</ul>
<p>HXT&#x7684;kernel config</p>
<pre class="language-"><code class="lang-bash">$ <span class="token function">cat</span> /boot/config-4.14.15-6.hxt.aarch64 <span class="token operator">|</span> <span class="token function">grep</span> <span class="token parameter variable">-i</span> hz
<span class="token assign-left variable">CONFIG_NO_HZ_COMMON</span><span class="token operator">=</span>y
<span class="token comment"># CONFIG_HZ_PERIODIC is not set</span>
<span class="token comment"># CONFIG_NO_HZ_IDLE is not set</span>
<span class="token assign-left variable">CONFIG_NO_HZ_FULL</span><span class="token operator">=</span>y
<span class="token comment"># CONFIG_NO_HZ_FULL_ALL is not set</span>
<span class="token assign-left variable">CONFIG_NO_HZ</span><span class="token operator">=</span>y
<span class="token assign-left variable">CONFIG_HZ_100</span><span class="token operator">=</span>y
<span class="token comment"># CONFIG_HZ_250 is not set</span>
<span class="token comment"># CONFIG_HZ_300 is not set</span>
<span class="token comment"># CONFIG_HZ_1000 is not set</span>
<span class="token assign-left variable">CONFIG_HZ</span><span class="token operator">=</span><span class="token number">100</span>
</code></pre>
<p>kernel&#x542F;&#x52A8;&#x53C2;&#x6570;&#x52A0;&#x4E86;<code>isolcpus=4,5,30,31 nohz_full=4,5,30,31 rcu_nocbs=4,5,30,31</code><br>&#x786E;&#x5B9E;&#x770B;&#x5230;<code>/proc/interrupts</code>&#x91CC;&#x9762;, arch_timer&#x548C;IPI5&#x4E0D;&#x518D;&#x589E;&#x52A0;
&#x4F46;testpmd&#x8DD1;&#x8D77;&#x6765;&#x8FD8;&#x662F;&#x5728;&#x589E;&#x52A0;</p>
<p>testpmd&#x8DD1;&#x5728;core 5&#x4E0A;, &#x7528;perf&#x770B;&#x7EDF;&#x8BA1;:</p>
<h2 id="&#x53EA;&#x52A0;isolcpus"><a name="&#x53EA;&#x52A0;isolcpus" class="anchor-navigation-ex-anchor" href="#&#x53EA;&#x52A0;isolcpus"><i class="fa fa-link" aria-hidden="true"></i></a>12.1. &#x53EA;&#x52A0;isolcpus</h2>
<pre class="language-"><code class="lang-bash">$ <span class="token function">sudo</span> perf <span class="token function">stat</span> <span class="token parameter variable">-a</span> <span class="token parameter variable">-d</span> <span class="token parameter variable">-d</span> <span class="token parameter variable">-d</span> <span class="token parameter variable">-C</span> <span class="token number">5</span> <span class="token parameter variable">-r</span> <span class="token number">6</span> -- <span class="token function">sleep</span> <span class="token number">10</span>

 Performance counter stats <span class="token keyword">for</span> <span class="token string">&apos;system wide&apos;</span> <span class="token punctuation">(</span><span class="token number">6</span> runs<span class="token punctuation">)</span>:

      <span class="token number">10001.613808</span>      cpu-clock <span class="token punctuation">(</span>msec<span class="token punctuation">)</span>          <span class="token comment">#    1.000 CPUs utilized            ( +-  0.00% )</span>
             <span class="token number">1,854</span>      context-switches          <span class="token comment">#    0.185 K/sec                    ( +-  0.31% )</span>
                 <span class="token number">0</span>      cpu-migrations            <span class="token comment">#    0.000 K/sec</span>
                 <span class="token number">0</span>      page-faults               <span class="token comment">#    0.000 K/sec</span>
    <span class="token number">24,980</span>,302,415      cycles                    <span class="token comment">#    2.498 GHz                      ( +-  0.00% )  (81.80%)</span>
    <span class="token number">39,758</span>,964,098      instructions              <span class="token comment">#    1.59  insn per cycle           ( +-  0.00% )  (81.80%)</span>
   <span class="token operator">&lt;</span>not supported<span class="token operator">&gt;</span>      branches
        <span class="token number">23,938</span>,460      branch-misses                                                 <span class="token punctuation">(</span> +-  <span class="token number">0.02</span>% <span class="token punctuation">)</span>  <span class="token punctuation">(</span><span class="token number">81.80</span>%<span class="token punctuation">)</span>
    <span class="token number">18,878</span>,052,718      L1-dcache-loads           <span class="token comment"># 1887.501 M/sec                    ( +-  0.00% )  (81.80%)</span>
        <span class="token number">55,552</span>,098      L1-dcache-load-misses     <span class="token comment">#    0.29% of all L1-dcache hits    ( +-  0.01% )  (81.80%)</span>
   <span class="token operator">&lt;</span>not supported<span class="token operator">&gt;</span>      LLC-loads
   <span class="token operator">&lt;</span>not supported<span class="token operator">&gt;</span>      LLC-load-misses
    <span class="token number">14,512</span>,068,781      L1-icache-loads           <span class="token comment"># 1450.973 M/sec                    ( +-  0.01% )  (81.80%)</span>
           <span class="token number">178,881</span>      L1-icache-load-misses                                         <span class="token punctuation">(</span> +-  <span class="token number">0.71</span>% <span class="token punctuation">)</span>  <span class="token punctuation">(</span><span class="token number">81.80</span>%<span class="token punctuation">)</span>
    <span class="token number">18,890</span>,206,505      dTLB-loads                <span class="token comment"># 1888.716 M/sec                    ( +-  0.00% )  (81.80%)</span>
         <span class="token number">1,433</span>,974      dTLB-load-misses          <span class="token comment">#    0.01% of all dTLB cache hits   ( +-  0.42% )  (81.84%)</span>
           <span class="token number">179,646</span>      iTLB-loads                <span class="token comment">#    0.018 M/sec                    ( +-  0.48% )  (72.79%)</span>
                 <span class="token number">0</span>      iTLB-load-misses          <span class="token comment">#    0.00% of all iTLB cache hits   (72.76%)</span>
   <span class="token operator">&lt;</span>not supported<span class="token operator">&gt;</span>      L1-dcache-prefetches
   <span class="token operator">&lt;</span>not supported<span class="token operator">&gt;</span>      L1-dcache-prefetch-misses

      <span class="token number">10.000882365</span> seconds <span class="token function">time</span> elapsed                                          <span class="token punctuation">(</span> +-  <span class="token number">0.00</span>% <span class="token punctuation">)</span>
</code></pre>
<h2 id="&#x5728;isolcpus&#x57FA;&#x7840;&#x4E0A;-&#x52A0;nohzfull&#x548C;rcunocbs"><a name="&#x5728;isolcpus&#x57FA;&#x7840;&#x4E0A;-&#x52A0;nohzfull&#x548C;rcunocbs" class="anchor-navigation-ex-anchor" href="#&#x5728;isolcpus&#x57FA;&#x7840;&#x4E0A;-&#x52A0;nohzfull&#x548C;rcunocbs"><i class="fa fa-link" aria-hidden="true"></i></a>12.2. &#x5728;isolcpus&#x57FA;&#x7840;&#x4E0A;, &#x52A0;nohz_full&#x548C;rcu_nocbs</h2>
<p>&#x5BF9;&#x6BD4;&#x524D;&#x9762;&#x7684;&#x573A;&#x666F;, context-switches&#x548C;iTLB-loads&#x90FD;&#x663E;&#x8457;&#x51CF;&#x5C11;&#x4E86;, L1-icache-load-misses&#x4E5F;&#x4E0B;&#x964D;&#x4E86;&#x4E00;&#x4E2A;&#x6570;&#x91CF;&#x7EA7;, &#x5176;&#x4ED6;&#x6CA1;&#x6709;&#x660E;&#x663E;&#x53D8;&#x5316;</p>
<pre class="language-"><code class="lang-bash">$ <span class="token function">sudo</span> perf <span class="token function">stat</span> <span class="token parameter variable">-a</span> <span class="token parameter variable">-d</span> <span class="token parameter variable">-d</span> <span class="token parameter variable">-d</span> <span class="token parameter variable">-C</span> <span class="token number">5</span> <span class="token parameter variable">-r</span> <span class="token number">6</span> -- <span class="token function">sleep</span> <span class="token number">10</span>

 Performance counter stats <span class="token keyword">for</span> <span class="token string">&apos;system wide&apos;</span> <span class="token punctuation">(</span><span class="token number">6</span> runs<span class="token punctuation">)</span>:

      <span class="token number">10004.600842</span>      cpu-clock <span class="token punctuation">(</span>msec<span class="token punctuation">)</span>          <span class="token comment">#    1.000 CPUs utilized            ( +-  0.02% )</span>
                <span class="token number">58</span>      context-switches          <span class="token comment">#    0.006 K/sec                    ( +-  3.28% )</span>
                 <span class="token number">0</span>      cpu-migrations            <span class="token comment">#    0.000 K/sec</span>
                 <span class="token number">0</span>      page-faults               <span class="token comment">#    0.000 K/sec</span>
    <span class="token number">24,988</span>,134,060      cycles                    <span class="token comment">#    2.498 GHz                      ( +-  0.02% )  (81.81%)</span>
    <span class="token number">39,771</span>,226,748      instructions              <span class="token comment">#    1.59  insn per cycle           ( +-  0.02% )  (81.81%)</span>
   <span class="token operator">&lt;</span>not supported<span class="token operator">&gt;</span>      branches
        <span class="token number">24,361</span>,683      branch-misses                                                 <span class="token punctuation">(</span> +-  <span class="token number">0.02</span>% <span class="token punctuation">)</span>  <span class="token punctuation">(</span><span class="token number">81.81</span>%<span class="token punctuation">)</span>
    <span class="token number">18,889</span>,305,775      L1-dcache-loads           <span class="token comment"># 1888.062 M/sec                    ( +-  0.02% )  (81.81%)</span>
        <span class="token number">55,348</span>,908      L1-dcache-load-misses     <span class="token comment">#    0.29% of all L1-dcache hits    ( +-  0.02% )  (81.81%)</span>
   <span class="token operator">&lt;</span>not supported<span class="token operator">&gt;</span>      LLC-loads
   <span class="token operator">&lt;</span>not supported<span class="token operator">&gt;</span>      LLC-load-misses
    <span class="token number">14,366</span>,129,596      L1-icache-loads           <span class="token comment"># 1435.952 M/sec                    ( +-  0.01% )  (81.81%)</span>
            <span class="token number">19,547</span>      L1-icache-load-misses                                         <span class="token punctuation">(</span> +-  <span class="token number">1.33</span>% <span class="token punctuation">)</span>  <span class="token punctuation">(</span><span class="token number">81.81</span>%<span class="token punctuation">)</span>
    <span class="token number">18,901</span>,566,631      dTLB-loads                <span class="token comment"># 1889.287 M/sec                    ( +-  0.02% )  (81.81%)</span>
         <span class="token number">1,960</span>,269      dTLB-load-misses          <span class="token comment">#    0.01% of all dTLB cache hits   ( +-  0.26% )  (81.83%)</span>
            <span class="token number">19,819</span>      iTLB-loads                <span class="token comment">#    0.002 M/sec                    ( +-  0.91% )  (72.77%)</span>
                 <span class="token number">0</span>      iTLB-load-misses          <span class="token comment">#    0.00% of all iTLB cache hits   (72.75%)</span>
   <span class="token operator">&lt;</span>not supported<span class="token operator">&gt;</span>      L1-dcache-prefetches
   <span class="token operator">&lt;</span>not supported<span class="token operator">&gt;</span>      L1-dcache-prefetch-misses

      <span class="token number">10.003905246</span> seconds <span class="token function">time</span> elapsed                                          <span class="token punctuation">(</span> +-  <span class="token number">0.02</span>% <span class="token punctuation">)</span>
</code></pre>
<h2 id="ipi&#x4E2D;&#x65AD;&#x548C;archtimer"><a name="ipi&#x4E2D;&#x65AD;&#x548C;archtimer" class="anchor-navigation-ex-anchor" href="#ipi&#x4E2D;&#x65AD;&#x548C;archtimer"><i class="fa fa-link" aria-hidden="true"></i></a>12.3. IPI&#x4E2D;&#x65AD;&#x548C;arch_timer</h2>
<p>&#x5728;&#x8DD1;DPDK&#x7684;&#x65F6;&#x5019;, &#x6211;&#x5728;cmdline&#x91CC;&#x9762;&#x9694;&#x79BB;&#x4E86;core
<code>isolcpus=4,5,30,31</code></p>
<p>&#x7136;&#x540E;&#x5728;core4,5&#x4E0A;&#x8DD1;DPDK&#x5355;&#x6D41;&#x5355;q&#x7684;io fwd, &#x5B9E;&#x9645;&#x662F;core4&#x8DD1;&#x547D;&#x4EE4;&#x884C;, core5&#x8DD1;pmd.</p>
<p>&#x4F46;&#x53D1;&#x73B0;core4&#x548C;5&#x90FD;&#x8FD8;&#x6709;arch_timer&#x548C;IPI5(IRQ work interrupts)&#x4E2D;&#x65AD;, &#x5E76;&#x4E14;core5&#x4E0A;&#x7684;IPI5&#x4E2D;&#x65AD;&#x5FEB;&#x901F;&#x589E;&#x52A0;, &#x505C;&#x4E86;DPDK&#x540E;&#x589E;&#x957F;&#x53D8;&#x6162;.</p>
<p>&#x901A;&#x8FC7;linux&#x4EE3;&#x7801;&#x5F97;&#x77E5;<br><code>irq_work_queue</code>&#x53D1;IPI&#x4E2D;&#x65AD;&#x7ED9;&#x81EA;&#x5DF1;, &#x4E3B;&#x8981;&#x7684;&#x4F5C;&#x7528;&#x662F;&#x63D0;&#x4F9B;&#x4E00;&#x4E2A;&#x5728;&#x4E2D;&#x65AD;&#x4E0A;&#x4E0B;&#x6587;&#x8FD0;&#x884C;work&#x7684;&#x624B;&#x6BB5;</p>
<p>&#x90A3;&#x4E48;&#x662F;&#x8C01;&#x8C03;&#x7528;&#x4E86;&#x5B83;, &#x53C8;&#x662F;&#x5E72;&#x4EC0;&#x4E48;&#x4E8B;&#x60C5;&#x5462;?<br>&#x7528;perf probe&#x6293;&#x4E00;&#x4E0B;&#x8C03;&#x7528;&#x6808;</p>
<pre class="language-"><code class="lang-sh"><span class="token function">sudo</span> perf probe <span class="token parameter variable">--add</span> irq_work_queue
<span class="token function">sudo</span> perf record <span class="token parameter variable">-e</span> probe:irq_work_queue <span class="token parameter variable">-a</span> <span class="token parameter variable">-C5</span> <span class="token parameter variable">-g</span> -- <span class="token function">sleep</span> <span class="token number">10</span>
<span class="token function">sudo</span> perf report <span class="token parameter variable">-n</span>
</code></pre>
<p>&#x5F97;&#x5230;</p>
<pre class="language-"><code class="lang-sh">            + <span class="token number">68.32</span>% pkt_burst_io_forward          
            - <span class="token number">21.45</span>% el0_irq                       
                 gic_handle_irq                    
                 __handle_domain_irq               
                 generic_handle_irq                
                 handle_percpu_devid_irq           
                 arch_timer_handler_phys           
                 hrtimer_interrupt                 
                 __hrtimer_run_queues              
                 tick_sched_timer                  
                 tick_sched_handle.isra.14         
                 update_process_times              
                 scheduler_tick                    
                 task_tick_fair                    
                 irq_work_queue
</code></pre>
<p>&#x8FD9;&#x91CC;&#x89E3;&#x91CA;&#x4E00;&#x4E0B;, &#x56E0;&#x4E3A;&#x662F;&#x4E2D;&#x65AD;&#x89E6;&#x53D1;&#x7684;, &#x7B2C;&#x4E00;&#x884C;pkt_burst_io_forward&#x548C;&#x8FD9;&#x4E2A;&#x4E2D;&#x65AD;&#x5E76;&#x6CA1;&#x6709;&#x7EDD;&#x5BF9;&#x5173;&#x7CFB;, &#x5B83;&#x662F;&#x88AB;&#x6253;&#x65AD;&#x7684;&#x51FD;&#x6570;, &#x4E0D;&#x77E5;&#x4E3A;&#x4F55;, &#x88AB;perf&#x5F53;&#x505A;&#x8C03;&#x7528;&#x51FD;&#x6570;&#x4E86;;</p>
<p>&#x8865;&#x5145;&#x4E00;&#x4E0B;, IPI&#x4E2D;&#x65AD;&#x7C7B;&#x578B;&#x6709;</p>
<pre class="language-"><code class="lang-c"><span class="token keyword">enum</span> <span class="token class-name">ipi_msg_type</span> <span class="token punctuation">{</span>
    IPI_RESCHEDULE<span class="token punctuation">,</span>
    IPI_CALL_FUNC<span class="token punctuation">,</span>
    IPI_CPU_STOP<span class="token punctuation">,</span>
    IPI_CPU_CRASH_STOP<span class="token punctuation">,</span>
    IPI_TIMER<span class="token punctuation">,</span>
    IPI_IRQ_WORK<span class="token punctuation">,</span>
    IPI_WAKEUP
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre>
<h2 id="&#x7ED3;&#x8BBA;"><a name="&#x7ED3;&#x8BBA;" class="anchor-navigation-ex-anchor" href="#&#x7ED3;&#x8BBA;"><i class="fa fa-link" aria-hidden="true"></i></a>12.4. &#x7ED3;&#x8BBA;</h2>
<p><code>arch_timer</code>&#x548C;<code>IPI5</code>&#x8FD9;&#x4E24;&#x4E2A;&#x4E2D;&#x65AD;&#x5BFC;&#x81F4;&#x7684;context-switches, kernel&#x542F;&#x52A8;&#x53C2;&#x6570;&#x589E;&#x52A0;<code>nohz_full</code>&#x548C;<code>rcu_nocbs</code>&#x540E;, context-switches&#x7531;&#x539F;&#x6765;&#x7684;185&#x6B21;/&#x79D2;&#x51CF;&#x5C0F;&#x5230;6&#x6B21;/&#x79D2;</p>
<h1 id="&#x52A8;&#x6001;&#x8C03;&#x9891;&#x548C;&#x4E2D;&#x65AD;"><a name="&#x52A8;&#x6001;&#x8C03;&#x9891;&#x548C;&#x4E2D;&#x65AD;" class="anchor-navigation-ex-anchor" href="#&#x52A8;&#x6001;&#x8C03;&#x9891;&#x548C;&#x4E2D;&#x65AD;"><i class="fa fa-link" aria-hidden="true"></i></a>13. &#x52A8;&#x6001;&#x8C03;&#x9891;&#x548C;&#x4E2D;&#x65AD;</h1>
<p>&#x5728;kernel&#x542F;&#x52A8;cmdline&#x52A0;<code>isolcpus=31-37 nohz_full=31-37 rcu_nocbs=31-37</code>&#x4F1A;&#x5BFC;&#x81F4;CPU&#x65E0;&#x6CD5;&#x6B63;&#x786E;&#x52A8;&#x6001;&#x8C03;&#x9891;, &#x6BD4;&#x5982;&#x8DD1;pmd&#x7684;core&#x5E76;&#x6CA1;&#x6709;&#x6EE1;&#x9891;&#x7387;&#x8DD1;, &#x6545;&#x53EF;&#x63A8;&#x65AD;&#x4EE5;&#x4E0A;&#x53C2;&#x6570;&#x4F1A;&#x628A;&#x8C03;&#x9891;&#x7684;driver&#x7684;&#x4E2D;&#x65AD;&#x7981;&#x6B62;&#x6389;, &#x5BFC;&#x81F4;&#x9891;&#x7387;&#x4E0D;&#x5BF9;.
&#x6B64;&#x65F6;&#x9700;&#x8981;&#x5F3A;&#x5236;&#x6700;&#x9AD8;&#x9891;&#x7387;:</p>
<pre class="language-"><code class="lang-bash"><span class="token comment">#&#x67E5;&#x5B9E;&#x9645;&#x9891;&#x7387;</span>
<span class="token function">sudo</span> cpupower <span class="token parameter variable">-c</span> all frequency-info <span class="token operator">|</span> <span class="token function">grep</span> <span class="token string">&quot;current CPU frequency&quot;</span>
<span class="token comment">#&#x5F3A;&#x5236;&#x6700;&#x9AD8;&#x9891;&#x7387;, &#x91CD;&#x542F;&#x4F1A;&#x5931;&#x6548;</span>
<span class="token function">sudo</span> cpupower frequency-set <span class="token parameter variable">-g</span> performance
</code></pre>
<h1 id="&#x8C03;&#x8BD5;testpmd"><a name="&#x8C03;&#x8BD5;testpmd" class="anchor-navigation-ex-anchor" href="#&#x8C03;&#x8BD5;testpmd"><i class="fa fa-link" aria-hidden="true"></i></a>14. &#x8C03;&#x8BD5;testpmd</h1>
<h2 id="&#x73B0;&#x8C61;"><a name="&#x73B0;&#x8C61;" class="anchor-navigation-ex-anchor" href="#&#x73B0;&#x8C61;"><i class="fa fa-link" aria-hidden="true"></i></a>14.1. &#x73B0;&#x8C61;</h2>
<p>42&#x4E0A;&#x8DD1;pktgen, 43&#x4E0A;&#x8DD1;testpmd<br>43&#x4E0A;&#x5F00;&#x4E86;SR-IOV, &#x914D;&#x4E86;2&#x4E2A;VF<br><code>$ sudo bash -c &quot;echo 2 &gt; /sys/class/net/enP5p1s0/device/sriov_numvfs&quot;</code><br>&#x7136;&#x540E;43&#x4E0A;&#x8DD1;testpmd, fwd&#x4E3A;macswap&#x6A21;&#x5F0F;</p>
<pre class="language-"><code class="lang-bash"><span class="token function">sudo</span> ./build/app/testpmd <span class="token parameter variable">-l</span> <span class="token number">37</span>-45 <span class="token parameter variable">-n</span> <span class="token number">6</span> <span class="token parameter variable">-w</span> 0005:01:00.0 <span class="token assign-left variable">txq_inline</span><span class="token operator">=</span><span class="token number">256</span>,rxq_cqe_comp_en<span class="token operator">=</span><span class="token number">1</span>,txqs_min_inline<span class="token operator">=</span><span class="token number">8</span>,txq_mpw_en<span class="token operator">=</span><span class="token number">1</span> -- <span class="token parameter variable">-i</span>
testpmd<span class="token operator">&gt;</span> <span class="token builtin class-name">set</span> fwd macswap
Set macswap packet forwarding mode
testpmd<span class="token operator">&gt;</span> start
</code></pre>
<p>&#x8DD1;&#x4E00;&#x4F1A;&#x51FA;&#x73B0;segment fault</p>
<h2 id="&#x6253;&#x5F00;coredump&#x5E76;&#x7528;gdb&#x8C03;&#x8BD5;"><a name="&#x6253;&#x5F00;coredump&#x5E76;&#x7528;gdb&#x8C03;&#x8BD5;" class="anchor-navigation-ex-anchor" href="#&#x6253;&#x5F00;coredump&#x5E76;&#x7528;gdb&#x8C03;&#x8BD5;"><i class="fa fa-link" aria-hidden="true"></i></a>14.2. &#x6253;&#x5F00;coredump&#x5E76;&#x7528;gdb&#x8C03;&#x8BD5;</h2>
<pre class="language-"><code class="lang-bash"><span class="token builtin class-name">ulimit</span> <span class="token parameter variable">-c</span> unlimited
<span class="token comment">#&#x628A;core&#x6587;&#x4EF6;&#x5199;&#x5230;/tmp&#x4E0B;&#x9762;</span>
<span class="token function">sudo</span> <span class="token function">bash</span> <span class="token parameter variable">-c</span> <span class="token string">&apos;echo &quot;/tmp/core-%e-%p-%t&quot; &gt; /proc/sys/kernel/core_pattern&apos;</span>
<span class="token comment">#gdb&#x6253;&#x5F00;core&#x6587;&#x4EF6;</span>
<span class="token function">sudo</span> gdb ./build/app/testpmd /tmp/core-lcore-slave-38-31988-1539675229
</code></pre>
<p><img src="img/profiling_&#x8C03;&#x8BD5;&#x548C;&#x5206;&#x6790;&#x8BB0;&#x5F55;2_20221018000629.png" alt="">  </p>
<h2 id="&#x662F;&#x6570;&#x7EC4;&#x8D8A;&#x754C;&#x5417;----&#x7B2C;&#x4E00;&#x6B21;&#x95EE;"><a name="&#x662F;&#x6570;&#x7EC4;&#x8D8A;&#x754C;&#x5417;----&#x7B2C;&#x4E00;&#x6B21;&#x95EE;" class="anchor-navigation-ex-anchor" href="#&#x662F;&#x6570;&#x7EC4;&#x8D8A;&#x754C;&#x5417;----&#x7B2C;&#x4E00;&#x6B21;&#x95EE;"><i class="fa fa-link" aria-hidden="true"></i></a>14.3. &#x662F;&#x6570;&#x7EC4;&#x8D8A;&#x754C;&#x5417;? -- &#x7B2C;&#x4E00;&#x6B21;&#x95EE;</h2>
<p><code>free[]</code>&#x662F;&#x4E2A;&#x6570;&#x7EC4;, &#x7A0B;&#x5E8F;&#x5728;<code>free[blk_n++] = m;</code>&#x51FA;&#x73B0;&#x6BB5;&#x9519;&#x8BEF;</p>
<p>&#x4F46;&#x662F;gdb&#x5374;&#x544A;&#x8BC9;&#x6211;&#x4EEC;: &#x6570;&#x7EC4;&#x5927;&#x5C0F;65535, &#x5728;&#x8BBF;&#x95EE;1915&#x4E2A;&#x5143;&#x7D20;&#x65F6;&#x51FA;&#x73B0;&#x95EE;&#x9898;, &#x4F3C;&#x4E4E;&#x6CA1;&#x6709;&#x95EE;&#x9898;</p>
<p>&#x8003;&#x8651;&#x5230;65535&#x4E2A;&#x5143;&#x7D20;&#x7684;&#x6570;&#x7EC4;&#x8FD8;&#x662F;&#x6BD4;&#x8F83;&#x5927;, &#x662F;&#x4E0D;&#x662F;&#x6808;&#x4E0D;&#x591F;&#x4E86;&#x5462;?</p>
<pre class="language-"><code class="lang-sh"><span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> p elts_n
<span class="token variable">$23</span> <span class="token operator">=</span> <span class="token number">65535</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> p blk_n
<span class="token variable">$24</span> <span class="token operator">=</span> <span class="token number">1915</span>
</code></pre>
<p><img src="img/profiling_&#x8C03;&#x8BD5;&#x548C;&#x5206;&#x6790;&#x8BB0;&#x5F55;2_20221018000708.png" alt="">  </p>
<h2 id="&#x770B;&#x6C47;&#x7F16;"><a name="&#x770B;&#x6C47;&#x7F16;" class="anchor-navigation-ex-anchor" href="#&#x770B;&#x6C47;&#x7F16;"><i class="fa fa-link" aria-hidden="true"></i></a>14.4. &#x770B;&#x6C47;&#x7F16;</h2>
<p>&#x6C47;&#x7F16; sp&#x5411;&#x4E0B;&#x589E;&#x957F;<br><img src="img/profiling_&#x8C03;&#x8BD5;&#x548C;&#x5206;&#x6790;&#x8BB0;&#x5F55;2_20221018000731.png" alt="">  </p>
<p><code>free[]</code>&#x6570;&#x7EC4;&#x662F;&#x5728;&#x6808;&#x4E0A;&#x7684;&#x6570;&#x7EC4;, &#x5927;&#x5C0F;&#x662F;&#x8FD0;&#x884C;&#x65F6;&#x786E;&#x5B9A;&#x7684;. &#x65B0;&#x7684;C&#x6807;&#x51C6;&#x652F;&#x6301;&#x8FD9;&#x79CD;&#x64CD;&#x4F5C;, &#x5B9E;&#x73B0;&#x4E0A;&#x5927;&#x6982;&#x662F;&#x8FD9;&#x6837;: &#x8FD0;&#x884C;&#x65F6;&#x7B97;&#x597D;&#x504F;&#x79FB;&#x91CF;, &#x6BD4;&#x5982;&#x4E0A;&#x9762;&#x4EE3;&#x7801;&#x4E2D;, x2&#x5C31;&#x662F;&#x504F;&#x79FB;&#x91CF;, sp&#x51CF;&#x53BB;&#x8FD9;&#x4E2A;&#x504F;&#x79FB;&#x91CF;, &#x5373;sp&#x5411;&#x4E0B;&#x589E;&#x957F;&#x51FA;&#x8BE5;&#x6570;&#x7EC4;&#x5927;&#x5C0F;&#x7684;&#x7A7A;&#x95F4;, &#x5E76;&#x628A;&#x57FA;&#x5730;&#x5740;&#x4FDD;&#x5B58;&#x5728;&#x5176;&#x4ED6;&#x5BC4;&#x5B58;&#x5668;&#x4E2D;, &#x6BD4;&#x5982;&#x4E0A;&#x9762;&#x4EE3;&#x7801;&#x4E2D;&#x7684;x5. x5&#x53EF;&#x4EE5;&#x505A;&#x4E3A;<code>free[]</code>&#x6570;&#x7EC4;&#x7684;&#x57FA;&#x5730;&#x5740;. &#x5728;&#x7ED9;&#x6570;&#x7EC4;&#x8D4B;&#x503C;&#x7684;&#x8FC7;&#x7A0B;&#x4E2D;, &#x5730;&#x5740;&#x5411;&#x4E0A;&#x589E;&#x957F;.</p>
<h2 id="&#x6269;&#x5927;&#x6808;"><a name="&#x6269;&#x5927;&#x6808;" class="anchor-navigation-ex-anchor" href="#&#x6269;&#x5927;&#x6808;"><i class="fa fa-link" aria-hidden="true"></i></a>14.5. &#x6269;&#x5927;&#x6808;</h2>
<p>&#x6808;&#x5927;&#x5C0F;&#x662F;&#x5728;&#x8FD0;&#x884C;&#x65F6;&#x51B3;&#x5B9A;&#x7684;, <code>readelf -a</code>&#x6216;<code>objdump</code>&#x90FD;&#x770B;&#x4E0D;&#x5230;&#x6808;&#x5927;&#x5C0F;
&#x4FEE;&#x6539;&#x6808;&#x5927;&#x5C0F;&#x53EF;&#x4EE5;&#x8C03;&#x51FD;&#x6570;&#x5728;&#x4EE3;&#x7801;&#x91CC;&#x6539;: <code>setrlimit()</code>, &#x4E5F;&#x53EF;&#x4EE5;&#x7528;<code>ulimit -s 16384</code>&#x6539;, &#x9ED8;&#x8BA4;&#x7684;&#x6808;&#x5927;&#x5C0F;&#x662F;8192(&#x5373;8M)</p>
<p>&#x6539;&#x5927;&#x4E86;&#x8FD8;&#x662F;&#x51FA;&#x4E00;&#x6837;&#x7684;&#x95EE;&#x9898;</p>
<h2 id="&#x68C0;&#x67E5;&#x5185;&#x5B58;&#x5206;&#x5E03;"><a name="&#x68C0;&#x67E5;&#x5185;&#x5B58;&#x5206;&#x5E03;" class="anchor-navigation-ex-anchor" href="#&#x68C0;&#x67E5;&#x5185;&#x5B58;&#x5206;&#x5E03;"><i class="fa fa-link" aria-hidden="true"></i></a>14.6. &#x68C0;&#x67E5;&#x5185;&#x5B58;&#x5206;&#x5E03;</h2>
<p>&#x7528;gdb&#x7684;&#x547D;&#x4EE4;<code>maintenance info sections</code>&#x53EF;&#x4EE5;&#x770B;&#x5230;&#x7A0B;&#x5E8F;&#x7684;&#x5185;&#x5B58;&#x5206;&#x5E03;<br>&#x4E2D;&#x95F4;&#x95F4;&#x6742;&#x7684;64K&#x53EA;&#x8BFB;&#x9875;(&#x9694;&#x79BB;&#x9875;)&#x5C31;&#x662F;&#x4FDD;&#x62A4;&#x6808;&#x8D8A;&#x754C;&#x7684;, &#x8FD9;&#x91CC;&#x5C31;&#x53EF;&#x4EE5;&#x770B;&#x5230;&#x5B83;&#x7684;&#x4F5C;&#x7528;.</p>
<pre class="language-"><code class="lang-bash"><span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> p <span class="token operator">&amp;</span>free<span class="token punctuation">[</span><span class="token number">1914</span><span class="token punctuation">]</span>
<span class="token variable">$5</span> <span class="token operator">=</span> <span class="token punctuation">(</span>struct rte_mbuf **<span class="token punctuation">)</span> 0xffffb3420000
</code></pre>
<p>&#x6839;&#x636E;gdb&#x7684;&#x8F93;&#x51FA;, &#x7B97;&#x4E00;&#x7B97;&#x6BCF;&#x4E2A;section&#x7684;&#x5927;&#x5C0F;<br>&#x770B;&#x5230;&#x51FA;&#x95EE;&#x9898;&#x7684;&#x5730;&#x5740;0xffffb3420000&#x662F;&#x4E00;&#x4E2A;64K&#x7684;&#x53EA;&#x8BFB;&#x9875;&#x4E0A;, &#x8FD9;&#x4E2A;&#x4E0D;&#x662F;&#x6808;&#x7684;&#x9875;, &#x5B83;&#x4E0A;&#x9762;&#x7684;16384K&#x7684;&#x9875;(&#x4EEC;)&#x624D;&#x662F;&#x6808;<br>&#x8BF4;&#x660E;&#x6808;&#x6EA2;&#x51FA;</p>
<pre class="language-"><code class="lang-sh"><span class="token function">cat</span> <span class="token operator">&lt;&lt;</span> <span class="token string">EOF<span class="token bash punctuation"> <span class="token operator">|</span> <span class="token function">awk</span> -F<span class="token string">&quot;-&gt;| *&quot;</span> <span class="token string">&apos;{printf &quot;%s %s %dK\n&quot;,$2,$3,(strtonum($3)-strtonum($2))/1024}&apos;</span></span>
    0xffffb1410000-&gt;0xffffb2410000 at 0x07650000: load103 ALLOC LOAD HAS_CONTENTS
    0xffffb2410000-&gt;0xffffb2420000 at 0x08650000: load104 ALLOC LOAD READONLY HAS_CONTENTS
    0xffffb2420000-&gt;0xffffb3420000 at 0x08660000: load105 ALLOC LOAD HAS_CONTENTS
    0xffffb3420000-&gt;0xffffb3430000 at 0x09660000: load106 ALLOC LOAD READONLY HAS_CONTENTS
EOF</span>
0xffffb1410000 0xffffb2410000 16384K
0xffffb2410000 0xffffb2420000 64K
0xffffb2420000 0xffffb3420000 16384K
0xffffb3420000 0xffffb3430000 64K
</code></pre>
<h2 id="&#x8FD8;&#x662F;&#x56DE;&#x5230;&#x6570;&#x7EC4;&#x8D8A;&#x754C;"><a name="&#x8FD8;&#x662F;&#x56DE;&#x5230;&#x6570;&#x7EC4;&#x8D8A;&#x754C;" class="anchor-navigation-ex-anchor" href="#&#x8FD8;&#x662F;&#x56DE;&#x5230;&#x6570;&#x7EC4;&#x8D8A;&#x754C;"><i class="fa fa-link" aria-hidden="true"></i></a>14.7. &#x8FD8;&#x662F;&#x56DE;&#x5230;&#x6570;&#x7EC4;&#x8D8A;&#x754C;</h2>
<p>&#x56DE;&#x8FC7;&#x5934;&#x6765;&#x518D;&#x770B;gdb, &#x6709;&#x4E24;&#x4E2A;&#x7591;&#x70B9;:</p>
<ul>
<li>&#x6570;&#x7EC4;&#x5143;&#x7D20;&#x4E2A;&#x6570;elts_n&#x4E3A;65535, &#x4F46;&#x5B83;&#x662F;&#x4ECE;<code>const uint16_t elts_n = 1 &lt;&lt; txq-&gt;elts_n;</code>&#x6765;, &#x4E0D;&#x53EF;&#x80FD;&#x662F;&#x5947;&#x6570;</li>
<li>sp&#x5730;&#x5740;&#x548C;&#x6808;&#x9876;&#x5730;&#x5740;&#x76F8;&#x5DEE;&#x5C0F;&#x4E8E;<code>65535*8(free&#x6570;&#x7EC4;&#x5927;&#x5C0F;&#x6309;65535&#x7B97;)</code><pre class="language-"><code class="lang-bash"><span class="token comment"># &#x6808;&#x9876;&#x5730;&#x5740;&#x662F;&#x4E0A;&#x9762;&#x67E5;&#x5230;&#x7684;&#x6808;&#x5730;&#x5740;&#x7A7A;&#x95F4;&#x7684;&#x6700;&#x5927;&#x503C;</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> p 0xffffb3420000-0xffffb341c430
<span class="token variable">$14</span> <span class="token operator">=</span> <span class="token number">15312</span>
</code></pre>
&#x5230;&#x8FD9;&#x91CC;&#x5C31;&#x5F88;&#x660E;&#x663E;&#x4E86;, <code>elts_n</code>&#x88AB;&#x8E29;, &#x5B9E;&#x9645;&#x6570;&#x7EC4;&#x5E76;&#x6CA1;&#x6709;&#x90A3;&#x4E48;&#x5927;. &#x5B9E;&#x9645;&#x88AB;&#x8E29;&#x8E0F;&#x7684;&#x6808;&#x5F88;&#x5927;, &#x76F4;&#x5230;&#x8E29;&#x5230;&quot;&#x9694;&#x79BB;&quot;&#x9875;.</li>
</ul>
<p>&#x589E;&#x5927;&#x6808;&#x5927;&#x5C0F;&#x4E0D;&#x7BA1;&#x7528;, &#x4E5F;&#x5370;&#x8BC1;&#x4E86;&#x8FD9;&#x4E00;&#x70B9;.</p>
<p>&#x7ED3;&#x5408;&#x4EE3;&#x7801;, &#x6808;&#x4E0A;&#x7684;&#x6570;&#x636E;(elts_n&#x5C31;&#x5728;&#x6808;&#x4E0A;)&#x88AB;502&#x884C;, &#x6570;&#x7EC4;&#x8D8A;&#x754C;&#x8D4B;&#x503C;&#x6240;&#x8E29;&#x8E0F;.
<code>free[blk_n++] = m;</code></p>
<h2 id="&#x8BB0;&#x5F55;&#x4E00;&#x4E0B;gdb&#x7528;&#x5230;&#x7684;&#x547D;&#x4EE4;"><a name="&#x8BB0;&#x5F55;&#x4E00;&#x4E0B;gdb&#x7528;&#x5230;&#x7684;&#x547D;&#x4EE4;" class="anchor-navigation-ex-anchor" href="#&#x8BB0;&#x5F55;&#x4E00;&#x4E0B;gdb&#x7528;&#x5230;&#x7684;&#x547D;&#x4EE4;"><i class="fa fa-link" aria-hidden="true"></i></a>14.8. &#x8BB0;&#x5F55;&#x4E00;&#x4E0B;gdb&#x7528;&#x5230;&#x7684;&#x547D;&#x4EE4;</h2>
<pre class="language-"><code class="lang-bash">gdb ./build/app/testpmd
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> b mlx5_tx_complete
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> b mlx5_rxtx.h:498
<span class="token comment">#&#x5E26;&#x6761;&#x4EF6;&#x7684;&#x65AD;&#x70B9;, GDB&#x6BCF;&#x6B21;&#x505C;&#x4E0B;&#x6765;&#x5224;&#x65AD;&#x4E00;&#x4E0B;, &#x4E0D;&#x6EE1;&#x8DB3;&#x6761;&#x4EF6;&#x7EE7;&#x7EED;&#x5F80;&#x4E0B;&#x6267;&#x884C;</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> b mlx5_rxtx.h:498 <span class="token keyword">if</span> elts_n<span class="token operator">&gt;</span><span class="token number">512</span>
<span class="token comment">#&#x6682;&#x65F6;&#x7981;&#x6B62;/&#x6253;&#x5F00;&#x5168;&#x90E8;&#x65AD;&#x70B9;</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> disable/enable
<span class="token comment">#&#x6682;&#x65F6;&#x7981;&#x6B62;/&#x6253;&#x5F00;&#x67D0;&#x4E2A;&#x65AD;&#x70B9;</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> disable/enable &#x5E8F;&#x53F7;, &#x6BD4;&#x5982; <span class="token number">1</span> <span class="token number">2</span> <span class="token number">3</span>
<span class="token comment"># run&#x547D;&#x4EE4;&#x63A5;&#x53D7;&#x88AB;&#x8C03;&#x7A0B;&#x5E8F;&#x7684;&#x53C2;&#x6570;</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> r <span class="token parameter variable">-l</span> <span class="token number">37</span>-45 <span class="token parameter variable">-n</span> <span class="token number">6</span> <span class="token parameter variable">-w</span> 0005:01:00.0 <span class="token assign-left variable">txq_inline</span><span class="token operator">=</span><span class="token number">256</span>,rxq_cqe_comp_en<span class="token operator">=</span><span class="token number">1</span>,txqs_min_inline<span class="token operator">=</span><span class="token number">8</span>,txq_mpw_en<span class="token operator">=</span><span class="token number">1</span> -- <span class="token parameter variable">-i</span>
<span class="token comment">#&#x5BC4;&#x5B58;&#x5668;&#x540D;&#x524D;&#x9762;&#x52A0;$&#x53EF;&#x4EE5;&#x76F4;&#x63A5;&#x7528;</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> p <span class="token variable">$x29</span>
</code></pre>
<h1 id="&#x8C03;&#x8BD5;testpmd&#x7EED;"><a name="&#x8C03;&#x8BD5;testpmd&#x7EED;" class="anchor-navigation-ex-anchor" href="#&#x8C03;&#x8BD5;testpmd&#x7EED;"><i class="fa fa-link" aria-hidden="true"></i></a>15. &#x8C03;&#x8BD5;testpmd&#x7EED;</h1>
<h2 id="macswap&#x6BB5;&#x9519;&#x8BEF;"><a name="macswap&#x6BB5;&#x9519;&#x8BEF;" class="anchor-navigation-ex-anchor" href="#macswap&#x6BB5;&#x9519;&#x8BEF;"><i class="fa fa-link" aria-hidden="true"></i></a>15.1. macswap&#x6BB5;&#x9519;&#x8BEF;</h2>
<p>&#x5728;&#x524D;&#x9762;&#x5DF2;&#x7ECF;&#x5206;&#x6790;&#x8FC7;, macswap&#x6BB5;&#x9519;&#x8BEF;&#x7684;&#x539F;&#x56E0;&#x662F;&#x6570;&#x7EC4;&#x8D8A;&#x754C;</p>
<p>&#x8FD9;&#x6BB5;&#x7A0B;&#x5E8F;&#x8D1F;&#x8D23;&#x56DE;&#x6536;mbuf, &#x6839;&#x636E;<code>txq-&gt;wqe_pi</code>&#x751F;&#x4EA7;&#x8005;&#x7684;index, &#x627E;&#x5230;<code>txq-&gt;wqes</code>&#x91CC;&#x9762;&#x5BF9;&#x5E94;&#x7684;wqe, &#x5176;&#x5BF9;&#x5E94;&#x7684;&#x786C;&#x4EF6;&#x5B9A;&#x4E49;&#x5982;&#x4E0B;:</p>
<pre class="language-"><code class="lang-c"><span class="token keyword">struct</span> <span class="token class-name">mlx5_wqe_ctrl</span> <span class="token punctuation">{</span>
    <span class="token class-name">uint32_t</span> ctrl0<span class="token punctuation">;</span>
    <span class="token class-name">uint32_t</span> ctrl1<span class="token punctuation">;</span>
    <span class="token class-name">uint32_t</span> ctrl2<span class="token punctuation">;</span>
    <span class="token class-name">uint32_t</span> ctrl3<span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token function">__rte_aligned</span><span class="token punctuation">(</span>MLX5_WQE_DWORD_SIZE<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p>elts_tail&#x6839;&#x636E;wqe&#x7684;ctrl3&#x5F97;&#x51FA;</p>
<pre class="language-"><code class="lang-c"><span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> p <span class="token operator">*</span><span class="token punctuation">(</span><span class="token keyword">volatile</span> <span class="token keyword">struct</span> <span class="token class-name">mlx5_wqe_ctrl</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token number">0xfff7a02b3e00</span>
$<span class="token number">52</span> <span class="token operator">=</span> <span class="token punctuation">{</span>ctrl0 <span class="token operator">=</span> <span class="token number">251167745</span><span class="token punctuation">,</span> ctrl1 <span class="token operator">=</span> <span class="token number">81465856</span><span class="token punctuation">,</span> ctrl2 <span class="token operator">=</span> <span class="token number">134217728</span><span class="token punctuation">,</span> ctrl3 <span class="token operator">=</span> <span class="token number">63836</span><span class="token punctuation">}</span>
elts_tail <span class="token operator">=</span> ctrl<span class="token operator">-&gt;</span>ctrl3 <span class="token comment">//&#x4ECE;&#x786C;&#x4EF6;&#x8BFB;&#x51FA;&#x6765;&#x7684;, &#x6240;&#x8C13;&#x7684;&#x786C;&#x4EF6;&#x662F;wqe</span>
elts_tail<span class="token operator">=</span><span class="token number">63836</span>
</code></pre>
<p>elts_free&#x662F;&#x4E0A;&#x4E00;&#x6B21;&#x7684;<code>txq-&gt;elts_tail</code></p>
<p>591&#x884C;free&#x6570;&#x7EC4;&#x8D8A;&#x754C;&#x5BFC;&#x81F4;&#x6BB5;&#x9519;&#x8BEF;<br><img src="img/profiling_&#x8C03;&#x8BD5;&#x548C;&#x5206;&#x6790;&#x8BB0;&#x5F55;2_20221018001113.png" alt="">  </p>
<p>&#x901A;&#x5E38;&#x60C5;&#x51B5;&#x4E0B;free&#x548C;tail&#x7684;&#x589E;&#x957F;&#x60C5;&#x51B5;<br><img src="img/profiling_&#x8C03;&#x8BD5;&#x548C;&#x5206;&#x6790;&#x8BB0;&#x5F55;2_20221018001147.png" alt="">  </p>
<p>perf&#x6293;&#x51FD;&#x6570;&#x91CC;&#x9762;&#x53C2;&#x6570;, &#x53C2;&#x8003;&#x7B14;&#x8BB0;<a href="profiling_perf&#x547D;&#x4EE4;&#x5907;&#x5FD8;&#x5F55;.html">profiling_perf&#x547D;&#x4EE4;&#x5907;&#x5FD8;&#x5F55;</a></p>
<p>&#x901A;&#x8FC7;&#x52A0;&#x6253;&#x5370;:950&#x884C;, &#x6293;&#x5230;&#x7684;2&#x6B21;&#x5F02;&#x5E38;&#x60C5;&#x51B5;</p>
<pre class="language-"><code class="lang-bash">testpmd<span class="token operator">&gt;</span> PANIC <span class="token keyword">in</span> mlx5_tx_complete_m<span class="token punctuation">(</span><span class="token punctuation">)</span>:
Array index exceeding: elts_free:2685 elts_tail:1576

testpmd<span class="token operator">&gt;</span> PANIC <span class="token keyword">in</span> mlx5_tx_complete<span class="token punctuation">(</span><span class="token punctuation">)</span>:
Array index exceeding: elts_free:40737 elts_tail:39488
</code></pre>
<p>&#x4E0B;&#x9762;&#x60F3;&#x77E5;&#x9053;, &#x5047;&#x5B9A;<code>elts_tail</code>&#x53D1;&#x751F;&#x4E86;&quot;&#x7A81;&#x53D8;&quot;, &#x90A3;&#x80FD;&#x6293;&#x5230;&#x8FD9;&#x6B21;&#x7A81;&#x53D8;&#x5417;? &#x7A81;&#x53D8;&#x7684;&#x4E0A;&#x4E00;&#x6B21;&#x503C;&#x662F;&#x591A;&#x5C11;? &#x6709;&#x4EC0;&#x4E48;&#x89C4;&#x5F8B;?</p>
<p>&#x8FD0;&#x884C;<code>sudo perf record -e probe_testpmd:mlx5_tx_complete_m -a -C 34 -- sleep 30</code>&#x6293;30&#x79D2;, &#x65F6;&#x95F4;&#x592A;&#x957F;&#x5219;&#x6570;&#x636E;&#x91CF;&#x592A;&#x5927;. &#x770B;&#x8FD0;&#x6C14;, &#x591A;&#x6293;&#x51E0;&#x6B21;.<br>&#x6216;&#x8005;:</p>
<pre class="language-"><code class="lang-bash"><span class="token keyword">while</span> <span class="token builtin class-name">test</span> <span class="token operator">!</span> <span class="token parameter variable">-z</span> <span class="token variable"><span class="token variable">`</span>pgrep testpmd<span class="token variable">`</span></span><span class="token punctuation">;</span><span class="token keyword">do</span> <span class="token function">sudo</span> perf record <span class="token parameter variable">-e</span> probe_testpmd:mlx5_tx_complete_m <span class="token parameter variable">-a</span> <span class="token parameter variable">-C</span> <span class="token number">34</span> -- <span class="token function">sleep</span> <span class="token number">30</span><span class="token punctuation">;</span> <span class="token keyword">done</span>
</code></pre>
<p>&#x6293;&#x5230;&#x4E86;, &#x6700;&#x540E;&#x4E00;&#x884C;<br><img src="img/profiling_&#x8C03;&#x8BD5;&#x548C;&#x5206;&#x6790;&#x8BB0;&#x5F55;2_20221018001350.png" alt="">  </p>
<p>&#x7EE7;&#x7EED;, &#x770B;&#x4EE3;&#x7801;&#x7EE7;&#x7EED;&#x5F80;&#x4E0A;&#x627E;&#x6E90;&#x5934;:<br><code>sudo perf probe -x arm64-armv8a-linuxapp-gcc/app/testpmd --add &apos;mlx5_tx_complete_m+240 txq-&gt;wqe_pi:u16 elts_tail:u16&apos;</code></p>
<p><img src="img/profiling_&#x8C03;&#x8BD5;&#x548C;&#x5206;&#x6790;&#x8BB0;&#x5F55;2_20221018001416.png" alt="">  </p>
<p>&#x7EE7;&#x7EED;&#x627E;:cq_ci&#x6B63;&#x5E38;&#x7684;, wqe_pi&#x5374;&#x4E0D;&#x5BF9;&#x4E86;:</p>
<pre class="language-"><code class="lang-bash"><span class="token function">sudo</span> perf probe <span class="token parameter variable">-x</span> arm64-armv8a-linuxapp-gcc/app/testpmd <span class="token parameter variable">--add</span> <span class="token string">&apos;mlx5_tx_complete_m+228 cq_ci:u16 txq-&gt;wqe_pi:u16 elts_tail:u16&apos;</span>

  lcore-slave-34 <span class="token number">14766</span> <span class="token punctuation">[</span>034<span class="token punctuation">]</span> <span class="token number">251661.247316</span>: probe_testpmd:mlx5_tx_complete_m: <span class="token punctuation">(</span>701ed8<span class="token punctuation">)</span> <span class="token assign-left variable">cq_ci</span><span class="token operator">=</span><span class="token number">24176</span> <span class="token assign-left variable">cq_ci_u16</span><span class="token operator">=</span><span class="token number">24177</span> <span class="token assign-left variable">wqe_pi</span><span class="token operator">=</span><span class="token number">64394</span> <span class="token assign-left variable">elts_tail_u16</span><span class="token operator">=</span><span class="token number">64024</span>
  lcore-slave-34 <span class="token number">14766</span> <span class="token punctuation">[</span>034<span class="token punctuation">]</span> <span class="token number">251661.247321</span>: probe_testpmd:mlx5_tx_complete_m: <span class="token punctuation">(</span>701ed8<span class="token punctuation">)</span> <span class="token assign-left variable">cq_ci</span><span class="token operator">=</span><span class="token number">24177</span> <span class="token assign-left variable">cq_ci_u16</span><span class="token operator">=</span><span class="token number">24178</span> <span class="token assign-left variable">wqe_pi</span><span class="token operator">=</span><span class="token number">64408</span> <span class="token assign-left variable">elts_tail_u16</span><span class="token operator">=</span><span class="token number">64056</span>
  lcore-slave-34 <span class="token number">14766</span> <span class="token punctuation">[</span>034<span class="token punctuation">]</span> <span class="token number">251661.247329</span>: probe_testpmd:mlx5_tx_complete_m: <span class="token punctuation">(</span>701ed8<span class="token punctuation">)</span> <span class="token assign-left variable">cq_ci</span><span class="token operator">=</span><span class="token number">24178</span> <span class="token assign-left variable">cq_ci_u16</span><span class="token operator">=</span><span class="token number">24179</span> <span class="token assign-left variable">wqe_pi</span><span class="token operator">=</span><span class="token number">64159</span> <span class="token assign-left variable">elts_tail_u16</span><span class="token operator">=</span><span class="token number">63456</span>
</code></pre>
<h1 id="&#x4FEE;&#x6539;&#x6808;&#x5927;&#x5C0F;"><a name="&#x4FEE;&#x6539;&#x6808;&#x5927;&#x5C0F;" class="anchor-navigation-ex-anchor" href="#&#x4FEE;&#x6539;&#x6808;&#x5927;&#x5C0F;"><i class="fa fa-link" aria-hidden="true"></i></a>16. &#x4FEE;&#x6539;&#x6808;&#x5927;&#x5C0F;</h1>
<pre class="language-"><code class="lang-bash"><span class="token comment"># &#x5355;&#x4F4D;&#x662F;1024, &#x8FD9;&#x91CC;&#x662F;8192K</span>
<span class="token comment"># ulimit&#x7684;&#x5355;&#x4F4D;&#x4E00;&#x822C;&#x90FD;&#x662F;1024, &#x8BE6;&#x89C1;help ulimit</span>
$ <span class="token builtin class-name">ulimit</span> <span class="token parameter variable">-s</span>
<span class="token number">8192</span>
<span class="token comment"># &#x8981;&#x6539;&#x5927;&#x70B9;&#x4E5F;&#x53EF;&#x4EE5;</span>
$ <span class="token builtin class-name">ulimit</span> <span class="token parameter variable">-s</span> <span class="token number">16384</span>
<span class="token comment"># &#x6539;&#x5B8C;&#x540E;&#x7528;pmap&#x53EF;&#x4EE5;&#x770B;&#x5230;&#x539F;&#x6765;8192&#x7684;&#x53D8;&#x6210;&#x4E86;16384</span>
<span class="token function">sudo</span> pmap <span class="token parameter variable">-p</span> <span class="token number">13234</span> <span class="token parameter variable">-x</span>

0000ffffb5930000     <span class="token number">128</span>     <span class="token number">128</span>       <span class="token number">0</span> r-x-- /usr/lib64/ld-2.17.so
0000ffffb5950000      <span class="token number">64</span>      <span class="token number">64</span>      <span class="token number">64</span> r---- /usr/lib64/ld-2.17.so
0000ffffb5960000      <span class="token number">64</span>      <span class="token number">64</span>      <span class="token number">64</span> rw--- /usr/lib64/ld-2.17.so
0000ffffddfd0000     <span class="token number">192</span>     <span class="token number">128</span>     <span class="token number">128</span> rw---   <span class="token punctuation">[</span> stack <span class="token punctuation">]</span>

<span class="token comment"># &#x4F3C;&#x4E4E;pmap&#x7684;&#x6808;&#x5730;&#x5740;&#x4E0D;&#x51C6;, &#x6BD4;&#x5982;&#x4E0A;&#x9762;&#x8BF4;&#x6808;&#x662F;0000ffffddfd0000&#x5F00;&#x59CB;,192K</span>
<span class="token comment"># &#x4F46;&#x6211;&#x5B9E;&#x9645;&#x8C03;&#x8BD5;&#x65F6;, &#x6808;&#x662F;&#x4E0B;&#x9762;16384K&#x5927;&#x5C0F;&#x7684;&#x7A7A;&#x95F4;</span>
16384K: 0xffffb2420000-<span class="token operator">&gt;</span>0xffffb3420000 at 0x08660000: load105 ALLOC LOAD HAS_CONTENTS 
64K:    0xffffb3420000-<span class="token operator">&gt;</span>0xffffb3430000 at 0x09660000: load106 ALLOC LOAD READONLY HAS_CONTENTS
</code></pre>
<h1 id="objdump&#x6C47;&#x7F16;&#x548C;c&#x6DF7;&#x5408;&#x663E;&#x793A;"><a name="objdump&#x6C47;&#x7F16;&#x548C;c&#x6DF7;&#x5408;&#x663E;&#x793A;" class="anchor-navigation-ex-anchor" href="#objdump&#x6C47;&#x7F16;&#x548C;c&#x6DF7;&#x5408;&#x663E;&#x793A;"><i class="fa fa-link" aria-hidden="true"></i></a>17. objdump&#x6C47;&#x7F16;&#x548C;C&#x6DF7;&#x5408;&#x663E;&#x793A;</h1>
<pre class="language-"><code class="lang-bash"><span class="token comment">#&#x7528;objdump&#x4E5F;&#x53EF;&#x4EE5;&#x6DF7;&#x5408;&#x663E;&#x793A;&#xFF0C;-S&#x9009;&#x9879;</span>
objdump <span class="token parameter variable">-dS</span> luajit <span class="token operator">&gt;</span> luajit.dump
</code></pre>
<h1 id="coredump&#x548C;gdb"><a name="coredump&#x548C;gdb" class="anchor-navigation-ex-anchor" href="#coredump&#x548C;gdb"><i class="fa fa-link" aria-hidden="true"></i></a>18. coredump&#x548C;GDB</h1>
<pre class="language-"><code class="lang-bash"><span class="token builtin class-name">ulimit</span> <span class="token parameter variable">-c</span> unlimited
<span class="token function">sudo</span> <span class="token function">bash</span> <span class="token parameter variable">-c</span> <span class="token string">&apos;echo &quot;/tmp/core-%e-%p-%t&quot; &gt; /proc/sys/kernel/core_pattern&apos;</span>
<span class="token function">sudo</span> gdb <span class="token parameter variable">-tui</span> ./build/app/testpmd /tmp/core-lcore-slave-38-41301-1539583957
</code></pre>
<h1 id="&#x67E5;&#x770B;&#x4F18;&#x5316;level&#x7684;&#x8BE6;&#x7EC6;&#x5F00;&#x5173;"><a name="&#x67E5;&#x770B;&#x4F18;&#x5316;level&#x7684;&#x8BE6;&#x7EC6;&#x5F00;&#x5173;" class="anchor-navigation-ex-anchor" href="#&#x67E5;&#x770B;&#x4F18;&#x5316;level&#x7684;&#x8BE6;&#x7EC6;&#x5F00;&#x5173;"><i class="fa fa-link" aria-hidden="true"></i></a>19. &#x67E5;&#x770B;&#x4F18;&#x5316;level&#x7684;&#x8BE6;&#x7EC6;&#x5F00;&#x5173;</h1>
<pre class="language-"><code class="lang-bash">gcc <span class="token parameter variable">-Q</span> <span class="token parameter variable">--help</span><span class="token operator">=</span>optimizers <span class="token parameter variable">-O2</span> <span class="token operator">&gt;</span> O2
gcc <span class="token parameter variable">-Q</span> <span class="token parameter variable">--help</span><span class="token operator">=</span>optimizers <span class="token parameter variable">-O3</span> <span class="token operator">&gt;</span> O3
vimdiff O2 O3
</code></pre>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="profiling_调试和分析记录3.html" class="navigation navigation-prev " aria-label="Previous page: 调试和分析记录3">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="as_title_perf_tools.html" class="navigation navigation-next " aria-label="Next page: profiling工具相关">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"调试和分析记录2","level":"1.3.1.4","depth":3,"next":{"title":"profiling工具相关","level":"1.3.2","depth":2,"path":"notes/as_title_perf_tools.md","ref":"notes/as_title_perf_tools.md","articles":[{"title":"perf命令备忘录","level":"1.3.2.1","depth":3,"path":"notes/profiling_perf命令备忘录.md","ref":"notes/profiling_perf命令备忘录.md","articles":[]},{"title":"ftrace和trace-cmd记录","level":"1.3.2.2","depth":3,"path":"notes/profiling_ftrace和trace-cmd记录.md","ref":"notes/profiling_ftrace和trace-cmd记录.md","articles":[]},{"title":"ftrace使用实例","level":"1.3.2.3","depth":3,"path":"notes/profiling_ftrace使用实例.md","ref":"notes/profiling_ftrace使用实例.md","articles":[]},{"title":"systemtap实例","level":"1.3.2.4","depth":3,"path":"notes/profiling_systemtap实例.md","ref":"notes/profiling_systemtap实例.md","articles":[]},{"title":"bcc和ebpf(starting)","level":"1.3.2.5","depth":3,"path":"notes/system_analysis_bcc和ebpf.md","ref":"notes/system_analysis_bcc和ebpf.md","articles":[]}]},"previous":{"title":"调试和分析记录3","level":"1.3.1.3","depth":3,"path":"notes/profiling_调试和分析记录3.md","ref":"notes/profiling_调试和分析记录3.md","articles":[]},"dir":"ltr"},"config":{"plugins":["-livereload","-sharing","-lunr","-search","search-plus","-highlight","theme-comscore","prism","code","chapter-fold","github","splitter","wide-page","hide-navigation-buttons","anchor-navigation-ex","sequence","mermaid-gb3"],"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"pluginsConfig":{"chapter-fold":{},"prism":{"css":["prismjs/themes/prism.css"],"ignore":["mermaid","sequence"]},"sequence":{"theme":"simple"},"github":{"url":"https://github.com/Bai-Yingjie/Bai-Yingjie.github.io"},"splitter":{},"wide-page":{},"code":{"copyButtons":true},"fontsettings":{"theme":"white","family":"sans","size":2},"hide-navigation-buttons":{},"mermaid-gb3":{},"anchor-navigation-ex":{"mode":"float","pageTop":{"level1Icon":"","level2Icon":"","level3Icon":"","showLevelIcon":false},"isRewritePageTitle":true,"showLevel":true,"tocLevel1Icon":"fa fa-hand-o-right","tocLevel2Icon":"fa fa-hand-o-right","tocLevel3Icon":"fa fa-hand-o-right","showGoTop":true,"isShowTocTitleIcon":true,"printLog":false,"multipleH1":true,"associatedWithSummary":true,"float":{"floatIcon":"fa fa-navicon","level1Icon":"","level2Icon":"","level3Icon":"","showLevelIcon":false}},"theme-comscore":{},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false},"search-plus":{}},"theme":"default","author":"Bai Yingjie","pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"variables":{},"title":"My Notes","language":"zh-hans","gitbook":"*"},"file":{"path":"notes/profiling_调试和分析记录2.md","mtime":"2022-10-18T08:58:28.284Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2022-10-18T08:59:36.045Z"},"basePath":"..","book":{"language":""}});
        });
    </script>
</div>

        
    
    <script src="../gitbook/gitbook.js"></script>
    <script src="../gitbook/theme.js"></script>
    
        
        <script src="../gitbook/gitbook-plugin-search-plus/jquery.mark.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search-plus/search.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-code/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-chapter-fold/chapter-fold.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-github/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-splitter/splitter.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-mermaid-gb3/book/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-theme-comscore/test.js"></script>
        
    

    <script src="../gitbook/gitbook-plugin-mermaid-gb3/mermaid/mermaid.min.js"></script>

    </body>
</html>

