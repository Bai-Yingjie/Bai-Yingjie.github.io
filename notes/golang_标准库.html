
<!DOCTYPE HTML>
<html lang="zh-hans" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>标准库 · My Notes</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        <meta name="author" content="Bai Yingjie">
        
        
    
    <link rel="stylesheet" href="../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-search-plus/search.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-prism/prism-coldark-cold.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-expandable-chapters-small/expandable-chapters-small.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-disqus/plugin.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-splitter/splitter.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-wide-page/wide.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-hide-navigation-buttons/index.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-anchor-navigation-ex/style/plugin.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="golang_我的反射代码.html" />
    
    
    <link rel="prev" href="golang_内存分配.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="输入并搜索" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../">
            
                <a href="../">
            
                    
                    简介
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="as_title.html">
            
                <a href="as_title.html">
            
                    
                    Golang
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1" data-path="as_title.html">
            
                <a href="as_title.html">
            
                    
                    入门
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1.1" data-path="golang_语法基础.html">
            
                <a href="golang_语法基础.html">
            
                    
                    语法基础
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.1.2" data-path="golang_json性能.html">
            
                <a href="golang_json性能.html">
            
                    
                    json性能比较
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.2.2" data-path="golang_原理.html">
            
                <a href="golang_原理.html">
            
                    
                    原理相关
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.2.1" data-path="golang_interface原理.html">
            
                <a href="golang_interface原理.html">
            
                    
                    interface原理(网摘)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2.2" data-path="golang_内存分配.html">
            
                <a href="golang_内存分配.html">
            
                    
                    内存分配(网摘)
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter active" data-level="1.2.3" data-path="golang_标准库.html">
            
                <a href="golang_标准库.html">
            
                    
                    标准库
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.4" data-path="golang_我的反射代码.html">
            
                <a href="golang_我的反射代码.html">
            
                    
                    我的反射代码
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.5" data-path="golang_问答.html">
            
                <a href="golang_问答.html">
            
                    
                    问答
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.6" data-path="golang_高效go.html">
            
                <a href="golang_高效go.html">
            
                    
                    高效go
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.7" data-path="golang_进阶.html">
            
                <a href="golang_进阶.html">
            
                    
                    进阶
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.8" data-path="as_title.html">
            
                <a href="as_title.html">
            
                    
                    杂记
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.8.1" data-path="golang_杂记1.html">
            
                <a href="golang_杂记1.html">
            
                    
                    杂记1
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.8.2" data-path="golang_杂记2.html">
            
                <a href="golang_杂记2.html">
            
                    
                    杂记2
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.8.3" data-path="golang_杂记3.html">
            
                <a href="golang_杂记3.html">
            
                    
                    杂记3
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.8.4" data-path="golang_lib选型.html">
            
                <a href="golang_lib选型.html">
            
                    
                    lib选型
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.8.5" data-path="golang_mod_proxy.html">
            
                <a href="golang_mod_proxy.html">
            
                    
                    go mod和go proxy
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.8.6" data-path="golang_汇编_arm64.html">
            
                <a href="golang_汇编_arm64.html">
            
                    
                    汇编语法和arm64小知识
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.8.7" data-path="golang_cgo_swig.html">
            
                <a href="golang_cgo_swig.html">
            
                    
                    go调用c可以用swig
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.2.9" data-path="as_title.html">
            
                <a href="as_title.html">
            
                    
                    环境和工具链生成
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.9.1" data-path="golang_toolchain_ppc.html">
            
                <a href="golang_toolchain_ppc.html">
            
                    
                    go tools增加ppc32支持.md
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.9.2" data-path="golang_toolchain_compile_gccgo.html">
            
                <a href="golang_toolchain_compile_gccgo.html">
            
                    
                    编译gccgo
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.9.3" data-path="golang_go_on_mips.html">
            
                <a href="golang_go_on_mips.html">
            
                    
                    go on mips boards(not so updated)
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.9.3.1" data-path="golang_go_on_mips_part1.html">
            
                <a href="golang_go_on_mips_part1.html">
            
                    
                    part 1: cross compile go
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.9.3.2" data-path="golang_go_on_mips_part2.html">
            
                <a href="golang_go_on_mips_part2.html">
            
                    
                    part 2: build native go compiler
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.9.3.3" data-path="golang_go_on_mips_part3.html">
            
                <a href="golang_go_on_mips_part3.html">
            
                    
                    part 3: gccgo experiments
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.9.3.4" data-path="golang_go_on_mips_part4.html">
            
                <a href="golang_go_on_mips_part4.html">
            
                    
                    part 4: json performance
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.9.3.5" data-path="golang_gentoo_on_mips_board_and_build_go.html">
            
                <a href="golang_gentoo_on_mips_board_and_build_go.html">
            
                    
                    Gentoo on mips board and build go
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.2.10" data-path="as_title.html">
            
                <a href="as_title.html">
            
                    
                    微服务
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.10.1" data-path="golang_micro.html">
            
                <a href="golang_micro.html">
            
                    
                    go-micro和micro
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.10.2" data-path="golang_微服务概念.html">
            
                <a href="golang_微服务概念.html">
            
                    
                    微服务概念
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.2.11" data-path="as_title.html">
            
                <a href="as_title.html">
            
                    
                    解释器和消息中间件
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.11.1" data-path="golang_yeagi.html">
            
                <a href="golang_yeagi.html">
            
                    
                    yeagi
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.11.2" data-path="golang_govaluate.html">
            
                <a href="golang_govaluate.html">
            
                    
                    govaluate
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="as_title.html">
            
                <a href="as_title.html">
            
                    
                    Rust
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1" data-path="rust_入门_brief.html">
            
                <a href="rust_入门_brief.html">
            
                    
                    入门系列
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1.1" data-path="rust_books.html">
            
                <a href="rust_books.html">
            
                    
                    reference books
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.1.2" data-path="rust_入门1.html">
            
                <a href="rust_入门1.html">
            
                    
                    安装和基础语法
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.1.3" data-path="rust_入门2.html">
            
                <a href="rust_入门2.html">
            
                    
                    泛型和内存所有权
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.1.4" data-path="rust_入门3.html">
            
                <a href="rust_入门3.html">
            
                    
                    闭包 容器 迭代器 生成器 线程
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.1.5" data-path="rust_工程构建.html">
            
                <a href="rust_工程构建.html">
            
                    
                    工程构建
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3.2" data-path="rust_vmm_brief.html">
            
                <a href="rust_vmm_brief.html">
            
                    
                    VMM(virtual machine monitor)
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.2.1" data-path="rust_vmm_简介.html">
            
                <a href="rust_vmm_简介.html">
            
                    
                    rust-vmm简介
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2.2" data-path="rust_firecracker_代码.html">
            
                <a href="rust_firecracker_代码.html">
            
                    
                    firecracker代码
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2.3" data-path="rust_firecracker_使用.html">
            
                <a href="rust_firecracker_使用.html">
            
                    
                    firecracker使用
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2.4" data-path="rust_cloud-hypervisor_代码.html">
            
                <a href="rust_cloud-hypervisor_代码.html">
            
                    
                    cloud hypervisor代码
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2.5" data-path="rust_cloud-hypervisor_使用.html">
            
                <a href="rust_cloud-hypervisor_使用.html">
            
                    
                    cloud hypervisor使用
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2.6" data-path="rust_cloud-hypervisor_问题与解决.html">
            
                <a href="rust_cloud-hypervisor_问题与解决.html">
            
                    
                    cloud hypervisor问题与解决
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3.3" data-path="rust_coding_brief.html">
            
                <a href="rust_coding_brief.html">
            
                    
                    代码积累
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.3.1" data-path="rust_序列化.html">
            
                <a href="rust_序列化.html">
            
                    
                    序列化原理
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3.2" data-path="rust_知识点积累.html">
            
                <a href="rust_知识点积累.html">
            
                    
                    知识点更新
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3.3" data-path="rust_adaptiveservice.html">
            
                <a href="rust_adaptiveservice.html">
            
                    
                    rust版本的adaptiveservice探索
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3.4" data-path="rust_常用设施.html">
            
                <a href="rust_常用设施.html">
            
                    
                    常用设施
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3.5" data-path="rust_代码小段.html">
            
                <a href="rust_代码小段.html">
            
                    
                    代码小段
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3.4" data-path="others.html">
            
                <a href="others.html">
            
                    
                    其他
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.4.1" data-path="rust_mdbook_使用.html">
            
                <a href="rust_mdbook_使用.html">
            
                    
                    使用mdbook
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="as_title.html">
            
                <a href="as_title.html">
            
                    
                    System
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1" data-path="system_原理杂记.html">
            
                <a href="system_原理杂记.html">
            
                    
                    原理杂记
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2" data-path="system_alpine.html">
            
                <a href="system_alpine.html">
            
                    
                    Alpine Linux
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.3" data-path="system_进程间通信.html">
            
                <a href="system_进程间通信.html">
            
                    
                    进程间通信
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.4" data-path="system_特殊功能fd.html">
            
                <a href="system_特殊功能fd.html">
            
                    
                    特殊功能fd
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="as_title.html">
            
                <a href="as_title.html">
            
                    
                    工程实践
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.1" data-path="gitlab_ci.html">
            
                <a href="gitlab_ci.html">
            
                    
                    gitlab CI
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            本书使用 GitBook 发布
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".." >标准库</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div class="search-plus" id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <div id="anchor-navigation-ex-navbar"><i class="fa fa-navicon"></i><ul><li><span class="title-icon "></span><a href="#texttemplate"><b>1. </b>text/template</a></li><ul><li><span class="title-icon "></span><a href="#execute&#x539F;&#x578B;"><b>1.1. </b>Execute&#x539F;&#x578B;</a></li><li><span class="title-icon "></span><a href="#actions"><b>1.2. </b>actions</a></li><ul><li><span class="title-icon "></span><a href="#arguments"><b>1.2.1. </b>arguments</a></li><li><span class="title-icon "></span><a href="#pipelines"><b>1.2.2. </b>Pipelines</a></li><li><span class="title-icon "></span><a href="#variables"><b>1.2.3. </b>Variables</a></li></ul><li><span class="title-icon "></span><a href="#&#x4E3E;&#x4F8B;"><b>1.3. </b>&#x4E3E;&#x4F8B;</a></li><li><span class="title-icon "></span><a href="#builtin&#x51FD;&#x6570;"><b>1.4. </b>builtin&#x51FD;&#x6570;</a></li></ul><li><span class="title-icon "></span><a href="#rand"><b>2. </b>rand</a></li><li><span class="title-icon "></span><a href="#unsafe"><b>3. </b>unsafe</a></li><ul><li><span class="title-icon "></span><a href="#unsafepointer&#x7C7B;&#x578B;"><b>3.1. </b>unsafe.Pointer&#x7C7B;&#x578B;</a></li><ul><li><span class="title-icon "></span><a href="#float64&#x8F6C;uint64"><b>3.1.1. </b>float64&#x8F6C;uint64</a></li></ul></ul><li><span class="title-icon "></span><a href="#strconv"><b>4. </b>strconv</a></li><li><span class="title-icon "></span><a href="#sync"><b>5. </b>sync</a></li><ul><li><span class="title-icon "></span><a href="#cond"><b>5.1. </b>Cond</a></li><li><span class="title-icon "></span><a href="#map"><b>5.2. </b>Map</a></li><li><span class="title-icon "></span><a href="#mutex"><b>5.3. </b>Mutex</a></li><li><span class="title-icon "></span><a href="#rwmutex"><b>5.4. </b>RWMutex</a></li><li><span class="title-icon "></span><a href="#once"><b>5.5. </b>Once</a></li><li><span class="title-icon "></span><a href="#pool"><b>5.6. </b>Pool</a></li><li><span class="title-icon "></span><a href="#&#x91CD;&#x70B9;waitgroup"><b>5.7. </b>&#x91CD;&#x70B9;WaitGroup</a></li></ul><li><span class="title-icon "></span><a href="#net"><b>6. </b>net</a></li><ul><li><span class="title-icon "></span><a href="#&#x540D;&#x5B57;&#x89E3;&#x6790;"><b>6.1. </b>&#x540D;&#x5B57;&#x89E3;&#x6790;</a></li><li><span class="title-icon "></span><a href="#api"><b>6.2. </b>api</a></li></ul><li><span class="title-icon "></span><a href="#path"><b>7. </b>path</a></li><ul><li><span class="title-icon "></span><a href="#filepath"><b>7.1. </b>filepath</a></li></ul><li><span class="title-icon "></span><a href="#encoding"><b>8. </b>encoding</a></li><ul><li><span class="title-icon "></span><a href="#&#x4E8C;&#x8FDB;&#x5236;"><b>8.1. </b>&#x4E8C;&#x8FDB;&#x5236;</a></li><li><span class="title-icon "></span><a href="#utf8"><b>8.2. </b>UTF8</a></li><li><span class="title-icon "></span><a href="#encodinggob"><b>8.3. </b>encoding/gob</a></li><ul><li><span class="title-icon "></span><a href="#api_1"><b>8.3.1. </b>api</a></li><li><span class="title-icon "></span><a href="#&#x7B80;&#x5355;&#x4F8B;&#x5B50;"><b>8.3.2. </b>&#x7B80;&#x5355;&#x4F8B;&#x5B50;</a></li><li><span class="title-icon "></span><a href="#&#x81EA;&#x5B9A;&#x4E49;encode&#x548C;decode"><b>8.3.3. </b>&#x81EA;&#x5B9A;&#x4E49;encode&#x548C;decode</a></li><li><span class="title-icon "></span><a href="#&#x4F20;&#x8F93;interface&#x5BF9;&#x8C61;"><b>8.3.4. </b>&#x4F20;&#x8F93;interface&#x5BF9;&#x8C61;</a></li></ul><li><span class="title-icon "></span><a href="#encodingbinary"><b>8.4. </b>encoding/binary</a></li><ul><li><span class="title-icon "></span><a href="#varint"><b>8.4.1. </b>varint</a></li></ul></ul><li><span class="title-icon "></span><a href="#time"><b>9. </b>time</a></li><ul><li><span class="title-icon "></span><a href="#time_1"><b>9.1. </b>Time</a></li><li><span class="title-icon "></span><a href="#&#x65F6;&#x95F4;&#x683C;&#x5F0F;&#x548C;&#x5355;&#x4F4D;"><b>9.2. </b>&#x65F6;&#x95F4;&#x683C;&#x5F0F;&#x548C;&#x5355;&#x4F4D;</a></li><li><span class="title-icon "></span><a href="#duration"><b>9.3. </b>Duration</a></li><li><span class="title-icon "></span><a href="#api_2"><b>9.4. </b>api</a></li><li><span class="title-icon "></span><a href="#ticker"><b>9.5. </b>Ticker</a></li><li><span class="title-icon "></span><a href="#timer"><b>9.6. </b>Timer</a></li></ul><li><span class="title-icon "></span><a href="#context"><b>10. </b>context</a></li><ul><li><span class="title-icon "></span><a href="#api_3"><b>10.1. </b>api</a></li><ul><li><span class="title-icon "></span><a href="#&#x6574;&#x6570;&#x53D1;&#x751F;&#x5668;-generator"><b>10.1.1. </b>&#x6574;&#x6570;&#x53D1;&#x751F;&#x5668; generator</a></li><li><span class="title-icon "></span><a href="#&#x5E26;&#x8D85;&#x65F6;&#x7684;context"><b>10.1.2. </b>&#x5E26;&#x8D85;&#x65F6;&#x7684;Context</a></li></ul></ul><li><span class="title-icon "></span><a href="#syscall"><b>11. </b>syscall</a></li><li><span class="title-icon "></span><a href="#runtime"><b>12. </b>runtime</a></li><ul><li><span class="title-icon "></span><a href="#runtime&#x76F8;&#x5173;&#x7684;&#x73AF;&#x5883;&#x53D8;&#x91CF;"><b>12.1. </b>runtime&#x76F8;&#x5173;&#x7684;&#x73AF;&#x5883;&#x53D8;&#x91CF;</a></li><li><span class="title-icon "></span><a href="#api_4"><b>12.2. </b>api</a></li><li><span class="title-icon "></span><a href="#runtimepprof"><b>12.3. </b>runtime/pprof</a></li><li><span class="title-icon "></span><a href="#runtimedebug"><b>12.4. </b>runtime/debug</a></li><li><span class="title-icon "></span><a href="#runtimetrace"><b>12.5. </b>runtime/trace</a></li></ul><li><span class="title-icon "></span><a href="#os"><b>13. </b>os</a></li><ul><li><span class="title-icon "></span><a href="#osexec"><b>13.1. </b>os/exec</a></li><li><span class="title-icon "></span><a href="#ossignal"><b>13.2. </b>os/signal</a></li><ul><li><span class="title-icon "></span><a href="#cgo"><b>13.2.1. </b>cgo</a></li><li><span class="title-icon "></span><a href="#go&#x4F5C;&#x4E3A;so"><b>13.2.2. </b>go&#x4F5C;&#x4E3A;so</a></li><li><span class="title-icon "></span><a href="#&#x65B9;&#x6CD5;"><b>13.2.3. </b>&#x65B9;&#x6CD5;</a></li></ul><li><span class="title-icon "></span><a href="#osuser"><b>13.3. </b>os/user</a></li></ul><li><span class="title-icon "></span><a href="#builtin"><b>14. </b>builtin</a></li><ul><li><span class="title-icon "></span><a href="#&#x51FD;&#x6570;"><b>14.1. </b>&#x51FD;&#x6570;</a></li><li><span class="title-icon "></span><a href="#&#x7C7B;&#x578B;"><b>14.2. </b>&#x7C7B;&#x578B;</a></li></ul><li><span class="title-icon "></span><a href="#strings"><b>15. </b>strings</a></li><li><span class="title-icon "></span><a href="#bytes"><b>16. </b>bytes</a></li><ul><li><span class="title-icon "></span><a href="#buffer"><b>16.1. </b>Buffer</a></li></ul><li><span class="title-icon "></span><a href="#logsyslog"><b>17. </b>log/syslog</a></li><li><span class="title-icon "></span><a href="#log"><b>18. </b>log</a></li><ul><li><span class="title-icon "></span><a href="#type-logger"><b>18.1. </b>type logger</a></li><li><span class="title-icon "></span><a href="#logger&#x652F;&#x6301;&#x591A;&#x79CD;&#x683C;&#x5F0F;-&#x7528;flag&#x6765;&#x914D;&#x7F6E;"><b>18.2. </b>logger&#x652F;&#x6301;&#x591A;&#x79CD;&#x683C;&#x5F0F;, &#x7528;flag&#x6765;&#x914D;&#x7F6E;</a></li></ul><li><span class="title-icon "></span><a href="#fmt"><b>19. </b>fmt</a></li><ul><li><span class="title-icon "></span><a href="#&#x65B9;&#x6CD5;_1"><b>19.1. </b>&#x65B9;&#x6CD5;</a></li><li><span class="title-icon "></span><a href="#stringer&#x7C7B;&#x578B;"><b>19.2. </b>Stringer&#x7C7B;&#x578B;</a></li><li><span class="title-icon "></span><a href="#&#x683C;&#x5F0F;&#x5316;&#x6807;&#x5FD7;&#x7B26;"><b>19.3. </b>&#x683C;&#x5F0F;&#x5316;&#x6807;&#x5FD7;&#x7B26;</a></li><ul><li><span class="title-icon "></span><a href="#&#x901A;&#x7528;"><b>19.3.1. </b>&#x901A;&#x7528;</a></li><li><span class="title-icon "></span><a href="#&#x5E03;&#x5C14;&#x503C;"><b>19.3.2. </b>&#x5E03;&#x5C14;&#x503C;</a></li><li><span class="title-icon "></span><a href="#&#x6574;&#x578B;"><b>19.3.3. </b>&#x6574;&#x578B;</a></li><li><span class="title-icon "></span><a href="#&#x6D6E;&#x70B9;"><b>19.3.4. </b>&#x6D6E;&#x70B9;</a></li><li><span class="title-icon "></span><a href="#&#x5B57;&#x7B26;&#x4E32;"><b>19.3.5. </b>&#x5B57;&#x7B26;&#x4E32;</a></li><li><span class="title-icon "></span><a href="#&#x5207;&#x7247;"><b>19.3.6. </b>&#x5207;&#x7247;</a></li><li><span class="title-icon "></span><a href="#&#x6307;&#x9488;"><b>19.3.7. </b>&#x6307;&#x9488;</a></li><li><span class="title-icon "></span><a href="#&#x9ED8;&#x8BA4;&#x683C;&#x5F0F;&#x5316;"><b>19.3.8. </b>&#x9ED8;&#x8BA4;&#x683C;&#x5F0F;&#x5316;</a></li><li><span class="title-icon "></span><a href="#&#x5BBD;&#x5EA6;-&#x7CBE;&#x5EA6;-&#x5BF9;&#x9F50;"><b>19.3.9. </b>&#x5BBD;&#x5EA6; &#x7CBE;&#x5EA6; &#x5BF9;&#x9F50;</a></li></ul><li><span class="title-icon "></span><a href="#&#x4E3E;&#x4F8B;_1"><b>19.4. </b>&#x4E3E;&#x4F8B;</a></li><ul><li><span class="title-icon "></span><a href="#scanf"><b>19.4.1. </b>scanf</a></li></ul></ul><li><span class="title-icon "></span><a href="#bufio"><b>20. </b>bufio</a></li><ul><li><span class="title-icon "></span><a href="#error&#x5BF9;&#x8C61;"><b>20.1. </b>error&#x5BF9;&#x8C61;</a></li><li><span class="title-icon "></span><a href="#reader&#x7684;&#x65B9;&#x6CD5;"><b>20.2. </b>Reader&#x7684;&#x65B9;&#x6CD5;</a></li><li><span class="title-icon "></span><a href="#writer&#x7684;&#x65B9;&#x6CD5;"><b>20.3. </b>Writer&#x7684;&#x65B9;&#x6CD5;</a></li><li><span class="title-icon "></span><a href="#scanner&#x7684;&#x65B9;&#x6CD5;"><b>20.4. </b>Scanner&#x7684;&#x65B9;&#x6CD5;</a></li><ul><li><span class="title-icon "></span><a href="#scanner&#x7684;&#x65B9;&#x6CD5;_1"><b>20.4.1. </b>Scanner&#x7684;&#x65B9;&#x6CD5;</a></li><li><span class="title-icon "></span><a href="#&#x6309;&#x884C;&#x8BFB;"><b>20.4.2. </b>&#x6309;&#x884C;&#x8BFB;</a></li><li><span class="title-icon "></span><a href="#&#x7EDF;&#x8BA1;&#x5B57;&#x7B26;&#x4E2A;&#x6570;"><b>20.4.3. </b>&#x7EDF;&#x8BA1;&#x5B57;&#x7B26;&#x4E2A;&#x6570;</a></li><li><span class="title-icon "></span><a href="#&#x4E5F;&#x53EF;&#x4EE5;&#x81EA;&#x5B9A;&#x4E49;&#x5206;&#x5272;&#x51FD;&#x6570;"><b>20.4.4. </b>&#x4E5F;&#x53EF;&#x4EE5;&#x81EA;&#x5B9A;&#x4E49;&#x5206;&#x5272;&#x51FD;&#x6570;</a></li></ul></ul><li><span class="title-icon "></span><a href="#ioioutil"><b>21. </b>io/ioutil</a></li><li><span class="title-icon "></span><a href="#io"><b>22. </b>io</a></li><ul><li><span class="title-icon "></span><a href="#&#x53D8;&#x91CF;"><b>22.1. </b>&#x53D8;&#x91CF;</a></li><li><span class="title-icon "></span><a href="#&#x4EE5;reader&#x4E3A;&#x4F8B;-&#x770B;golang&#x7684;&#x6D3E;&#x751F;"><b>22.2. </b>&#x4EE5;Reader&#x4E3A;&#x4F8B;, &#x770B;golang&#x7684;&#x6D3E;&#x751F;</a></li><li><span class="title-icon "></span><a href="#pipereader-&#x6D3E;&#x751F;&#x7C7B;"><b>22.3. </b>PipeReader, &#x6D3E;&#x751F;&#x7C7B;</a></li><li><span class="title-icon "></span><a href="#readwriter"><b>22.4. </b>ReadWriter</a></li><ul><li><span class="title-icon "></span><a href="#writerto"><b>22.4.1. </b>WriterTo</a></li></ul><li><span class="title-icon "></span><a href="#readerat"><b>22.5. </b>ReaderAt</a></li><li><span class="title-icon "></span><a href="#&#x5176;&#x4ED6;&#x57FA;&#x7C7B;"><b>22.6. </b>&#x5176;&#x4ED6;&#x57FA;&#x7C7B;</a></li><li><span class="title-icon "></span><a href="#seeker"><b>22.7. </b>Seeker</a></li><li><span class="title-icon "></span><a href="#io&#x5305;&#x7684;&#x65B9;&#x6CD5;"><b>22.8. </b>io&#x5305;&#x7684;&#x65B9;&#x6CD5;</a></li><ul><li><span class="title-icon "></span><a href="#copy"><b>22.8.1. </b>Copy</a></li><li><span class="title-icon "></span><a href="#pipe"><b>22.8.2. </b>Pipe</a></li><li><span class="title-icon "></span><a href="#teereader"><b>22.8.3. </b>TeeReader</a></li></ul></ul><li><span class="title-icon "></span><a href="#containerring"><b>23. </b>container/ring</a></li><ul><li><span class="title-icon "></span><a href="#api_5"><b>23.1. </b>api</a></li><li><span class="title-icon "></span><a href="#&#x4F8B;&#x5B50;-&#x8FDE;&#x63A5;&#x4E24;&#x4E2A;ring"><b>23.2. </b>&#x4F8B;&#x5B50;: &#x8FDE;&#x63A5;&#x4E24;&#x4E2A;ring</a></li></ul><li><span class="title-icon "></span><a href="#containerlist"><b>24. </b>container/list</a></li><ul><li><span class="title-icon "></span><a href="#api_6"><b>24.1. </b>api</a></li><li><span class="title-icon "></span><a href="#&#x4F7F;&#x7528;&#x4E3E;&#x4F8B;"><b>24.2. </b>&#x4F7F;&#x7528;&#x4E3E;&#x4F8B;</a></li></ul><li><span class="title-icon "></span><a href="#containerheap"><b>25. </b>container/heap</a></li><ul><li><span class="title-icon "></span><a href="#&#x6811;&#x7684;&#x6570;&#x7EC4;&#x8868;&#x8FBE;"><b>25.1. </b>&#x6811;&#x7684;&#x6570;&#x7EC4;&#x8868;&#x8FBE;</a></li><li><span class="title-icon "></span><a href="#min-int&#x6811;"><b>25.2. </b>min-int&#x6811;</a></li><li><span class="title-icon "></span><a href="#&#x53EF;&#x4EE5;&#x7528;heap&#x6765;&#x5B9E;&#x73B0;&#x4F18;&#x5148;&#x7EA7;&#x961F;&#x5217;"><b>25.3. </b>&#x53EF;&#x4EE5;&#x7528;heap&#x6765;&#x5B9E;&#x73B0;&#x4F18;&#x5148;&#x7EA7;&#x961F;&#x5217;</a></li></ul><li><span class="title-icon "></span><a href="#sort"><b>26. </b>sort</a></li><ul><li><span class="title-icon "></span><a href="#&#x652F;&#x6301;&#x5BF9;&#x57FA;&#x672C;&#x7C7B;&#x578B;&#x7684;&#x6392;&#x5E8F;"><b>26.1. </b>&#x652F;&#x6301;&#x5BF9;&#x57FA;&#x672C;&#x7C7B;&#x578B;&#x7684;&#x6392;&#x5E8F;</a></li><li><span class="title-icon "></span><a href="#&#x5BF9;struct&#x6392;&#x5E8F;"><b>26.2. </b>&#x5BF9;struct&#x6392;&#x5E8F;</a></li><li><span class="title-icon "></span><a href="#&#x901A;&#x7528;&#x6392;&#x5E8F;"><b>26.3. </b>&#x901A;&#x7528;&#x6392;&#x5E8F;</a></li><li><span class="title-icon "></span><a href="#&#x5BF9;&#x5916;&#x63A5;&#x53E3;"><b>26.4. </b>&#x5BF9;&#x5916;&#x63A5;&#x53E3;</a></li></ul></ul></div><a href="#texttemplate" id="anchorNavigationExGoTop"><i class="fa fa-arrow-up"></i></a><ul>
<li><a href="#texttemplate">text/template</a><ul>
<li><a href="#execute&#x539F;&#x578B;">Execute&#x539F;&#x578B;</a></li>
<li><a href="#actions">actions</a><ul>
<li><a href="#arguments">arguments</a></li>
<li><a href="#pipelines">Pipelines</a></li>
<li><a href="#variables">Variables</a></li>
</ul>
</li>
<li><a href="#&#x4E3E;&#x4F8B;">&#x4E3E;&#x4F8B;</a></li>
<li><a href="#builtin&#x51FD;&#x6570;">builtin&#x51FD;&#x6570;</a></li>
</ul>
</li>
<li><a href="#rand">rand</a></li>
<li><a href="#unsafe">unsafe</a><ul>
<li><a href="#unsafepointer&#x7C7B;&#x578B;">unsafe.Pointer&#x7C7B;&#x578B;</a><ul>
<li><a href="#float64&#x8F6C;uint64">float64&#x8F6C;uint64</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#strconv">strconv</a></li>
<li><a href="#sync">sync</a><ul>
<li><a href="#cond">Cond</a></li>
<li><a href="#map">Map</a></li>
<li><a href="#mutex">Mutex</a></li>
<li><a href="#rwmutex">RWMutex</a></li>
<li><a href="#once">Once</a></li>
<li><a href="#pool">Pool</a></li>
<li><a href="#&#x91CD;&#x70B9;waitgroup">&#x91CD;&#x70B9;WaitGroup</a></li>
</ul>
</li>
<li><a href="#net">net</a><ul>
<li><a href="#&#x540D;&#x5B57;&#x89E3;&#x6790;">&#x540D;&#x5B57;&#x89E3;&#x6790;</a></li>
<li><a href="#api">api</a></li>
</ul>
</li>
<li><a href="#path">path</a><ul>
<li><a href="#filepath">filepath</a></li>
</ul>
</li>
<li><a href="#encoding">encoding</a><ul>
<li><a href="#&#x4E8C;&#x8FDB;&#x5236;">&#x4E8C;&#x8FDB;&#x5236;</a></li>
<li><a href="#utf8">UTF8</a></li>
<li><a href="#encodinggob">encoding/gob</a><ul>
<li><a href="#api-1">api</a></li>
<li><a href="#&#x7B80;&#x5355;&#x4F8B;&#x5B50;">&#x7B80;&#x5355;&#x4F8B;&#x5B50;</a></li>
<li><a href="#&#x81EA;&#x5B9A;&#x4E49;encode&#x548C;decode">&#x81EA;&#x5B9A;&#x4E49;encode&#x548C;decode</a></li>
<li><a href="#&#x4F20;&#x8F93;interface&#x5BF9;&#x8C61;">&#x4F20;&#x8F93;interface&#x5BF9;&#x8C61;</a></li>
</ul>
</li>
<li><a href="#encodingbinary">encoding/binary</a><ul>
<li><a href="#varint">varint</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#time">time</a><ul>
<li><a href="#time-1">Time</a></li>
<li><a href="#&#x65F6;&#x95F4;&#x683C;&#x5F0F;&#x548C;&#x5355;&#x4F4D;">&#x65F6;&#x95F4;&#x683C;&#x5F0F;&#x548C;&#x5355;&#x4F4D;</a></li>
<li><a href="#duration">Duration</a></li>
<li><a href="#api-2">api</a></li>
<li><a href="#ticker">Ticker</a></li>
<li><a href="#timer">Timer</a></li>
</ul>
</li>
<li><a href="#context">context</a><ul>
<li><a href="#api-3">api</a><ul>
<li><a href="#&#x6574;&#x6570;&#x53D1;&#x751F;&#x5668;-generator">&#x6574;&#x6570;&#x53D1;&#x751F;&#x5668; generator</a></li>
<li><a href="#&#x5E26;&#x8D85;&#x65F6;&#x7684;context">&#x5E26;&#x8D85;&#x65F6;&#x7684;Context</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#syscall">syscall</a></li>
<li><a href="#runtime">runtime</a><ul>
<li><a href="#runtime&#x76F8;&#x5173;&#x7684;&#x73AF;&#x5883;&#x53D8;&#x91CF;">runtime&#x76F8;&#x5173;&#x7684;&#x73AF;&#x5883;&#x53D8;&#x91CF;</a></li>
<li><a href="#api-4">api</a></li>
<li><a href="#runtimepprof">runtime/pprof</a></li>
<li><a href="#runtimedebug">runtime/debug</a></li>
<li><a href="#runtimetrace">runtime/trace</a></li>
</ul>
</li>
<li><a href="#os">os</a><ul>
<li><a href="#osexec">os/exec</a></li>
<li><a href="#ossignal">os/signal</a><ul>
<li><a href="#cgo">cgo</a></li>
<li><a href="#go&#x4F5C;&#x4E3A;so">go&#x4F5C;&#x4E3A;so</a></li>
<li><a href="#&#x65B9;&#x6CD5;">&#x65B9;&#x6CD5;</a></li>
</ul>
</li>
<li><a href="#osuser">os/user</a></li>
</ul>
</li>
<li><a href="#builtin">builtin</a><ul>
<li><a href="#&#x51FD;&#x6570;">&#x51FD;&#x6570;</a></li>
<li><a href="#&#x7C7B;&#x578B;">&#x7C7B;&#x578B;</a></li>
</ul>
</li>
<li><a href="#strings">strings</a></li>
<li><a href="#bytes">bytes</a><ul>
<li><a href="#buffer">Buffer</a></li>
</ul>
</li>
<li><a href="#logsyslog">log/syslog</a></li>
<li><a href="#log">log</a><ul>
<li><a href="#type-logger">type logger</a></li>
<li><a href="#logger&#x652F;&#x6301;&#x591A;&#x79CD;&#x683C;&#x5F0F;-&#x7528;flag&#x6765;&#x914D;&#x7F6E;">logger&#x652F;&#x6301;&#x591A;&#x79CD;&#x683C;&#x5F0F;, &#x7528;flag&#x6765;&#x914D;&#x7F6E;</a></li>
</ul>
</li>
<li><a href="#fmt">fmt</a><ul>
<li><a href="#&#x65B9;&#x6CD5;-1">&#x65B9;&#x6CD5;</a></li>
<li><a href="#stringer&#x7C7B;&#x578B;">Stringer&#x7C7B;&#x578B;</a></li>
<li><a href="#&#x683C;&#x5F0F;&#x5316;&#x6807;&#x5FD7;&#x7B26;">&#x683C;&#x5F0F;&#x5316;&#x6807;&#x5FD7;&#x7B26;</a><ul>
<li><a href="#&#x901A;&#x7528;">&#x901A;&#x7528;</a></li>
<li><a href="#&#x5E03;&#x5C14;&#x503C;">&#x5E03;&#x5C14;&#x503C;</a></li>
<li><a href="#&#x6574;&#x578B;">&#x6574;&#x578B;</a></li>
<li><a href="#&#x6D6E;&#x70B9;">&#x6D6E;&#x70B9;</a></li>
<li><a href="#&#x5B57;&#x7B26;&#x4E32;">&#x5B57;&#x7B26;&#x4E32;</a></li>
<li><a href="#&#x5207;&#x7247;">&#x5207;&#x7247;</a></li>
<li><a href="#&#x6307;&#x9488;">&#x6307;&#x9488;</a></li>
<li><a href="#&#x9ED8;&#x8BA4;&#x683C;&#x5F0F;&#x5316;">&#x9ED8;&#x8BA4;&#x683C;&#x5F0F;&#x5316;</a></li>
<li><a href="#&#x5BBD;&#x5EA6;-&#x7CBE;&#x5EA6;-&#x5BF9;&#x9F50;">&#x5BBD;&#x5EA6; &#x7CBE;&#x5EA6; &#x5BF9;&#x9F50;</a></li>
</ul>
</li>
<li><a href="#&#x4E3E;&#x4F8B;-1">&#x4E3E;&#x4F8B;</a><ul>
<li><a href="#scanf">scanf</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#bufio">bufio</a><ul>
<li><a href="#error&#x5BF9;&#x8C61;">error&#x5BF9;&#x8C61;</a></li>
<li><a href="#reader&#x7684;&#x65B9;&#x6CD5;">Reader&#x7684;&#x65B9;&#x6CD5;</a></li>
<li><a href="#writer&#x7684;&#x65B9;&#x6CD5;">Writer&#x7684;&#x65B9;&#x6CD5;</a></li>
<li><a href="#scanner&#x7684;&#x65B9;&#x6CD5;">Scanner&#x7684;&#x65B9;&#x6CD5;</a><ul>
<li><a href="#scanner&#x7684;&#x65B9;&#x6CD5;-1">Scanner&#x7684;&#x65B9;&#x6CD5;</a></li>
<li><a href="#&#x6309;&#x884C;&#x8BFB;">&#x6309;&#x884C;&#x8BFB;</a></li>
<li><a href="#&#x7EDF;&#x8BA1;&#x5B57;&#x7B26;&#x4E2A;&#x6570;">&#x7EDF;&#x8BA1;&#x5B57;&#x7B26;&#x4E2A;&#x6570;</a></li>
<li><a href="#&#x4E5F;&#x53EF;&#x4EE5;&#x81EA;&#x5B9A;&#x4E49;&#x5206;&#x5272;&#x51FD;&#x6570;">&#x4E5F;&#x53EF;&#x4EE5;&#x81EA;&#x5B9A;&#x4E49;&#x5206;&#x5272;&#x51FD;&#x6570;</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#ioioutil">io/ioutil</a></li>
<li><a href="#io">io</a><ul>
<li><a href="#&#x53D8;&#x91CF;">&#x53D8;&#x91CF;</a></li>
<li><a href="#&#x4EE5;reader&#x4E3A;&#x4F8B;-&#x770B;golang&#x7684;&#x6D3E;&#x751F;">&#x4EE5;Reader&#x4E3A;&#x4F8B;, &#x770B;golang&#x7684;&#x6D3E;&#x751F;</a></li>
<li><a href="#pipereader-&#x6D3E;&#x751F;&#x7C7B;">PipeReader, &#x6D3E;&#x751F;&#x7C7B;</a></li>
<li><a href="#readwriter">ReadWriter</a><ul>
<li><a href="#writerto">WriterTo</a></li>
</ul>
</li>
<li><a href="#readerat">ReaderAt</a></li>
<li><a href="#&#x5176;&#x4ED6;&#x57FA;&#x7C7B;">&#x5176;&#x4ED6;&#x57FA;&#x7C7B;</a></li>
<li><a href="#seeker">Seeker</a></li>
<li><a href="#io&#x5305;&#x7684;&#x65B9;&#x6CD5;">io&#x5305;&#x7684;&#x65B9;&#x6CD5;</a><ul>
<li><a href="#copy">Copy</a></li>
<li><a href="#pipe">Pipe</a></li>
<li><a href="#teereader">TeeReader</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#containerring">container/ring</a><ul>
<li><a href="#api-5">api</a></li>
<li><a href="#&#x4F8B;&#x5B50;-&#x8FDE;&#x63A5;&#x4E24;&#x4E2A;ring">&#x4F8B;&#x5B50;: &#x8FDE;&#x63A5;&#x4E24;&#x4E2A;ring</a></li>
</ul>
</li>
<li><a href="#containerlist">container/list</a><ul>
<li><a href="#api-6">api</a></li>
<li><a href="#&#x4F7F;&#x7528;&#x4E3E;&#x4F8B;">&#x4F7F;&#x7528;&#x4E3E;&#x4F8B;</a></li>
</ul>
</li>
<li><a href="#containerheap">container/heap</a><ul>
<li><a href="#&#x6811;&#x7684;&#x6570;&#x7EC4;&#x8868;&#x8FBE;">&#x6811;&#x7684;&#x6570;&#x7EC4;&#x8868;&#x8FBE;</a></li>
<li><a href="#min-int&#x6811;">min-int&#x6811;</a></li>
<li><a href="#&#x53EF;&#x4EE5;&#x7528;heap&#x6765;&#x5B9E;&#x73B0;&#x4F18;&#x5148;&#x7EA7;&#x961F;&#x5217;">&#x53EF;&#x4EE5;&#x7528;heap&#x6765;&#x5B9E;&#x73B0;&#x4F18;&#x5148;&#x7EA7;&#x961F;&#x5217;</a></li>
</ul>
</li>
<li><a href="#sort">sort</a><ul>
<li><a href="#&#x652F;&#x6301;&#x5BF9;&#x57FA;&#x672C;&#x7C7B;&#x578B;&#x7684;&#x6392;&#x5E8F;">&#x652F;&#x6301;&#x5BF9;&#x57FA;&#x672C;&#x7C7B;&#x578B;&#x7684;&#x6392;&#x5E8F;</a></li>
<li><a href="#&#x5BF9;struct&#x6392;&#x5E8F;">&#x5BF9;struct&#x6392;&#x5E8F;</a></li>
<li><a href="#&#x901A;&#x7528;&#x6392;&#x5E8F;">&#x901A;&#x7528;&#x6392;&#x5E8F;</a></li>
<li><a href="#&#x5BF9;&#x5916;&#x63A5;&#x53E3;">&#x5BF9;&#x5916;&#x63A5;&#x53E3;</a></li>
</ul>
</li>
</ul>
<h1 id="texttemplate"><a name="texttemplate" class="anchor-navigation-ex-anchor" href="#texttemplate"><i class="fa fa-link" aria-hidden="true"></i></a>1. text/template</h1>
<p>&#x6CE8;: gitbook&#x5BF9;&#x6A21;&#x677F;&#x5173;&#x952E;&#x5B57;<code>{{ }}</code>&#x6709;&#x7279;&#x6B8A;&#x5904;&#x7406;. &#x4E0B;&#x6587;&#x4E2D;&#x4E3A;&#x4E86;&#x89C4;&#x907F;&#x8FD9;&#x4E2A;&#x95EE;&#x9898;, &#x5728;&#x4E24;&#x4E2A;&#x5927;&#x62EC;&#x53F7;&#x4E2D;&#x95F4;&#x90FD;&#x52A0;&#x4E86;&#x7A7A;&#x683C;.</p>
<ul>
<li><code>{ {.var} }</code>: &#x8981;&#x88AB;&#x66FF;&#x6362;&#x7684;&#x6A21;&#x677F;&#x53D8;&#x91CF;. </li>
<li><code>&quot;{ {23 -} } &lt; { {- 45} }&quot;</code>: <code>-</code>&#x7528;&#x6765;&#x53BB;&#x6389;&#x7A7A;&#x683C; <code>&quot;23&lt;45&quot;</code></li>
</ul>
<p>&#x4F20;&#x5165;&#x6A21;&#x677F;&#x7684;&#x6570;&#x636E;&#x4E00;&#x822C;&#x662F;&#x4E2A;&#x7ED3;&#x6784;&#x4F53;, &#x6216;&#x8005;map.</p>
<blockquote>
<p>Templates are executed by applying them to a data structure. Annotations in the template refer to elements of the data structure (typically a field of a struct or a key in a map) to control execution and derive values to be displayed. Execution of the template walks the structure and sets the cursor, represented by a period &apos;.&apos; and called &quot;dot&quot;, to the value at the current location in the structure as execution proceeds.</p>
</blockquote>
<h2 id="execute&#x539F;&#x578B;"><a name="execute&#x539F;&#x578B;" class="anchor-navigation-ex-anchor" href="#execute&#x539F;&#x578B;"><i class="fa fa-link" aria-hidden="true"></i></a>1.1. Execute&#x539F;&#x578B;</h2>
<p>&#x5165;&#x53C2;data&#x53EF;&#x4EE5;&#x662F;&#x7ED3;&#x6784;&#x4F53;, map&#x7B49;. &#x628A;&#x7ED3;&#x679C;&#x5199;&#x5165;io.Writer(&#x8FD9;&#x4E2A;&#x8BBE;&#x8BA1;&#x5F88;&#x597D;, &#x7ED3;&#x679C;&#x5199;&#x5165;&#x63A5;&#x53E3;, &#x4EE3;&#x7801;&#x7684;&#x7EC4;&#x5408;&#x6027;&#x5C31;&#x5F88;&#x5F3A;)</p>
<pre class="language-"><code class="lang-go"><span class="token keyword">func</span> <span class="token punctuation">(</span>t <span class="token operator">*</span>Template<span class="token punctuation">)</span> <span class="token function">Execute</span><span class="token punctuation">(</span>wr io<span class="token punctuation">.</span>Writer<span class="token punctuation">,</span> data <span class="token keyword">interface</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token builtin">error</span>
</code></pre>
<h2 id="actions"><a name="actions" class="anchor-navigation-ex-anchor" href="#actions"><i class="fa fa-link" aria-hidden="true"></i></a>1.2. actions</h2>
<p><code>{ { } }</code>&#x5305;&#x8D77;&#x6765;&#x7684;&#x53EB;action.</p>
<pre class="language-"><code class="lang-go"><span class="token punctuation">{</span> <span class="token punctuation">{</span><span class="token comment">/* a comment */</span><span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token punctuation">{</span><span class="token operator">-</span> <span class="token comment">/* a comment with white space trimmed from preceding and following text */</span> <span class="token operator">-</span><span class="token punctuation">}</span> <span class="token punctuation">}</span>
    A comment<span class="token punctuation">;</span> discarded<span class="token punctuation">.</span> May contain newlines<span class="token punctuation">.</span>
    Comments do not nest and must start and end at the
    delimiters<span class="token punctuation">,</span> as shown here<span class="token punctuation">.</span>

<span class="token punctuation">{</span> <span class="token punctuation">{</span>pipeline<span class="token punctuation">}</span> <span class="token punctuation">}</span>
    The <span class="token keyword">default</span> textual representation <span class="token punctuation">(</span>the same as would be
    printed by fmt<span class="token punctuation">.</span>Print<span class="token punctuation">)</span> of the value of the pipeline is copied
    to the output<span class="token punctuation">.</span>

<span class="token punctuation">{</span> <span class="token punctuation">{</span><span class="token keyword">if</span> pipeline<span class="token punctuation">}</span> <span class="token punctuation">}</span> T1 <span class="token punctuation">{</span> <span class="token punctuation">{</span>end<span class="token punctuation">}</span> <span class="token punctuation">}</span>
    If the value of the pipeline is empty<span class="token punctuation">,</span> no output is generated<span class="token punctuation">;</span>
    otherwise<span class="token punctuation">,</span> T1 is executed<span class="token punctuation">.</span> The empty values are <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> any
    <span class="token boolean">nil</span> pointer or <span class="token keyword">interface</span> value<span class="token punctuation">,</span> and any array<span class="token punctuation">,</span> slice<span class="token punctuation">,</span> <span class="token keyword">map</span><span class="token punctuation">,</span> or
    <span class="token builtin">string</span> of length zero<span class="token punctuation">.</span>
    Dot is unaffected<span class="token punctuation">.</span>

<span class="token punctuation">{</span> <span class="token punctuation">{</span><span class="token keyword">if</span> pipeline<span class="token punctuation">}</span> <span class="token punctuation">}</span> T1 <span class="token punctuation">{</span> <span class="token punctuation">{</span><span class="token keyword">else</span><span class="token punctuation">}</span> <span class="token punctuation">}</span> T0 <span class="token punctuation">{</span> <span class="token punctuation">{</span>end<span class="token punctuation">}</span> <span class="token punctuation">}</span>
    If the value of the pipeline is empty<span class="token punctuation">,</span> T0 is executed<span class="token punctuation">;</span>
    otherwise<span class="token punctuation">,</span> T1 is executed<span class="token punctuation">.</span> Dot is unaffected<span class="token punctuation">.</span>

<span class="token punctuation">{</span> <span class="token punctuation">{</span><span class="token keyword">if</span> pipeline<span class="token punctuation">}</span> <span class="token punctuation">}</span> T1 <span class="token punctuation">{</span> <span class="token punctuation">{</span><span class="token keyword">else</span> <span class="token keyword">if</span> pipeline<span class="token punctuation">}</span> <span class="token punctuation">}</span> T0 <span class="token punctuation">{</span> <span class="token punctuation">{</span>end<span class="token punctuation">}</span> <span class="token punctuation">}</span>
    To simplify the appearance of <span class="token keyword">if</span><span class="token operator">-</span><span class="token keyword">else</span> chains<span class="token punctuation">,</span> the <span class="token keyword">else</span> action
    of an <span class="token keyword">if</span> may include another <span class="token keyword">if</span> directly<span class="token punctuation">;</span> the effect is exactly
    the same as writing
        <span class="token punctuation">{</span> <span class="token punctuation">{</span><span class="token keyword">if</span> pipeline<span class="token punctuation">}</span> <span class="token punctuation">}</span> T1 <span class="token punctuation">{</span> <span class="token punctuation">{</span><span class="token keyword">else</span><span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">{</span> <span class="token punctuation">{</span><span class="token keyword">if</span> pipeline<span class="token punctuation">}</span> <span class="token punctuation">}</span> T0 <span class="token punctuation">{</span> <span class="token punctuation">{</span>end<span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">{</span> <span class="token punctuation">{</span>end<span class="token punctuation">}</span> <span class="token punctuation">}</span>

<span class="token punctuation">{</span> <span class="token punctuation">{</span><span class="token keyword">range</span> pipeline<span class="token punctuation">}</span> <span class="token punctuation">}</span> T1 <span class="token punctuation">{</span> <span class="token punctuation">{</span>end<span class="token punctuation">}</span> <span class="token punctuation">}</span>
    The value of the pipeline must be an array<span class="token punctuation">,</span> slice<span class="token punctuation">,</span> <span class="token keyword">map</span><span class="token punctuation">,</span> or channel<span class="token punctuation">.</span>
    If the value of the pipeline has length zero<span class="token punctuation">,</span> nothing is output<span class="token punctuation">;</span>
    otherwise<span class="token punctuation">,</span> dot is set to the successive elements of the array<span class="token punctuation">,</span>
    slice<span class="token punctuation">,</span> or <span class="token keyword">map</span> and T1 is executed<span class="token punctuation">.</span> If the value is a <span class="token keyword">map</span> and the
    keys are of basic <span class="token keyword">type</span> with a defined order <span class="token punctuation">(</span><span class="token string">&quot;comparable&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> the
    elements will be visited in sorted key order<span class="token punctuation">.</span>

<span class="token punctuation">{</span> <span class="token punctuation">{</span><span class="token keyword">range</span> pipeline<span class="token punctuation">}</span> <span class="token punctuation">}</span> T1 <span class="token punctuation">{</span> <span class="token punctuation">{</span><span class="token keyword">else</span><span class="token punctuation">}</span> <span class="token punctuation">}</span> T0 <span class="token punctuation">{</span> <span class="token punctuation">{</span>end<span class="token punctuation">}</span> <span class="token punctuation">}</span>
    The value of the pipeline must be an array<span class="token punctuation">,</span> slice<span class="token punctuation">,</span> <span class="token keyword">map</span><span class="token punctuation">,</span> or channel<span class="token punctuation">.</span>
    If the value of the pipeline has length zero<span class="token punctuation">,</span> dot is unaffected and
    T0 is executed<span class="token punctuation">;</span> otherwise<span class="token punctuation">,</span> dot is set to the successive elements
    of the array<span class="token punctuation">,</span> slice<span class="token punctuation">,</span> or <span class="token keyword">map</span> and T1 is executed<span class="token punctuation">.</span>

<span class="token punctuation">{</span> <span class="token punctuation">{</span>block <span class="token string">&quot;name&quot;</span> pipeline<span class="token punctuation">}</span> <span class="token punctuation">}</span> T1 <span class="token punctuation">{</span> <span class="token punctuation">{</span>end<span class="token punctuation">}</span> <span class="token punctuation">}</span>
    A block is shorthand <span class="token keyword">for</span> defining a template
        <span class="token punctuation">{</span> <span class="token punctuation">{</span>define <span class="token string">&quot;name&quot;</span><span class="token punctuation">}</span> <span class="token punctuation">}</span> T1 <span class="token punctuation">{</span> <span class="token punctuation">{</span>end<span class="token punctuation">}</span> <span class="token punctuation">}</span>
    and then executing it in place
        <span class="token punctuation">{</span> <span class="token punctuation">{</span>template <span class="token string">&quot;name&quot;</span> pipeline<span class="token punctuation">}</span> <span class="token punctuation">}</span>
    The typical use is to define a set of root templates that are
    then customized by redefining the block templates within<span class="token punctuation">.</span>

<span class="token punctuation">{</span> <span class="token punctuation">{</span>with pipeline<span class="token punctuation">}</span> <span class="token punctuation">}</span> T1 <span class="token punctuation">{</span> <span class="token punctuation">{</span>end<span class="token punctuation">}</span> <span class="token punctuation">}</span>
    If the value of the pipeline is empty<span class="token punctuation">,</span> no output is generated<span class="token punctuation">;</span>
    otherwise<span class="token punctuation">,</span> dot is set to the value of the pipeline and T1 is
    executed<span class="token punctuation">.</span>

<span class="token punctuation">{</span> <span class="token punctuation">{</span>with pipeline<span class="token punctuation">}</span> <span class="token punctuation">}</span> T1 <span class="token punctuation">{</span> <span class="token punctuation">{</span><span class="token keyword">else</span><span class="token punctuation">}</span> <span class="token punctuation">}</span> T0 <span class="token punctuation">{</span> <span class="token punctuation">{</span>end<span class="token punctuation">}</span> <span class="token punctuation">}</span>
    If the value of the pipeline is empty<span class="token punctuation">,</span> dot is unaffected and T0
    is executed<span class="token punctuation">;</span> otherwise<span class="token punctuation">,</span> dot is set to the value of the pipeline
    and T1 is executed<span class="token punctuation">.</span>
</code></pre>
<p>&#x7279;&#x522B;&#x7684;, &#x6A21;&#x677F;&#x53EF;&#x4EE5;&#x5F15;&#x7528;&#x5176;&#x4ED6;&#x547D;&#x540D;&#x6A21;&#x677F;: New&#x6A21;&#x677F;&#x7684;&#x65F6;&#x5019;&#x4F1A;&#x7ED9;&#x6BCF;&#x4E2A;&#x6A21;&#x677F;&#x8D77;&#x4E2A;&#x540D;&#x5B57;, &#x7528;&#x8FD9;&#x4E2A;&#x540D;&#x5B57;&#x6765;&#x5F15;&#x7528;&#x5B83;. -- &#x5173;&#x8054;&#x6A21;&#x677F;</p>
<pre class="language-"><code class="lang-go"><span class="token punctuation">{</span> <span class="token punctuation">{</span>template <span class="token string">&quot;name&quot;</span><span class="token punctuation">}</span> <span class="token punctuation">}</span>
    The template with the specified name is executed with <span class="token boolean">nil</span> data<span class="token punctuation">.</span>

<span class="token punctuation">{</span> <span class="token punctuation">{</span>template <span class="token string">&quot;name&quot;</span> pipeline<span class="token punctuation">}</span> <span class="token punctuation">}</span>
    The template with the specified name is executed with dot set
    to the value of the pipeline<span class="token punctuation">.</span>
</code></pre>
<h3 id="arguments"><a name="arguments" class="anchor-navigation-ex-anchor" href="#arguments"><i class="fa fa-link" aria-hidden="true"></i></a>1.2.1. arguments</h3>
<p>action&#x91CC;&#x9762;&#x7684;&#x6982;&#x5FF5;: argument
&#x6A21;&#x677F;&#x652F;&#x6301;</p>
<ul>
<li>struct&#x7684;.Field&#x5F15;&#x7528;</li>
<li>map&#x7684;.Key&#x5F15;&#x7528;</li>
<li>&#x5BF9;&#x8C61;&#x7684;.Method&#x65B9;&#x6CD5;&#x5F15;&#x7528; -- &#x5373;&#x8C03;&#x7528;dot.Method()&#x51FD;&#x6570;</li>
<li>&#x4E5F;&#x53EF;&#x4EE5;&#x662F;&#x666E;&#x901A;&#x51FD;&#x6570;func</li>
</ul>
<pre class="language-"><code>- A boolean, string, character, integer, floating-point, imaginary
  or complex constant in Go syntax. These behave like Go&apos;s untyped
  constants. Note that, as in Go, whether a large integer constant
  overflows when assigned or passed to a function can depend on whether
  the host machine&apos;s ints are 32 or 64 bits.
- The keyword nil, representing an untyped Go nil.
- The character &apos;.&apos; (period):
    .
  The result is the value of dot.
- A variable name, which is a (possibly empty) alphanumeric string
  preceded by a dollar sign, such as
    $piOver2
  or
    $
  The result is the value of the variable.
  Variables are described below.
- The name of a field of the data, which must be a struct, preceded
  by a period, such as
    .Field
  The result is the value of the field. Field invocations may be
  chained:
    .Field1.Field2
  Fields can also be evaluated on variables, including chaining:
    $x.Field1.Field2
- The name of a key of the data, which must be a map, preceded
  by a period, such as
    .Key
  The result is the map element value indexed by the key.
  Key invocations may be chained and combined with fields to any
  depth:
    .Field1.Key1.Field2.Key2
  Although the key must be an alphanumeric identifier, unlike with
  field names they do not need to start with an upper case letter.
  Keys can also be evaluated on variables, including chaining:
    $x.key1.key2
- The name of a niladic method of the data, preceded by a period,
  such as
    .Method
  The result is the value of invoking the method with dot as the
  receiver, dot.Method(). Such a method must have one return value (of
  any type) or two return values, the second of which is an error.
  If it has two and the returned error is non-nil, execution terminates
  and an error is returned to the caller as the value of Execute.
  Method invocations may be chained and combined with fields and keys
  to any depth:
    .Field1.Key1.Method1.Field2.Key2.Method2
  Methods can also be evaluated on variables, including chaining:
    $x.Method1.Field
- The name of a niladic function, such as
    fun
  The result is the value of invoking the function, fun(). The return
  types and values behave as in methods. Functions and function
  names are described below.
- A parenthesized instance of one the above, for grouping. The result
  may be accessed by a field or map key invocation.
    print (.F1 arg1) (.F2 arg2)
    (.StructValuedMethod &quot;arg&quot;).Field
</code></pre><h3 id="pipelines"><a name="pipelines" class="anchor-navigation-ex-anchor" href="#pipelines"><i class="fa fa-link" aria-hidden="true"></i></a>1.2.2. Pipelines</h3>
<p>&#x987E;&#x540D;&#x601D;&#x4E49;, &#x6A21;&#x677F;&#x652F;&#x6301;pipe&#x64CD;&#x4F5C;.&#x5373;&#x591A;&#x4E2A;commands&#x53EF;&#x4EE5;&#x7528;<code>|</code>&#x8FDE;&#x63A5;, &#x6700;&#x540E;&#x547D;&#x4EE4;&#x7684;&#x503C;&#x662F;pipeline&#x7684;&#x503C;</p>
<pre class="language-"><code>Argument
    The result is the value of evaluating the argument.
.Method [Argument...]
    The method can be alone or the last element of a chain but,
    unlike methods in the middle of a chain, it can take arguments.
    The result is the value of calling the method with the
    arguments:
        dot.Method(Argument1, etc.)
functionName [Argument...]
    The result is the value of calling the function associated
    with the name:
        function(Argument1, etc.)
    Functions and function names are described below.
</code></pre><h3 id="variables"><a name="variables" class="anchor-navigation-ex-anchor" href="#variables"><i class="fa fa-link" aria-hidden="true"></i></a>1.2.3. Variables</h3>
<p>Action&#x91CC;&#x9762;&#x53EF;&#x4EE5;&#x58F0;&#x660E;&#x53D8;&#x91CF;:</p>
<pre class="language-"><code class="lang-go">#&#x7528;variable&#x6765;&#x83B7;&#x53D6;pipeline&#x7684;&#x8F93;&#x51FA;<span class="token punctuation">;</span> &#x548C;shell&#x91CC;&#x9762;&#x4E00;&#x6837;<span class="token punctuation">,</span> pipeline&#x8F93;&#x51FA;&#x5230;&#x53D8;&#x91CF;&#x91CC;<span class="token punctuation">,</span> &#x800C;&#x4E0D;&#x662F;&#x5C55;&#x5F00;
$variable <span class="token operator">:=</span> pipeline

<span class="token keyword">range</span> $index<span class="token punctuation">,</span> $element <span class="token operator">:=</span> pipeline
</code></pre>
<p>&#x7279;&#x522B;&#x7684;, <code>$</code>&#x7684;&#x9ED8;&#x8BA4;&#x503C;&#x4E3A;&#x4F20;&#x5165;Execute&#x7684;&#x503C;.
When execution begins, <code>$</code> is set to the data argument passed to Execute, that is, to the starting value of dot.</p>
<h2 id="&#x4E3E;&#x4F8B;"><a name="&#x4E3E;&#x4F8B;" class="anchor-navigation-ex-anchor" href="#&#x4E3E;&#x4F8B;"><i class="fa fa-link" aria-hidden="true"></i></a>1.3. &#x4E3E;&#x4F8B;</h2>
<p>&#x4E0B;&#x9762;&#x6240;&#x6709;&#x4F8B;&#x5B50;&#x90FD;&#x662F;&#x4E00;&#x884C;&#x7684;&#x6A21;&#x677F;, &#x5168;&#x90E8;&#x751F;&#x6210;<code>&quot;output&quot;</code>&#x8F93;&#x51FA;.</p>
<pre class="language-"><code class="lang-go"><span class="token punctuation">{</span> <span class="token punctuation">{</span><span class="token string">&quot;\&quot;output\&quot;&quot;</span><span class="token punctuation">}</span> <span class="token punctuation">}</span>
    A <span class="token builtin">string</span> constant<span class="token punctuation">.</span>
<span class="token punctuation">{</span> <span class="token punctuation">{</span>`<span class="token string">&quot;output&quot;</span>`<span class="token punctuation">}</span> <span class="token punctuation">}</span>
    A raw <span class="token builtin">string</span> constant<span class="token punctuation">.</span>
<span class="token punctuation">{</span> <span class="token punctuation">{</span>printf <span class="token string">&quot;%q&quot;</span> <span class="token string">&quot;output&quot;</span><span class="token punctuation">}</span> <span class="token punctuation">}</span>
    A function call<span class="token punctuation">.</span>
<span class="token punctuation">{</span> <span class="token punctuation">{</span><span class="token string">&quot;output&quot;</span> <span class="token operator">|</span> printf <span class="token string">&quot;%q&quot;</span><span class="token punctuation">}</span> <span class="token punctuation">}</span>
    A function call whose final argument comes from the previous
    command<span class="token punctuation">.</span>
<span class="token punctuation">{</span> <span class="token punctuation">{</span>printf <span class="token string">&quot;%q&quot;</span> <span class="token punctuation">(</span><span class="token builtin">print</span> <span class="token string">&quot;out&quot;</span> <span class="token string">&quot;put&quot;</span><span class="token punctuation">)</span><span class="token punctuation">}</span> <span class="token punctuation">}</span>
    A parenthesized argument<span class="token punctuation">.</span>
<span class="token punctuation">{</span> <span class="token punctuation">{</span><span class="token string">&quot;put&quot;</span> <span class="token operator">|</span> printf <span class="token string">&quot;%s%s&quot;</span> <span class="token string">&quot;out&quot;</span> <span class="token operator">|</span> printf <span class="token string">&quot;%q&quot;</span><span class="token punctuation">}</span> <span class="token punctuation">}</span>
    A more elaborate call<span class="token punctuation">.</span>
<span class="token punctuation">{</span> <span class="token punctuation">{</span><span class="token string">&quot;output&quot;</span> <span class="token operator">|</span> printf <span class="token string">&quot;%s&quot;</span> <span class="token operator">|</span> printf <span class="token string">&quot;%q&quot;</span><span class="token punctuation">}</span> <span class="token punctuation">}</span>
    A longer chain<span class="token punctuation">.</span>
<span class="token punctuation">{</span> <span class="token punctuation">{</span>with <span class="token string">&quot;output&quot;</span><span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">{</span> <span class="token punctuation">{</span>printf <span class="token string">&quot;%q&quot;</span> <span class="token punctuation">.</span><span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">{</span> <span class="token punctuation">{</span>end<span class="token punctuation">}</span> <span class="token punctuation">}</span>
    A with action using dot<span class="token punctuation">.</span>
<span class="token punctuation">{</span> <span class="token punctuation">{</span>with $x <span class="token operator">:=</span> <span class="token string">&quot;output&quot;</span> <span class="token operator">|</span> printf <span class="token string">&quot;%q&quot;</span><span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">{</span> <span class="token punctuation">{</span>$x<span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">{</span> <span class="token punctuation">{</span>end<span class="token punctuation">}</span> <span class="token punctuation">}</span>
    A with action that creates and uses a variable<span class="token punctuation">.</span>
<span class="token punctuation">{</span> <span class="token punctuation">{</span>with $x <span class="token operator">:=</span> <span class="token string">&quot;output&quot;</span><span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">{</span> <span class="token punctuation">{</span>printf <span class="token string">&quot;%q&quot;</span> $x<span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">{</span> <span class="token punctuation">{</span>end<span class="token punctuation">}</span> <span class="token punctuation">}</span>
    A with action that uses the variable in another action<span class="token punctuation">.</span>
<span class="token punctuation">{</span> <span class="token punctuation">{</span>with $x <span class="token operator">:=</span> <span class="token string">&quot;output&quot;</span><span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">{</span> <span class="token punctuation">{</span>$x <span class="token operator">|</span> printf <span class="token string">&quot;%q&quot;</span><span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">{</span> <span class="token punctuation">{</span>end<span class="token punctuation">}</span> <span class="token punctuation">}</span>
    The same<span class="token punctuation">,</span> but pipelined<span class="token punctuation">.</span>
</code></pre>
<h2 id="builtin&#x51FD;&#x6570;"><a name="builtin&#x51FD;&#x6570;" class="anchor-navigation-ex-anchor" href="#builtin&#x51FD;&#x6570;"><i class="fa fa-link" aria-hidden="true"></i></a>1.4. builtin&#x51FD;&#x6570;</h2>
<p>&#x6A21;&#x677F;&#x63D0;&#x4F9B;&#x4E86;&#x4E00;&#x4E9B;&#x9884;&#x5B9A;&#x4E49;&#x7684;&#x51FD;&#x6570;:</p>
<pre class="language-"><code>and
    Returns the boolean AND of its arguments by returning the
    first empty argument or the last argument, that is,
    &quot;and x y&quot; behaves as &quot;if x then y else x&quot;. All the
    arguments are evaluated.
call
    Returns the result of calling the first argument, which
    must be a function, with the remaining arguments as parameters.
    Thus &quot;call .X.Y 1 2&quot; is, in Go notation, dot.X.Y(1, 2) where
    Y is a func-valued field, map entry, or the like.
    The first argument must be the result of an evaluation
    that yields a value of function type (as distinct from
    a predefined function such as print). The function must
    return either one or two result values, the second of which
    is of type error. If the arguments don&apos;t match the function
    or the returned error value is non-nil, execution stops.
html
    Returns the escaped HTML equivalent of the textual
    representation of its arguments. This function is unavailable
    in html/template, with a few exceptions.
index
    Returns the result of indexing its first argument by the
    following arguments. Thus &quot;index x 1 2 3&quot; is, in Go syntax,
    x[1][2][3]. Each indexed item must be a map, slice, or array.
slice
    slice returns the result of slicing its first argument by the
    remaining arguments. Thus &quot;slice x 1 2&quot; is, in Go syntax, x[1:2],
    while &quot;slice x&quot; is x[:], &quot;slice x 1&quot; is x[1:], and &quot;slice x 1 2 3&quot;
    is x[1:2:3]. The first argument must be a string, slice, or array.
js
    Returns the escaped JavaScript equivalent of the textual
    representation of its arguments.
len
    Returns the integer length of its argument.
not
    Returns the boolean negation of its single argument.
or
    Returns the boolean OR of its arguments by returning the
    first non-empty argument or the last argument, that is,
    &quot;or x y&quot; behaves as &quot;if x then x else y&quot;. All the
    arguments are evaluated.
print
    An alias for fmt.Sprint
printf
    An alias for fmt.Sprintf
println
    An alias for fmt.Sprintln
urlquery
    Returns the escaped value of the textual representation of
    its arguments in a form suitable for embedding in a URL query.
    This function is unavailable in html/template, with a few
    exceptions.

eq
    Returns the boolean truth of arg1 == arg2
ne
    Returns the boolean truth of arg1 != arg2
lt
    Returns the boolean truth of arg1 &lt; arg2
le
    Returns the boolean truth of arg1 &lt;= arg2
gt
    Returns the boolean truth of arg1 &gt; arg2
ge
    Returns the boolean truth of arg1 &gt;= arg2
</code></pre><p>bool&#x503C;&#x662F;&#x4EFB;&#x4F55;&#x7C7B;&#x578B;&#x7684;0&#x503C;.</p>
<p>&#x8C03;&#x7528;&#x51FD;&#x6570;&#x4E0D;&#x7528;&#x52A0;&#x62EC;&#x53F7;, &#x4E3E;&#x4F8B;:</p>
<pre class="language-"><code>{ {printf &quot;%q&quot; &quot;output&quot;} }
    A function call.
{ {printf &quot;%q&quot; (print &quot;out&quot; &quot;put&quot;)} }
    A parenthesized argument.
</code></pre><h1 id="rand"><a name="rand" class="anchor-navigation-ex-anchor" href="#rand"><i class="fa fa-link" aria-hidden="true"></i></a>2. rand</h1>
<pre class="language-"><code class="lang-go"><span class="token keyword">import</span> <span class="token string">&quot;math/rand&quot;</span>
<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    rand<span class="token punctuation">.</span><span class="token function">Seed</span><span class="token punctuation">(</span>time<span class="token punctuation">.</span><span class="token function">Now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">UnixNano</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    min <span class="token operator">:=</span> <span class="token number">10</span>
    max <span class="token operator">:=</span> <span class="token number">30</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>rand<span class="token punctuation">.</span><span class="token function">Intn</span><span class="token punctuation">(</span>max <span class="token operator">-</span> min <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> min<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre>
<h1 id="unsafe"><a name="unsafe" class="anchor-navigation-ex-anchor" href="#unsafe"><i class="fa fa-link" aria-hidden="true"></i></a>3. unsafe</h1>
<p>&#x5982;&#x5305;&#x540D;&#x6240;&#x6307;, unsafe&#x4E0D;&#x600E;&#x4E48;safe, &#x4F46;&#x5B83;&#x63D0;&#x4F9B;&#x4E86;&#x66F4;&#x5E95;&#x5C42;&#x7684;&#x64CD;&#x4F5C;&#x80FD;&#x529B;
&#x6BD4;&#x5982;timer&#x7684;&#x5B9E;&#x73B0;&#x91CC;, &#x8C03;&#x7528;&#x4E86;unsafe.Sizeof&#x83B7;&#x53D6;&#x4E00;&#x4E2A;&#x7ED3;&#x6784;&#x4F53;&#x7684;&#x5927;&#x5C0F;.</p>
<pre class="language-"><code class="lang-go"><span class="token comment">//&#x8FD4;&#x56DE;&#x4EFB;&#x610F;&#x7C7B;&#x578B;&#x7684;x&#x7684;&#x5B57;&#x8282;&#x5BF9;&#x9F50;&#x8981;&#x6C42;</span>
<span class="token keyword">func</span> <span class="token function">Alignof</span><span class="token punctuation">(</span>x ArbitraryType<span class="token punctuation">)</span> <span class="token builtin">uintptr</span>

<span class="token comment">//&#x8FD4;&#x56DE;x&#x5728;&#x7ED3;&#x6784;&#x4F53;&#x91CC;&#x7684;offset&#x5E38;&#x91CF;, x&#x5FC5;&#x987B;&#x662F;structValue.field&#x683C;&#x5F0F;</span>
<span class="token keyword">func</span> <span class="token function">Offsetof</span><span class="token punctuation">(</span>x ArbitraryType<span class="token punctuation">)</span> <span class="token builtin">uintptr</span>
<span class="token comment">//&#x6BD4;&#x5982;</span>
dataOffset <span class="token operator">=</span> unsafe<span class="token punctuation">.</span><span class="token function">Offsetof</span><span class="token punctuation">(</span><span class="token keyword">struct</span> <span class="token punctuation">{</span>
        b bmap
        v <span class="token builtin">int64</span>
    <span class="token punctuation">}</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">.</span>v<span class="token punctuation">)</span>

<span class="token comment">//&#x8FD4;&#x56DE;&#x7C7B;&#x578B;&#x7684;&#x5B57;&#x8282;&#x6570;&#x5E38;&#x91CF;</span>
<span class="token keyword">func</span> <span class="token function">Sizeof</span><span class="token punctuation">(</span>x ArbitraryType<span class="token punctuation">)</span> <span class="token builtin">uintptr</span>
</code></pre>
<h2 id="unsafepointer&#x7C7B;&#x578B;"><a name="unsafepointer&#x7C7B;&#x578B;" class="anchor-navigation-ex-anchor" href="#unsafepointer&#x7C7B;&#x578B;"><i class="fa fa-link" aria-hidden="true"></i></a>3.1. unsafe.Pointer&#x7C7B;&#x578B;</h2>
<p>unsafe.Pointer uintptr &#x548C;&#x4EFB;&#x610F;&#x7C7B;&#x578B;&#x7684;&#x6307;&#x9488;&#x90FD;&#x53EF;&#x4EE5;&#x4E92;&#x76F8;&#x8F6C;&#x6362;.
&#x7528;&#x4E86;Pointer&#x7C7B;&#x578B;, &#x53EF;&#x4EE5;&#x7ED5;&#x8FC7;&#x7C7B;&#x578B;&#x7CFB;&#x7EDF;, &#x76F4;&#x63A5;&#x8BFB;&#x5199;&#x4EFB;&#x610F;&#x5185;&#x5B58;.
&#x7528;Pointer&#x53EF;&#x4EE5;&#x5B9E;&#x73B0;C&#x7684;&#x7C7B;&#x578B;&#x5F3A;&#x8F6C;
&#x51E0;&#x4E2A;&#x4F8B;&#x5B50;:</p>
<h3 id="float64&#x8F6C;uint64"><a name="float64&#x8F6C;uint64" class="anchor-navigation-ex-anchor" href="#float64&#x8F6C;uint64"><i class="fa fa-link" aria-hidden="true"></i></a>3.1.1. float64&#x8F6C;uint64</h3>
<pre class="language-"><code class="lang-go"><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
    <span class="token string">&quot;fmt&quot;</span>
    <span class="token string">&quot;unsafe&quot;</span>
<span class="token punctuation">)</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> v <span class="token builtin">float64</span> <span class="token operator">=</span> <span class="token number">1.1</span>
    <span class="token comment">//&#x7C7B;&#x578B;&#x5F3A;&#x8F6C;</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token function">uint64</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token comment">//&#x901A;&#x8FC7;&#x6307;&#x9488;&#x5F3A;&#x8F6C;, &#x7ED3;&#x679C;&#x662F;&#x4E0D;&#x4E00;&#x6837;&#x7684;.</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token builtin">uint64</span><span class="token punctuation">)</span><span class="token punctuation">(</span>unsafe<span class="token punctuation">.</span><span class="token function">Pointer</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>v<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">//&#x7ED3;&#x679C;</span>
<span class="token number">1</span>
<span class="token number">4607632778762754458</span>
</code></pre>
<h1 id="strconv"><a name="strconv" class="anchor-navigation-ex-anchor" href="#strconv"><i class="fa fa-link" aria-hidden="true"></i></a>4. strconv</h1>
<p>&#x63D0;&#x4F9B;&#x5B57;&#x7B26;&#x4E32;&#x5230;&#x5176;&#x4ED6;&#x57FA;&#x672C;&#x7C7B;&#x578B;&#x7684;&#x8F6C;&#x6362;
&#x6BD4;&#x5982;Atoi, Itoa</p>
<h1 id="sync"><a name="sync" class="anchor-navigation-ex-anchor" href="#sync"><i class="fa fa-link" aria-hidden="true"></i></a>5. sync</h1>
<p>&#x4E00;&#x822C;&#x7684;&#x540C;&#x6B65;&#x7528;channel&#x5C31;&#x597D;. 
sync&#x5305;&#x540C;&#x65F6;&#x4E5F;&#x63D0;&#x4F9B;&#x4E86;&#x66F4;&#x5E95;&#x5C42;&#x7684;&#x540C;&#x6B65;&#x65B9;&#x6CD5;.
Once&#x548C;WaitGroup&#x7C7B;&#x578B;&#x5E94;&#x8BE5;&#x662F;&#x7528;&#x7684;&#x6BD4;&#x8F83;&#x591A;&#x7684;.
&#x6CE8;&#x610F;, &#x5305;&#x542B;&#x8FD9;&#x4E2A;&#x5305;&#x91CC;&#x5B9A;&#x4E49;&#x7684;&#x7C7B;&#x578B;&#x7684;&#x6570;&#x636E;&#x4E0D;&#x80FD;&#x62F7;&#x8D1D;.</p>
<h2 id="cond"><a name="cond" class="anchor-navigation-ex-anchor" href="#cond"><i class="fa fa-link" aria-hidden="true"></i></a>5.1. Cond</h2>
<p>Cond&#x662F;&#x7528;&#x6765;&#x4FDD;&#x62A4;&#x5E76;&#x53D1;&#x6761;&#x4EF6;&#x4E0B;&#x7684;&#x6761;&#x4EF6;&#x53D8;&#x91CF;x&#x7684;. &#x4F7F;&#x7528;&#x65F6;&#x5019;&#x9700;&#x8981;</p>
<ul>
<li>&#x53D8;&#x91CF;x&#x6765;&#x8868;&#x793A;&#x4E1A;&#x52A1;&#x6761;&#x4EF6;</li>
<li>mutex&#x4FDD;&#x62A4;&#x8FD9;&#x4E2A;&#x53D8;&#x91CF;&#x7684;&#x4FEE;&#x6539;. &#x5E76;&#x4E0D;&#x662F;&#x7528;&#x6765;&#x4F11;&#x7720;&#x7684;</li>
<li>&#x524D;&#x9762;&#x4E24;&#x4E2A;&#x662F;&#x7A0B;&#x5E8F;&#x5DF2;&#x7ECF;&#x6709;&#x4E86;&#x7684;. &#x90A3;&#x4E48;&#x7528;Cond&#x7684;&#x76EE;&#x7684;&#x662F;&#x7528;&#x6765;&#x7B49;&#x5F85;&#x548C;&#x901A;&#x77E5;&#x7684;. &#x6BD4;&#x5982;&#x7A0B;&#x5E8F;&#x8981;&#x7B49;&#x5F85;x&#x53D8;&#x6210;&#x6BD4;&#x5982;&#x8BF4;100, &#x5C31;&#x7528;cond.wait; &#x5230;&#x8FBE;&#x6761;&#x4EF6;&#x7684;routine&#x8D1F;&#x8D23;&#x901A;&#x77E5;&#x6216;&#x8005;&#x5E7F;&#x64AD;&#x7B49;&#x5F85;&#x8005;.</li>
</ul>
<p><strong>&#x8BBE;&#x8BA1;&#x601D;&#x8DEF;&#x548C;pthread_cond&#x4E00;&#x6BDB;&#x4E00;&#x6837;</strong> &#x53E6;&#x89C1;<code>&#x5E76;&#x53D1; &#x4EFB;&#x52A1; &#x4E8B;&#x4EF6; &#x548C;&#x9501;.md</code></p>
<pre class="language-"><code class="lang-go"><span class="token keyword">type</span> Cond <span class="token keyword">struct</span> <span class="token punctuation">{</span>

    <span class="token comment">// L is held while observing or changing the condition</span>
    L Locker
    <span class="token comment">// contains filtered or unexported fields</span>
<span class="token punctuation">}</span>
<span class="token comment">// &#x5176;&#x4E2D;, Locker&#x662F;&#x4E2A;&#x63A5;&#x53E3;</span>
<span class="token keyword">type</span> Locker <span class="token keyword">interface</span> <span class="token punctuation">{</span>
    <span class="token function">Lock</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token function">Unlock</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">//&#x8FD4;&#x56DE;&#x4E00;&#x4E2A;Cond&#x7ED3;&#x6784;&#x7684;&#x53D8;&#x91CF;, &#x9700;&#x8981;&#x4F20;&#x5165;&#x4E00;&#x4E2A;Locker</span>
<span class="token keyword">func</span> <span class="token function">NewCond</span><span class="token punctuation">(</span>l Locker<span class="token punctuation">)</span> <span class="token operator">*</span>Cond

<span class="token comment">//&#x5524;&#x9192;&#x6240;&#x6709;&#x7B49;&#x5728;&#x8FD9;&#x4E2A;Cond&#x4E0A;&#x7684;routine, &#x4E0D;&#x9700;&#x8981;&#x6301;&#x6709;&#x9501;</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>c <span class="token operator">*</span>Cond<span class="token punctuation">)</span> <span class="token function">Broadcast</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">//&#x5524;&#x9192;&#x5728;c&#x4E0A;&#x7B49;&#x5F85;&#x7684;&#x4E00;&#x4E2A;go routine, &#x4E0D;&#x9700;&#x8981;&#x6301;&#x6709;&#x9501;</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>c <span class="token operator">*</span>Cond<span class="token punctuation">)</span> <span class="token function">Signal</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">//&#x8C03;&#x7528;Wait&#x65F6;, Wait&#x81EA;&#x52A8;unlock c.L, &#x7136;&#x540E;&#x6302;&#x8D77;&#x8BE5;go routine</span>
<span class="token comment">//&#x6062;&#x590D;&#x7684;&#x65F6;&#x5019;, Wait&#x81EA;&#x52A8;lock c.L, &#x7136;&#x540E;return</span>
<span class="token comment">//&#x9664;&#x975E;Broadcast&#x6216;&#x8005;Signal, Wait&#x4E0D;&#x4F1A;&#x8FD4;&#x56DE;</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>c <span class="token operator">*</span>Cond<span class="token punctuation">)</span> <span class="token function">Wait</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre>
<blockquote>
<p>&#x6CA1;&#x770B;&#x61C2;: Because c.L is not locked when Wait first resumes, the caller typically cannot assume that the condition is true when Wait returns. Instead, the caller should Wait in a loop:</p>
<pre class="language-"><code class="lang-go">c<span class="token punctuation">.</span>L<span class="token punctuation">.</span><span class="token function">Lock</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> <span class="token operator">!</span><span class="token function">condition</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    c<span class="token punctuation">.</span><span class="token function">Wait</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token operator">...</span> <span class="token builtin">make</span> use of condition <span class="token operator">...</span>
c<span class="token punctuation">.</span>L<span class="token punctuation">.</span><span class="token function">Unlock</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre>
</blockquote>
<h2 id="map"><a name="map" class="anchor-navigation-ex-anchor" href="#map"><i class="fa fa-link" aria-hidden="true"></i></a>5.2. Map</h2>
<p>&#x5185;&#x7F6E;&#x7684;&#x5E26;&#x9501;&#x4FDD;&#x62A4;&#x7684;map. 
&#x666E;&#x901A;&#x7684;map&#x4E0D;&#x662F;&#x5E76;&#x53D1;&#x5B89;&#x5168;&#x7684;, &#x9700;&#x8981;&#x81EA;&#x5DF1;&#x4FDD;&#x62A4;&#x4E34;&#x754C;&#x533A;.</p>
<pre class="language-"><code class="lang-go"><span class="token keyword">type</span> Map <span class="token keyword">struct</span> <span class="token punctuation">{</span>
    <span class="token comment">// contains filtered or unexported fields</span>
<span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>m <span class="token operator">*</span>Map<span class="token punctuation">)</span> <span class="token function">Delete</span><span class="token punctuation">(</span>key <span class="token keyword">interface</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>m <span class="token operator">*</span>Map<span class="token punctuation">)</span> <span class="token function">Load</span><span class="token punctuation">(</span>key <span class="token keyword">interface</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>value <span class="token keyword">interface</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> ok <span class="token builtin">bool</span><span class="token punctuation">)</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>m <span class="token operator">*</span>Map<span class="token punctuation">)</span> <span class="token function">LoadOrStore</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> value <span class="token keyword">interface</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>actual <span class="token keyword">interface</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> loaded <span class="token builtin">bool</span><span class="token punctuation">)</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>m <span class="token operator">*</span>Map<span class="token punctuation">)</span> <span class="token function">Range</span><span class="token punctuation">(</span>f <span class="token keyword">func</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> value <span class="token keyword">interface</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token builtin">bool</span><span class="token punctuation">)</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>m <span class="token operator">*</span>Map<span class="token punctuation">)</span> <span class="token function">Store</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> value <span class="token keyword">interface</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre>
<h2 id="mutex"><a name="mutex" class="anchor-navigation-ex-anchor" href="#mutex"><i class="fa fa-link" aria-hidden="true"></i></a>5.3. Mutex</h2>
<p>&#x521D;&#x59CB;&#x72B6;&#x6001;&#x65F6;unlock&#x6001;</p>
<pre class="language-"><code class="lang-go"><span class="token keyword">type</span> Mutex <span class="token keyword">struct</span> <span class="token punctuation">{</span>
    <span class="token comment">// contains filtered or unexported fields</span>
<span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>m <span class="token operator">*</span>Mutex<span class="token punctuation">)</span> <span class="token function">Lock</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>m <span class="token operator">*</span>Mutex<span class="token punctuation">)</span> <span class="token function">Unlock</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre>
<h2 id="rwmutex"><a name="rwmutex" class="anchor-navigation-ex-anchor" href="#rwmutex"><i class="fa fa-link" aria-hidden="true"></i></a>5.4. RWMutex</h2>
<pre class="language-"><code class="lang-go"><span class="token keyword">type</span> RWMutex <span class="token keyword">struct</span> <span class="token punctuation">{</span>
    <span class="token comment">// contains filtered or unexported fields</span>
<span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>rw <span class="token operator">*</span>RWMutex<span class="token punctuation">)</span> <span class="token function">Lock</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>rw <span class="token operator">*</span>RWMutex<span class="token punctuation">)</span> <span class="token function">RLock</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>rw <span class="token operator">*</span>RWMutex<span class="token punctuation">)</span> <span class="token function">RLocker</span><span class="token punctuation">(</span><span class="token punctuation">)</span> Locker
<span class="token keyword">func</span> <span class="token punctuation">(</span>rw <span class="token operator">*</span>RWMutex<span class="token punctuation">)</span> <span class="token function">RUnlock</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>rw <span class="token operator">*</span>RWMutex<span class="token punctuation">)</span> <span class="token function">Unlock</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre>
<h2 id="once"><a name="once" class="anchor-navigation-ex-anchor" href="#once"><i class="fa fa-link" aria-hidden="true"></i></a>5.5. Once</h2>
<p>Once&#x53EA;&#x6267;&#x884C;&#x4E00;&#x6B21;</p>
<pre class="language-"><code class="lang-go"><span class="token keyword">type</span> Once <span class="token keyword">struct</span> <span class="token punctuation">{</span>
    <span class="token comment">// contains filtered or unexported fields</span>
<span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>o <span class="token operator">*</span>Once<span class="token punctuation">)</span> <span class="token function">Do</span><span class="token punctuation">(</span>f <span class="token keyword">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment">//&#x56E0;&#x4E3A;f&#x6CA1;&#x6709;&#x53C2;&#x6570;, &#x4E0B;&#x9762;&#x7684;&#x5F62;&#x5F0F;&#x66F4;&#x5E38;&#x89C1;</span>
config<span class="token punctuation">.</span>once<span class="token punctuation">.</span><span class="token function">Do</span><span class="token punctuation">(</span><span class="token keyword">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> config<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span>filename<span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre>
<h2 id="pool"><a name="pool" class="anchor-navigation-ex-anchor" href="#pool"><i class="fa fa-link" aria-hidden="true"></i></a>5.6. Pool</h2>
<p>Pool&#x662F;&#x4E2A;cache, &#x662F;&#x4E2A;&#x5E76;&#x53D1;&#x5B89;&#x5168;&#x7684;free list. &#x88AB;put&#x8FDB;pool&#x7684;&#x5BF9;&#x8C61;&#x53EF;&#x80FD;&#x6CA1;&#x6709;&#x4EFB;&#x4F55;&#x901A;&#x77E5;&#x7684;&#x88AB;&#x79FB;&#x9664;.</p>
<pre class="language-"><code class="lang-go"><span class="token keyword">type</span> Pool <span class="token keyword">struct</span> <span class="token punctuation">{</span>

    <span class="token comment">// New optionally specifies a function to generate</span>
    <span class="token comment">// a value when Get would otherwise return nil.</span>
    <span class="token comment">// It may not be changed concurrently with calls to Get.</span>
    New <span class="token keyword">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">interface</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token comment">// contains filtered or unexported fields</span>
<span class="token punctuation">}</span>

<span class="token comment">//&#x968F;&#x673A;&#x4ECE;pool&#x91CC;&#x9009;&#x4E00;&#x4E2A;&#x5BF9;&#x8C61;, &#x5E76;&#x628A;&#x8BE5;&#x5BF9;&#x8C61;&#x4ECE;pool&#x91CC;&#x79FB;&#x9664;. &#x4E0D;&#x4FDD;&#x8BC1;&#x88AB;put&#x8FC7;&#x7684;&#x5BF9;&#x8C61;&#x80FD;&#x591F;&#x88AB;get</span>
<span class="token comment">//&#x6CA1;&#x6709;&#x5BF9;&#x8C61;&#x7684;&#x65F6;&#x5019;, &#x4F1A;&#x8C03;&#x7528;p.New&#x65B9;&#x6CD5;.</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>p <span class="token operator">*</span>Pool<span class="token punctuation">)</span> <span class="token function">Get</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">interface</span><span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token comment">//add&#x5BF9;&#x8C61;&#x5230;pool</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>p <span class="token operator">*</span>Pool<span class="token punctuation">)</span> <span class="token function">Put</span><span class="token punctuation">(</span>x <span class="token keyword">interface</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre>
<h2 id="&#x91CD;&#x70B9;waitgroup"><a name="&#x91CD;&#x70B9;waitgroup" class="anchor-navigation-ex-anchor" href="#&#x91CD;&#x70B9;waitgroup"><i class="fa fa-link" aria-hidden="true"></i></a>5.7. &#x91CD;&#x70B9;WaitGroup</h2>
<p>&#x7ED9;main routine&#x6765;&#x7B49;&#x5F85;&#x6240;&#x6709;&#x5176;&#x4ED6;go routine&#x7ED3;&#x675F;&#x7528;&#x7684;.
&#x548C;shell&#x7684;wait&#x5DEE;&#x4E0D;&#x591A;</p>
<pre class="language-"><code class="lang-go"><span class="token keyword">type</span> WaitGroup <span class="token keyword">struct</span> <span class="token punctuation">{</span>
    <span class="token comment">// contains filtered or unexported fields</span>
<span class="token punctuation">}</span>
<span class="token comment">//&#x7ED9;counter&#x52A0;delta, delta&#x53EF;&#x4EE5;&#x662F;&#x8D1F;&#x503C;.</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>wg <span class="token operator">*</span>WaitGroup<span class="token punctuation">)</span> <span class="token function">Add</span><span class="token punctuation">(</span>delta <span class="token builtin">int</span><span class="token punctuation">)</span>
<span class="token comment">//&#x5B50;routine&#x8C03;&#x7528;done&#x8868;&#x793A;&#x81EA;&#x5DF1;&#x5E72;&#x5B8C;&#x4E86;, counter&#x51CF;&#x4E00;</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>wg <span class="token operator">*</span>WaitGroup<span class="token punctuation">)</span> <span class="token function">Done</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">//main routine&#x8C03;&#x7528;Wait&#x7B49;&#x5F85;&#x91CC;&#x9762;&#x7684;counter&#x51CF;&#x5230;0</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>wg <span class="token operator">*</span>WaitGroup<span class="token punctuation">)</span> <span class="token function">Wait</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre>
<p>&#x4F8B;&#x5B50;:</p>
<pre class="language-"><code class="lang-go"><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
    <span class="token string">&quot;sync&quot;</span>
<span class="token punctuation">)</span>

<span class="token keyword">type</span> httpPkg <span class="token keyword">struct</span><span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>httpPkg<span class="token punctuation">)</span> <span class="token function">Get</span><span class="token punctuation">(</span>url <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token keyword">var</span> http httpPkg

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> wg sync<span class="token punctuation">.</span>WaitGroup
    <span class="token keyword">var</span> urls <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">{</span>
        <span class="token string">&quot;http://www.golang.org/&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;http://www.google.com/&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;http://www.somestupidname.com/&quot;</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">for</span> <span class="token boolean">_</span><span class="token punctuation">,</span> url <span class="token operator">:=</span> <span class="token keyword">range</span> urls <span class="token punctuation">{</span>
        <span class="token comment">// Increment the WaitGroup counter.</span>
        wg<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
        <span class="token comment">// Launch a goroutine to fetch the URL.</span>
        <span class="token keyword">go</span> <span class="token keyword">func</span><span class="token punctuation">(</span>url <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// Decrement the counter when the goroutine completes.</span>
            <span class="token keyword">defer</span> wg<span class="token punctuation">.</span><span class="token function">Done</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token comment">// Fetch the URL.</span>
            http<span class="token punctuation">.</span><span class="token function">Get</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// Wait for all HTTP fetches to complete.</span>
    wg<span class="token punctuation">.</span><span class="token function">Wait</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre>
<h1 id="net"><a name="net" class="anchor-navigation-ex-anchor" href="#net"><i class="fa fa-link" aria-hidden="true"></i></a>6. net</h1>
<p>net&#x63D0;&#x4F9B;tcp/ip&#x548C;unix socket&#x63A5;&#x53E3;
net&#x63D0;&#x4F9B;&#x4E86;&#x539F;&#x59CB;&#x7684;socket&#x63A5;&#x53E3;, &#x4E5F;&#x63D0;&#x4F9B;&#x4E86;&#x4E00;&#x5C42;&#x66F4;&#x7B80;&#x4FBF;&#x7684;&#x63A5;&#x53E3;. 
&#x5BF9;client&#x6765;&#x8BF4;, &#x662F;Dial</p>
<pre class="language-"><code class="lang-go">conn<span class="token punctuation">,</span> err <span class="token operator">:=</span> net<span class="token punctuation">.</span><span class="token function">Dial</span><span class="token punctuation">(</span><span class="token string">&quot;tcp&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;golang.org:80&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
    <span class="token comment">// handle error</span>
<span class="token punctuation">}</span>
fmt<span class="token punctuation">.</span><span class="token function">Fprintf</span><span class="token punctuation">(</span>conn<span class="token punctuation">,</span> <span class="token string">&quot;GET / HTTP/1.0\r\n\r\n&quot;</span><span class="token punctuation">)</span>
status<span class="token punctuation">,</span> err <span class="token operator">:=</span> bufio<span class="token punctuation">.</span><span class="token function">NewReader</span><span class="token punctuation">(</span>conn<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ReadString</span><span class="token punctuation">(</span><span class="token char">&apos;\n&apos;</span><span class="token punctuation">)</span>
<span class="token comment">// ...</span>
</code></pre>
<p>&#x5BF9;server&#x6765;&#x8BF4;, &#x662F;Listen</p>
<pre class="language-"><code class="lang-go">ln<span class="token punctuation">,</span> err <span class="token operator">:=</span> net<span class="token punctuation">.</span><span class="token function">Listen</span><span class="token punctuation">(</span><span class="token string">&quot;tcp&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;:8080&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
    <span class="token comment">// handle error</span>
<span class="token punctuation">}</span>
<span class="token keyword">for</span> <span class="token punctuation">{</span>
    conn<span class="token punctuation">,</span> err <span class="token operator">:=</span> ln<span class="token punctuation">.</span><span class="token function">Accept</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
        <span class="token comment">// handle error</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">go</span> <span class="token function">handleConnection</span><span class="token punctuation">(</span>conn<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre>
<h2 id="&#x540D;&#x5B57;&#x89E3;&#x6790;"><a name="&#x540D;&#x5B57;&#x89E3;&#x6790;" class="anchor-navigation-ex-anchor" href="#&#x540D;&#x5B57;&#x89E3;&#x6790;"><i class="fa fa-link" aria-hidden="true"></i></a>6.1. &#x540D;&#x5B57;&#x89E3;&#x6790;</h2>
<p>&#x540D;&#x5B57;&#x89E3;&#x6790;&#x6709;&#x4E24;&#x4E2A;&#x65B9;&#x5F0F;: &#x7EAF;go&#x65B9;&#x5F0F;&#x548C;cgo&#x65B9;&#x5F0F;
&#x9ED8;&#x8BA4;&#x662F;&#x7EAF;go. &#x4F7F;&#x80FD;&#x4E86;cgo&#x5C31;&#x4F1A;&#x7528;cgo. 
&#x73AF;&#x5883;&#x53D8;&#x91CF;&#x53EF;&#x4EE5;&#x9009;&#x62E9;&#x7528;&#x54EA;&#x79CD;&#x65B9;&#x5F0F;:</p>
<pre class="language-"><code class="lang-sh"><span class="token builtin class-name">export</span> <span class="token assign-left variable">GODEBUG</span><span class="token operator">=</span>netdns<span class="token operator">=</span>go <span class="token comment"># force pure Go resolver</span>
<span class="token builtin class-name">export</span> <span class="token assign-left variable">GODEBUG</span><span class="token operator">=</span>netdns<span class="token operator">=</span>cgo <span class="token comment"># force cgo resolver</span>
</code></pre>
<h2 id="api"><a name="api" class="anchor-navigation-ex-anchor" href="#api"><i class="fa fa-link" aria-hidden="true"></i></a>6.2. api</h2>
<pre class="language-"><code class="lang-go"><span class="token keyword">type</span> Buffers
    <span class="token keyword">func</span> <span class="token punctuation">(</span>v <span class="token operator">*</span>Buffers<span class="token punctuation">)</span> <span class="token function">Read</span><span class="token punctuation">(</span>p <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">byte</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>n <span class="token builtin">int</span><span class="token punctuation">,</span> err <span class="token builtin">error</span><span class="token punctuation">)</span>
    <span class="token keyword">func</span> <span class="token punctuation">(</span>v <span class="token operator">*</span>Buffers<span class="token punctuation">)</span> <span class="token function">WriteTo</span><span class="token punctuation">(</span>w io<span class="token punctuation">.</span>Writer<span class="token punctuation">)</span> <span class="token punctuation">(</span>n <span class="token builtin">int64</span><span class="token punctuation">,</span> err <span class="token builtin">error</span><span class="token punctuation">)</span>

<span class="token comment">//Conn&#x662F;&#x4E2A;interface, &#x9762;&#x5411;&#x6D41;&#x7684;. &#x6709;Read&#x548C;Write&#x65B9;&#x6CD5;. Conn&#x5BF9;&#x591A;&#x4E2A;goroutine&#x5E76;&#x53D1;&#x5B89;&#x5168;</span>
<span class="token keyword">type</span> Conn
    <span class="token keyword">func</span> <span class="token function">Dial</span><span class="token punctuation">(</span>network<span class="token punctuation">,</span> address <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>Conn<span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span>
    <span class="token keyword">func</span> <span class="token function">DialTimeout</span><span class="token punctuation">(</span>network<span class="token punctuation">,</span> address <span class="token builtin">string</span><span class="token punctuation">,</span> timeout time<span class="token punctuation">.</span>Duration<span class="token punctuation">)</span> <span class="token punctuation">(</span>Conn<span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span>

<span class="token comment">//Listener&#x662F;&#x4E2A;&#x63A5;&#x53E3;</span>
<span class="token keyword">type</span> Listener
    <span class="token keyword">func</span> <span class="token function">FileListener</span><span class="token punctuation">(</span>f <span class="token operator">*</span>os<span class="token punctuation">.</span>File<span class="token punctuation">)</span> <span class="token punctuation">(</span>ln Listener<span class="token punctuation">,</span> err <span class="token builtin">error</span><span class="token punctuation">)</span>
    <span class="token keyword">func</span> <span class="token function">Listen</span><span class="token punctuation">(</span>network<span class="token punctuation">,</span> address <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>Listener<span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span>

<span class="token comment">//PacketConn&#x662F;&#x4E2A;&#x63A5;&#x53E3;, &#x9762;&#x5411;datagram&#x7684;, &#x6709;ReadFrom&#x548C;WriteTo&#x65B9;&#x6CD5;.</span>
<span class="token keyword">type</span> PacketConn
    <span class="token keyword">func</span> <span class="token function">FilePacketConn</span><span class="token punctuation">(</span>f <span class="token operator">*</span>os<span class="token punctuation">.</span>File<span class="token punctuation">)</span> <span class="token punctuation">(</span>c PacketConn<span class="token punctuation">,</span> err <span class="token builtin">error</span><span class="token punctuation">)</span>
    <span class="token keyword">func</span> <span class="token function">ListenPacket</span><span class="token punctuation">(</span>network<span class="token punctuation">,</span> address <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>PacketConn<span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span>

<span class="token comment">//IPConn is the implementation of the Conn and PacketConn interfaces for IP network connections.</span>
<span class="token comment">//IPConn&#x662F;Conn&#x7684;&#x4E00;&#x79CD;&#x5B9E;&#x73B0;</span>
<span class="token keyword">type</span> IPConn
    <span class="token keyword">func</span> <span class="token function">DialIP</span><span class="token punctuation">(</span>network <span class="token builtin">string</span><span class="token punctuation">,</span> laddr<span class="token punctuation">,</span> raddr <span class="token operator">*</span>IPAddr<span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token operator">*</span>IPConn<span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span>
    <span class="token keyword">func</span> <span class="token function">ListenIP</span><span class="token punctuation">(</span>network <span class="token builtin">string</span><span class="token punctuation">,</span> laddr <span class="token operator">*</span>IPAddr<span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token operator">*</span>IPConn<span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span>
    <span class="token keyword">func</span> <span class="token punctuation">(</span>c <span class="token operator">*</span>IPConn<span class="token punctuation">)</span> <span class="token function">Close</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token builtin">error</span>
    <span class="token keyword">func</span> <span class="token punctuation">(</span>c <span class="token operator">*</span>IPConn<span class="token punctuation">)</span> <span class="token function">File</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>f <span class="token operator">*</span>os<span class="token punctuation">.</span>File<span class="token punctuation">,</span> err <span class="token builtin">error</span><span class="token punctuation">)</span>
    <span class="token keyword">func</span> <span class="token punctuation">(</span>c <span class="token operator">*</span>IPConn<span class="token punctuation">)</span> <span class="token function">LocalAddr</span><span class="token punctuation">(</span><span class="token punctuation">)</span> Addr
    <span class="token keyword">func</span> <span class="token punctuation">(</span>c <span class="token operator">*</span>IPConn<span class="token punctuation">)</span> <span class="token function">Read</span><span class="token punctuation">(</span>b <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">byte</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span>
    <span class="token keyword">func</span> <span class="token punctuation">(</span>c <span class="token operator">*</span>IPConn<span class="token punctuation">)</span> <span class="token function">ReadFrom</span><span class="token punctuation">(</span>b <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">byte</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">,</span> Addr<span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span>
    <span class="token keyword">func</span> <span class="token punctuation">(</span>c <span class="token operator">*</span>IPConn<span class="token punctuation">)</span> <span class="token function">ReadFromIP</span><span class="token punctuation">(</span>b <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">byte</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">,</span> <span class="token operator">*</span>IPAddr<span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span>
    <span class="token keyword">func</span> <span class="token punctuation">(</span>c <span class="token operator">*</span>IPConn<span class="token punctuation">)</span> <span class="token function">ReadMsgIP</span><span class="token punctuation">(</span>b<span class="token punctuation">,</span> oob <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">byte</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>n<span class="token punctuation">,</span> oobn<span class="token punctuation">,</span> flags <span class="token builtin">int</span><span class="token punctuation">,</span> addr <span class="token operator">*</span>IPAddr<span class="token punctuation">,</span> err <span class="token builtin">error</span><span class="token punctuation">)</span>
    <span class="token keyword">func</span> <span class="token punctuation">(</span>c <span class="token operator">*</span>IPConn<span class="token punctuation">)</span> <span class="token function">RemoteAddr</span><span class="token punctuation">(</span><span class="token punctuation">)</span> Addr
    <span class="token keyword">func</span> <span class="token punctuation">(</span>c <span class="token operator">*</span>IPConn<span class="token punctuation">)</span> <span class="token function">SetDeadline</span><span class="token punctuation">(</span>t time<span class="token punctuation">.</span>Time<span class="token punctuation">)</span> <span class="token builtin">error</span>
    <span class="token keyword">func</span> <span class="token punctuation">(</span>c <span class="token operator">*</span>IPConn<span class="token punctuation">)</span> <span class="token function">SetReadBuffer</span><span class="token punctuation">(</span>bytes <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token builtin">error</span>
    <span class="token keyword">func</span> <span class="token punctuation">(</span>c <span class="token operator">*</span>IPConn<span class="token punctuation">)</span> <span class="token function">SetReadDeadline</span><span class="token punctuation">(</span>t time<span class="token punctuation">.</span>Time<span class="token punctuation">)</span> <span class="token builtin">error</span>
    <span class="token keyword">func</span> <span class="token punctuation">(</span>c <span class="token operator">*</span>IPConn<span class="token punctuation">)</span> <span class="token function">SetWriteBuffer</span><span class="token punctuation">(</span>bytes <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token builtin">error</span>
    <span class="token keyword">func</span> <span class="token punctuation">(</span>c <span class="token operator">*</span>IPConn<span class="token punctuation">)</span> <span class="token function">SetWriteDeadline</span><span class="token punctuation">(</span>t time<span class="token punctuation">.</span>Time<span class="token punctuation">)</span> <span class="token builtin">error</span>
    <span class="token keyword">func</span> <span class="token punctuation">(</span>c <span class="token operator">*</span>IPConn<span class="token punctuation">)</span> <span class="token function">SyscallConn</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>syscall<span class="token punctuation">.</span>RawConn<span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span>
    <span class="token keyword">func</span> <span class="token punctuation">(</span>c <span class="token operator">*</span>IPConn<span class="token punctuation">)</span> <span class="token function">Write</span><span class="token punctuation">(</span>b <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">byte</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span>
    <span class="token keyword">func</span> <span class="token punctuation">(</span>c <span class="token operator">*</span>IPConn<span class="token punctuation">)</span> <span class="token function">WriteMsgIP</span><span class="token punctuation">(</span>b<span class="token punctuation">,</span> oob <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">byte</span><span class="token punctuation">,</span> addr <span class="token operator">*</span>IPAddr<span class="token punctuation">)</span> <span class="token punctuation">(</span>n<span class="token punctuation">,</span> oobn <span class="token builtin">int</span><span class="token punctuation">,</span> err <span class="token builtin">error</span><span class="token punctuation">)</span>
    <span class="token keyword">func</span> <span class="token punctuation">(</span>c <span class="token operator">*</span>IPConn<span class="token punctuation">)</span> <span class="token function">WriteTo</span><span class="token punctuation">(</span>b <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">byte</span><span class="token punctuation">,</span> addr Addr<span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span>
    <span class="token keyword">func</span> <span class="token punctuation">(</span>c <span class="token operator">*</span>IPConn<span class="token punctuation">)</span> <span class="token function">WriteToIP</span><span class="token punctuation">(</span>b <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">byte</span><span class="token punctuation">,</span> addr <span class="token operator">*</span>IPAddr<span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span>
<span class="token keyword">type</span> TCPConn
    <span class="token keyword">func</span> <span class="token function">DialTCP</span><span class="token punctuation">(</span>network <span class="token builtin">string</span><span class="token punctuation">,</span> laddr<span class="token punctuation">,</span> raddr <span class="token operator">*</span>TCPAddr<span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token operator">*</span>TCPConn<span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span>
    <span class="token keyword">func</span> <span class="token punctuation">(</span>c <span class="token operator">*</span>TCPConn<span class="token punctuation">)</span> <span class="token function">Close</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token builtin">error</span>
    <span class="token keyword">func</span> <span class="token punctuation">(</span>c <span class="token operator">*</span>TCPConn<span class="token punctuation">)</span> <span class="token function">CloseRead</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token builtin">error</span>
    <span class="token keyword">func</span> <span class="token punctuation">(</span>c <span class="token operator">*</span>TCPConn<span class="token punctuation">)</span> <span class="token function">CloseWrite</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token builtin">error</span>
    <span class="token keyword">func</span> <span class="token punctuation">(</span>c <span class="token operator">*</span>TCPConn<span class="token punctuation">)</span> <span class="token function">File</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>f <span class="token operator">*</span>os<span class="token punctuation">.</span>File<span class="token punctuation">,</span> err <span class="token builtin">error</span><span class="token punctuation">)</span>
    <span class="token keyword">func</span> <span class="token punctuation">(</span>c <span class="token operator">*</span>TCPConn<span class="token punctuation">)</span> <span class="token function">LocalAddr</span><span class="token punctuation">(</span><span class="token punctuation">)</span> Addr
    <span class="token keyword">func</span> <span class="token punctuation">(</span>c <span class="token operator">*</span>TCPConn<span class="token punctuation">)</span> <span class="token function">Read</span><span class="token punctuation">(</span>b <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">byte</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span>
    <span class="token keyword">func</span> <span class="token punctuation">(</span>c <span class="token operator">*</span>TCPConn<span class="token punctuation">)</span> <span class="token function">ReadFrom</span><span class="token punctuation">(</span>r io<span class="token punctuation">.</span>Reader<span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token builtin">int64</span><span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span>
    <span class="token keyword">func</span> <span class="token punctuation">(</span>c <span class="token operator">*</span>TCPConn<span class="token punctuation">)</span> <span class="token function">RemoteAddr</span><span class="token punctuation">(</span><span class="token punctuation">)</span> Addr
    <span class="token keyword">func</span> <span class="token punctuation">(</span>c <span class="token operator">*</span>TCPConn<span class="token punctuation">)</span> <span class="token function">SetDeadline</span><span class="token punctuation">(</span>t time<span class="token punctuation">.</span>Time<span class="token punctuation">)</span> <span class="token builtin">error</span>
    <span class="token keyword">func</span> <span class="token punctuation">(</span>c <span class="token operator">*</span>TCPConn<span class="token punctuation">)</span> <span class="token function">SetKeepAlive</span><span class="token punctuation">(</span>keepalive <span class="token builtin">bool</span><span class="token punctuation">)</span> <span class="token builtin">error</span>
    <span class="token keyword">func</span> <span class="token punctuation">(</span>c <span class="token operator">*</span>TCPConn<span class="token punctuation">)</span> <span class="token function">SetKeepAlivePeriod</span><span class="token punctuation">(</span>d time<span class="token punctuation">.</span>Duration<span class="token punctuation">)</span> <span class="token builtin">error</span>
    <span class="token keyword">func</span> <span class="token punctuation">(</span>c <span class="token operator">*</span>TCPConn<span class="token punctuation">)</span> <span class="token function">SetLinger</span><span class="token punctuation">(</span>sec <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token builtin">error</span>
    <span class="token keyword">func</span> <span class="token punctuation">(</span>c <span class="token operator">*</span>TCPConn<span class="token punctuation">)</span> <span class="token function">SetNoDelay</span><span class="token punctuation">(</span>noDelay <span class="token builtin">bool</span><span class="token punctuation">)</span> <span class="token builtin">error</span>
    <span class="token keyword">func</span> <span class="token punctuation">(</span>c <span class="token operator">*</span>TCPConn<span class="token punctuation">)</span> <span class="token function">SetReadBuffer</span><span class="token punctuation">(</span>bytes <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token builtin">error</span>
    <span class="token keyword">func</span> <span class="token punctuation">(</span>c <span class="token operator">*</span>TCPConn<span class="token punctuation">)</span> <span class="token function">SetReadDeadline</span><span class="token punctuation">(</span>t time<span class="token punctuation">.</span>Time<span class="token punctuation">)</span> <span class="token builtin">error</span>
    <span class="token keyword">func</span> <span class="token punctuation">(</span>c <span class="token operator">*</span>TCPConn<span class="token punctuation">)</span> <span class="token function">SetWriteBuffer</span><span class="token punctuation">(</span>bytes <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token builtin">error</span>
    <span class="token keyword">func</span> <span class="token punctuation">(</span>c <span class="token operator">*</span>TCPConn<span class="token punctuation">)</span> <span class="token function">SetWriteDeadline</span><span class="token punctuation">(</span>t time<span class="token punctuation">.</span>Time<span class="token punctuation">)</span> <span class="token builtin">error</span>
    <span class="token keyword">func</span> <span class="token punctuation">(</span>c <span class="token operator">*</span>TCPConn<span class="token punctuation">)</span> <span class="token function">SyscallConn</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>syscall<span class="token punctuation">.</span>RawConn<span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span>
    <span class="token keyword">func</span> <span class="token punctuation">(</span>c <span class="token operator">*</span>TCPConn<span class="token punctuation">)</span> <span class="token function">Write</span><span class="token punctuation">(</span>b <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">byte</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span>
<span class="token keyword">type</span> TCPListener
    <span class="token keyword">func</span> <span class="token function">ListenTCP</span><span class="token punctuation">(</span>network <span class="token builtin">string</span><span class="token punctuation">,</span> laddr <span class="token operator">*</span>TCPAddr<span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token operator">*</span>TCPListener<span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span>
    <span class="token keyword">func</span> <span class="token punctuation">(</span>l <span class="token operator">*</span>TCPListener<span class="token punctuation">)</span> <span class="token function">Accept</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>Conn<span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span>
    <span class="token keyword">func</span> <span class="token punctuation">(</span>l <span class="token operator">*</span>TCPListener<span class="token punctuation">)</span> <span class="token function">AcceptTCP</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token operator">*</span>TCPConn<span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span>
    <span class="token keyword">func</span> <span class="token punctuation">(</span>l <span class="token operator">*</span>TCPListener<span class="token punctuation">)</span> <span class="token function">Addr</span><span class="token punctuation">(</span><span class="token punctuation">)</span> Addr
    <span class="token keyword">func</span> <span class="token punctuation">(</span>l <span class="token operator">*</span>TCPListener<span class="token punctuation">)</span> <span class="token function">Close</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token builtin">error</span>
    <span class="token keyword">func</span> <span class="token punctuation">(</span>l <span class="token operator">*</span>TCPListener<span class="token punctuation">)</span> <span class="token function">File</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>f <span class="token operator">*</span>os<span class="token punctuation">.</span>File<span class="token punctuation">,</span> err <span class="token builtin">error</span><span class="token punctuation">)</span>
    <span class="token keyword">func</span> <span class="token punctuation">(</span>l <span class="token operator">*</span>TCPListener<span class="token punctuation">)</span> <span class="token function">SetDeadline</span><span class="token punctuation">(</span>t time<span class="token punctuation">.</span>Time<span class="token punctuation">)</span> <span class="token builtin">error</span>
    <span class="token keyword">func</span> <span class="token punctuation">(</span>l <span class="token operator">*</span>TCPListener<span class="token punctuation">)</span> <span class="token function">SyscallConn</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>syscall<span class="token punctuation">.</span>RawConn<span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span>
<span class="token keyword">type</span> UDPConn
    <span class="token keyword">func</span> <span class="token function">DialUDP</span><span class="token punctuation">(</span>network <span class="token builtin">string</span><span class="token punctuation">,</span> laddr<span class="token punctuation">,</span> raddr <span class="token operator">*</span>UDPAddr<span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token operator">*</span>UDPConn<span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span>
    <span class="token keyword">func</span> <span class="token function">ListenMulticastUDP</span><span class="token punctuation">(</span>network <span class="token builtin">string</span><span class="token punctuation">,</span> ifi <span class="token operator">*</span>Interface<span class="token punctuation">,</span> gaddr <span class="token operator">*</span>UDPAddr<span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token operator">*</span>UDPConn<span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span>
    <span class="token keyword">func</span> <span class="token function">ListenUDP</span><span class="token punctuation">(</span>network <span class="token builtin">string</span><span class="token punctuation">,</span> laddr <span class="token operator">*</span>UDPAddr<span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token operator">*</span>UDPConn<span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span>
    <span class="token keyword">func</span> <span class="token punctuation">(</span>c <span class="token operator">*</span>UDPConn<span class="token punctuation">)</span> <span class="token function">Close</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token builtin">error</span>
    <span class="token keyword">func</span> <span class="token punctuation">(</span>c <span class="token operator">*</span>UDPConn<span class="token punctuation">)</span> <span class="token function">File</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>f <span class="token operator">*</span>os<span class="token punctuation">.</span>File<span class="token punctuation">,</span> err <span class="token builtin">error</span><span class="token punctuation">)</span>
    <span class="token keyword">func</span> <span class="token punctuation">(</span>c <span class="token operator">*</span>UDPConn<span class="token punctuation">)</span> <span class="token function">LocalAddr</span><span class="token punctuation">(</span><span class="token punctuation">)</span> Addr
    <span class="token keyword">func</span> <span class="token punctuation">(</span>c <span class="token operator">*</span>UDPConn<span class="token punctuation">)</span> <span class="token function">Read</span><span class="token punctuation">(</span>b <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">byte</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span>
    <span class="token keyword">func</span> <span class="token punctuation">(</span>c <span class="token operator">*</span>UDPConn<span class="token punctuation">)</span> <span class="token function">ReadFrom</span><span class="token punctuation">(</span>b <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">byte</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">,</span> Addr<span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span>
    <span class="token keyword">func</span> <span class="token punctuation">(</span>c <span class="token operator">*</span>UDPConn<span class="token punctuation">)</span> <span class="token function">ReadFromUDP</span><span class="token punctuation">(</span>b <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">byte</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">,</span> <span class="token operator">*</span>UDPAddr<span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span>
    <span class="token keyword">func</span> <span class="token punctuation">(</span>c <span class="token operator">*</span>UDPConn<span class="token punctuation">)</span> <span class="token function">ReadMsgUDP</span><span class="token punctuation">(</span>b<span class="token punctuation">,</span> oob <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">byte</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>n<span class="token punctuation">,</span> oobn<span class="token punctuation">,</span> flags <span class="token builtin">int</span><span class="token punctuation">,</span> addr <span class="token operator">*</span>UDPAddr<span class="token punctuation">,</span> err <span class="token builtin">error</span><span class="token punctuation">)</span>
    <span class="token keyword">func</span> <span class="token punctuation">(</span>c <span class="token operator">*</span>UDPConn<span class="token punctuation">)</span> <span class="token function">RemoteAddr</span><span class="token punctuation">(</span><span class="token punctuation">)</span> Addr
    <span class="token keyword">func</span> <span class="token punctuation">(</span>c <span class="token operator">*</span>UDPConn<span class="token punctuation">)</span> <span class="token function">SetDeadline</span><span class="token punctuation">(</span>t time<span class="token punctuation">.</span>Time<span class="token punctuation">)</span> <span class="token builtin">error</span>
    <span class="token keyword">func</span> <span class="token punctuation">(</span>c <span class="token operator">*</span>UDPConn<span class="token punctuation">)</span> <span class="token function">SetReadBuffer</span><span class="token punctuation">(</span>bytes <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token builtin">error</span>
    <span class="token keyword">func</span> <span class="token punctuation">(</span>c <span class="token operator">*</span>UDPConn<span class="token punctuation">)</span> <span class="token function">SetReadDeadline</span><span class="token punctuation">(</span>t time<span class="token punctuation">.</span>Time<span class="token punctuation">)</span> <span class="token builtin">error</span>
    <span class="token keyword">func</span> <span class="token punctuation">(</span>c <span class="token operator">*</span>UDPConn<span class="token punctuation">)</span> <span class="token function">SetWriteBuffer</span><span class="token punctuation">(</span>bytes <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token builtin">error</span>
    <span class="token keyword">func</span> <span class="token punctuation">(</span>c <span class="token operator">*</span>UDPConn<span class="token punctuation">)</span> <span class="token function">SetWriteDeadline</span><span class="token punctuation">(</span>t time<span class="token punctuation">.</span>Time<span class="token punctuation">)</span> <span class="token builtin">error</span>
    <span class="token keyword">func</span> <span class="token punctuation">(</span>c <span class="token operator">*</span>UDPConn<span class="token punctuation">)</span> <span class="token function">SyscallConn</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>syscall<span class="token punctuation">.</span>RawConn<span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span>
    <span class="token keyword">func</span> <span class="token punctuation">(</span>c <span class="token operator">*</span>UDPConn<span class="token punctuation">)</span> <span class="token function">Write</span><span class="token punctuation">(</span>b <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">byte</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span>
    <span class="token keyword">func</span> <span class="token punctuation">(</span>c <span class="token operator">*</span>UDPConn<span class="token punctuation">)</span> <span class="token function">WriteMsgUDP</span><span class="token punctuation">(</span>b<span class="token punctuation">,</span> oob <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">byte</span><span class="token punctuation">,</span> addr <span class="token operator">*</span>UDPAddr<span class="token punctuation">)</span> <span class="token punctuation">(</span>n<span class="token punctuation">,</span> oobn <span class="token builtin">int</span><span class="token punctuation">,</span> err <span class="token builtin">error</span><span class="token punctuation">)</span>
    <span class="token keyword">func</span> <span class="token punctuation">(</span>c <span class="token operator">*</span>UDPConn<span class="token punctuation">)</span> <span class="token function">WriteTo</span><span class="token punctuation">(</span>b <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">byte</span><span class="token punctuation">,</span> addr Addr<span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span>
    <span class="token keyword">func</span> <span class="token punctuation">(</span>c <span class="token operator">*</span>UDPConn<span class="token punctuation">)</span> <span class="token function">WriteToUDP</span><span class="token punctuation">(</span>b <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">byte</span><span class="token punctuation">,</span> addr <span class="token operator">*</span>UDPAddr<span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span>
<span class="token keyword">type</span> UnixConn
    <span class="token keyword">func</span> <span class="token function">DialUnix</span><span class="token punctuation">(</span>network <span class="token builtin">string</span><span class="token punctuation">,</span> laddr<span class="token punctuation">,</span> raddr <span class="token operator">*</span>UnixAddr<span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token operator">*</span>UnixConn<span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span>
    <span class="token keyword">func</span> <span class="token function">ListenUnixgram</span><span class="token punctuation">(</span>network <span class="token builtin">string</span><span class="token punctuation">,</span> laddr <span class="token operator">*</span>UnixAddr<span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token operator">*</span>UnixConn<span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span>
    <span class="token keyword">func</span> <span class="token punctuation">(</span>c <span class="token operator">*</span>UnixConn<span class="token punctuation">)</span> <span class="token function">Close</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token builtin">error</span>
    <span class="token keyword">func</span> <span class="token punctuation">(</span>c <span class="token operator">*</span>UnixConn<span class="token punctuation">)</span> <span class="token function">CloseRead</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token builtin">error</span>
    <span class="token keyword">func</span> <span class="token punctuation">(</span>c <span class="token operator">*</span>UnixConn<span class="token punctuation">)</span> <span class="token function">CloseWrite</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token builtin">error</span>
    <span class="token keyword">func</span> <span class="token punctuation">(</span>c <span class="token operator">*</span>UnixConn<span class="token punctuation">)</span> <span class="token function">File</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>f <span class="token operator">*</span>os<span class="token punctuation">.</span>File<span class="token punctuation">,</span> err <span class="token builtin">error</span><span class="token punctuation">)</span>
    <span class="token keyword">func</span> <span class="token punctuation">(</span>c <span class="token operator">*</span>UnixConn<span class="token punctuation">)</span> <span class="token function">LocalAddr</span><span class="token punctuation">(</span><span class="token punctuation">)</span> Addr
    <span class="token keyword">func</span> <span class="token punctuation">(</span>c <span class="token operator">*</span>UnixConn<span class="token punctuation">)</span> <span class="token function">Read</span><span class="token punctuation">(</span>b <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">byte</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span>
    <span class="token keyword">func</span> <span class="token punctuation">(</span>c <span class="token operator">*</span>UnixConn<span class="token punctuation">)</span> <span class="token function">ReadFrom</span><span class="token punctuation">(</span>b <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">byte</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">,</span> Addr<span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span>
    <span class="token keyword">func</span> <span class="token punctuation">(</span>c <span class="token operator">*</span>UnixConn<span class="token punctuation">)</span> <span class="token function">ReadFromUnix</span><span class="token punctuation">(</span>b <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">byte</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">,</span> <span class="token operator">*</span>UnixAddr<span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span>
    <span class="token keyword">func</span> <span class="token punctuation">(</span>c <span class="token operator">*</span>UnixConn<span class="token punctuation">)</span> <span class="token function">ReadMsgUnix</span><span class="token punctuation">(</span>b<span class="token punctuation">,</span> oob <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">byte</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>n<span class="token punctuation">,</span> oobn<span class="token punctuation">,</span> flags <span class="token builtin">int</span><span class="token punctuation">,</span> addr <span class="token operator">*</span>UnixAddr<span class="token punctuation">,</span> err <span class="token builtin">error</span><span class="token punctuation">)</span>
    <span class="token keyword">func</span> <span class="token punctuation">(</span>c <span class="token operator">*</span>UnixConn<span class="token punctuation">)</span> <span class="token function">RemoteAddr</span><span class="token punctuation">(</span><span class="token punctuation">)</span> Addr
    <span class="token keyword">func</span> <span class="token punctuation">(</span>c <span class="token operator">*</span>UnixConn<span class="token punctuation">)</span> <span class="token function">SetDeadline</span><span class="token punctuation">(</span>t time<span class="token punctuation">.</span>Time<span class="token punctuation">)</span> <span class="token builtin">error</span>
    <span class="token keyword">func</span> <span class="token punctuation">(</span>c <span class="token operator">*</span>UnixConn<span class="token punctuation">)</span> <span class="token function">SetReadBuffer</span><span class="token punctuation">(</span>bytes <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token builtin">error</span>
    <span class="token keyword">func</span> <span class="token punctuation">(</span>c <span class="token operator">*</span>UnixConn<span class="token punctuation">)</span> <span class="token function">SetReadDeadline</span><span class="token punctuation">(</span>t time<span class="token punctuation">.</span>Time<span class="token punctuation">)</span> <span class="token builtin">error</span>
    <span class="token keyword">func</span> <span class="token punctuation">(</span>c <span class="token operator">*</span>UnixConn<span class="token punctuation">)</span> <span class="token function">SetWriteBuffer</span><span class="token punctuation">(</span>bytes <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token builtin">error</span>
    <span class="token keyword">func</span> <span class="token punctuation">(</span>c <span class="token operator">*</span>UnixConn<span class="token punctuation">)</span> <span class="token function">SetWriteDeadline</span><span class="token punctuation">(</span>t time<span class="token punctuation">.</span>Time<span class="token punctuation">)</span> <span class="token builtin">error</span>
    <span class="token keyword">func</span> <span class="token punctuation">(</span>c <span class="token operator">*</span>UnixConn<span class="token punctuation">)</span> <span class="token function">SyscallConn</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>syscall<span class="token punctuation">.</span>RawConn<span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span>
    <span class="token keyword">func</span> <span class="token punctuation">(</span>c <span class="token operator">*</span>UnixConn<span class="token punctuation">)</span> <span class="token function">Write</span><span class="token punctuation">(</span>b <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">byte</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span>
    <span class="token keyword">func</span> <span class="token punctuation">(</span>c <span class="token operator">*</span>UnixConn<span class="token punctuation">)</span> <span class="token function">WriteMsgUnix</span><span class="token punctuation">(</span>b<span class="token punctuation">,</span> oob <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">byte</span><span class="token punctuation">,</span> addr <span class="token operator">*</span>UnixAddr<span class="token punctuation">)</span> <span class="token punctuation">(</span>n<span class="token punctuation">,</span> oobn <span class="token builtin">int</span><span class="token punctuation">,</span> err <span class="token builtin">error</span><span class="token punctuation">)</span>
    <span class="token keyword">func</span> <span class="token punctuation">(</span>c <span class="token operator">*</span>UnixConn<span class="token punctuation">)</span> <span class="token function">WriteTo</span><span class="token punctuation">(</span>b <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">byte</span><span class="token punctuation">,</span> addr Addr<span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span>
    <span class="token keyword">func</span> <span class="token punctuation">(</span>c <span class="token operator">*</span>UnixConn<span class="token punctuation">)</span> <span class="token function">WriteToUnix</span><span class="token punctuation">(</span>b <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">byte</span><span class="token punctuation">,</span> addr <span class="token operator">*</span>UnixAddr<span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span>
<span class="token keyword">type</span> UnixListener
    <span class="token keyword">func</span> <span class="token function">ListenUnix</span><span class="token punctuation">(</span>network <span class="token builtin">string</span><span class="token punctuation">,</span> laddr <span class="token operator">*</span>UnixAddr<span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token operator">*</span>UnixListener<span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span>
    <span class="token keyword">func</span> <span class="token punctuation">(</span>l <span class="token operator">*</span>UnixListener<span class="token punctuation">)</span> <span class="token function">Accept</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>Conn<span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span>
    <span class="token keyword">func</span> <span class="token punctuation">(</span>l <span class="token operator">*</span>UnixListener<span class="token punctuation">)</span> <span class="token function">AcceptUnix</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token operator">*</span>UnixConn<span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span>
    <span class="token keyword">func</span> <span class="token punctuation">(</span>l <span class="token operator">*</span>UnixListener<span class="token punctuation">)</span> <span class="token function">Addr</span><span class="token punctuation">(</span><span class="token punctuation">)</span> Addr
    <span class="token keyword">func</span> <span class="token punctuation">(</span>l <span class="token operator">*</span>UnixListener<span class="token punctuation">)</span> <span class="token function">Close</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token builtin">error</span>
    <span class="token keyword">func</span> <span class="token punctuation">(</span>l <span class="token operator">*</span>UnixListener<span class="token punctuation">)</span> <span class="token function">File</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>f <span class="token operator">*</span>os<span class="token punctuation">.</span>File<span class="token punctuation">,</span> err <span class="token builtin">error</span><span class="token punctuation">)</span>
    <span class="token keyword">func</span> <span class="token punctuation">(</span>l <span class="token operator">*</span>UnixListener<span class="token punctuation">)</span> <span class="token function">SetDeadline</span><span class="token punctuation">(</span>t time<span class="token punctuation">.</span>Time<span class="token punctuation">)</span> <span class="token builtin">error</span>
    <span class="token keyword">func</span> <span class="token punctuation">(</span>l <span class="token operator">*</span>UnixListener<span class="token punctuation">)</span> <span class="token function">SetUnlinkOnClose</span><span class="token punctuation">(</span>unlink <span class="token builtin">bool</span><span class="token punctuation">)</span>
    <span class="token keyword">func</span> <span class="token punctuation">(</span>l <span class="token operator">*</span>UnixListener<span class="token punctuation">)</span> <span class="token function">SyscallConn</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>syscall<span class="token punctuation">.</span>RawConn<span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span>
</code></pre>
<h1 id="path"><a name="path" class="anchor-navigation-ex-anchor" href="#path"><i class="fa fa-link" aria-hidden="true"></i></a>7. path</h1>
<p>path&#x662F;&#x4E2A;&#x8F85;&#x52A9;&#x5305;, &#x7528;&#x4E8E;&#x89E3;&#x6790;&#x8DEF;&#x5F84;&#x7684;, &#x57FA;&#x672C;&#x4E0A;&#x5E26;&#x659C;&#x6760;&#x7684;&#x8DEF;&#x5F84;&#x5E38;&#x7528;&#x7684;&#x65B9;&#x6CD5;&#x90FD;&#x6709;.
&#x9488;&#x5BF9;URL&#x5730;&#x5740;&#x7684;, &#x5BF9;unix&#x8DEF;&#x5F84;&#x4E5F;&#x6709;&#x6548;. windows&#x8DEF;&#x5F84;&#x65E0;&#x6548;.</p>
<pre class="language-"><code class="lang-go"><span class="token keyword">func</span> <span class="token function">Base</span><span class="token punctuation">(</span>path <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token builtin">string</span>
<span class="token keyword">func</span> <span class="token function">Clean</span><span class="token punctuation">(</span>path <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token builtin">string</span>
<span class="token keyword">func</span> <span class="token function">Dir</span><span class="token punctuation">(</span>path <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token builtin">string</span>
<span class="token keyword">func</span> <span class="token function">Ext</span><span class="token punctuation">(</span>path <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token builtin">string</span>
<span class="token keyword">func</span> <span class="token function">IsAbs</span><span class="token punctuation">(</span>path <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token builtin">bool</span>
<span class="token keyword">func</span> <span class="token function">Join</span><span class="token punctuation">(</span>elem <span class="token operator">...</span><span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token builtin">string</span>
<span class="token keyword">func</span> <span class="token function">Match</span><span class="token punctuation">(</span>pattern<span class="token punctuation">,</span> name <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>matched <span class="token builtin">bool</span><span class="token punctuation">,</span> err <span class="token builtin">error</span><span class="token punctuation">)</span>
<span class="token keyword">func</span> <span class="token function">Split</span><span class="token punctuation">(</span>path <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>dir<span class="token punctuation">,</span> file <span class="token builtin">string</span><span class="token punctuation">)</span>
</code></pre>
<h2 id="filepath"><a name="filepath" class="anchor-navigation-ex-anchor" href="#filepath"><i class="fa fa-link" aria-hidden="true"></i></a>7.1. filepath</h2>
<p>filepath&#x63D0;&#x4F9B;OS&#x65E0;&#x5173;&#x7684;&#x8DEF;&#x5F84;, &#x6B63;&#x659C;&#x6760;&#x548C;&#x53CD;&#x659C;&#x6760;&#x90FD;&#x652F;&#x6301;.
filepath&#x63D0;&#x4F9B;&#x57FA;&#x672C;&#x7684;path&#x65B9;&#x6CD5;, &#x8FD8;&#x63D0;&#x4F9B;&#x4E86;&#x4E00;&#x4E2A;&#x5F88;&#x597D;&#x7684;&#x76EE;&#x5F55;&#x904D;&#x5386;&#x65B9;&#x6CD5;: Walk, &#x5BF9;&#x76EE;&#x5F55;&#x4E0B;&#x7684;&#x6240;&#x6709;&#x6587;&#x4EF6;&#x8C03;&#x7528;WalkFunc</p>
<pre class="language-"><code class="lang-go"><span class="token keyword">func</span> <span class="token function">Abs</span><span class="token punctuation">(</span>path <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token builtin">string</span><span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span>
<span class="token keyword">func</span> <span class="token function">Base</span><span class="token punctuation">(</span>path <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token builtin">string</span>
<span class="token keyword">func</span> <span class="token function">Clean</span><span class="token punctuation">(</span>path <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token builtin">string</span>
<span class="token keyword">func</span> <span class="token function">Dir</span><span class="token punctuation">(</span>path <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token builtin">string</span>
<span class="token keyword">func</span> <span class="token function">EvalSymlinks</span><span class="token punctuation">(</span>path <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token builtin">string</span><span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span>
<span class="token keyword">func</span> <span class="token function">Ext</span><span class="token punctuation">(</span>path <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token builtin">string</span>
<span class="token keyword">func</span> <span class="token function">FromSlash</span><span class="token punctuation">(</span>path <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token builtin">string</span>
<span class="token keyword">func</span> <span class="token function">Glob</span><span class="token punctuation">(</span>pattern <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>matches <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">,</span> err <span class="token builtin">error</span><span class="token punctuation">)</span>
<span class="token keyword">func</span> <span class="token function">HasPrefix</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span> prefix <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token builtin">bool</span>
<span class="token keyword">func</span> <span class="token function">IsAbs</span><span class="token punctuation">(</span>path <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token builtin">bool</span>
<span class="token keyword">func</span> <span class="token function">Join</span><span class="token punctuation">(</span>elem <span class="token operator">...</span><span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token builtin">string</span>
<span class="token keyword">func</span> <span class="token function">Match</span><span class="token punctuation">(</span>pattern<span class="token punctuation">,</span> name <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>matched <span class="token builtin">bool</span><span class="token punctuation">,</span> err <span class="token builtin">error</span><span class="token punctuation">)</span>
<span class="token keyword">func</span> <span class="token function">Rel</span><span class="token punctuation">(</span>basepath<span class="token punctuation">,</span> targpath <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token builtin">string</span><span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span>
<span class="token keyword">func</span> <span class="token function">Split</span><span class="token punctuation">(</span>path <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>dir<span class="token punctuation">,</span> file <span class="token builtin">string</span><span class="token punctuation">)</span>
<span class="token keyword">func</span> <span class="token function">SplitList</span><span class="token punctuation">(</span>path <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">string</span>
<span class="token keyword">func</span> <span class="token function">ToSlash</span><span class="token punctuation">(</span>path <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token builtin">string</span>
<span class="token keyword">func</span> <span class="token function">VolumeName</span><span class="token punctuation">(</span>path <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token builtin">string</span>
<span class="token keyword">func</span> <span class="token function">Walk</span><span class="token punctuation">(</span>root <span class="token builtin">string</span><span class="token punctuation">,</span> walkFn WalkFunc<span class="token punctuation">)</span> <span class="token builtin">error</span>
<span class="token keyword">type</span> WalkFunc
</code></pre>
<h1 id="encoding"><a name="encoding" class="anchor-navigation-ex-anchor" href="#encoding"><i class="fa fa-link" aria-hidden="true"></i></a>8. encoding</h1>
<p>encoding&#x4E0B;&#x9762;&#x6709;&#x597D;&#x51E0;&#x79CD;encode&#x65B9;&#x6CD5;, &#x4F46;&#x90FD;&#x80FD;&#x7528;&#x5230;&#x4E0B;&#x9762;&#x4E24;&#x5BF9;&#x63A5;&#x53E3;.</p>
<h2 id="&#x4E8C;&#x8FDB;&#x5236;"><a name="&#x4E8C;&#x8FDB;&#x5236;" class="anchor-navigation-ex-anchor" href="#&#x4E8C;&#x8FDB;&#x5236;"><i class="fa fa-link" aria-hidden="true"></i></a>8.1. &#x4E8C;&#x8FDB;&#x5236;</h2>
<pre class="language-"><code class="lang-go"><span class="token keyword">type</span> BinaryMarshaler <span class="token keyword">interface</span> <span class="token punctuation">{</span>
    <span class="token function">MarshalBinary</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>data <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">byte</span><span class="token punctuation">,</span> err <span class="token builtin">error</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">type</span> BinaryUnmarshaler <span class="token keyword">interface</span> <span class="token punctuation">{</span>
    <span class="token function">UnmarshalBinary</span><span class="token punctuation">(</span>data <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">byte</span><span class="token punctuation">)</span> <span class="token builtin">error</span>
<span class="token punctuation">}</span>
</code></pre>
<h2 id="utf8"><a name="utf8" class="anchor-navigation-ex-anchor" href="#utf8"><i class="fa fa-link" aria-hidden="true"></i></a>8.2. UTF8</h2>
<pre class="language-"><code class="lang-go"><span class="token keyword">type</span> TextMarshaler <span class="token keyword">interface</span> <span class="token punctuation">{</span>
    <span class="token function">MarshalText</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>text <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">byte</span><span class="token punctuation">,</span> err <span class="token builtin">error</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">type</span> TextUnmarshaler <span class="token keyword">interface</span> <span class="token punctuation">{</span>
    <span class="token function">UnmarshalText</span><span class="token punctuation">(</span>text <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">byte</span><span class="token punctuation">)</span> <span class="token builtin">error</span>
<span class="token punctuation">}</span>
</code></pre>
<h2 id="encodinggob"><a name="encodinggob" class="anchor-navigation-ex-anchor" href="#encodinggob"><i class="fa fa-link" aria-hidden="true"></i></a>8.3. encoding/gob</h2>
<p>gob&#x63D0;&#x4F9B;&#x5728;&#x53D1;&#x9001;&#x548C;&#x63A5;&#x6536;&#x53CC;&#x65B9;&#x4F20;&#x8F93;&#x4E8C;&#x8FDB;&#x5236;&#x6D41;&#x7684;&#x65B9;&#x6CD5;. &#x6BD4;&#x8F83;&#x5E38;&#x7528;&#x4E8E;rpc
gob&#x6D41;&#x662F;&#x81EA;&#x89E3;&#x91CA;&#x7684;. &#x6BCF;&#x4E2A;gob&#x6570;&#x636E;&#x524D;&#x9762;&#x90FD;&#x6709;&#x4E2A;&#x7C7B;&#x578B;, &#x662F;&#x9884;&#x5B9A;&#x4E49;&#x597D;&#x7684;. 
&#x5728;gob&#x6D41;&#x4E2D;, &#x6307;&#x9488;&#x4F1A;&#x88AB;&#x53D8;&#x6210;&#x5176;&#x6307;&#x5411;&#x7684;&#x5185;&#x5BB9;.
&#x4F7F;&#x7528;gob&#x7684;&#x65F6;&#x5019;, Encoder&#x628A;&#x672C;&#x5730;&#x53D8;&#x91CF;&#x53D8;&#x6210;gob&#x6D41;,Decoder&#x628A;&#x6D41;&#x6570;&#x636E;&#x8FD8;&#x539F;&#x5230;&#x672C;&#x5730;&#x53D8;&#x91CF;.</p>
<hr>
<p>&#x63A5;&#x6536;&#x7AEF;&#x548C;&#x53D1;&#x9001;&#x7AEF;&#x4E0D;&#x4E00;&#x5B9A;&#x8981;&#x5B8C;&#x5168;&#x4E00;&#x6837;. &#x7ED3;&#x6784;&#x4F53;&#x7684;&#x6210;&#x5458;&#x6309;&#x540D;&#x5B57;&#x6765;&#x5339;&#x914D;.
&#x6BD4;&#x5982;&#x53D1;&#x9001;&#x4E00;&#x4E2A;&#x7ED3;&#x6784;&#x4F53;: <code>struct { A, B int }</code>
&#x90A3;&#x4E0B;&#x9762;&#x7684;&#x5F62;&#x5F0F;&#x90FD;&#x53EF;&#x4EE5;:</p>
<pre class="language-"><code class="lang-go"><span class="token keyword">struct</span> <span class="token punctuation">{</span> A<span class="token punctuation">,</span> B <span class="token builtin">int</span> <span class="token punctuation">}</span>    <span class="token comment">// the same</span>
<span class="token operator">*</span><span class="token keyword">struct</span> <span class="token punctuation">{</span> A<span class="token punctuation">,</span> B <span class="token builtin">int</span> <span class="token punctuation">}</span>    <span class="token comment">// extra indirection of the struct</span>
<span class="token keyword">struct</span> <span class="token punctuation">{</span> <span class="token operator">*</span>A<span class="token punctuation">,</span> <span class="token operator">*</span><span class="token operator">*</span>B <span class="token builtin">int</span> <span class="token punctuation">}</span>    <span class="token comment">// extra indirection of the fields</span>
<span class="token keyword">struct</span> <span class="token punctuation">{</span> A<span class="token punctuation">,</span> B <span class="token builtin">int64</span> <span class="token punctuation">}</span>    <span class="token comment">// different concrete value type; see below</span>
</code></pre>
<p>&#x63A5;&#x53D7;&#x65B9;&#x53EF;&#x4EE5;&#x662F;:</p>
<pre class="language-"><code class="lang-go"><span class="token keyword">struct</span> <span class="token punctuation">{</span> A<span class="token punctuation">,</span> B <span class="token builtin">int</span> <span class="token punctuation">}</span>    <span class="token comment">// the same</span>
<span class="token operator">*</span><span class="token keyword">struct</span> <span class="token punctuation">{</span> A<span class="token punctuation">,</span> B <span class="token builtin">int</span> <span class="token punctuation">}</span>    <span class="token comment">// extra indirection of the struct</span>
<span class="token keyword">struct</span> <span class="token punctuation">{</span> <span class="token operator">*</span>A<span class="token punctuation">,</span> <span class="token operator">*</span><span class="token operator">*</span>B <span class="token builtin">int</span> <span class="token punctuation">}</span>    <span class="token comment">// extra indirection of the fields</span>
<span class="token keyword">struct</span> <span class="token punctuation">{</span> A<span class="token punctuation">,</span> B <span class="token builtin">int64</span> <span class="token punctuation">}</span>    <span class="token comment">// different concrete value type; see below</span>
</code></pre>
<p>&#x63A5;&#x6536;&#x4E0B;&#x9762;&#x7684;&#x5F62;&#x5F0F;&#x662F;&#x9519;&#x8BEF;&#x7684;:</p>
<pre class="language-"><code class="lang-go"><span class="token keyword">struct</span> <span class="token punctuation">{</span> A <span class="token builtin">int</span><span class="token punctuation">;</span> B <span class="token builtin">uint</span> <span class="token punctuation">}</span>    <span class="token comment">// change of signedness for B</span>
<span class="token keyword">struct</span> <span class="token punctuation">{</span> A <span class="token builtin">int</span><span class="token punctuation">;</span> B float <span class="token punctuation">}</span>    <span class="token comment">// change of type for B</span>
<span class="token keyword">struct</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span>    <span class="token comment">// no field names in common</span>
<span class="token keyword">struct</span> <span class="token punctuation">{</span> C<span class="token punctuation">,</span> D <span class="token builtin">int</span> <span class="token punctuation">}</span>    <span class="token comment">// no field names in common</span>
</code></pre>
<p>&#x4F20;&#x8F93;&#x7684;&#x8FC7;&#x7A0B;&#x4E0D;&#x662F;&#x5F88;&#x7B80;&#x5355;, &#x6BD4;&#x5982;&#x5BF9;&#x6574;&#x5F62;&#x6765;&#x8BF4;, int&#x662F;&#x4EE5;&#x53D8;&#x957F;&#x65B9;&#x5F0F;&#x4F20;&#x8F93;&#x7684;, &#x5E76;&#x4E0D;&#x533A;&#x5206;int32, int64&#x7B49;.
string&#x548C;byte&#x5207;&#x7247;, &#x6570;&#x7EC4;&#x548C;map, &#x90FD;&#x53EF;&#x4EE5;&#x88AB;Encode&#x7136;&#x540E;send.</p>
<p>&#x4E5F;&#x53EF;&#x4EE5;&#x81EA;&#x5B9A;&#x4E49;Encode&#x65B9;&#x6CD5;&#x6765;&#x53D1;&#x9001;&#x81EA;&#x5B9A;&#x4E49;&#x6570;&#x636E;.</p>
<h3 id="api_1"><a name="api_1" class="anchor-navigation-ex-anchor" href="#api_1"><i class="fa fa-link" aria-hidden="true"></i></a>8.3.1. api</h3>
<pre class="language-"><code class="lang-go"><span class="token keyword">func</span> <span class="token function">Register</span><span class="token punctuation">(</span>value <span class="token keyword">interface</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">func</span> <span class="token function">RegisterName</span><span class="token punctuation">(</span>name <span class="token builtin">string</span><span class="token punctuation">,</span> value <span class="token keyword">interface</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">type</span> CommonType
<span class="token keyword">type</span> Decoder
    <span class="token keyword">func</span> <span class="token function">NewDecoder</span><span class="token punctuation">(</span>r io<span class="token punctuation">.</span>Reader<span class="token punctuation">)</span> <span class="token operator">*</span>Decoder
    <span class="token keyword">func</span> <span class="token punctuation">(</span>dec <span class="token operator">*</span>Decoder<span class="token punctuation">)</span> <span class="token function">Decode</span><span class="token punctuation">(</span>e <span class="token keyword">interface</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token builtin">error</span>
    <span class="token keyword">func</span> <span class="token punctuation">(</span>dec <span class="token operator">*</span>Decoder<span class="token punctuation">)</span> <span class="token function">DecodeValue</span><span class="token punctuation">(</span>v reflect<span class="token punctuation">.</span>Value<span class="token punctuation">)</span> <span class="token builtin">error</span>
<span class="token keyword">type</span> Encoder
    <span class="token keyword">func</span> <span class="token function">NewEncoder</span><span class="token punctuation">(</span>w io<span class="token punctuation">.</span>Writer<span class="token punctuation">)</span> <span class="token operator">*</span>Encoder
    <span class="token keyword">func</span> <span class="token punctuation">(</span>enc <span class="token operator">*</span>Encoder<span class="token punctuation">)</span> <span class="token function">Encode</span><span class="token punctuation">(</span>e <span class="token keyword">interface</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token builtin">error</span>
    <span class="token keyword">func</span> <span class="token punctuation">(</span>enc <span class="token operator">*</span>Encoder<span class="token punctuation">)</span> <span class="token function">EncodeValue</span><span class="token punctuation">(</span>value reflect<span class="token punctuation">.</span>Value<span class="token punctuation">)</span> <span class="token builtin">error</span>
<span class="token keyword">type</span> GobDecoder
<span class="token keyword">type</span> GobEncoder
</code></pre>
<p>&#x6CE8;&#x610F;:</p>
<ul>
<li>type Decoder&#x548C;type Encoder&#x90FD;&#x662F;struct, &#x800C;&#x4E0D;&#x662F;interface
&#x8FD4;&#x56DE;struct, &#x662F;&#x8981;&#x8C03;&#x7528;&#x8FD9;&#x4E2A;&#x5BF9;&#x8C61;&#x7684;&#x65B9;&#x6CD5;.
&#x800C;&#x5B9E;&#x73B0;interface, &#x662F;&#x5B9E;&#x73B0;&#x4E00;&#x4E2A;&#x6D3E;&#x751F;&#x7C7B;</li>
<li>&#x5165;&#x53C2;&#x90FD;&#x662F;<code>e interface{}</code>, &#x8FD9;&#x662F;&#x4E2A;&#x4E07;&#x80FD;&#x5BF9;&#x8C61;. &#x53EF;&#x4EE5;&#x662F;&#x6307;&#x9488;, &#x4E5F;&#x53EF;&#x4EE5;&#x662F;&#x503C;. &#x770B;&#x600E;&#x4E48;&#x7528;.</li>
</ul>
<h3 id="&#x7B80;&#x5355;&#x4F8B;&#x5B50;"><a name="&#x7B80;&#x5355;&#x4F8B;&#x5B50;" class="anchor-navigation-ex-anchor" href="#&#x7B80;&#x5355;&#x4F8B;&#x5B50;"><i class="fa fa-link" aria-hidden="true"></i></a>8.3.2. &#x7B80;&#x5355;&#x4F8B;&#x5B50;</h3>
<pre class="language-"><code class="lang-go"><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
    <span class="token string">&quot;bytes&quot;</span>
    <span class="token string">&quot;encoding/gob&quot;</span>
    <span class="token string">&quot;fmt&quot;</span>
    <span class="token string">&quot;log&quot;</span>
<span class="token punctuation">)</span>

<span class="token keyword">type</span> P <span class="token keyword">struct</span> <span class="token punctuation">{</span>
    X<span class="token punctuation">,</span> Y<span class="token punctuation">,</span> Z <span class="token builtin">int</span>
    Name    <span class="token builtin">string</span>
<span class="token punctuation">}</span>

<span class="token keyword">type</span> Q <span class="token keyword">struct</span> <span class="token punctuation">{</span>
    X<span class="token punctuation">,</span> Y <span class="token operator">*</span><span class="token builtin">int32</span>
    Name <span class="token builtin">string</span>
<span class="token punctuation">}</span>

<span class="token comment">// This example shows the basic usage of the package: Create an encoder,</span>
<span class="token comment">// transmit some values, receive them with a decoder.</span>
<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Initialize the encoder and decoder. Normally enc and dec would be</span>
    <span class="token comment">// bound to network connections and the encoder and decoder would</span>
    <span class="token comment">// run in different processes.</span>
    <span class="token keyword">var</span> network bytes<span class="token punctuation">.</span>Buffer        <span class="token comment">// Stand-in for a network connection</span>
    enc <span class="token operator">:=</span> gob<span class="token punctuation">.</span><span class="token function">NewEncoder</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>network<span class="token punctuation">)</span> <span class="token comment">// Will write to network.</span>
    dec <span class="token operator">:=</span> gob<span class="token punctuation">.</span><span class="token function">NewDecoder</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>network<span class="token punctuation">)</span> <span class="token comment">// Will read from network.</span>

    <span class="token comment">// Encode (send) some values.</span>
    err <span class="token operator">:=</span> enc<span class="token punctuation">.</span><span class="token function">Encode</span><span class="token punctuation">(</span>P<span class="token punctuation">{</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token string">&quot;Pythagoras&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
        log<span class="token punctuation">.</span><span class="token function">Fatal</span><span class="token punctuation">(</span><span class="token string">&quot;encode error:&quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    err <span class="token operator">=</span> enc<span class="token punctuation">.</span><span class="token function">Encode</span><span class="token punctuation">(</span>P<span class="token punctuation">{</span><span class="token number">1782</span><span class="token punctuation">,</span> <span class="token number">1841</span><span class="token punctuation">,</span> <span class="token number">1922</span><span class="token punctuation">,</span> <span class="token string">&quot;Treehouse&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
        log<span class="token punctuation">.</span><span class="token function">Fatal</span><span class="token punctuation">(</span><span class="token string">&quot;encode error:&quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// Decode (receive) and print the values.</span>
    <span class="token keyword">var</span> q Q
    err <span class="token operator">=</span> dec<span class="token punctuation">.</span><span class="token function">Decode</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>q<span class="token punctuation">)</span>
    <span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
        log<span class="token punctuation">.</span><span class="token function">Fatal</span><span class="token punctuation">(</span><span class="token string">&quot;decode error 1:&quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;%q: {%d, %d}\n&quot;</span><span class="token punctuation">,</span> q<span class="token punctuation">.</span>Name<span class="token punctuation">,</span> <span class="token operator">*</span>q<span class="token punctuation">.</span>X<span class="token punctuation">,</span> <span class="token operator">*</span>q<span class="token punctuation">.</span>Y<span class="token punctuation">)</span>
    err <span class="token operator">=</span> dec<span class="token punctuation">.</span><span class="token function">Decode</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>q<span class="token punctuation">)</span>
    <span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
        log<span class="token punctuation">.</span><span class="token function">Fatal</span><span class="token punctuation">(</span><span class="token string">&quot;decode error 2:&quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;%q: {%d, %d}\n&quot;</span><span class="token punctuation">,</span> q<span class="token punctuation">.</span>Name<span class="token punctuation">,</span> <span class="token operator">*</span>q<span class="token punctuation">.</span>X<span class="token punctuation">,</span> <span class="token operator">*</span>q<span class="token punctuation">.</span>Y<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre>
<p>&#x7ED3;&#x679C;</p>
<pre class="language-"><code>&quot;Pythagoras&quot;: {3, 4}
&quot;Treehouse&quot;: {1782, 1841}
</code></pre><h3 id="&#x81EA;&#x5B9A;&#x4E49;encode&#x548C;decode"><a name="&#x81EA;&#x5B9A;&#x4E49;encode&#x548C;decode" class="anchor-navigation-ex-anchor" href="#&#x81EA;&#x5B9A;&#x4E49;encode&#x548C;decode"><i class="fa fa-link" aria-hidden="true"></i></a>8.3.3. &#x81EA;&#x5B9A;&#x4E49;encode&#x548C;decode</h3>
<p>Vector&#x91CC;&#x9762;&#x6709;&#x79C1;&#x6709;&#x6210;&#x5458;, gob&#x65E0;&#x6CD5;&#x76F4;&#x63A5;&#x8BBF;&#x95EE;, &#x5FC5;&#x987B;&#x901A;&#x8FC7;Vector&#x81EA;&#x5DF1;&#x7684;&#x65B9;&#x6CD5;.
gob&#x4F1A;&#x8C03;&#x7528;encoding&#x7684;MarshalBinary&#x548C;UnmarshalBinary&#x6765;&#x5B8C;&#x6210;&#x8FD9;&#x4E2A;&#x4EFB;&#x52A1;.</p>
<pre class="language-"><code class="lang-go"><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
    <span class="token string">&quot;bytes&quot;</span>
    <span class="token string">&quot;encoding/gob&quot;</span>
    <span class="token string">&quot;fmt&quot;</span>
    <span class="token string">&quot;log&quot;</span>
<span class="token punctuation">)</span>

<span class="token comment">// The Vector type has unexported fields, which the package cannot access.</span>
<span class="token comment">// We therefore write a BinaryMarshal/BinaryUnmarshal method pair to allow us</span>
<span class="token comment">// to send and receive the type with the gob package. These interfaces are</span>
<span class="token comment">// defined in the &quot;encoding&quot; package.</span>
<span class="token comment">// We could equivalently use the locally defined GobEncode/GobDecoder</span>
<span class="token comment">// interfaces.</span>
<span class="token keyword">type</span> Vector <span class="token keyword">struct</span> <span class="token punctuation">{</span>
    x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> z <span class="token builtin">int</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>v Vector<span class="token punctuation">)</span> <span class="token function">MarshalBinary</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">byte</span><span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// A simple encoding: plain text.</span>
    <span class="token keyword">var</span> b bytes<span class="token punctuation">.</span>Buffer
    fmt<span class="token punctuation">.</span><span class="token function">Fprintln</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>b<span class="token punctuation">,</span> v<span class="token punctuation">.</span>x<span class="token punctuation">,</span> v<span class="token punctuation">.</span>y<span class="token punctuation">,</span> v<span class="token punctuation">.</span>z<span class="token punctuation">)</span>
    <span class="token keyword">return</span> b<span class="token punctuation">.</span><span class="token function">Bytes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token boolean">nil</span>
<span class="token punctuation">}</span>

<span class="token comment">// UnmarshalBinary modifies the receiver so it must take a pointer receiver.</span>
<span class="token comment">//&#x56E0;&#x4E3A;&#x4E0B;&#x9762;Decode()&#x5165;&#x53C2;&#x662F;Vector&#x7684;&#x5730;&#x5740;, &#x6240;&#x4EE5;&#x8FD9;&#x91CC;&#x8981;&#x5F15;&#x7528;&#x65B9;&#x5F0F;.</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>v <span class="token operator">*</span>Vector<span class="token punctuation">)</span> <span class="token function">UnmarshalBinary</span><span class="token punctuation">(</span>data <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">byte</span><span class="token punctuation">)</span> <span class="token builtin">error</span> <span class="token punctuation">{</span>
    <span class="token comment">// A simple encoding: plain text.</span>
    b <span class="token operator">:=</span> bytes<span class="token punctuation">.</span><span class="token function">NewBuffer</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>
    <span class="token boolean">_</span><span class="token punctuation">,</span> err <span class="token operator">:=</span> fmt<span class="token punctuation">.</span><span class="token function">Fscanln</span><span class="token punctuation">(</span>b<span class="token punctuation">,</span> <span class="token operator">&amp;</span>v<span class="token punctuation">.</span>x<span class="token punctuation">,</span> <span class="token operator">&amp;</span>v<span class="token punctuation">.</span>y<span class="token punctuation">,</span> <span class="token operator">&amp;</span>v<span class="token punctuation">.</span>z<span class="token punctuation">)</span>
    <span class="token keyword">return</span> err
<span class="token punctuation">}</span>

<span class="token comment">// This example transmits a value that implements the custom encoding and decoding methods.</span>
<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> network bytes<span class="token punctuation">.</span>Buffer <span class="token comment">// Stand-in for the network.</span>

    <span class="token comment">// Create an encoder and send a value.</span>
    enc <span class="token operator">:=</span> gob<span class="token punctuation">.</span><span class="token function">NewEncoder</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>network<span class="token punctuation">)</span>
    err <span class="token operator">:=</span> enc<span class="token punctuation">.</span><span class="token function">Encode</span><span class="token punctuation">(</span>Vector<span class="token punctuation">{</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
        log<span class="token punctuation">.</span><span class="token function">Fatal</span><span class="token punctuation">(</span><span class="token string">&quot;encode:&quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// Create a decoder and receive a value.</span>
    dec <span class="token operator">:=</span> gob<span class="token punctuation">.</span><span class="token function">NewDecoder</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>network<span class="token punctuation">)</span>
    <span class="token keyword">var</span> v Vector
    err <span class="token operator">=</span> dec<span class="token punctuation">.</span><span class="token function">Decode</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>v<span class="token punctuation">)</span>
    <span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
        log<span class="token punctuation">.</span><span class="token function">Fatal</span><span class="token punctuation">(</span><span class="token string">&quot;decode:&quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span>

<span class="token punctuation">}</span>

&#x7ED3;&#x679C;<span class="token punctuation">:</span>
<span class="token punctuation">{</span><span class="token number">3</span> <span class="token number">4</span> <span class="token number">5</span><span class="token punctuation">}</span>
</code></pre>
<h3 id="&#x4F20;&#x8F93;interface&#x5BF9;&#x8C61;"><a name="&#x4F20;&#x8F93;interface&#x5BF9;&#x8C61;" class="anchor-navigation-ex-anchor" href="#&#x4F20;&#x8F93;interface&#x5BF9;&#x8C61;"><i class="fa fa-link" aria-hidden="true"></i></a>8.3.4. &#x4F20;&#x8F93;interface&#x5BF9;&#x8C61;</h3>
<p>interface, channel&#x7B49;&#x9ED8;&#x8BA4;&#x4E0D;&#x80FD;&#x4F20;&#x8F93;. &#x4F46;&#x53EF;&#x4EE5;&#x6CE8;&#x518C;interface&#x7684;concrete &#x7C7B;&#x578B;&#x6765;&#x4F20;&#x8F93;.
&#x6BD4;&#x5982;: Point&#x662F;&#x4E2A;struct, &#x53EF;&#x4EE5;&#x76F4;&#x63A5;gob; &#x4F46;Pythagoras&#x662F;interface, &#x8981;&#x4F20;&#x8F93;&#x5B83;&#x5FC5;&#x987B;&#x8981;&#x6CE8;&#x518C;&#x5B83;&#x5BF9;&#x5E94;&#x7684;concrete&#x7C7B;&#x578B;:
<code>gob.Register(Point{})</code></p>
<pre class="language-"><code class="lang-go"><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
    <span class="token string">&quot;bytes&quot;</span>
    <span class="token string">&quot;encoding/gob&quot;</span>
    <span class="token string">&quot;fmt&quot;</span>
    <span class="token string">&quot;log&quot;</span>
    <span class="token string">&quot;math&quot;</span>
<span class="token punctuation">)</span>

<span class="token keyword">type</span> Point <span class="token keyword">struct</span> <span class="token punctuation">{</span>
    X<span class="token punctuation">,</span> Y <span class="token builtin">int</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>p Point<span class="token punctuation">)</span> <span class="token function">Hypotenuse</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token builtin">float64</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> math<span class="token punctuation">.</span><span class="token function">Hypot</span><span class="token punctuation">(</span><span class="token function">float64</span><span class="token punctuation">(</span>p<span class="token punctuation">.</span>X<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">float64</span><span class="token punctuation">(</span>p<span class="token punctuation">.</span>Y<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">type</span> Pythagoras <span class="token keyword">interface</span> <span class="token punctuation">{</span>
    <span class="token function">Hypotenuse</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token builtin">float64</span>
<span class="token punctuation">}</span>

<span class="token comment">// This example shows how to encode an interface value. The key</span>
<span class="token comment">// distinction from regular types is to register the concrete type that</span>
<span class="token comment">// implements the interface.</span>
<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> network bytes<span class="token punctuation">.</span>Buffer <span class="token comment">// Stand-in for the network.</span>

    <span class="token comment">// We must register the concrete type for the encoder and decoder (which would</span>
    <span class="token comment">// normally be on a separate machine from the encoder). On each end, this tells the</span>
    <span class="token comment">// engine which concrete type is being sent that implements the interface.</span>
    gob<span class="token punctuation">.</span><span class="token function">Register</span><span class="token punctuation">(</span>Point<span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>

    <span class="token comment">// Create an encoder and send some values.</span>
    enc <span class="token operator">:=</span> gob<span class="token punctuation">.</span><span class="token function">NewEncoder</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>network<span class="token punctuation">)</span>
    <span class="token keyword">for</span> i <span class="token operator">:=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> <span class="token number">3</span><span class="token punctuation">;</span> i<span class="token operator">++</span> <span class="token punctuation">{</span>
        <span class="token comment">//&#x8FD9;&#x91CC;&#x4F20;&#x5165;Point&#x5B9E;&#x4F8B;, &#x4F46;&#x5B9E;&#x9645;&#x4E0A;, &#x8FD9;&#x4E2A;&#x5B9E;&#x4F8B;&#x662F;&#x4F5C;&#x4E3A;Pythagoras&#x63A5;&#x53E3;&#x7C7B;&#x578B;&#x4F20;&#x9012;&#x7684;.</span>
        <span class="token function">interfaceEncode</span><span class="token punctuation">(</span>enc<span class="token punctuation">,</span> Point<span class="token punctuation">{</span><span class="token number">3</span> <span class="token operator">*</span> i<span class="token punctuation">,</span> <span class="token number">4</span> <span class="token operator">*</span> i<span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// Create a decoder and receive some values.</span>
    dec <span class="token operator">:=</span> gob<span class="token punctuation">.</span><span class="token function">NewDecoder</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>network<span class="token punctuation">)</span>
    <span class="token keyword">for</span> i <span class="token operator">:=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> <span class="token number">3</span><span class="token punctuation">;</span> i<span class="token operator">++</span> <span class="token punctuation">{</span>
        result <span class="token operator">:=</span> <span class="token function">interfaceDecode</span><span class="token punctuation">(</span>dec<span class="token punctuation">)</span>
        fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>result<span class="token punctuation">.</span><span class="token function">Hypotenuse</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>

<span class="token comment">// interfaceEncode encodes the interface value into the encoder.</span>
<span class="token keyword">func</span> <span class="token function">interfaceEncode</span><span class="token punctuation">(</span>enc <span class="token operator">*</span>gob<span class="token punctuation">.</span>Encoder<span class="token punctuation">,</span> p Pythagoras<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// The encode will fail unless the concrete type has been</span>
    <span class="token comment">// registered. We registered it in the calling function.</span>

    <span class="token comment">// Pass pointer to interface so Encode sees (and hence sends) a value of</span>
    <span class="token comment">// interface type. If we passed p directly it would see the concrete type instead.</span>
    <span class="token comment">// See the blog post, &quot;The Laws of Reflection&quot; for background.</span>
    err <span class="token operator">:=</span> enc<span class="token punctuation">.</span><span class="token function">Encode</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>p<span class="token punctuation">)</span>
    <span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
        log<span class="token punctuation">.</span><span class="token function">Fatal</span><span class="token punctuation">(</span><span class="token string">&quot;encode:&quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// interfaceDecode decodes the next interface value from the stream and returns it.</span>
<span class="token keyword">func</span> <span class="token function">interfaceDecode</span><span class="token punctuation">(</span>dec <span class="token operator">*</span>gob<span class="token punctuation">.</span>Decoder<span class="token punctuation">)</span> Pythagoras <span class="token punctuation">{</span>
    <span class="token comment">// The decode will fail unless the concrete type on the wire has been</span>
    <span class="token comment">// registered. We registered it in the calling function.</span>
    <span class="token keyword">var</span> p Pythagoras
    err <span class="token operator">:=</span> dec<span class="token punctuation">.</span><span class="token function">Decode</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>p<span class="token punctuation">)</span>
    <span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
        log<span class="token punctuation">.</span><span class="token function">Fatal</span><span class="token punctuation">(</span><span class="token string">&quot;decode:&quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> p
<span class="token punctuation">}</span>
</code></pre>
<h2 id="encodingbinary"><a name="encodingbinary" class="anchor-navigation-ex-anchor" href="#encodingbinary"><i class="fa fa-link" aria-hidden="true"></i></a>8.4. encoding/binary</h2>
<p>binary&#x63D0;&#x4F9B;&#x5BF9;&#x5B57;&#x8282;&#x5E8F;&#x5217;&#x5230;&#x4EFB;&#x610F;&#x683C;&#x5F0F;&#x7684;&#x8F6C;&#x6362;.
&#x6BD4;&#x5982;&#x4E0B;&#x9762;&#x7684;&#x4F8B;&#x5B50;, &#x628A;&#x4E00;&#x4E2A;&#x5B57;&#x8282;&#x5E8F;&#x5217;, &quot;&#x8BFB;&quot;&#x5230;&#x4E00;&#x4E2A;&#x7ED3;&#x6784;&#x4F53;&#x91CC;&#x9762;.</p>
<pre class="language-"><code class="lang-go"><span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    b <span class="token operator">:=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">byte</span><span class="token punctuation">{</span><span class="token number">0x18</span><span class="token punctuation">,</span> <span class="token number">0x2d</span><span class="token punctuation">,</span> <span class="token number">0x44</span><span class="token punctuation">,</span> <span class="token number">0x54</span><span class="token punctuation">,</span> <span class="token number">0xfb</span><span class="token punctuation">,</span> <span class="token number">0x21</span><span class="token punctuation">,</span> <span class="token number">0x09</span><span class="token punctuation">,</span> <span class="token number">0x40</span><span class="token punctuation">,</span> <span class="token number">0xff</span><span class="token punctuation">,</span> <span class="token number">0x01</span><span class="token punctuation">,</span> <span class="token number">0x02</span><span class="token punctuation">,</span> <span class="token number">0x03</span><span class="token punctuation">,</span> <span class="token number">0xbe</span><span class="token punctuation">,</span> <span class="token number">0xef</span><span class="token punctuation">}</span>
    r <span class="token operator">:=</span> bytes<span class="token punctuation">.</span><span class="token function">NewReader</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span>

    <span class="token keyword">var</span> data <span class="token keyword">struct</span> <span class="token punctuation">{</span>
        PI   <span class="token builtin">float64</span>
        Uate <span class="token builtin">uint8</span>
        Mine <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token builtin">byte</span>
        Too  <span class="token builtin">uint16</span>
    <span class="token punctuation">}</span>
    <span class="token comment">//&#x5BF9;&#x5B57;&#x7B26;&#x6570;&#x7EC4;&#x6765;&#x8BF4;, &#x5927;&#x5C0F;&#x7AEF;&#x6CA1;&#x5173;&#x7CFB;. &#x4F46;&#x5BF9;uint16&#x6765;&#x8BF4;, &#x8981;&#x77E5;&#x9053;&#x5927;&#x5C0F;&#x7AEF;&#x624D;&#x77E5;&#x9053;&#x5982;&#x4F55;&#x89E3;&#x8BFB;.</span>
    <span class="token keyword">if</span> err <span class="token operator">:=</span> binary<span class="token punctuation">.</span><span class="token function">Read</span><span class="token punctuation">(</span>r<span class="token punctuation">,</span> binary<span class="token punctuation">.</span>LittleEndian<span class="token punctuation">,</span> <span class="token operator">&amp;</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
        fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;binary.Read failed:&quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>PI<span class="token punctuation">)</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>Uate<span class="token punctuation">)</span>
    fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;% x\n&quot;</span><span class="token punctuation">,</span> data<span class="token punctuation">.</span>Mine<span class="token punctuation">)</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>Too<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">//&#x8F93;&#x51FA;. </span>
<span class="token number">3.141592653589793</span>
<span class="token number">255</span>
<span class="token number">01</span> <span class="token number">02</span> <span class="token number">03</span>
<span class="token number">61374</span>
</code></pre>
<p>&#x4E0B;&#x9762;&#x662F;&#x4E2A;&#x5199;&#x7684;&#x4F8B;&#x5B50;:</p>
<pre class="language-"><code class="lang-go"><span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    buf <span class="token operator">:=</span> <span class="token function">new</span><span class="token punctuation">(</span>bytes<span class="token punctuation">.</span>Buffer<span class="token punctuation">)</span>
    <span class="token keyword">var</span> data <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token keyword">interface</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">{</span>
        <span class="token function">uint16</span><span class="token punctuation">(</span><span class="token number">61374</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token function">int8</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">54</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token function">uint8</span><span class="token punctuation">(</span><span class="token number">254</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">for</span> <span class="token boolean">_</span><span class="token punctuation">,</span> v <span class="token operator">:=</span> <span class="token keyword">range</span> data <span class="token punctuation">{</span>
        err <span class="token operator">:=</span> binary<span class="token punctuation">.</span><span class="token function">Write</span><span class="token punctuation">(</span>buf<span class="token punctuation">,</span> binary<span class="token punctuation">.</span>LittleEndian<span class="token punctuation">,</span> v<span class="token punctuation">)</span>
        <span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
            fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;binary.Write failed:&quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;%x&quot;</span><span class="token punctuation">,</span> buf<span class="token punctuation">.</span><span class="token function">Bytes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre>
<h3 id="varint"><a name="varint" class="anchor-navigation-ex-anchor" href="#varint"><i class="fa fa-link" aria-hidden="true"></i></a>8.4.1. varint</h3>
<p>varint&#x662F;&#x79CD;&#x5BF9;int&#x7684;&#x53D8;&#x957F;&#x5B58;&#x50A8;&#x7B56;&#x7565;, &#x8D8A;&#x5C0F;&#x7684;&#x6570;, &#x7528;&#x8D8A;&#x5C11;&#x7684;&#x5B57;&#x8282;&#x5B58;&#x50A8;.</p>
<h1 id="time"><a name="time" class="anchor-navigation-ex-anchor" href="#time"><i class="fa fa-link" aria-hidden="true"></i></a>9. time</h1>
<p>&#x5E95;&#x5C42;OS&#x4E00;&#x822C;&#x63D0;&#x4F9B;</p>
<ul>
<li>&#x5899;&#x4E0A;(wall clock)&#x65F6;&#x95F4;: &#x7528;&#x6765;&#x62A5;&#x544A;&#x65F6;&#x95F4;, &#x8868;&#x793A;&#x7EDD;&#x5BF9;&#x65F6;&#x95F4;; &#x5899;&#x4E0A;&#x65F6;&#x95F4;&#x53EF;&#x80FD;&#x7531;&#x4E8E;&#x8BBE;&#x5B9A;&#x65F6;&#x95F4;&#x7B49;&#x64CD;&#x4F5C;, &#x9020;&#x6210;&#x8DF3;&#x53D8;.</li>
<li>&#x5355;&#x4E00;(monotonic)&#x65F6;&#x95F4;: &#x7528;&#x6765;&#x6D4B;&#x91CF;&#x65F6;&#x95F4;, &#x8868;&#x793A;&#x76F8;&#x5BF9;&#x65F6;&#x95F4;
time.Now()&#x8FD4;&#x56DE;&#x7684;&#x5C31;&#x662F;Time&#x7C7B;&#x578B;&#x7684;&#x503C;, &#x8FD9;&#x4E2A;&#x503C;&#x65E2;&#x5305;&#x62EC;&#x5899;&#x4E0A;&#x65F6;&#x95F4;, &#x53C8;&#x5305;&#x62EC;&#x5355;&#x4E00;&#x65F6;&#x95F4;.</li>
</ul>
<p>&#x4E0B;&#x9762;&#x7684;&#x4EE3;&#x7801;&#x4FDD;&#x8BC1;&#x5373;&#x4F7F;&#x5899;&#x4E0A;&#x65F6;&#x95F4;&#x8DF3;&#x53D8;&#x4E86;, &#x6BD4;&#x5982;&#x65F6;&#x95F4;&#x88AB;&#x6821;&#x51C6;&#x4E86;, &#x4F46;&#x76F8;&#x5BF9;&#x65F6;&#x95F4;elapsed&#x662F;&#x5B9E;&#x9645;&#x7684;delta&#x65F6;&#x95F4;.</p>
<pre class="language-"><code class="lang-go">start <span class="token operator">:=</span> time<span class="token punctuation">.</span><span class="token function">Now</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token operator">...</span> operation that takes <span class="token number">20</span> milliseconds <span class="token operator">...</span>
t <span class="token operator">:=</span> time<span class="token punctuation">.</span><span class="token function">Now</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
elapsed <span class="token operator">:=</span> t<span class="token punctuation">.</span><span class="token function">Sub</span><span class="token punctuation">(</span>start<span class="token punctuation">)</span>
</code></pre>
<p>&#x5728;api&#x4E2D;, &#x5E94;&#x8BE5;&#x8BF4;&#x6709;&#x76F8;&#x5BF9;&#x6982;&#x5FF5;&#x7684;api, &#x6BD4;&#x5982;Time.sub, Time.before&#x7B49;&#x7B49;, &#x90FD;&#x7528;&#x7684;&#x662F;&#x5355;&#x4E00;&#x65F6;&#x95F4;. 
&#x76F8;&#x5BF9;&#x65F6;&#x95F4;&#x53EA;&#x5BF9;&#x5F53;&#x524D;&#x7684;&#x8FDB;&#x7A0B;&#x6709;&#x6548;.</p>
<h2 id="time_1"><a name="time_1" class="anchor-navigation-ex-anchor" href="#time_1"><i class="fa fa-link" aria-hidden="true"></i></a>9.1. Time</h2>
<p>&#x9996;&#x5148;, Time&#x662F;&#x4E2A;&#x7ED3;&#x6784;&#x4F53;; &#x4F46;&#x5176;&#x5185;&#x90E8;&#x7ED3;&#x6784;&#x5BF9;&#x5916;&#x662F;&#x4E0D;&#x53EF;&#x89C1;&#x7684;. &#x6211;&#x4EEC;&#x77E5;&#x9053;&#x7684;, &#x53EA;&#x662F;Time&#x662F;&#x5BF9;&#x7EDD;&#x5BF9;&#x65F6;&#x95F4;&#x7684;&#x8868;&#x8FBE;, &#x7CBE;&#x5EA6;&#x662F;ns
Time&#x662F;&#x503C;, &#x4E0D;&#x662F;&#x6307;&#x9488;.
Time&#x7684;0&#x503C;&#x662F;1&#x5E74;1&#x6708;1&#x53F7;0&#x70B9;
&#x6BD4;&#x8F83;&#x7B26;&#x53F7;==&#x53EF;&#x4EE5;&#x6BD4;&#x8F83;&#x4E24;&#x4E2A;Time, &#x4F46;&#x63A8;&#x8350;&#x7528;t1.Equal(t2), &#x540E;&#x8005;&#x66F4;&#x7CBE;&#x786E;.</p>
<pre class="language-"><code class="lang-go"><span class="token keyword">type</span> Time <span class="token keyword">struct</span> <span class="token punctuation">{</span>
    <span class="token comment">// contains filtered or unexported fields</span>
<span class="token punctuation">}</span>
</code></pre>
<p>Time&#x6709;&#x5982;&#x4E0B;&#x65B9;&#x6CD5;:
<code>func Date(year int, month Month, day, hour, min, sec, nsec int, loc *Location) Time</code>
&#x6BD4;&#x5982;: <code>t := time.Date(2009, time.November, 10, 23, 0, 0, 0, time.UTC)</code>, &#x8FD9;&#x6837;&#x521D;&#x59CB;&#x5316;&#x4E00;&#x4E2A;time
&#x6709;Now(), &#x6709;&#x4ECE;&#x5B57;&#x7B26;&#x4E32;&#x89E3;&#x6790;&#x65F6;&#x95F4;&#x7684;Parse()&#x65B9;&#x6CD5;.
&#x6709;Add(), After(), Before()
&#x8FD8;&#x6709;&#x7ED9;&#x5B9A;Time t, &#x6709;&#x89E3;&#x6790;&#x5230;Date, Day&#x7684;&#x65B9;&#x6CD5;
&#x6BD4;&#x5982;:</p>
<pre class="language-"><code class="lang-go">    d <span class="token operator">:=</span> time<span class="token punctuation">.</span><span class="token function">Date</span><span class="token punctuation">(</span><span class="token number">2000</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> time<span class="token punctuation">.</span>UTC<span class="token punctuation">)</span>
    year<span class="token punctuation">,</span> month<span class="token punctuation">,</span> day <span class="token operator">:=</span> d<span class="token punctuation">.</span><span class="token function">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

    fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;year = %v\n&quot;</span><span class="token punctuation">,</span> year<span class="token punctuation">)</span>
    fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;month = %v\n&quot;</span><span class="token punctuation">,</span> month<span class="token punctuation">)</span>
    fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;day = %v\n&quot;</span><span class="token punctuation">,</span> day<span class="token punctuation">)</span>
</code></pre>
<p>&#x8FD8;&#x6709;&#x628A;Time&#x8F6C;&#x4E3A;json&#x683C;&#x5F0F;&#x7684;&#x65B9;&#x6CD5;.</p>
<h2 id="&#x65F6;&#x95F4;&#x683C;&#x5F0F;&#x548C;&#x5355;&#x4F4D;"><a name="&#x65F6;&#x95F4;&#x683C;&#x5F0F;&#x548C;&#x5355;&#x4F4D;" class="anchor-navigation-ex-anchor" href="#&#x65F6;&#x95F4;&#x683C;&#x5F0F;&#x548C;&#x5355;&#x4F4D;"><i class="fa fa-link" aria-hidden="true"></i></a>9.2. &#x65F6;&#x95F4;&#x683C;&#x5F0F;&#x548C;&#x5355;&#x4F4D;</h2>
<pre class="language-"><code class="lang-go"><span class="token keyword">const</span> <span class="token punctuation">(</span>
    ANSIC <span class="token operator">=</span> <span class="token string">&quot;Mon Jan _2 15:04:05 2006&quot;</span>
    UnixDate <span class="token operator">=</span> <span class="token string">&quot;Mon Jan _2 15:04:05 MST 2006&quot;</span>
    RubyDate <span class="token operator">=</span> <span class="token string">&quot;Mon Jan 02 15:04:05 -0700 2006&quot;</span>
    RFC822 <span class="token operator">=</span> <span class="token string">&quot;02 Jan 06 15:04 MST&quot;</span>
    RFC822Z <span class="token operator">=</span> <span class="token string">&quot;02 Jan 06 15:04 -0700&quot;</span> <span class="token comment">// RFC822 with numeric zone</span>
    RFC850 <span class="token operator">=</span> <span class="token string">&quot;Monday, 02-Jan-06 15:04:05 MST&quot;</span>
    RFC1123 <span class="token operator">=</span> <span class="token string">&quot;Mon, 02 Jan 2006 15:04:05 MST&quot;</span>
    RFC1123Z <span class="token operator">=</span> <span class="token string">&quot;Mon, 02 Jan 2006 15:04:05 -0700&quot;</span> <span class="token comment">// RFC1123 with numeric zone</span>
    RFC3339 <span class="token operator">=</span> <span class="token string">&quot;2006-01-02T15:04:05Z07:00&quot;</span>
    RFC3339Nano <span class="token operator">=</span> <span class="token string">&quot;2006-01-02T15:04:05.999999999Z07:00&quot;</span>
    Kitchen <span class="token operator">=</span> <span class="token string">&quot;3:04PM&quot;</span>
    <span class="token comment">// Handy time stamps.</span>
    Stamp <span class="token operator">=</span> <span class="token string">&quot;Jan _2 15:04:05&quot;</span>
    StampMilli <span class="token operator">=</span> <span class="token string">&quot;Jan _2 15:04:05.000&quot;</span>
    StampMicro <span class="token operator">=</span> <span class="token string">&quot;Jan _2 15:04:05.000000&quot;</span>
    StampNano <span class="token operator">=</span> <span class="token string">&quot;Jan _2 15:04:05.000000000&quot;</span>
<span class="token punctuation">)</span>

<span class="token comment">//&#x8FD9;&#x4E9B;&#x65F6;&#x95F4;&#x90FD;&#x662F;&#x4EE5;ns&#x4E3A;&#x5355;&#x4F4D;&#x7684;</span>
<span class="token keyword">const</span> <span class="token punctuation">(</span>
    Nanosecond Duration <span class="token operator">=</span> <span class="token number">1</span>
    Microsecond <span class="token operator">=</span> <span class="token number">1000</span> <span class="token operator">*</span> Nanosecond
    Millisecond <span class="token operator">=</span> <span class="token number">1000</span> <span class="token operator">*</span> Microsecond
    Second <span class="token operator">=</span> <span class="token number">1000</span> <span class="token operator">*</span> Millisecond
    Minute <span class="token operator">=</span> <span class="token number">60</span> <span class="token operator">*</span> Second
    Hour <span class="token operator">=</span> <span class="token number">60</span> <span class="token operator">*</span> Minute
<span class="token punctuation">)</span>
</code></pre>
<h2 id="duration"><a name="duration" class="anchor-navigation-ex-anchor" href="#duration"><i class="fa fa-link" aria-hidden="true"></i></a>9.3. Duration</h2>
<p>Duration&#x662F;&#x4E2A;&#x65F6;&#x95F4;delta, <code>type Duration int64</code>, &#x65F6;&#x95F4;&#x5355;&#x4F4D;&#x662F;ns, &#x662F;64&#x4F4D;&#x7684;int, &#x6700;&#x5927;&#x80FD;&#x8868;&#x793A;290&#x5E74;.
&#x6BD4;&#x5982;</p>
<pre class="language-"><code class="lang-go">t0 <span class="token operator">:=</span> time<span class="token punctuation">.</span><span class="token function">Now</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token function">expensiveCall</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
t1 <span class="token operator">:=</span> time<span class="token punctuation">.</span><span class="token function">Now</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;The call took %v to run.\n&quot;</span><span class="token punctuation">,</span> t1<span class="token punctuation">.</span><span class="token function">Sub</span><span class="token punctuation">(</span>t0<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre>
<p>Duration&#x7684;&#x503C;&#x6709;&#x51E0;&#x4E2A;&#x65B9;&#x6CD5;, &#x6BD4;&#x5982; d Duration, d.Hours, d.Senconds&#x7B49;, &#x628A;Duration&#x8F6C;&#x6362;&#x4E3A;&#x76F8;&#x5E94;&#x7684;&#x5355;&#x4F4D;.&#x5176;String&#x65B9;&#x6CD5;&#x8FD4;&#x56DE;&#x7C7B;&#x4F3C;&#x7684;&#x5B57;&#x7B26;&#x4E32;:  &quot;72h3m0.5s&quot;</p>
<h2 id="api_2"><a name="api_2" class="anchor-navigation-ex-anchor" href="#api_2"><i class="fa fa-link" aria-hidden="true"></i></a>9.4. api</h2>
<p><code>func Now() Time</code> : &#x8FD4;&#x56DE;&#x5F53;&#x524D;local&#x65F6;&#x95F4;
<code>func After(d Duration) &lt;-chan Time</code> : &#x63D0;&#x4F9B;&#x4E00;&#x4E2A;&#x7B80;&#x5355;&#x7684;&#x8D85;&#x65F6;&#x673A;&#x5236;, &#x5B83;&#x8FD4;&#x56DE;&#x4E00;&#x4E2A;channel, &#x8D85;&#x65F6;&#x540E;&#x53EF;&#x8BFB;. &#x8D85;&#x65F6;&#x540E;&#x53EF;&#x4EE5;&#x88AB;&#x5783;&#x573E;&#x56DE;&#x6536;. </p>
<pre class="language-"><code class="lang-go"><span class="token keyword">var</span> c <span class="token keyword">chan</span> <span class="token builtin">int</span>

<span class="token keyword">func</span> <span class="token function">handle</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">select</span> <span class="token punctuation">{</span>
    <span class="token keyword">case</span> m <span class="token operator">:=</span> <span class="token operator">&lt;-</span>c<span class="token punctuation">:</span>
        <span class="token function">handle</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span>
    <span class="token keyword">case</span> <span class="token operator">&lt;-</span>time<span class="token punctuation">.</span><span class="token function">After</span><span class="token punctuation">(</span><span class="token number">10</span> <span class="token operator">*</span> time<span class="token punctuation">.</span>Second<span class="token punctuation">)</span><span class="token punctuation">:</span>
        fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;timed out&quot;</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p><code>time.Sleep(100 * time.Millisecond)</code> : sleep
<code>time.Tick</code> &#x8FD4;&#x56DE;&#x4E00;&#x4E2A;channel, &#x8FD9;&#x4E2A;channel&#x4E0D;&#x4F1A;close, &#x4E00;&#x76F4;&#x80FD;&#x8BFB;&#x5230;Time, &#x5B83;&#x662F;&#x5BF9;NewTicker&#x7684;&#x5C01;&#x88C5;
&#x6BD4;&#x5982;&#x4E0B;&#x9762;&#x7684;&#x4EE3;&#x7801;&#x4E00;&#x76F4;&#x4F1A;&#x6253;&#x5370;, &#x6BCF;5&#x79D2;&#x4E00;&#x6B21;. &#x8FD9;&#x4E2A;&#x662F;&#x4E0D;&#x662F;&#x548C;while 1&#x91CC;&#x9762;sleep&#x5DEE;&#x4E0D;&#x591A;.</p>
<pre class="language-"><code class="lang-go"><span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    c <span class="token operator">:=</span> time<span class="token punctuation">.</span><span class="token function">Tick</span><span class="token punctuation">(</span><span class="token number">5</span> <span class="token operator">*</span> time<span class="token punctuation">.</span>Second<span class="token punctuation">)</span>
    <span class="token keyword">for</span> now <span class="token operator">:=</span> <span class="token keyword">range</span> c <span class="token punctuation">{</span>
        fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;%v %s\n&quot;</span><span class="token punctuation">,</span> now<span class="token punctuation">,</span> <span class="token function">statusUpdate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p><code>func Since(t Time) Duration</code> : &#x548C;<code>time.Now().Sub(t)</code>&#x4E00;&#x6837;. &#x4ECE;t&#x5230;&#x73B0;&#x5728;&#x7684;Duration</p>
<h2 id="ticker"><a name="ticker" class="anchor-navigation-ex-anchor" href="#ticker"><i class="fa fa-link" aria-hidden="true"></i></a>9.5. Ticker</h2>
<pre class="language-"><code class="lang-go"><span class="token keyword">type</span> Ticker <span class="token keyword">struct</span> <span class="token punctuation">{</span>
    <span class="token comment">//C&#x662F;&#x7ED9;&#x5916;&#x90E8;&#x7528;&#x7684;channel</span>
    C <span class="token operator">&lt;-</span><span class="token keyword">chan</span> Time <span class="token comment">// The channel on which the ticks are delivered.</span>
    <span class="token comment">// contains filtered or unexported fields</span>
<span class="token punctuation">}</span>
</code></pre>
<p>&#x4F7F;&#x7528;<code>func NewTicker(d Duration) *Ticker</code>&#x6765;&#x83B7;&#x5F97;&#x4E00;&#x4E2A;Ticker&#x5B9E;&#x4F8B;
Ticker&#x662F;&#x5468;&#x671F;&#x7684;tick, &#x6709;NewTicker(), Stop()&#x7B49;&#x65B9;&#x6CD5;.</p>
<h2 id="timer"><a name="timer" class="anchor-navigation-ex-anchor" href="#timer"><i class="fa fa-link" aria-hidden="true"></i></a>9.6. Timer</h2>
<pre class="language-"><code class="lang-go"><span class="token keyword">type</span> Timer <span class="token keyword">struct</span> <span class="token punctuation">{</span>
    <span class="token comment">//&#x5916;&#x90E8;&#x53EF;&#x4EE5;&#x7528;C&#x8FD9;&#x4E2A;channel</span>
    C <span class="token operator">&lt;-</span><span class="token keyword">chan</span> Time
    <span class="token comment">// contains filtered or unexported fields</span>
<span class="token punctuation">}</span>
</code></pre>
<p>&#x4F7F;&#x7528;<code>func NewTimer(d Duration) *Timer</code>&#x5148;&#x751F;&#x6210;&#x4E00;&#x4E2A;Timer&#x5BF9;&#x8C61;
&#x548C;Ticker&#x4E0D;&#x540C;&#x7684;&#x662F;, Timer&#x662F;&#x4E00;&#x6B21;&#x6027;&#x7684;&#x4E8B;&#x4EF6;. &#x6709;NewTimer() Stop&#x7B49;&#x65B9;&#x6CD5;.</p>
<h1 id="context"><a name="context" class="anchor-navigation-ex-anchor" href="#context"><i class="fa fa-link" aria-hidden="true"></i></a>10. context</h1>
<pre class="language-"><code class="lang-go"><span class="token comment">//Context&#x662F;&#x4E2A;interface</span>
<span class="token keyword">type</span> Context <span class="token keyword">interface</span> <span class="token punctuation">{</span>
    <span class="token function">Deadline</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>deadline time<span class="token punctuation">.</span>Time<span class="token punctuation">,</span> ok <span class="token builtin">bool</span><span class="token punctuation">)</span>
    <span class="token comment">//&#x8FD9;&#x662F;&#x4E2A;&#x7A7A;&#x7ED3;&#x6784;&#x4F53;&#x7684;channel</span>
    <span class="token function">Done</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;-</span><span class="token keyword">chan</span> <span class="token keyword">struct</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token function">Err</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token builtin">error</span>
    <span class="token function">Value</span><span class="token punctuation">(</span>key <span class="token keyword">interface</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token keyword">interface</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p>&#x987E;&#x540D;&#x601D;&#x4E49;, &#x4E0A;&#x4E0B;&#x6587;. &#x63D0;&#x4F9B;&#x901A;&#x7528;&#x7684;deadline, cancel&#x7B49;API, &#x7528;&#x4E8E;&#x591A;&#x4E2A;go routine&#x4E4B;&#x95F4;&#x534F;&#x4F5C;&#x7684;.
context&#x4E0D;&#x5E94;&#x8BE5;&#x88AB;&#x5305;&#x542B;&#x5728;&#x4EFB;&#x4F55;struct&#x91CC;, &#x800C;&#x662F;&#x5E94;&#x8BE5;&#x76F4;&#x63A5;&#x4F20;&#x5165;&#x51FD;&#x6570;, &#x901A;&#x5E38;&#x5E94;&#x8BE5;&#x662F;&#x7B2C;&#x4E00;&#x4E2A;&#x53C2;&#x6570;, &#x53EB;ctx.
&#x4E00;&#x4E2A;context&#x53EF;&#x80FD;&#x4F1A;&#x88AB;&#x591A;&#x4E2A;go routine&#x4F7F;&#x7528;, context&#x4FDD;&#x8BC1;&#x5E76;&#x53D1;&#x5B89;&#x5168;.
context&#x5BF9;&#x8C61;&#x90FD;&#x6709;&#x4E2A;Done()&#x65B9;&#x6CD5;, &#x8FD4;&#x56DE;&#x4E00;&#x4E2A;channel. &#x8BFB;&#x8FD9;&#x4E2A;channel&#x5C31;&#x77E5;&#x9053;&#x662F;&#x5426;&#x6709;&#x4EBA;&#x6216;&#x6709;&#x4E8B;&#x4EF6;&#x901A;&#x77E5;&#x6211;&#x4EEC;&#x8BE5;&#x7ED3;&#x675F;&#x4E86;.</p>
<p>&#x901A;&#x5E38;&#x5728;&#x670D;&#x52A1;&#x7AEF;&#x6536;&#x5230;&#x4E00;&#x4E2A;request&#x65F6;, &#x4F1A;&#x65B0;&#x5F00;&#x4E00;&#x4E2A;goroutine&#x6765;&#x54CD;&#x5E94;&#x8FD9;&#x4E2A;&#x8BF7;&#x6C42;, &#x6211;&#x4EEC;&#x79F0;&#x5176;&#x4E3A;&#x8FD9;&#x4E2A;&#x8BF7;&#x6C42;&#x7684;&#x4E3B;routine;&#x901A;&#x5E38;&#x8FD9;&#x4E2A;&#x4E3B;routine&#x4F1A;&#x518D;&#x5F00;&#x5176;&#x4ED6;&#x7684;goroutine&#x7528;&#x6765;&#x8BBF;&#x95EE;&#x6570;&#x636E;&#x5E93;&#x6216;&#x8005;&#x5176;&#x4ED6;RPC&#x670D;&#x52A1;, &#x8FD9;&#x4E9B;&#x5B50;routine&#x90FD;&#x4F1A;&#x7528;&#x5230;request&#x7684;&#x76F8;&#x5173;user&#x7684;token&#x7B49;&#x8EAB;&#x4EFD;&#x6570;&#x636E;. &#x5F53;&#x4E3B;routine&#x8BA4;&#x4E3A;&#x8D85;&#x65F6;&#x7684;&#x65F6;&#x5019;, &#x8FD9;&#x4E9B;&#x5B50;routine&#x5E94;&#x8BE5;&#x5C3D;&#x5FEB;&#x7ED3;&#x675F;.</p>
<p>&#x6240;&#x4EE5;&#x662F;&#x4E3B;routine&#x521B;&#x5EFA;Context, &#x8BBE;&#x7F6E;&#x8D85;&#x65F6;&#x65F6;&#x95F4;, &#x628A;Context&#x4F20;&#x5165;&#x6BCF;&#x4E2A;&#x5B50;routine; &#x4E3B;routine&#x68C0;&#x6D4B;&#x5230;&#x8D85;&#x65F6;, &#x4F1A;&#x8C03;&#x7528;Context&#x7684;Cancel&#x51FD;&#x6570;, &#x89E6;&#x53D1;Done&#x7684;&#x901A;&#x9053;&#x5173;&#x95ED;; &#x5B50;routine&#x9700;&#x8981;&#x5728;&#x4EE3;&#x7801;&#x91CC;&#x68C0;&#x6D4B;Done&#x901A;&#x9053;, &#x5982;&#x679C;&#x5173;&#x95ED;&#x4E86;&#x5C31;&#x9A6C;&#x4E0A;&#x9000;&#x51FA;.</p>
<p>&#x8FD9;&#x662F;&#x4E00;&#x79CD;&#x4E3B;routine&quot;&#x901A;&#x77E5;&quot;&#x5B50;routine&#x9000;&#x51FA;&#x7684;&#x65B9;&#x6CD5;.</p>
<h2 id="api_3"><a name="api_3" class="anchor-navigation-ex-anchor" href="#api_3"><i class="fa fa-link" aria-hidden="true"></i></a>10.1. api</h2>
<p><code>func Background() Context</code> : &#x8FD4;&#x56DE;&#x4E00;&#x4E2A;&#x7A7A;&#x7684;ctx&#x53D8;&#x91CF;</p>
<h3 id="&#x6574;&#x6570;&#x53D1;&#x751F;&#x5668;-generator"><a name="&#x6574;&#x6570;&#x53D1;&#x751F;&#x5668;-generator" class="anchor-navigation-ex-anchor" href="#&#x6574;&#x6570;&#x53D1;&#x751F;&#x5668;-generator"><i class="fa fa-link" aria-hidden="true"></i></a>10.1.1. &#x6574;&#x6570;&#x53D1;&#x751F;&#x5668; generator</h3>
<p><code>func WithCancel(parent Context) (ctx Context, cancel CancelFunc)</code>
&#x8FD4;&#x56DE;&#x4E00;&#x4E2A;Context&#x53D8;&#x91CF;ctx, ctx&#x6709;&#x4E2A;Done&#x7684;channel
&#x8FD4;&#x56DE;&#x7684;&#x7B2C;&#x4E8C;&#x4E2A;&#x503C;&#x662F;CancelFunc&#x51FD;&#x6570;, &#x7528;&#x4E8E;&#x5173;&#x95ED;ctx.Done</p>
<hr>
<p>&#x4E3E;&#x4F8B;: &#x4E0B;&#x9762;&#x7684;&#x4F8B;&#x5B50;, main&#x8C03;&#x7528;gen(), &#x540E;&#x8005;&#x8FD4;&#x56DE;&#x4E2A;channel, &#x5E76;&#x8D77;&#x4E2A; go routine&#x4E0D;&#x65AD;&#x7684;&#x4EA7;&#x751F;&#x6574;&#x6570;, &#x5199;&#x5165;&#x8FD9;&#x4E2A;channel.
&#x8FD9;&#x4E2A;go routine&#x8FD8;&#x76D1;&#x89C6;<code>ctx.Done()</code>, &#x8FD9;&#x662F;ctx&#x63D0;&#x4F9B;&#x7684;channel, &#x80FD;&#x8BFB;&#x5230;&#x4E1C;&#x897F;&#x8BF4;&#x660E;&#x522B;&#x4EBA;&#x544A;&#x8BC9;&#x4ED6;&#x4E8B;&#x60C5;&#x505A;&#x5B8C;&#x4E86;.</p>
<pre class="language-"><code class="lang-go"><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
    <span class="token string">&quot;context&quot;</span>
    <span class="token string">&quot;fmt&quot;</span>
<span class="token punctuation">)</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// gen generates integers in a separate goroutine and</span>
    <span class="token comment">// sends them to the returned channel.</span>
    <span class="token comment">// The callers of gen need to cancel the context once</span>
    <span class="token comment">// they are done consuming generated integers not to leak</span>
    <span class="token comment">// the internal goroutine started by gen.</span>
    gen <span class="token operator">:=</span> <span class="token keyword">func</span><span class="token punctuation">(</span>ctx context<span class="token punctuation">.</span>Context<span class="token punctuation">)</span> <span class="token operator">&lt;-</span><span class="token keyword">chan</span> <span class="token builtin">int</span> <span class="token punctuation">{</span>
        dst <span class="token operator">:=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token keyword">chan</span> <span class="token builtin">int</span><span class="token punctuation">)</span>
        n <span class="token operator">:=</span> <span class="token number">1</span>
        <span class="token keyword">go</span> <span class="token keyword">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">for</span> <span class="token punctuation">{</span>
                <span class="token keyword">select</span> <span class="token punctuation">{</span>
                <span class="token keyword">case</span> <span class="token operator">&lt;-</span>ctx<span class="token punctuation">.</span><span class="token function">Done</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                    <span class="token keyword">return</span> <span class="token comment">// returning not to leak the goroutine</span>
                <span class="token keyword">case</span> dst <span class="token operator">&lt;-</span> n<span class="token punctuation">:</span>
                    n<span class="token operator">++</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token comment">//&#x8FD9;&#x91CC;return&#x8FD9;&#x4E2A;channel&#x548C;&#x4E0A;&#x9762;&#x7684;go routine&#x662F;&#x5E76;&#x884C;&#x7684;.</span>
        <span class="token keyword">return</span> dst
    <span class="token punctuation">}</span>

    <span class="token comment">//Background&#x65B9;&#x6CD5;&#x8FD4;&#x56DE;&#x4E00;&#x4E2A;&#x7A7A;&#x7684;context&#x53D8;&#x91CF;</span>
    ctx<span class="token punctuation">,</span> cancel <span class="token operator">:=</span> context<span class="token punctuation">.</span><span class="token function">WithCancel</span><span class="token punctuation">(</span>context<span class="token punctuation">.</span><span class="token function">Background</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token comment">//&#x5728;&#x672C;&#x5C42;&#x51FD;&#x6570;&#x8FD4;&#x56DE;&#x524D;, &#x8C03;&#x7528;cancel</span>
    <span class="token keyword">defer</span> <span class="token function">cancel</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// cancel when we are finished consuming integers</span>

    <span class="token comment">//&#x56E0;&#x4E3A;gen&#x8FD4;&#x56DE;&#x7684;&#x662F;channel, &#x7528;range&#x4E0D;&#x65AD;&#x7684;&#x8BFB;&#x53D6;&#x8FD9;&#x4E2A;channel&#x7684;&#x503C;. &#x6CA1;&#x6709;&#x503C;&#x5C31;&#x963B;&#x585E;</span>
    <span class="token comment">//gen&#x7684;go routine&#x4E0D;&#x65AD;&#x4EA7;&#x751F;int&#x7ED9;&#x8FD9;&#x4E2A;channel</span>
    <span class="token keyword">for</span> n <span class="token operator">:=</span> <span class="token keyword">range</span> <span class="token function">gen</span><span class="token punctuation">(</span>ctx<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span>
        <span class="token keyword">if</span> n <span class="token operator">==</span> <span class="token number">5</span> <span class="token punctuation">{</span>
            <span class="token keyword">break</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token comment">//&#x5230;&#x8FD9;&#x91CC;cancel&#x88AB;&#x8C03;&#x7528;, &#x628A;ctx&#x7684;channel&#x5173;&#x95ED;. &#x6240;&#x4EE5;gen&#x7684;goroutine&#x4F1A;&#x6536;&#x5230;Done, select&#x9000;&#x51FA;, for&#x9000;&#x51FA;, goroutine&#x9000;&#x51FA;</span>
    <span class="token comment">//&#x6548;&#x679C;&#x662F;: gen&#x7684;goroutine&#x968F;&#x7740;main&#x7684;&#x6267;&#x884C;&#x5B8C;&#x6BD5;&#x800C;&#x9000;&#x51FA;, &#x4E0D;&#x4F1A;&#x4E00;&#x76F4;&#x8FD0;&#x884C;.</span>
<span class="token punctuation">}</span>
</code></pre>
<p>Context&#x9002;&#x5408;&#x7528;&#x4E8E;main&#x901A;&#x77E5;&#x5B50;routine&#x7ED3;&#x675F;; &#x800C;WaitGroup&#x673A;&#x5236;&#x662F;&#x5B50;routine&#x901A;&#x77E5;main&#x5B8C;&#x6210;, main&#x53EF;&#x4EE5;&#x7ED3;&#x675F;&#x7B49;&#x5F85;.</p>
<h3 id="&#x5E26;&#x8D85;&#x65F6;&#x7684;context"><a name="&#x5E26;&#x8D85;&#x65F6;&#x7684;context" class="anchor-navigation-ex-anchor" href="#&#x5E26;&#x8D85;&#x65F6;&#x7684;context"><i class="fa fa-link" aria-hidden="true"></i></a>10.1.2. &#x5E26;&#x8D85;&#x65F6;&#x7684;Context</h3>
<p><code>func WithDeadline(parent Context, d time.Time) (Context, CancelFunc)</code>
&#x548C;WithCancel&#x7C7B;&#x4F3C;, &#x8FD4;&#x56DE;&#x4E00;&#x4E2A;&#x4EE5;time.Time&#x4E3A;deadline&#x7684;ctx. &#x5982;&#x679C;&#x65F6;&#x95F4;&#x5230;&#x4E86;, &#x6216;&#x8005;ctx&#x7684;CancelFunc&#x88AB;&#x8C03;&#x7528;&#x4E86;, &#x6216;&#x8005;&#x8FD9;&#x4E2A;Done channel&#x672C;&#x8EAB;&#x88AB;close&#x4E86;, &#x90A3;&#x8FD9;&#x4E2A;ctx&#x7684;Done channel&#x4F1A;close.</p>
<hr>
<p>&#x4E3E;&#x4F8B;: &#x4E0B;&#x9762;&#x7684;&#x4F8B;&#x5B50;&#x8BBE;&#x7F6E;&#x8D85;&#x65F6;&#x65F6;&#x95F4;d&#x4E3A;&#x73B0;&#x5728;&#x5F00;&#x59CB;&#x540E;50ms, &#x5E76;&#x4EE5;d&#x521D;&#x59CB;&#x5316;ctx. 
&#x7136;&#x540E;&#x7528;defer&#x5173;&#x952E;&#x8BCD;&#x6267;&#x884C;<code>cancel()</code>. &#x6CE8;&#x610F;, &#x4E0D;&#x7BA1;&#x54EA;&#x79CD;&#x60C5;&#x51B5;, &#x5728;&#x51FD;&#x6570;&#x9000;&#x51FA;&#x7684;&#x65F6;&#x5019;&#x6267;&#x884C;cancel&#x90FD;&#x662F;&#x6CA1;&#x574F;&#x5904;&#x7684;.
&#x7136;&#x540E;select&#x4F1A;&#x963B;&#x585E;, &#x7B49;1&#x79D2;&#x6216;&#x8005;&#x662F;&#x7B49;&#x8D85;&#x65F6;, &#x5F88;&#x660E;&#x663E;, &#x662F;&#x8D85;&#x65F6;.</p>
<pre class="language-"><code class="lang-go"><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
    <span class="token string">&quot;context&quot;</span>
    <span class="token string">&quot;fmt&quot;</span>
    <span class="token string">&quot;time&quot;</span>
<span class="token punctuation">)</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    d <span class="token operator">:=</span> time<span class="token punctuation">.</span><span class="token function">Now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token number">50</span> <span class="token operator">*</span> time<span class="token punctuation">.</span>Millisecond<span class="token punctuation">)</span>
    ctx<span class="token punctuation">,</span> cancel <span class="token operator">:=</span> context<span class="token punctuation">.</span><span class="token function">WithDeadline</span><span class="token punctuation">(</span>context<span class="token punctuation">.</span><span class="token function">Background</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> d<span class="token punctuation">)</span>

    <span class="token comment">// Even though ctx will be expired, it is good practice to call its</span>
    <span class="token comment">// cancellation function in any case. Failure to do so may keep the</span>
    <span class="token comment">// context and its parent alive longer than necessary.</span>
    <span class="token keyword">defer</span> <span class="token function">cancel</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token keyword">select</span> <span class="token punctuation">{</span>
    <span class="token keyword">case</span> <span class="token operator">&lt;-</span>time<span class="token punctuation">.</span><span class="token function">After</span><span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">*</span> time<span class="token punctuation">.</span>Second<span class="token punctuation">)</span><span class="token punctuation">:</span>
        fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;overslept&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">case</span> <span class="token operator">&lt;-</span>ctx<span class="token punctuation">.</span><span class="token function">Done</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>ctx<span class="token punctuation">.</span><span class="token function">Err</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">//context deadline exceeded</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p>&#x601D;&#x8003;: &#x5982;&#x679C;&#x662F;&#x7528;c&#x5199;&#x4E00;&#x4E2A;&#x5E26;&#x8D85;&#x65F6;&#x7684;&#x7B49;&#x5F85;, &#x8BE5;&#x600E;&#x4E48;&#x5199;&#x5462;?</p>
<p>WithTimeout&#x65B9;&#x6CD5;&#x662F;WithDeadline&#x7684;&#x7B80;&#x5316;&#x7248;: &#x5373;WithTimeout = <code>WithDeadline(parent, time.Now().Add(timeout))</code></p>
<h1 id="syscall"><a name="syscall" class="anchor-navigation-ex-anchor" href="#syscall"><i class="fa fa-link" aria-hidden="true"></i></a>11. syscall</h1>
<p>syscall&#x5305;&#x88C5;&#x4E86;&#x5F88;&#x591A;&#x5E95;&#x5C42;OS&#x7CFB;&#x7EDF;&#x8C03;&#x7528;
&#x4F46;&#x53EA;&#x6709;&#x4E00;&#x90E8;&#x5206;? &#x6BD4;&#x5982;&#x6CA1;&#x6709;ioctl?</p>
<h1 id="runtime"><a name="runtime" class="anchor-navigation-ex-anchor" href="#runtime"><i class="fa fa-link" aria-hidden="true"></i></a>12. runtime</h1>
<p>runtime&#x5305;&#x63D0;&#x4F9B;&#x5BF9;go&#x7684;runtime&#x7CFB;&#x7EDF;&#x8BBF;&#x95EE;&#x7684;&#x529F;&#x80FD;</p>
<h2 id="runtime&#x76F8;&#x5173;&#x7684;&#x73AF;&#x5883;&#x53D8;&#x91CF;"><a name="runtime&#x76F8;&#x5173;&#x7684;&#x73AF;&#x5883;&#x53D8;&#x91CF;" class="anchor-navigation-ex-anchor" href="#runtime&#x76F8;&#x5173;&#x7684;&#x73AF;&#x5883;&#x53D8;&#x91CF;"><i class="fa fa-link" aria-hidden="true"></i></a>12.1. runtime&#x76F8;&#x5173;&#x7684;&#x73AF;&#x5883;&#x53D8;&#x91CF;</h2>
<ul>
<li><p>GOGC: &#x65B0;&#x5206;&#x914D;&#x6570;&#x636E;&#x548C;&#x8001;&#x6570;&#x636E;&#x7684;&#x6BD4;&#x7387;. &#x9ED8;&#x8BA4;&#x662F;100. &#x5373;&#x65B0;&#x8001;&#x6570;&#x636E;&#x4E00;&#x6837;&#x591A;&#x7684;&#x65F6;&#x5019;, &#x89E6;&#x53D1;&#x4E00;&#x6B21;&#x5783;&#x573E;&#x56DE;&#x6536;.<br>&#x8FD9;&#x4E2A;&#x6BD4;&#x7387;&#x8D8A;&#x5927;, gc&#x88AB;&#x89E6;&#x53D1;&#x6B21;&#x6570;&#x8D8A;&#x5C11;, &#x6BD4;&#x5982;&#x8BF4;&#x8C03;&#x9AD8;&#x5230;500
SetGCPercent&#x51FD;&#x6570;&#x548C;GOGC&#x73AF;&#x5883;&#x53D8;&#x91CF;&#x4F5C;&#x7528;&#x4E00;&#x6837;, &#x4F46;&#x53EF;&#x4EE5;&#x5728;&#x8FD0;&#x884C;&#x65F6;&#x8C03;&#x7528;.</p>
</li>
<li><p>GODEBUG: &#x91CC;&#x9762;&#x6709;&#x63A7;&#x5236;&#x76F8;&#x5173;&#x6A21;&#x5757;&#x7684;debug&#x7684;&#x5F00;&#x5173;, &#x6BD4;&#x5982; gc, cgo, &#x8C03;&#x5EA6;, &#x5185;&#x5B58;&#x5206;&#x6790;&#x7B49;.<br>&#x89C1;&#x7B14;&#x8BB0;go&#x8C03;&#x8BD5;
<code>GODEBUG=schedtrace=10000,scheddetail=1</code></p>
</li>
<li><p>GOMAXPROCS: &#x63A7;&#x5236;&#x591A;&#x5C11;&#x4E2A;goroutine&#x53EF;&#x4EE5;&#x5E76;&#x884C;&#x8DD1;</p>
</li>
<li>&#x53E6;&#x5916;&#x8FD8;&#x6709;&#x5173;&#x4E8E;&#x8C03;&#x7528;&#x6808;&#x7684;, &#x5173;&#x4E8E;&#x7ADE;&#x4E89;&#x7684;&#x73AF;&#x5883;&#x53D8;&#x91CF;</li>
</ul>
<h2 id="api_4"><a name="api_4" class="anchor-navigation-ex-anchor" href="#api_4"><i class="fa fa-link" aria-hidden="true"></i></a>12.2. api</h2>
<p>runtime&#x5F88;&#x5F3A;&#x5927;, &#x5B83;&#x66B4;&#x9732;&#x4E86;&#x5F88;&#x591A;go&#x7684;&#x7EC6;&#x8282;. &#x6BD4;&#x5982;</p>
<pre class="language-"><code class="lang-go">#&#x6267;&#x884C;&#x65AD;&#x70B9;
<span class="token keyword">func</span> <span class="token function">Breakpoint</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
#&#x8C03;&#x7528;goroutine&#x9000;&#x51FA;<span class="token punctuation">,</span> &#x5176;&#x4ED6;&#x4E0D;&#x53D7;&#x5F71;&#x54CD;
<span class="token keyword">func</span> <span class="token function">Goexit</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
#&#x89E6;&#x53D1;&#x4E00;&#x6B21;&#x8C03;&#x5EA6;
<span class="token keyword">func</span> <span class="token function">Gosched</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
#&#x7ED1;&#x5B9A;goroutine&#x5230;&#x5E95;&#x5C42;&#x7EBF;&#x7A0B;
<span class="token keyword">func</span> <span class="token function">LockOSThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
#&#x6709;MemProfile&#x548C;CPUProfile&#x7B49;&#x68C0;&#x67E5;&#x6027;&#x80FD;&#x7684;&#x51FD;&#x6570;<span class="token punctuation">,</span> &#x4F46;&#x63A8;&#x8350;&#x666E;&#x901A;&#x7528;&#x6237;&#x4F7F;&#x7528;
runtime<span class="token operator">/</span>pprof
#&#x53EF;&#x7528;cpu&#x6570;
<span class="token keyword">func</span> <span class="token function">NumCPU</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token builtin">int</span>
#&#x8FD8;&#x6709;api&#x53EF;&#x4EE5;&#x83B7;&#x5F97;goroutine&#x7684;&#x4E2A;&#x6570;<span class="token punctuation">,</span> &#x8C03;&#x7528;cgo&#x7684;&#x6B21;&#x6570;&#x7B49;
<span class="token comment">//...&#x7701;&#x7565;&#x4E00;&#x4E9B;&#x9AD8;&#x7AEF;api</span>
#&#x8FD4;&#x56DE;&#x7248;&#x672C;&#x53F7;
<span class="token keyword">func</span> <span class="token function">Version</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token builtin">string</span>
#&#x8C03;&#x7528;&#x6808;
Callers
CallersFrames
</code></pre>
<h2 id="runtimepprof"><a name="runtimepprof" class="anchor-navigation-ex-anchor" href="#runtimepprof"><i class="fa fa-link" aria-hidden="true"></i></a>12.3. runtime/pprof</h2>
<p>&#x7BA1;&#x6027;&#x80FD;&#x5206;&#x6790;&#x7684;.</p>
<h2 id="runtimedebug"><a name="runtimedebug" class="anchor-navigation-ex-anchor" href="#runtimedebug"><i class="fa fa-link" aria-hidden="true"></i></a>12.4. runtime/debug</h2>
<p>&#x987E;&#x540D;&#x601D;&#x4E49;, &#x6709;&#x6253;&#x5370;&#x8C03;&#x7528;&#x6808;&#x7684;, &#x6709;&#x8C03;&#x8282;gc&#x7684;&#x7B49;&#x7B49;.</p>
<pre class="language-"><code class="lang-go"><span class="token keyword">func</span> <span class="token function">FreeOSMemory</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">func</span> <span class="token function">PrintStack</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">func</span> <span class="token function">ReadGCStats</span><span class="token punctuation">(</span>stats <span class="token operator">*</span>GCStats<span class="token punctuation">)</span>
<span class="token keyword">func</span> <span class="token function">SetGCPercent</span><span class="token punctuation">(</span>percent <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token builtin">int</span>
<span class="token keyword">func</span> <span class="token function">SetMaxStack</span><span class="token punctuation">(</span>bytes <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token builtin">int</span>
<span class="token keyword">func</span> <span class="token function">SetMaxThreads</span><span class="token punctuation">(</span>threads <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token builtin">int</span>
<span class="token keyword">func</span> <span class="token function">SetPanicOnFault</span><span class="token punctuation">(</span>enabled <span class="token builtin">bool</span><span class="token punctuation">)</span> <span class="token builtin">bool</span>
<span class="token keyword">func</span> <span class="token function">SetTraceback</span><span class="token punctuation">(</span>level <span class="token builtin">string</span><span class="token punctuation">)</span>
<span class="token keyword">func</span> <span class="token function">Stack</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">byte</span>
<span class="token keyword">func</span> <span class="token function">WriteHeapDump</span><span class="token punctuation">(</span>fd <span class="token builtin">uintptr</span><span class="token punctuation">)</span>
<span class="token keyword">type</span> BuildInfo
    <span class="token keyword">func</span> <span class="token function">ReadBuildInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>info <span class="token operator">*</span>BuildInfo<span class="token punctuation">,</span> ok <span class="token builtin">bool</span><span class="token punctuation">)</span>
<span class="token keyword">type</span> GCStats
<span class="token keyword">type</span> Module
</code></pre>
<h2 id="runtimetrace"><a name="runtimetrace" class="anchor-navigation-ex-anchor" href="#runtimetrace"><i class="fa fa-link" aria-hidden="true"></i></a>12.5. runtime/trace</h2>
<p>&#x548C;ftrace&#x6982;&#x5FF5;&#x7C7B;&#x4F3C;, &#x5728;&#x5173;&#x952E;&#x70B9;&#x4E0A;&#x6253;&#x6869;.</p>
<h1 id="os"><a name="os" class="anchor-navigation-ex-anchor" href="#os"><i class="fa fa-link" aria-hidden="true"></i></a>13. os</h1>
<p>os&#x5305;&#x63D0;&#x4F9B;&#x5E73;&#x53F0;&#x65E0;&#x5173;&#x7684;&#x63A5;&#x53E3;. &#x5B83;&#x7684;&#x9519;&#x8BEF;&#x5904;&#x7406;&#x65B9;&#x5F0F;&#x662F;go&#x7684;&#x7ECF;&#x5178;&#x65B9;&#x5F0F;:</p>
<pre class="language-"><code class="lang-go">file<span class="token punctuation">,</span> err <span class="token operator">:=</span> os<span class="token punctuation">.</span><span class="token function">Open</span><span class="token punctuation">(</span><span class="token string">&quot;file.go&quot;</span><span class="token punctuation">)</span> <span class="token comment">// For read access.</span>
<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
     log<span class="token punctuation">.</span><span class="token function">Fatal</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre>
<p>&#x63D0;&#x4F9B;&#x7684;&#x63A5;&#x53E3;&#x5305;&#x62EC;</p>
<ul>
<li>Chdir Chmod Link Mkdir Pipe Remove TempDir Rename Expand&#x73AF;&#x5883;&#x53D8;&#x91CF;&#x7B49;</li>
<li>Getpid, ppid&#x7B49;</li>
<li>IsExist IsTimeout&#x7B49;</li>
<li>&#x6587;&#x4EF6;&#x7C7B; type File<ul>
<li>Create NewFile Open &#x7528;&#x4E8E;&#x521B;&#x5EFA;File&#x5BF9;&#x8C61;</li>
<li>&#x6CE8;&#x610F;, Open()&#x8FD4;&#x56DE;&#x53EA;&#x8BFB;&#x7684;File&#x5BF9;&#x8C61;, OpenFile()&#x53EF;&#x4EE5;&#x6307;&#x5B9A;&#x6253;&#x5F00;&#x6A21;&#x5F0F;, &#x548C;C&#x4E00;&#x6837;.</li>
<li>&#x8BFB; &#x5199; Seek Sync Close</li>
</ul>
</li>
<li>&#x8FDB;&#x7A0B;&#x7C7B; type Process<ul>
<li>&#x6309;pid&#x67E5;&#x627E;&#x8FDB;&#x7A0B;</li>
<li>&#x5F00;&#x59CB;&#x8FDB;&#x7A0B;</li>
<li>Kill Release Signal Wait&#x7B49;</li>
</ul>
</li>
<li>&#x5B9A;&#x4E49;&#x4E86;&#x9519;&#x8BEF;&#x7C7B;&#x578B;<ul>
<li>PathError LinkError SyscallError</li>
</ul>
</li>
</ul>
<pre class="language-"><code class="lang-go"><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
    <span class="token string">&quot;log&quot;</span>
    <span class="token string">&quot;os&quot;</span>
<span class="token punctuation">)</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    f<span class="token punctuation">,</span> err <span class="token operator">:=</span> os<span class="token punctuation">.</span><span class="token function">OpenFile</span><span class="token punctuation">(</span><span class="token string">&quot;notes.txt&quot;</span><span class="token punctuation">,</span> os<span class="token punctuation">.</span>O_RDWR<span class="token operator">|</span>os<span class="token punctuation">.</span>O_CREATE<span class="token punctuation">,</span> <span class="token number">0755</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
        log<span class="token punctuation">.</span><span class="token function">Fatal</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span> err <span class="token operator">:=</span> f<span class="token punctuation">.</span><span class="token function">Close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
        log<span class="token punctuation">.</span><span class="token function">Fatal</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<h2 id="osexec"><a name="osexec" class="anchor-navigation-ex-anchor" href="#osexec"><i class="fa fa-link" aria-hidden="true"></i></a>13.1. os/exec</h2>
<p>&#x7528;&#x4E8E;&#x6267;&#x884C;&#x5916;&#x90E8;&#x7A0B;&#x5E8F;; &#x53EA;&#x80FD;&#x5728;linux&#x4E0A;&#x8DD1;
&#x548C;c&#x91CC;&#x9762;&#x7684;system&#x4E0D;&#x592A;&#x4E00;&#x6837;, exec&#x548C;c&#x7684;exec&#x66F4;&#x50CF;, &#x6BD4;system&#x7B80;&#x5355;.
Run&#x548C;Start&#x7684;&#x533A;&#x522B;&#x662F;: Run&#x8981;&#x7B49;&#x5F85;&#x547D;&#x4EE4;&#x8FD4;&#x56DE;, &#x800C;Start&#x53EA;&#x7BA1;&#x5F00;&#x59CB;, &#x4E0D;&#x7B49;&#x5F85;&#x8FD4;&#x56DE;, &#x8981;&#x548C;Wait&#x8FDE;&#x7528;.</p>
<pre class="language-"><code class="lang-go"><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
    <span class="token string">&quot;log&quot;</span>
    <span class="token string">&quot;os/exec&quot;</span>
<span class="token punctuation">)</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//&#x4E00;&#x822C;&#x7684;&#x6A21;&#x5F0F;&#x662F;&#x5148;&#x751F;&#x6210;&#x4E00;&#x4E2A;cmd&#x5BF9;&#x8C61;.</span>
    cmd <span class="token operator">:=</span> exec<span class="token punctuation">.</span><span class="token function">Command</span><span class="token punctuation">(</span><span class="token string">&quot;sleep&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;1&quot;</span><span class="token punctuation">)</span>
    log<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;Running command and waiting for it to finish...&quot;</span><span class="token punctuation">)</span>
    <span class="token comment">//&#x540E;&#x9762;&#x90FD;&#x7528;&#x8FD9;&#x4E2A;cmd&#x5BF9;&#x8C61;&#x6765;&#x64CD;&#x4F5C;</span>
    err <span class="token operator">:=</span> cmd<span class="token punctuation">.</span><span class="token function">Run</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    log<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;Command finished with error: %v&quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre>
<h2 id="ossignal"><a name="ossignal" class="anchor-navigation-ex-anchor" href="#ossignal"><i class="fa fa-link" aria-hidden="true"></i></a>13.2. os/signal</h2>
<p>&#x7528;&#x6765;&#x5904;&#x7406;go&#x7684;signal</p>
<ul>
<li>SIGKILL and SIGSTOP&#x4E0D;&#x80FD;&#x88AB;&#x6355;&#x83B7;, &#x6240;&#x4EE5;&#x8FD9;&#x91CC;&#x7684;&#x4E1C;&#x897F;&#x90FD;&#x7BA1;&#x4E0D;&#x4E86;&#x5B83;&#x4EEC;</li>
<li>&#x540C;&#x6B65;&#x7684;signal, &#x4E00;&#x822C;&#x662F;SIGBUS, SIGFPE, and SIGSEGV, &#x662F;&#x7531;&#x6B63;&#x5728;&#x6267;&#x884C;&#x7684;go&#x7A0B;&#x5E8F;&#x5F15;&#x8D77;&#x7684;
&#x5728;go&#x91CC;, &#x8FD9;&#x4E9B;signal&#x88AB;&#x8F6C;&#x6362;&#x4E3A;&#x8FD0;&#x884C;&#x65F6;&#x7684;panic</li>
<li>&#x5269;&#x4E0B;&#x7684;signal, &#x662F;&#x5176;&#x4ED6;&#x8FDB;&#x7A0B;&#x5F02;&#x6B65;&#x901A;&#x77E5;&#x7684;signal, &#x7528;&#x8FD9;&#x91CC;&#x7684;&#x63A5;&#x53E3;&#x5904;&#x7406;</li>
</ul>
<hr>
<p>&#x9ED8;&#x8BA4;&#x884C;&#x4E3A;:</p>
<blockquote>
<p>By default, a synchronous signal is converted into a run-time panic. A SIGHUP, SIGINT, or SIGTERM signal causes the program to exit. A SIGQUIT, SIGILL, SIGTRAP, SIGABRT, SIGSTKFLT, SIGEMT, or SIGSYS signal causes the program to exit with a stack dump. A SIGTSTP, SIGTTIN, or SIGTTOU signal gets the system default behavior (these signals are used by the shell for job control). The SIGPROF signal is handled directly by the Go runtime to implement runtime.CPUProfile. Other signals will be caught but no action will be taken.</p>
</blockquote>
<h3 id="cgo"><a name="cgo" class="anchor-navigation-ex-anchor" href="#cgo"><i class="fa fa-link" aria-hidden="true"></i></a>13.2.1. cgo</h3>
<p>&#x4E00;&#x822C;go&#x7A0B;&#x5E8F;&#x5728;&#x542F;&#x52A8;&#x7684;&#x65F6;&#x5019;, runtime&#x4F1A;&#x5148;&#x5B89;&#x88C5;&#x9ED8;&#x8BA4;&#x7684;sighandler, cgo&#x5982;&#x679C;&#x81EA;&#x5DF1;&#x6709;&#x5904;&#x7406;signal&#x7684;&#x9700;&#x6C42;, &#x8981;&#x7528;SA_ONSTACK&#x6807;&#x8BB0;. &#x5426;&#x5219;&#x7A0B;&#x5E8F;&#x4F1A;crash
&#x8FD9;&#x79CD;&#x60C5;&#x51B5;&#x8981;&#x5F53;&#x5FC3;, &#x8BE6;&#x89C1;: 
<a href="https://golang.google.cn/pkg/os/signal/#hdr-Go_programs_that_use_cgo_or_SWIG" target="_blank">https://golang.google.cn/pkg/os/signal/#hdr-Go_programs_that_use_cgo_or_SWIG</a></p>
<h3 id="go&#x4F5C;&#x4E3A;so"><a name="go&#x4F5C;&#x4E3A;so" class="anchor-navigation-ex-anchor" href="#go&#x4F5C;&#x4E3A;so"><i class="fa fa-link" aria-hidden="true"></i></a>13.2.2. go&#x4F5C;&#x4E3A;so</h3>
<p>&#x5F53;go&#x7F16;&#x8BD1;&#x4E3A;-buildmode=c-shared&#x65F6;, &#x4E00;&#x822C;&#x8C03;&#x7528;&#x8FD9;&#x4E2A;so&#x7684;&#x975E;go&#x7A0B;&#x5E8F;, &#x5DF2;&#x7ECF;&#x5B89;&#x88C5;&#x4E86;sighandler, &#x90A3;go runtime&#x6709;&#x76F8;&#x5173;&#x5904;&#x7406;.
<a href="https://golang.google.cn/pkg/os/signal/#hdr-Non_Go_programs_that_call_Go_code" target="_blank">https://golang.google.cn/pkg/os/signal/#hdr-Non_Go_programs_that_call_Go_code</a></p>
<h3 id="&#x65B9;&#x6CD5;"><a name="&#x65B9;&#x6CD5;" class="anchor-navigation-ex-anchor" href="#&#x65B9;&#x6CD5;"><i class="fa fa-link" aria-hidden="true"></i></a>13.2.3. &#x65B9;&#x6CD5;</h3>
<pre class="language-"><code class="lang-go"><span class="token keyword">func</span> <span class="token function">Ignore</span><span class="token punctuation">(</span>sig <span class="token operator">...</span>os<span class="token punctuation">.</span>Signal<span class="token punctuation">)</span>
<span class="token keyword">func</span> <span class="token function">Ignored</span><span class="token punctuation">(</span>sig os<span class="token punctuation">.</span>Signal<span class="token punctuation">)</span> <span class="token builtin">bool</span>
<span class="token keyword">func</span> <span class="token function">Notify</span><span class="token punctuation">(</span>c <span class="token keyword">chan</span><span class="token operator">&lt;-</span> os<span class="token punctuation">.</span>Signal<span class="token punctuation">,</span> sig <span class="token operator">...</span>os<span class="token punctuation">.</span>Signal<span class="token punctuation">)</span>
<span class="token keyword">func</span> <span class="token function">Reset</span><span class="token punctuation">(</span>sig <span class="token operator">...</span>os<span class="token punctuation">.</span>Signal<span class="token punctuation">)</span>
<span class="token keyword">func</span> <span class="token function">Stop</span><span class="token punctuation">(</span>c <span class="token keyword">chan</span><span class="token operator">&lt;-</span> os<span class="token punctuation">.</span>Signal<span class="token punctuation">)</span>
</code></pre>
<p>&#x6BD4;&#x5982;</p>
<pre class="language-"><code class="lang-go"><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
    <span class="token string">&quot;fmt&quot;</span>
    <span class="token string">&quot;os&quot;</span>
    <span class="token string">&quot;os/signal&quot;</span>
<span class="token punctuation">)</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Set up channel on which to send signal notifications.</span>
    <span class="token comment">// We must use a buffered channel or risk missing the signal</span>
    <span class="token comment">// if we&apos;re not ready to receive when the signal is sent.</span>
    c <span class="token operator">:=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token keyword">chan</span> os<span class="token punctuation">.</span>Signal<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token comment">// &#x5728;os&#x5305;&#x4E2D;, var Interrupt Signal = syscall.SIGINT</span>
    signal<span class="token punctuation">.</span><span class="token function">Notify</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> os<span class="token punctuation">.</span>Interrupt<span class="token punctuation">)</span>

    <span class="token comment">// Block until a signal is received.</span>
    s <span class="token operator">:=</span> <span class="token operator">&lt;-</span>c
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;Got signal:&quot;</span><span class="token punctuation">,</span> s<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre>
<h2 id="osuser"><a name="osuser" class="anchor-navigation-ex-anchor" href="#osuser"><i class="fa fa-link" aria-hidden="true"></i></a>13.3. os/user</h2>
<p>&#x63D0;&#x4F9B;&#x7528;&#x6237;name id&#x7B49;&#x67E5;&#x8BE2;&#x7684;&#x529F;&#x80FD;.</p>
<h1 id="builtin"><a name="builtin" class="anchor-navigation-ex-anchor" href="#builtin"><i class="fa fa-link" aria-hidden="true"></i></a>14. builtin</h1>
<p>builtin&#x91CC;&#x9884;&#x5B9A;&#x4E49;&#x4E86;golang&#x7684;&#x5E38;&#x7528;&#x51FD;&#x6570;&#x548C;&#x7C7B;&#x578B;
&#x6BD4;&#x5982;</p>
<h2 id="&#x51FD;&#x6570;"><a name="&#x51FD;&#x6570;" class="anchor-navigation-ex-anchor" href="#&#x51FD;&#x6570;"><i class="fa fa-link" aria-hidden="true"></i></a>14.1. &#x51FD;&#x6570;</h2>
<pre class="language-"><code>append
cap
close
copy
delete
len
make
new
panic
recover
print
</code></pre><h2 id="&#x7C7B;&#x578B;"><a name="&#x7C7B;&#x578B;" class="anchor-navigation-ex-anchor" href="#&#x7C7B;&#x578B;"><i class="fa fa-link" aria-hidden="true"></i></a>14.2. &#x7C7B;&#x578B;</h2>
<p><code>bool byte error int u/int8/16/32/64 float32/64 rune string uintptr</code></p>
<h1 id="strings"><a name="strings" class="anchor-navigation-ex-anchor" href="#strings"><i class="fa fa-link" aria-hidden="true"></i></a>15. strings</h1>
<p>strings&#x548C;bytes&#x7684;&#x65B9;&#x6CD5;&#x5DEE;&#x4E0D;&#x591A;, &#x4E0D;&#x540C;&#x5728;&#x4E8E;</p>
<ul>
<li>strings&#x662F;UTF8&#x7F16;&#x7801;, &#x53D8;&#x957F;&#x7684;</li>
<li>bytes&#x662F;C&#x91CC;&#x7684;&#x5B57;&#x7B26;&#x6570;&#x7EC4;</li>
</ul>
<hr>
<p>&#x4E3E;&#x4F8B;: Builder&#x662F;strings&#x5305;&#x63D0;&#x4F9B;&#x7684;&#x4E00;&#x4E2A;struct, &#x5B9E;&#x73B0;&#x4E86;Write&#x65B9;&#x6CD5;. &#x5B83;&#x5C3D;&#x91CF;&#x5C11;copy</p>
<pre class="language-"><code class="lang-go"><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
    <span class="token string">&quot;fmt&quot;</span>
    <span class="token string">&quot;strings&quot;</span>
<span class="token punctuation">)</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> b strings<span class="token punctuation">.</span>Builder
    <span class="token keyword">for</span> i <span class="token operator">:=</span> <span class="token number">3</span><span class="token punctuation">;</span> i <span class="token operator">&gt;=</span> <span class="token number">1</span><span class="token punctuation">;</span> i<span class="token operator">--</span> <span class="token punctuation">{</span>
        fmt<span class="token punctuation">.</span><span class="token function">Fprintf</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>b<span class="token punctuation">,</span> <span class="token string">&quot;%d...&quot;</span><span class="token punctuation">,</span> i<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    b<span class="token punctuation">.</span><span class="token function">WriteString</span><span class="token punctuation">(</span><span class="token string">&quot;ignition&quot;</span><span class="token punctuation">)</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>b<span class="token punctuation">.</span><span class="token function">String</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token punctuation">}</span>

<span class="token comment">//&#x8F93;&#x51FA;</span>
<span class="token number">3.</span><span class="token punctuation">.</span><span class="token number">.2</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token number">.1</span><span class="token operator">...</span>ignition
</code></pre>
<h1 id="bytes"><a name="bytes" class="anchor-navigation-ex-anchor" href="#bytes"><i class="fa fa-link" aria-hidden="true"></i></a>16. bytes</h1>
<p>bytes&#x53EF;&#x4EE5;&#x6709;</p>
<ul>
<li>&#x4E24;&#x4E2A;byte&#x5207;&#x7247;&#x53EF;&#x4EE5;&#x6BD4;&#x8F83;: <code>func Compare(a, b []byte) int</code></li>
<li>&#x53EF;&#x4EE5;&#x5224;&#x65AD;&#x662F;&#x5426;&#x6709;&#x5B50;&#x4E32;: Contains</li>
<li>&#x5B50;&#x4E32;&#x8BA1;&#x6570;: Count</li>
<li>&#x5B57;&#x4E32;&#x4F4D;&#x7F6E;: Index</li>
<li>&#x76F8;&#x7B49;: Equal</li>
<li>&#x524D;&#x540E;&#x7F00;: HasPrefix HasSuffix</li>
<li>&#x5B57;&#x7B26;&#x4E32;&#x9010;&#x4E2A;map: Map</li>
<li>&#x91CD;&#x590D;N&#x6B21;&#x5B57;&#x7B26;&#x4E32;: Repeat</li>
<li>&#x66FF;&#x6362;: Replace</li>
<li>&#x5206;&#x5272;: Split</li>
<li>&#x5927;&#x5C0F;&#x5199;&#x8F6C;&#x6362;: ToUpper ToLower</li>
<li>&#x53BB;&#x6389;&#x7A7A;&#x767D;: Trim</li>
<li>&#x8FDE;&#x63A5;: Join</li>
</ul>
<h2 id="buffer"><a name="buffer" class="anchor-navigation-ex-anchor" href="#buffer"><i class="fa fa-link" aria-hidden="true"></i></a>16.1. Buffer</h2>
<p>Buffer&#x662F;&#x4E2A;struct, &#x662F;&#x52A8;&#x6001;&#x5927;&#x5C0F;&#x7684;byte&#x5207;&#x7247;. &#x6709;Read&#x548C;Write&#x65B9;&#x6CD5;, &#x7B26;&#x5408;io.Reaer&#x548C;io.Writer
NewBuffer&#x8FD4;&#x56DE;&#x4E00;&#x4E2A;Buffer&#x5BF9;&#x8C61;, &#x4F46;&#x901A;&#x5E38;<code>new(Buffer)</code>&#x6216;&#x8005;<code>var b bytes.Buffer</code>&#x5C31;&#x591F;&#x5B9E;&#x4F8B;&#x5316;&#x4E00;&#x4E2A;Buffer&#x4E86;.
Buffer&#x7684;&#x6240;&#x6709;&#x65B9;&#x6CD5;, &#x90FD;&#x662F;&#x5F15;&#x7528;&#x65B9;&#x5F0F;. &#x6BD4;&#x5982;:
<code>func (b *Buffer) Read(p []byte) (n int, err error)</code>
<code>func (b *Buffer) Write(p []byte) (n int, err error)</code></p>
<h1 id="logsyslog"><a name="logsyslog" class="anchor-navigation-ex-anchor" href="#logsyslog"><i class="fa fa-link" aria-hidden="true"></i></a>17. log/syslog</h1>
<p>&#x867D;&#x7136;&#x8FD9;&#x4E2A;&#x5305;&#x5DF2;&#x7ECF;&#x505C;&#x6B62;&#x7EF4;&#x62A4;, &#x4F46;&#x5B83;&#x63D0;&#x4F9B;&#x4E86;&#x4E00;&#x4E2A;&#x53C2;&#x8003;&#x8BBE;&#x8BA1;
&#x8FD9;&#x4E2A;&#x5305;&#x901A;&#x8FC7;unix socket, &#x53D1;&#x9001;&#x8BB0;&#x5F55;&#x5230;syslog&#x5B88;&#x62A4;&#x8FDB;&#x7A0B;; &#x53EA;&#x9700;&#x8981;&#x8C03;&#x7528;&#x4E00;&#x6B21;Dial&#x65B9;&#x6CD5;&#x6765;&#x8FDE;&#x63A5;&#x5230;syslog&#x5B88;&#x62A4;&#x8FDB;&#x7A0B;, &#x5982;&#x679C;&#x6709;&#x95EE;&#x9898;, &#x4F1A;&#x81EA;&#x52A8;&#x91CD;&#x8FDE;.</p>
<pre class="language-"><code class="lang-go"><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
    <span class="token string">&quot;fmt&quot;</span>
    <span class="token string">&quot;log&quot;</span>
    <span class="token string">&quot;log/syslog&quot;</span>
<span class="token punctuation">)</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    sysLog<span class="token punctuation">,</span> err <span class="token operator">:=</span> syslog<span class="token punctuation">.</span><span class="token function">Dial</span><span class="token punctuation">(</span><span class="token string">&quot;tcp&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;localhost:1234&quot;</span><span class="token punctuation">,</span>
        syslog<span class="token punctuation">.</span>LOG_WARNING<span class="token operator">|</span>syslog<span class="token punctuation">.</span>LOG_DAEMON<span class="token punctuation">,</span> <span class="token string">&quot;demotag&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
        log<span class="token punctuation">.</span><span class="token function">Fatal</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    fmt<span class="token punctuation">.</span><span class="token function">Fprintf</span><span class="token punctuation">(</span>sysLog<span class="token punctuation">,</span> <span class="token string">&quot;This is a daemon warning with demotag.&quot;</span><span class="token punctuation">)</span>
    sysLog<span class="token punctuation">.</span><span class="token function">Emerg</span><span class="token punctuation">(</span><span class="token string">&quot;And this is a daemon emergency with demotag.&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre>
<p>&#x65B0;&#x7684;&#x7B2C;&#x4E09;&#x65B9;&#x7684;syslog&#x66F4;&#x597D;&#x7528;</p>
<h1 id="log"><a name="log" class="anchor-navigation-ex-anchor" href="#log"><i class="fa fa-link" aria-hidden="true"></i></a>18. log</h1>
<p>log&#x5305;&#x5B9E;&#x73B0;&#x4E86;&#x4E00;&#x4E2A;logger&#x7C7B;&#x578B;, &#x5E76;&#x63D0;&#x4F9B;&#x57FA;&#x7840;&#x7684;log&#x529F;&#x80FD;. log&#x8FD8;&#x63D0;&#x4F9B;&#x4E86;&#x4E00;&#x4E2A;&quot;&#x6807;&#x51C6;&quot;&#x7684;logger, &#x7528;&#x6765;&#x8BB0;&#x5F55;log&#x5230;stdout
log&#x7ED9;&#x6BCF;&#x4E2A;message&#x90FD;&#x52A0;&#x6362;&#x884C;.
Fatal()&#x4F1A;&#x8C03;&#x7528;os.Exit()
Panic()&#x4F1A;&#x8C03;&#x7528;&#x5185;&#x7F6E;&#x51FD;&#x6570;panic()
Print()&#x5BB6;&#x65CF;&#x51FD;&#x6570;&#x7528;&#x6765;&#x6253;&#x5370;&#x5230;log</p>
<h2 id="type-logger"><a name="type-logger" class="anchor-navigation-ex-anchor" href="#type-logger"><i class="fa fa-link" aria-hidden="true"></i></a>18.1. type logger</h2>
<p>logger&#x662F;&#x4E2A;struct, &#x63D0;&#x4F9B;&#x5728;io.Writer&#x57FA;&#x7840;&#x4E0A;&#x7684;log&#x529F;&#x80FD;. &#x5B83;&#x4E0D;&#x662F;&#x4E2A;interface, &#x5E76;&#x4E0D;&#x62BD;&#x8C61;, &#x5B83;&#x662F;&#x5B9E;&#x5B9E;&#x5728;&#x5728;&#x7684;&#x4E00;&#x4E2A;&#x5BF9;&#x8C61;.
&#x7528;<code>func New(out io.Writer, prefix string, flag int) *Logger</code>&#x6765;&#x5B9E;&#x4F8B;&#x5316;&#x4E00;&#x4E2A;logger
&#x8FD9;&#x4E2A;New&#x5F88;&#x7CBE;&#x9AD3;, &#x5B9E;&#x4F8B;&#x5316;&#x4E00;&#x4E2A;&#x5BF9;&#x8C61;&#x6765;&#x5BF9;&#x5916;&#x63D0;&#x4F9B;&#x529F;&#x80FD;.</p>
<pre class="language-"><code class="lang-go"><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
    <span class="token string">&quot;bytes&quot;</span>
    <span class="token string">&quot;fmt&quot;</span>
    <span class="token string">&quot;log&quot;</span>
<span class="token punctuation">)</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> <span class="token punctuation">(</span>
        buf    bytes<span class="token punctuation">.</span>Buffer
        logger <span class="token operator">=</span> log<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>buf<span class="token punctuation">,</span> <span class="token string">&quot;logger: &quot;</span><span class="token punctuation">,</span> log<span class="token punctuation">.</span>Lshortfile<span class="token punctuation">)</span>
    <span class="token punctuation">)</span>

    logger<span class="token punctuation">.</span><span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;Hello, log file!&quot;</span><span class="token punctuation">)</span>

    fmt<span class="token punctuation">.</span><span class="token function">Print</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>buf<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre>
<h2 id="logger&#x652F;&#x6301;&#x591A;&#x79CD;&#x683C;&#x5F0F;-&#x7528;flag&#x6765;&#x914D;&#x7F6E;"><a name="logger&#x652F;&#x6301;&#x591A;&#x79CD;&#x683C;&#x5F0F;-&#x7528;flag&#x6765;&#x914D;&#x7F6E;" class="anchor-navigation-ex-anchor" href="#logger&#x652F;&#x6301;&#x591A;&#x79CD;&#x683C;&#x5F0F;-&#x7528;flag&#x6765;&#x914D;&#x7F6E;"><i class="fa fa-link" aria-hidden="true"></i></a>18.2. logger&#x652F;&#x6301;&#x591A;&#x79CD;&#x683C;&#x5F0F;, &#x7528;flag&#x6765;&#x914D;&#x7F6E;</h2>
<p>&#x6BD4;&#x5982;<code>Ldate | Ltime | Lmicroseconds | Llongfile</code>&#x4EA7;&#x751F;&#x8FD9;&#x6837;&#x7684;&#x6253;&#x5370;</p>
<pre class="language-"><code>2009/01/23 01:23:23.123123 /a/b/c/d.go:23: message
</code></pre><p>&#x6211;&#x4EEC;&#x6CE8;&#x610F;&#x5230;, logger&#x7684;&#x4E00;&#x4E2A;&#x529F;&#x80FD;&#x5C31;&#x662F;&#x6253;&#x5370;&#x5F53;&#x524D;&#x7684;&#x6587;&#x4EF6;&#x540D;&#x548C;&#x884C;&#x6570;
&#x6709;&#x4E2A;Output()&#x51FD;&#x6570;, &#x5730;&#x4E00;&#x4E2A;&#x53C2;&#x6570;&#x662F;skip&#x591A;&#x5C11;&#x7EA7;&#x7684;&#x610F;&#x601D;, &#x56E0;&#x4E3A;&#x6253;&#x5370;&#x5F53;&#x524D;&#x884C;, &#x4E5F;&#x5C31;&#x662F;&#x6253;&#x5370;&#x8BED;&#x53E5;&#x672C;&#x8EAB;&#x6240;&#x5728;&#x7684;&#x884C;, &#x5E76;&#x6CA1;&#x6709;&#x4EC0;&#x4E48;&#x5B9E;&#x9645;&#x610F;&#x4E49;.
&#x8FD9;&#x548C;callstack&#x51FD;&#x6570;&#x4F1A;skip&#x51E0;&#x4E2A;&#x5C42;&#x7EA7;&#x9053;&#x7406;&#x4E00;&#x6837;.</p>
<h1 id="fmt"><a name="fmt" class="anchor-navigation-ex-anchor" href="#fmt"><i class="fa fa-link" aria-hidden="true"></i></a>19. fmt</h1>
<p>&#x4E0E;python&#x4E0D;&#x540C;&#x7684;&#x662F;, &#x5B57;&#x7B26;&#x4E32;&#x683C;&#x5F0F;&#x5316;&#x4E0D;&#x662F;&#x8BED;&#x8A00;&#x7EA7;&#x522B;&#x7684;. &#x5728;go&#x91CC;, &#x7528;fmt&#x5305;&#x63D0;&#x4F9B;&#x8FD9;&#x7C7B;&#x529F;&#x80FD;.</p>
<h2 id="&#x65B9;&#x6CD5;_1"><a name="&#x65B9;&#x6CD5;_1" class="anchor-navigation-ex-anchor" href="#&#x65B9;&#x6CD5;_1"><i class="fa fa-link" aria-hidden="true"></i></a>19.1. &#x65B9;&#x6CD5;</h2>
<p>&#x6BD4;&#x8F83;&#x5E38;&#x7528;&#x7684;&#x6709;</p>
<pre class="language-"><code class="lang-go"><span class="token comment">//&#x63A5;&#x53D7;&#x683C;&#x5F0F;&#x5316;&#x5B57;&#x7B26;&#x4E32;, &#x8FD4;&#x56DE;error&#x5BF9;&#x8C61;</span>
<span class="token keyword">func</span> <span class="token function">Errorf</span><span class="token punctuation">(</span>format <span class="token builtin">string</span><span class="token punctuation">,</span> a <span class="token operator">...</span><span class="token keyword">interface</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token builtin">error</span>
<span class="token comment">//Fprintf/Fprintln&#x5BB6;&#x65CF;, &#x8F93;&#x51FA;&#x5230;io.Writer</span>
<span class="token keyword">func</span> <span class="token function">Fprintf</span><span class="token punctuation">(</span>w io<span class="token punctuation">.</span>Writer<span class="token punctuation">,</span> format <span class="token builtin">string</span><span class="token punctuation">,</span> a <span class="token operator">...</span><span class="token keyword">interface</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>n <span class="token builtin">int</span><span class="token punctuation">,</span> err <span class="token builtin">error</span><span class="token punctuation">)</span>
<span class="token comment">//&#x683C;&#x5F0F;&#x5316;&#x8F93;&#x5165;, &#x8F93;&#x5165;&#x6E90;&#x662F;io.Reader</span>
<span class="token keyword">func</span> <span class="token function">Fscanf</span><span class="token punctuation">(</span>r io<span class="token punctuation">.</span>Reader<span class="token punctuation">,</span> format <span class="token builtin">string</span><span class="token punctuation">,</span> a <span class="token operator">...</span><span class="token keyword">interface</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>n <span class="token builtin">int</span><span class="token punctuation">,</span> err <span class="token builtin">error</span><span class="token punctuation">)</span>

<span class="token comment">//&#x53BB;&#x6389;F&#x7684;&#x662F; &#x6807;&#x51C6;&#x8F93;&#x5165;&#x8F93;&#x51FA;</span>
Printf<span class="token operator">/</span>Scanf
</code></pre>
<h2 id="stringer&#x7C7B;&#x578B;"><a name="stringer&#x7C7B;&#x578B;" class="anchor-navigation-ex-anchor" href="#stringer&#x7C7B;&#x578B;"><i class="fa fa-link" aria-hidden="true"></i></a>19.2. Stringer&#x7C7B;&#x578B;</h2>
<p>Stringer&#x7C7B;&#x578B;&#x7684;String&#x65B9;&#x6CD5;&#x662F;&#x9ED8;&#x8BA4;&#x7684;&#x6253;&#x5370;&#x65B9;&#x6CD5;, &#x6709;String&#x65B9;&#x6CD5;&#x7684;&#x7C7B;&#x578B;&#x90FD;&#x80FD;&#x88AB;Print&#x5BB6;&#x65CF;&#x6253;&#x5370;, &#x4E0D;&#x7528;&#x663E;&#x5F0F;&#x7ED9;&#x51FA;&#x683C;&#x5F0F;&#x5316;&#x4E32;.</p>
<pre class="language-"><code class="lang-go"><span class="token keyword">type</span> Stringer <span class="token keyword">interface</span> <span class="token punctuation">{</span>
    <span class="token function">String</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token builtin">string</span>
<span class="token punctuation">}</span>
</code></pre>
<pre class="language-"><code class="lang-go"><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
    <span class="token string">&quot;fmt&quot;</span>
<span class="token punctuation">)</span>

<span class="token comment">// Animal has a Name and an Age to represent an animal.</span>
<span class="token keyword">type</span> Animal <span class="token keyword">struct</span> <span class="token punctuation">{</span>
    Name <span class="token builtin">string</span>
    Age  <span class="token builtin">uint</span>
<span class="token punctuation">}</span>

<span class="token comment">// String makes Animal satisfy the Stringer interface.</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>a Animal<span class="token punctuation">)</span> <span class="token function">String</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token builtin">string</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> fmt<span class="token punctuation">.</span><span class="token function">Sprintf</span><span class="token punctuation">(</span><span class="token string">&quot;%v (%d)&quot;</span><span class="token punctuation">,</span> a<span class="token punctuation">.</span>Name<span class="token punctuation">,</span> a<span class="token punctuation">.</span>Age<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    a <span class="token operator">:=</span> Animal<span class="token punctuation">{</span>
        Name<span class="token punctuation">:</span> <span class="token string">&quot;Gopher&quot;</span><span class="token punctuation">,</span>
        Age<span class="token punctuation">:</span>  <span class="token number">2</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre>
<h2 id="&#x683C;&#x5F0F;&#x5316;&#x6807;&#x5FD7;&#x7B26;"><a name="&#x683C;&#x5F0F;&#x5316;&#x6807;&#x5FD7;&#x7B26;" class="anchor-navigation-ex-anchor" href="#&#x683C;&#x5F0F;&#x5316;&#x6807;&#x5FD7;&#x7B26;"><i class="fa fa-link" aria-hidden="true"></i></a>19.3. &#x683C;&#x5F0F;&#x5316;&#x6807;&#x5FD7;&#x7B26;</h2>
<h3 id="&#x901A;&#x7528;"><a name="&#x901A;&#x7528;" class="anchor-navigation-ex-anchor" href="#&#x901A;&#x7528;"><i class="fa fa-link" aria-hidden="true"></i></a>19.3.1. &#x901A;&#x7528;</h3>
<pre class="language-"><code class="lang-go"><span class="token operator">%</span>v    the value in a <span class="token keyword">default</span> format
    when printing structs<span class="token punctuation">,</span> the plus flag <span class="token punctuation">(</span><span class="token operator">%</span><span class="token operator">+</span>v<span class="token punctuation">)</span> adds field names
<span class="token operator">%</span>#v   a Go<span class="token operator">-</span>syntax representation of the value
<span class="token operator">%</span>T    a Go<span class="token operator">-</span>syntax representation of the <span class="token keyword">type</span> of the value
<span class="token operator">%</span><span class="token operator">%</span>    a literal percent sign<span class="token punctuation">;</span> consumes no value
</code></pre>
<h3 id="&#x5E03;&#x5C14;&#x503C;"><a name="&#x5E03;&#x5C14;&#x503C;" class="anchor-navigation-ex-anchor" href="#&#x5E03;&#x5C14;&#x503C;"><i class="fa fa-link" aria-hidden="true"></i></a>19.3.2. &#x5E03;&#x5C14;&#x503C;</h3>
<p><code>%t    the word true or false</code></p>
<h3 id="&#x6574;&#x578B;"><a name="&#x6574;&#x578B;" class="anchor-navigation-ex-anchor" href="#&#x6574;&#x578B;"><i class="fa fa-link" aria-hidden="true"></i></a>19.3.3. &#x6574;&#x578B;</h3>
<pre class="language-"><code class="lang-go"><span class="token operator">%</span>b    base <span class="token number">2</span>
<span class="token operator">%</span>c    the character represented by the corresponding Unicode code point
<span class="token operator">%</span>d    base <span class="token number">10</span>
<span class="token operator">%</span>o    base <span class="token number">8</span>
<span class="token operator">%</span>O    base <span class="token number">8</span> with 0o prefix
<span class="token operator">%</span>q    a single<span class="token operator">-</span>quoted character literal safely escaped with Go syntax<span class="token punctuation">.</span>
<span class="token operator">%</span>x    base <span class="token number">16</span><span class="token punctuation">,</span> with lower<span class="token operator">-</span><span class="token keyword">case</span> letters <span class="token keyword">for</span> a<span class="token operator">-</span>f
<span class="token operator">%</span>X    base <span class="token number">16</span><span class="token punctuation">,</span> with upper<span class="token operator">-</span><span class="token keyword">case</span> letters <span class="token keyword">for</span> A<span class="token operator">-</span>F
<span class="token operator">%</span>U    Unicode format<span class="token punctuation">:</span> U<span class="token operator">+</span><span class="token number">1234</span><span class="token punctuation">;</span> same as <span class="token string">&quot;U+%04X&quot;</span>
</code></pre>
<h3 id="&#x6D6E;&#x70B9;"><a name="&#x6D6E;&#x70B9;" class="anchor-navigation-ex-anchor" href="#&#x6D6E;&#x70B9;"><i class="fa fa-link" aria-hidden="true"></i></a>19.3.4. &#x6D6E;&#x70B9;</h3>
<pre class="language-"><code class="lang-go"><span class="token operator">%</span>b    decimalless scientific notation with exponent a power of two<span class="token punctuation">,</span>
    in the manner of strconv<span class="token punctuation">.</span>FormatFloat with the <span class="token char">&apos;b&apos;</span> format<span class="token punctuation">,</span>
    e<span class="token punctuation">.</span>g<span class="token punctuation">.</span> <span class="token operator">-</span>123456p<span class="token operator">-</span><span class="token number">78</span>
<span class="token operator">%</span>e    scientific notation<span class="token punctuation">,</span> e<span class="token punctuation">.</span>g<span class="token punctuation">.</span> <span class="token operator">-</span><span class="token number">1.234456e+78</span>
<span class="token operator">%</span>E    scientific notation<span class="token punctuation">,</span> e<span class="token punctuation">.</span>g<span class="token punctuation">.</span> <span class="token operator">-</span><span class="token number">1.234456E+78</span>
<span class="token operator">%</span>f    decimal point but no exponent<span class="token punctuation">,</span> e<span class="token punctuation">.</span>g<span class="token punctuation">.</span> <span class="token number">123.456</span>
<span class="token operator">%</span>F    synonym <span class="token keyword">for</span> <span class="token operator">%</span>f
<span class="token operator">%</span>g    <span class="token operator">%</span>e <span class="token keyword">for</span> large exponents<span class="token punctuation">,</span> <span class="token operator">%</span>f otherwise<span class="token punctuation">.</span> Precision is discussed below<span class="token punctuation">.</span>
<span class="token operator">%</span>G    <span class="token operator">%</span>E <span class="token keyword">for</span> large exponents<span class="token punctuation">,</span> <span class="token operator">%</span>F otherwise
<span class="token operator">%</span>x    hexadecimal notation <span class="token punctuation">(</span>with decimal power of two exponent<span class="token punctuation">)</span><span class="token punctuation">,</span> e<span class="token punctuation">.</span>g<span class="token punctuation">.</span> <span class="token operator">-</span><span class="token number">0x1.23abcp+20</span>
<span class="token operator">%</span>X    upper<span class="token operator">-</span><span class="token keyword">case</span> hexadecimal notation<span class="token punctuation">,</span> e<span class="token punctuation">.</span>g<span class="token punctuation">.</span> <span class="token operator">-</span><span class="token number">0X1.23ABCP+20</span>
</code></pre>
<h3 id="&#x5B57;&#x7B26;&#x4E32;"><a name="&#x5B57;&#x7B26;&#x4E32;" class="anchor-navigation-ex-anchor" href="#&#x5B57;&#x7B26;&#x4E32;"><i class="fa fa-link" aria-hidden="true"></i></a>19.3.5. &#x5B57;&#x7B26;&#x4E32;</h3>
<pre class="language-"><code class="lang-go"><span class="token operator">%</span>s    the uninterpreted bytes of the <span class="token builtin">string</span> or slice
<span class="token operator">%</span>q    a double<span class="token operator">-</span>quoted <span class="token builtin">string</span> safely escaped with Go syntax
<span class="token operator">%</span>x    base <span class="token number">16</span><span class="token punctuation">,</span> lower<span class="token operator">-</span><span class="token keyword">case</span><span class="token punctuation">,</span> two characters per <span class="token builtin">byte</span>
<span class="token operator">%</span>X    base <span class="token number">16</span><span class="token punctuation">,</span> upper<span class="token operator">-</span><span class="token keyword">case</span><span class="token punctuation">,</span> two characters per <span class="token builtin">byte</span>
</code></pre>
<h3 id="&#x5207;&#x7247;"><a name="&#x5207;&#x7247;" class="anchor-navigation-ex-anchor" href="#&#x5207;&#x7247;"><i class="fa fa-link" aria-hidden="true"></i></a>19.3.6. &#x5207;&#x7247;</h3>
<p><code>%p    address of 0th element in base 16 notation, with leading 0x</code></p>
<h3 id="&#x6307;&#x9488;"><a name="&#x6307;&#x9488;" class="anchor-navigation-ex-anchor" href="#&#x6307;&#x9488;"><i class="fa fa-link" aria-hidden="true"></i></a>19.3.7. &#x6307;&#x9488;</h3>
<pre class="language-"><code class="lang-go"><span class="token operator">%</span>p    base <span class="token number">16</span> notation<span class="token punctuation">,</span> with leading 0x
The <span class="token operator">%</span>b<span class="token punctuation">,</span> <span class="token operator">%</span>d<span class="token punctuation">,</span> <span class="token operator">%</span>o<span class="token punctuation">,</span> <span class="token operator">%</span>x and <span class="token operator">%</span>X verbs also work with pointers<span class="token punctuation">,</span>
formatting the value exactly as <span class="token keyword">if</span> it were an integer<span class="token punctuation">.</span>
</code></pre>
<h3 id="&#x9ED8;&#x8BA4;&#x683C;&#x5F0F;&#x5316;"><a name="&#x9ED8;&#x8BA4;&#x683C;&#x5F0F;&#x5316;" class="anchor-navigation-ex-anchor" href="#&#x9ED8;&#x8BA4;&#x683C;&#x5F0F;&#x5316;"><i class="fa fa-link" aria-hidden="true"></i></a>19.3.8. &#x9ED8;&#x8BA4;&#x683C;&#x5F0F;&#x5316;</h3>
<pre class="language-"><code class="lang-go"><span class="token builtin">bool</span><span class="token punctuation">:</span>                    <span class="token operator">%</span>t
<span class="token builtin">int</span><span class="token punctuation">,</span> <span class="token builtin">int8</span> etc<span class="token punctuation">.</span><span class="token punctuation">:</span>          <span class="token operator">%</span>d
<span class="token builtin">uint</span><span class="token punctuation">,</span> <span class="token builtin">uint8</span> etc<span class="token punctuation">.</span><span class="token punctuation">:</span>        <span class="token operator">%</span>d<span class="token punctuation">,</span> <span class="token operator">%</span>#x <span class="token keyword">if</span> printed with <span class="token operator">%</span>#v
<span class="token builtin">float32</span><span class="token punctuation">,</span> <span class="token builtin">complex64</span><span class="token punctuation">,</span> etc<span class="token punctuation">:</span> <span class="token operator">%</span>g
<span class="token builtin">string</span><span class="token punctuation">:</span>                  <span class="token operator">%</span>s
<span class="token keyword">chan</span><span class="token punctuation">:</span>                    <span class="token operator">%</span>p
pointer<span class="token punctuation">:</span>                 <span class="token operator">%</span>p

<span class="token keyword">struct</span><span class="token punctuation">:</span>             <span class="token punctuation">{</span>field0 field1 <span class="token operator">...</span><span class="token punctuation">}</span>
array<span class="token punctuation">,</span> slice<span class="token punctuation">:</span>       <span class="token punctuation">[</span>elem0 elem1 <span class="token operator">...</span><span class="token punctuation">]</span>
maps<span class="token punctuation">:</span>               <span class="token keyword">map</span><span class="token punctuation">[</span>key1<span class="token punctuation">:</span>value1 key2<span class="token punctuation">:</span>value2 <span class="token operator">...</span><span class="token punctuation">]</span>
pointer to above<span class="token punctuation">:</span>   <span class="token operator">&amp;</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span><span class="token keyword">map</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
</code></pre>
<h3 id="&#x5BBD;&#x5EA6;-&#x7CBE;&#x5EA6;-&#x5BF9;&#x9F50;"><a name="&#x5BBD;&#x5EA6;-&#x7CBE;&#x5EA6;-&#x5BF9;&#x9F50;" class="anchor-navigation-ex-anchor" href="#&#x5BBD;&#x5EA6;-&#x7CBE;&#x5EA6;-&#x5BF9;&#x9F50;"><i class="fa fa-link" aria-hidden="true"></i></a>19.3.9. &#x5BBD;&#x5EA6; &#x7CBE;&#x5EA6; &#x5BF9;&#x9F50;</h3>
<pre class="language-"><code class="lang-go"><span class="token operator">%</span>f     <span class="token keyword">default</span> width<span class="token punctuation">,</span> <span class="token keyword">default</span> precision
<span class="token operator">%</span>9f    width <span class="token number">9</span><span class="token punctuation">,</span> <span class="token keyword">default</span> precision
<span class="token operator">%</span><span class="token punctuation">.</span>2f   <span class="token keyword">default</span> width<span class="token punctuation">,</span> precision <span class="token number">2</span>
<span class="token operator">%</span><span class="token number">9</span><span class="token punctuation">.</span>2f  width <span class="token number">9</span><span class="token punctuation">,</span> precision <span class="token number">2</span>
<span class="token operator">%</span><span class="token number">9</span><span class="token punctuation">.</span>f   width <span class="token number">9</span><span class="token punctuation">,</span> precision <span class="token number">0</span>

<span class="token operator">+</span>    always <span class="token builtin">print</span> a sign <span class="token keyword">for</span> numeric values<span class="token punctuation">;</span>
    guarantee ASCII<span class="token operator">-</span>only output <span class="token keyword">for</span> <span class="token operator">%</span>q <span class="token punctuation">(</span><span class="token operator">%</span><span class="token operator">+</span>q<span class="token punctuation">)</span>
<span class="token operator">-</span>    pad with spaces on the right rather than the left <span class="token punctuation">(</span>left<span class="token operator">-</span>justify the field<span class="token punctuation">)</span>
#    alternate format<span class="token punctuation">:</span> add leading 0b <span class="token keyword">for</span> binary <span class="token punctuation">(</span><span class="token operator">%</span>#b<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span> <span class="token keyword">for</span> octal <span class="token punctuation">(</span><span class="token operator">%</span>#o<span class="token punctuation">)</span><span class="token punctuation">,</span>
    0x or 0X <span class="token keyword">for</span> hex <span class="token punctuation">(</span><span class="token operator">%</span>#x or <span class="token operator">%</span>#X<span class="token punctuation">)</span><span class="token punctuation">;</span> suppress 0x <span class="token keyword">for</span> <span class="token operator">%</span>p <span class="token punctuation">(</span><span class="token operator">%</span>#p<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token operator">%</span>q<span class="token punctuation">,</span> <span class="token builtin">print</span> a raw <span class="token punctuation">(</span>backquoted<span class="token punctuation">)</span> <span class="token builtin">string</span> <span class="token keyword">if</span> strconv<span class="token punctuation">.</span>CanBackquote
    returns <span class="token boolean">true</span><span class="token punctuation">;</span>
    always <span class="token builtin">print</span> a decimal point <span class="token keyword">for</span> <span class="token operator">%</span>e<span class="token punctuation">,</span> <span class="token operator">%</span>E<span class="token punctuation">,</span> <span class="token operator">%</span>f<span class="token punctuation">,</span> <span class="token operator">%</span>F<span class="token punctuation">,</span> <span class="token operator">%</span>g and <span class="token operator">%</span>G<span class="token punctuation">;</span>
    do not remove trailing zeros <span class="token keyword">for</span> <span class="token operator">%</span>g and <span class="token operator">%</span>G<span class="token punctuation">;</span>
    write e<span class="token punctuation">.</span>g<span class="token punctuation">.</span> U<span class="token operator">+</span><span class="token number">0078</span> <span class="token char">&apos;x&apos;</span> <span class="token keyword">if</span> the character is printable <span class="token keyword">for</span> <span class="token operator">%</span>U <span class="token punctuation">(</span><span class="token operator">%</span>#U<span class="token punctuation">)</span><span class="token punctuation">.</span>
<span class="token char">&apos; &apos;</span>    <span class="token punctuation">(</span>space<span class="token punctuation">)</span> leave a space <span class="token keyword">for</span> elided sign in numbers <span class="token punctuation">(</span><span class="token operator">%</span> d<span class="token punctuation">)</span><span class="token punctuation">;</span>
    put spaces between bytes printing strings or slices in hex <span class="token punctuation">(</span><span class="token operator">%</span> x<span class="token punctuation">,</span> <span class="token operator">%</span> X<span class="token punctuation">)</span>
<span class="token number">0</span>    pad with leading zeros rather than spaces<span class="token punctuation">;</span>
    <span class="token keyword">for</span> numbers<span class="token punctuation">,</span> this moves the padding after the sign
</code></pre>
<h2 id="&#x4E3E;&#x4F8B;_1"><a name="&#x4E3E;&#x4F8B;_1" class="anchor-navigation-ex-anchor" href="#&#x4E3E;&#x4F8B;_1"><i class="fa fa-link" aria-hidden="true"></i></a>19.4. &#x4E3E;&#x4F8B;</h2>
<p>fmt&#x683C;&#x5F0F;&#x7684;&#x8BE6;&#x7EC6;&#x4F8B;&#x5B50;, &#x5728;golang&#x7684;doc&#x4E0A;&#x90FD;&#x6709;:
<a href="https://golang.org/pkg/fmt/#example__formats" target="_blank">https://golang.org/pkg/fmt/#example__formats</a></p>
<h3 id="scanf"><a name="scanf" class="anchor-navigation-ex-anchor" href="#scanf"><i class="fa fa-link" aria-hidden="true"></i></a>19.4.1. scanf</h3>
<pre class="language-"><code class="lang-go"><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
    <span class="token string">&quot;fmt&quot;</span>
    <span class="token string">&quot;os&quot;</span>
    <span class="token string">&quot;strings&quot;</span>
<span class="token punctuation">)</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> <span class="token punctuation">(</span>
        i <span class="token builtin">int</span>
        b <span class="token builtin">bool</span>
        s <span class="token builtin">string</span>
    <span class="token punctuation">)</span>
    r <span class="token operator">:=</span> strings<span class="token punctuation">.</span><span class="token function">NewReader</span><span class="token punctuation">(</span><span class="token string">&quot;5 true gophers&quot;</span><span class="token punctuation">)</span>
    n<span class="token punctuation">,</span> err <span class="token operator">:=</span> fmt<span class="token punctuation">.</span><span class="token function">Fscanf</span><span class="token punctuation">(</span>r<span class="token punctuation">,</span> <span class="token string">&quot;%d %t %s&quot;</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>i<span class="token punctuation">,</span> <span class="token operator">&amp;</span>b<span class="token punctuation">,</span> <span class="token operator">&amp;</span>s<span class="token punctuation">)</span>
    <span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
        fmt<span class="token punctuation">.</span><span class="token function">Fprintf</span><span class="token punctuation">(</span>os<span class="token punctuation">.</span>Stderr<span class="token punctuation">,</span> <span class="token string">&quot;Fscanf: %v\n&quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> b<span class="token punctuation">,</span> s<span class="token punctuation">)</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre>
<h1 id="bufio"><a name="bufio" class="anchor-navigation-ex-anchor" href="#bufio"><i class="fa fa-link" aria-hidden="true"></i></a>20. bufio</h1>
<p>bufio&#x662F;&#x5728;io&#x5C42;&#x4E4B;&#x4E0A;&#x7684;, &#x63D0;&#x4F9B;&#x5E26;buffer&#x7684;io
New&#x5BB6;&#x65CF;&#x7684;&#x65B9;&#x6CD5;&#x6709;</p>
<ul>
<li>&#x4F7F;&#x7528;io.Reader&#x521D;&#x59CB;&#x5316;&#x4E00;&#x4E2A;bufio.Reader
<code>func NewReader(rd io.Reader) *Reader</code></li>
<li>&#x4F7F;&#x7528;io.Writer&#x521D;&#x59CB;&#x5316;&#x4E00;&#x4E2A;bufio.Writer
<code>func NewWriter(w io.Writer) *Writer</code></li>
<li>&#x4F7F;&#x7528;bufio&#x7684;Reader&#x548C;Writer&#x521B;&#x5EFA;&#x4E00;&#x4E2A;ReadWriter
<code>func NewReadWriter(r *Reader, w *Writer) *ReadWriter</code></li>
</ul>
<h2 id="error&#x5BF9;&#x8C61;"><a name="error&#x5BF9;&#x8C61;" class="anchor-navigation-ex-anchor" href="#error&#x5BF9;&#x8C61;"><i class="fa fa-link" aria-hidden="true"></i></a>20.1. error&#x5BF9;&#x8C61;</h2>
<p>&#x8FD9;&#x4E2A;&#x6A21;&#x5F0F;&#x5728;go&#x91CC;&#x5F88;&#x5E38;&#x89C1;: &#x628A;&#x9519;&#x8BEF;&#x5B9A;&#x4E49;&#x4E3A;&#x53D8;&#x91CF;, &#x9519;&#x8BEF;&#x7528;error.New&#x521B;&#x5EFA;, &#x53EF;&#x4EE5;&#x88AB;&#x5F53;&#x4F5C;error&#x8FD4;&#x56DE;.</p>
<pre class="language-"><code class="lang-go"><span class="token keyword">var</span> <span class="token punctuation">(</span>
    ErrInvalidUnreadByte <span class="token operator">=</span> errors<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token string">&quot;bufio: invalid use of UnreadByte&quot;</span><span class="token punctuation">)</span>
    ErrInvalidUnreadRune <span class="token operator">=</span> errors<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token string">&quot;bufio: invalid use of UnreadRune&quot;</span><span class="token punctuation">)</span>
    ErrBufferFull        <span class="token operator">=</span> errors<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token string">&quot;bufio: buffer full&quot;</span><span class="token punctuation">)</span>
    ErrNegativeCount     <span class="token operator">=</span> errors<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token string">&quot;bufio: negative count&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span>
</code></pre>
<h2 id="reader&#x7684;&#x65B9;&#x6CD5;"><a name="reader&#x7684;&#x65B9;&#x6CD5;" class="anchor-navigation-ex-anchor" href="#reader&#x7684;&#x65B9;&#x6CD5;"><i class="fa fa-link" aria-hidden="true"></i></a>20.2. Reader&#x7684;&#x65B9;&#x6CD5;</h2>
<p>bufio&#x7684;Reader, &#x53EF;&#x4EE5;</p>
<ul>
<li>&#x770B;&#x5F53;&#x524D;buffer&#x7684;&#x53EF;&#x8BFB;&#x53D6;byte&#x6570;: Buffered</li>
<li>&#x53EF;&#x4EE5;&#x4E22;&#x5F03;&#x5F53;&#x524D;buffer&#x7684;n&#x4E2A;&#x5B57;&#x8282;: Discard</li>
<li>&#x4E34;&#x65F6;&#x8BFB;n&#x4E2A;byte: Peek</li>
<li>&#x8C03;&#x7528;&#x5E95;&#x5C42;io.Reader, &#x8BFB;&#x4E00;&#x6B21;: Read</li>
<li>&#x8BFB;&#x4E00;&#x4E2A;&#x5B57;&#x8282;: ReadByte</li>
<li>&#x8BFB;n&#x4E2A;&#x5B57;&#x8282;, &#x76F4;&#x5230;&#x5206;&#x9694;&#x7B26;: <code>func (b *Reader) ReadBytes(delim byte) ([]byte, error)</code></li>
<li>&#x8BFB;&#x4E00;&#x884C;: ReadLine</li>
<li>&#x8BFB;&#x4E00;&#x4E2A;&#x7B26;&#x6587;: ReadRune</li>
<li>&#x8BFB;&#x51FA;&#x4E00;&#x4E2A;&#x5207;&#x7247;, &#x76F4;&#x5230;&#x67D0;&#x4E2A;&#x5B57;&#x7B26;: ReadSlice</li>
<li>&#x8BFB;&#x51FA;&#x4E00;&#x4E2A;&#x5B57;&#x7B26;&#x4E32;, &#x76F4;&#x5230;&#x67D0;&#x4E2A;&#x5B57;&#x7B26;: ReadString</li>
<li>&#x91CD;&#x7F6E;buffer: Reset</li>
<li>&#x5927;&#x5C0F;: Size</li>
<li>&#x53D6;&#x6D88;&#x4E0A;&#x6B21;&#x8BFB;: UnreadByte</li>
<li>&#x5199;&#x5230;&#x522B;&#x5904;: WriteTo</li>
</ul>
<h2 id="writer&#x7684;&#x65B9;&#x6CD5;"><a name="writer&#x7684;&#x65B9;&#x6CD5;" class="anchor-navigation-ex-anchor" href="#writer&#x7684;&#x65B9;&#x6CD5;"><i class="fa fa-link" aria-hidden="true"></i></a>20.3. Writer&#x7684;&#x65B9;&#x6CD5;</h2>
<ul>
<li>&#x6709;&#x591A;&#x5C11;&#x4E2A;&#x5B57;&#x8282;&#x5728;buffer&#x91CC;&#x672A;&#x88AB;&#x4F7F;&#x7528;: Available</li>
<li>&#x5DF2;&#x7ECF;&#x7528;&#x4E86;&#x591A;&#x5C11;: Buffered</li>
<li>&#x4ECE;&#x4E00;&#x4E2A;Reader&#x91CC;&#x8BFB;: ReadFrom</li>
<li>&#x91CD;&#x7F6E;buffer: Reset</li>
<li>&#x5199;&#x5B57;&#x7B26;&#x5207;&#x7247;, &#x5199;&#x5355;&#x4E2A;&#x5B57;&#x7B26;, &#x5199;&#x5355;&#x4E2A;&#x7B26;&#x6587;, &#x5199;utf8&#x5B57;&#x7B26;&#x4E32;</li>
</ul>
<h2 id="scanner&#x7684;&#x65B9;&#x6CD5;"><a name="scanner&#x7684;&#x65B9;&#x6CD5;" class="anchor-navigation-ex-anchor" href="#scanner&#x7684;&#x65B9;&#x6CD5;"><i class="fa fa-link" aria-hidden="true"></i></a>20.4. Scanner&#x7684;&#x65B9;&#x6CD5;</h2>
<p>bufio&#x63D0;&#x4F9B;&#x4E86;&#x5BF9;&#x6587;&#x4EF6;&#x904D;&#x5386;&#x7684;&#x65B9;&#x6848;: &#x6309;&#x884C;(&#x9ED8;&#x8BA4;&#x884C;&#x4E3A;), &#x6309;&#x7A7A;&#x767D;&#x5B57;&#x7B26;, &#x6309;&#x6307;&#x5B9A;&#x7684;rune, &#x6309;&#x5236;&#x5B9A;&#x7684;byte&#x7B49;&#x65B9;&#x5F0F;.</p>
<h3 id="scanner&#x7684;&#x65B9;&#x6CD5;_1"><a name="scanner&#x7684;&#x65B9;&#x6CD5;_1" class="anchor-navigation-ex-anchor" href="#scanner&#x7684;&#x65B9;&#x6CD5;_1"><i class="fa fa-link" aria-hidden="true"></i></a>20.4.1. Scanner&#x7684;&#x65B9;&#x6CD5;</h3>
<p>&#x8FD9;&#x91CC;&#x7684;Scanner&#x662F;&#x4E2A;&#x5F88;&#x597D;&#x7684;&#x8FED;&#x4EE3;&#x5668;&#x7684;&#x53C2;&#x8003;
New: <code>func NewScanner(r io.Reader) *Scanner</code>
&#x5E38;&#x7528;&#x7684;&#x65B9;&#x6CD5;:</p>
<ul>
<li>Scan: &#x6839;&#x636E;split&#x7684;&#x5B9A;&#x4E49;, &#x5185;&#x90E8;&#x4FDD;&#x5B58;&#x672C;&#x6B21;token, &#x8FD4;&#x56DE;&#x662F;&#x5426;&#x7ED3;&#x675F;.</li>
<li>Text&#x6216;&#x8005;Bytes : &#x83B7;&#x53D6;&#x6700;&#x540E;&#x4E00;&#x6B21;Scan&#x5230;&#x7684;token
&#x6211;&#x89C9;&#x5F97;&#x5176;&#x5B9E;Scan&#x53EF;&#x4EE5;&#x8FD4;&#x56DE;&#x4E24;&#x4E2A;&#x503C;, &#x7B2C;&#x4E00;&#x4E2A;&#x662F;token, &#x7B2C;&#x4E8C;&#x4E2A;&#x624D;&#x662F;&#x8868;&#x793A;&#x7ED3;&#x675F;&#x7684;bool&#x503C;.
&#x90A3;&#x4E48;<code>for scanner.Scan() {...}</code>
&#x5C31;&#x53EF;&#x4EE5;&#x5199;&#x6210;<code>for token, finish := scanner.Scan(); finish != ture; token, finish := scanner.Scan(); {...}</code>, &#x4E0D;&#x662F;&#x7701;&#x6389;&#x4E86;<code>scanner.Text()</code>&#x8C03;&#x7528;?
&#x4F3C;&#x4E4E;&#x4EBA;&#x5BB6;&#x8FD9;&#x4E48;&#x8BBE;&#x8BA1;&#x662F;&#x6709;&#x539F;&#x56E0;&#x7684;, &#x53EF;&#x80FD;&#x548C;go&#x6CA1;&#x6709;do while&#x7ED3;&#x6784;&#x6709;&#x5173;.</li>
<li>SplitFunc&#x65B9;&#x6CD5;
&#x7528;&#x6765;&#x5B9A;&#x4E49;&#x5206;&#x5272;&#x7B26;&#x7684;
<code>type SplitFunc func(data []byte, atEOF bool) (advance int, token []byte, err error)</code>
&#x88AB;Scan&#x8C03;&#x7528;. data&#x662F;Scan&#x4F20;&#x7ED9;SplitFunc&#x7684;&#x6570;&#x636E;, &#x662F;&#x5269;&#x4E0B;&#x672A;&#x88AB;&#x626B;&#x63CF;&#x7684;&#x5B57;&#x7B26;&#x6570;&#x7EC4;, &#x548C;&#x4E00;&#x4E2A;&#x5E95;&#x5C42;io.Reader&#x662F;&#x5426;&#x5DF2;&#x7ECF;&#x662F;EOF&#x7684;&#x6807;&#x8BB0;.
&#x8FD4;&#x56DE;&#x7684;avance&#x662F;&#x672C;&#x6B21;&#x5728;buffer&#x91CC;&#x524D;&#x8FDB;&#x4E86;&#x591A;&#x5C11;&#x4E2A;&#x5B57;&#x8282;, token&#x662F;&#x672C;&#x6B21;&#x626B;&#x63CF;&#x5230;&#x7684;token.</li>
</ul>
<h3 id="&#x6309;&#x884C;&#x8BFB;"><a name="&#x6309;&#x884C;&#x8BFB;" class="anchor-navigation-ex-anchor" href="#&#x6309;&#x884C;&#x8BFB;"><i class="fa fa-link" aria-hidden="true"></i></a>20.4.2. &#x6309;&#x884C;&#x8BFB;</h3>
<pre class="language-"><code class="lang-go"><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
    <span class="token string">&quot;bufio&quot;</span>
    <span class="token string">&quot;fmt&quot;</span>
    <span class="token string">&quot;os&quot;</span>
<span class="token punctuation">)</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    scanner <span class="token operator">:=</span> bufio<span class="token punctuation">.</span><span class="token function">NewScanner</span><span class="token punctuation">(</span>os<span class="token punctuation">.</span>Stdin<span class="token punctuation">)</span>
    <span class="token comment">//&#x8FD9;&#x91CC;&#x50CF;&#x4E2A;&#x8FED;&#x4EE3;&#x5668;, &#x5B9E;&#x9645;&#x662F;&#x6BCF;&#x6B21;for&#x90FD;&#x8C03;&#x7528;&#x4E00;&#x6B21;Scan, Scan&#x8FD4;&#x56DE;&#x8FD9;&#x6B21;&#x7684;token, &#x5373;&#x88AB;&#x5206;&#x5272;&#x540E;&#x7684;&#x5B57;&#x7B26;</span>
    <span class="token comment">//&#x7528;Text&#x6216;&#x8005;Bytes&#x65B9;&#x6CD5;&#x8FD4;&#x56DE;token.</span>
    <span class="token keyword">for</span> scanner<span class="token punctuation">.</span><span class="token function">Scan</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>scanner<span class="token punctuation">.</span><span class="token function">Text</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// Println will add back the final &apos;\n&apos;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span> err <span class="token operator">:=</span> scanner<span class="token punctuation">.</span><span class="token function">Err</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
        fmt<span class="token punctuation">.</span><span class="token function">Fprintln</span><span class="token punctuation">(</span>os<span class="token punctuation">.</span>Stderr<span class="token punctuation">,</span> <span class="token string">&quot;reading standard input:&quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<h3 id="&#x7EDF;&#x8BA1;&#x5B57;&#x7B26;&#x4E2A;&#x6570;"><a name="&#x7EDF;&#x8BA1;&#x5B57;&#x7B26;&#x4E2A;&#x6570;" class="anchor-navigation-ex-anchor" href="#&#x7EDF;&#x8BA1;&#x5B57;&#x7B26;&#x4E2A;&#x6570;"><i class="fa fa-link" aria-hidden="true"></i></a>20.4.3. &#x7EDF;&#x8BA1;&#x5B57;&#x7B26;&#x4E2A;&#x6570;</h3>
<pre class="language-"><code class="lang-go"><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
    <span class="token string">&quot;bufio&quot;</span>
    <span class="token string">&quot;fmt&quot;</span>
    <span class="token string">&quot;os&quot;</span>
    <span class="token string">&quot;strings&quot;</span>
<span class="token punctuation">)</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// An artificial input source.</span>
    <span class="token keyword">const</span> input <span class="token operator">=</span> <span class="token string">&quot;Now is the winter of our discontent,\nMade glorious summer by this sun of York.\n&quot;</span>
    scanner <span class="token operator">:=</span> bufio<span class="token punctuation">.</span><span class="token function">NewScanner</span><span class="token punctuation">(</span>strings<span class="token punctuation">.</span><span class="token function">NewReader</span><span class="token punctuation">(</span>input<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token comment">// Set the split function for the scanning operation.</span>
    scanner<span class="token punctuation">.</span><span class="token function">Split</span><span class="token punctuation">(</span>bufio<span class="token punctuation">.</span>ScanWords<span class="token punctuation">)</span>
    <span class="token comment">// Count the words.</span>
    count <span class="token operator">:=</span> <span class="token number">0</span>
    <span class="token keyword">for</span> scanner<span class="token punctuation">.</span><span class="token function">Scan</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        count<span class="token operator">++</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span> err <span class="token operator">:=</span> scanner<span class="token punctuation">.</span><span class="token function">Err</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
        fmt<span class="token punctuation">.</span><span class="token function">Fprintln</span><span class="token punctuation">(</span>os<span class="token punctuation">.</span>Stderr<span class="token punctuation">,</span> <span class="token string">&quot;reading input:&quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;%d\n&quot;</span><span class="token punctuation">,</span> count<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre>
<h3 id="&#x4E5F;&#x53EF;&#x4EE5;&#x81EA;&#x5B9A;&#x4E49;&#x5206;&#x5272;&#x51FD;&#x6570;"><a name="&#x4E5F;&#x53EF;&#x4EE5;&#x81EA;&#x5B9A;&#x4E49;&#x5206;&#x5272;&#x51FD;&#x6570;" class="anchor-navigation-ex-anchor" href="#&#x4E5F;&#x53EF;&#x4EE5;&#x81EA;&#x5B9A;&#x4E49;&#x5206;&#x5272;&#x51FD;&#x6570;"><i class="fa fa-link" aria-hidden="true"></i></a>20.4.4. &#x4E5F;&#x53EF;&#x4EE5;&#x81EA;&#x5B9A;&#x4E49;&#x5206;&#x5272;&#x51FD;&#x6570;</h3>
<pre class="language-"><code class="lang-go"><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
    <span class="token string">&quot;bufio&quot;</span>
    <span class="token string">&quot;fmt&quot;</span>
    <span class="token string">&quot;strconv&quot;</span>
    <span class="token string">&quot;strings&quot;</span>
<span class="token punctuation">)</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// An artificial input source.</span>
    <span class="token keyword">const</span> input <span class="token operator">=</span> <span class="token string">&quot;1234 5678 1234567901234567890&quot;</span>
    scanner <span class="token operator">:=</span> bufio<span class="token punctuation">.</span><span class="token function">NewScanner</span><span class="token punctuation">(</span>strings<span class="token punctuation">.</span><span class="token function">NewReader</span><span class="token punctuation">(</span>input<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token comment">// Create a custom split function by wrapping the existing ScanWords function.</span>
    split <span class="token operator">:=</span> <span class="token keyword">func</span><span class="token punctuation">(</span>data <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">byte</span><span class="token punctuation">,</span> atEOF <span class="token builtin">bool</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>advance <span class="token builtin">int</span><span class="token punctuation">,</span> token <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">byte</span><span class="token punctuation">,</span> err <span class="token builtin">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        advance<span class="token punctuation">,</span> token<span class="token punctuation">,</span> err <span class="token operator">=</span> bufio<span class="token punctuation">.</span><span class="token function">ScanWords</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> atEOF<span class="token punctuation">)</span>
        <span class="token keyword">if</span> err <span class="token operator">==</span> <span class="token boolean">nil</span> <span class="token operator">&amp;&amp;</span> token <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
            <span class="token boolean">_</span><span class="token punctuation">,</span> err <span class="token operator">=</span> strconv<span class="token punctuation">.</span><span class="token function">ParseInt</span><span class="token punctuation">(</span><span class="token function">string</span><span class="token punctuation">(</span>token<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// Set the split function for the scanning operation.</span>
    scanner<span class="token punctuation">.</span><span class="token function">Split</span><span class="token punctuation">(</span>split<span class="token punctuation">)</span>
    <span class="token comment">// Validate the input</span>
    <span class="token keyword">for</span> scanner<span class="token punctuation">.</span><span class="token function">Scan</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;%s\n&quot;</span><span class="token punctuation">,</span> scanner<span class="token punctuation">.</span><span class="token function">Text</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">if</span> err <span class="token operator">:=</span> scanner<span class="token punctuation">.</span><span class="token function">Err</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
        fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;Invalid input: %s&quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<h1 id="ioioutil"><a name="ioioutil" class="anchor-navigation-ex-anchor" href="#ioioutil"><i class="fa fa-link" aria-hidden="true"></i></a>21. io/ioutil</h1>
<p>&#x5305;&#x62EC;&#x4E86;ReadAll ReadDir ReadFile WriteFile&#x7B49;&#x65B9;&#x6CD5;.
&#x8FD8;&#x5305;&#x62EC;&#x4E00;&#x4E2A;<code>/dev/null</code>&#x5BF9;&#x8C61;:
<code>var Discard io.Writer = devNull(0)</code></p>
<pre class="language-"><code class="lang-go"><span class="token keyword">func</span> <span class="token function">NopCloser</span><span class="token punctuation">(</span>r io<span class="token punctuation">.</span>Reader<span class="token punctuation">)</span> io<span class="token punctuation">.</span>ReadCloser
<span class="token keyword">func</span> <span class="token function">ReadAll</span><span class="token punctuation">(</span>r io<span class="token punctuation">.</span>Reader<span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">byte</span><span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span>
<span class="token keyword">func</span> <span class="token function">ReadDir</span><span class="token punctuation">(</span>dirname <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span>os<span class="token punctuation">.</span>FileInfo<span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span>
<span class="token keyword">func</span> <span class="token function">ReadFile</span><span class="token punctuation">(</span>filename <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">byte</span><span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span>
<span class="token keyword">func</span> <span class="token function">TempDir</span><span class="token punctuation">(</span>dir<span class="token punctuation">,</span> prefix <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>name <span class="token builtin">string</span><span class="token punctuation">,</span> err <span class="token builtin">error</span><span class="token punctuation">)</span>
<span class="token keyword">func</span> <span class="token function">TempFile</span><span class="token punctuation">(</span>dir<span class="token punctuation">,</span> pattern <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>f <span class="token operator">*</span>os<span class="token punctuation">.</span>File<span class="token punctuation">,</span> err <span class="token builtin">error</span><span class="token punctuation">)</span>
<span class="token keyword">func</span> <span class="token function">WriteFile</span><span class="token punctuation">(</span>filename <span class="token builtin">string</span><span class="token punctuation">,</span> data <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">byte</span><span class="token punctuation">,</span> perm os<span class="token punctuation">.</span>FileMode<span class="token punctuation">)</span> <span class="token builtin">error</span>
</code></pre>
<h1 id="io"><a name="io" class="anchor-navigation-ex-anchor" href="#io"><i class="fa fa-link" aria-hidden="true"></i></a>22. io</h1>
<p>io&#x5305;&#x63D0;&#x4F9B;&#x5E95;&#x5C42;&#x7684;io&#x539F;&#x8BED;, &#x4E3B;&#x8981;&#x7684;&#x5DE5;&#x4F5C;&#x662F;&#x5BF9;os&#x5305;&#x7684;&#x4E00;&#x5C42;&#x5C01;&#x88C5;, &#x63D0;&#x4F9B;&#x63A5;&#x53E3;&#x7684;&#x62BD;&#x8C61;</p>
<h2 id="&#x53D8;&#x91CF;"><a name="&#x53D8;&#x91CF;" class="anchor-navigation-ex-anchor" href="#&#x53D8;&#x91CF;"><i class="fa fa-link" aria-hidden="true"></i></a>22.1. &#x53D8;&#x91CF;</h2>
<p>io&#x5305;&#x91CC;, &#x5B9A;&#x4E49;&#x4E86;&#x4E00;&#x4E9B;&#x53D8;&#x91CF;. &#x662F;io&#x5305;&#x6301;&#x6709;&#x7684;&#x4E00;&#x4E9B;&#x5BF9;&#x8C61;.
&#x4E3B;&#x8981;&#x662F;&#x4E00;&#x4E9B;&#x9519;&#x8BEF;&#x7684;&#x5BF9;&#x8C61;, &#x5176;&#x4ED6;&#x7A0B;&#x5E8F;&#x53EF;&#x4EE5;&#x76F4;&#x63A5;&#x7528;. &#x6BD4;&#x5982;:</p>
<pre class="language-"><code class="lang-go"><span class="token keyword">var</span> EOF <span class="token operator">=</span> errors<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token string">&quot;EOF&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">var</span> ErrClosedPipe <span class="token operator">=</span> errors<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token string">&quot;io: read/write on closed pipe&quot;</span><span class="token punctuation">)</span>
<span class="token operator">...</span>
</code></pre>
<h2 id="&#x4EE5;reader&#x4E3A;&#x4F8B;-&#x770B;golang&#x7684;&#x6D3E;&#x751F;"><a name="&#x4EE5;reader&#x4E3A;&#x4F8B;-&#x770B;golang&#x7684;&#x6D3E;&#x751F;" class="anchor-navigation-ex-anchor" href="#&#x4EE5;reader&#x4E3A;&#x4F8B;-&#x770B;golang&#x7684;&#x6D3E;&#x751F;"><i class="fa fa-link" aria-hidden="true"></i></a>22.2. &#x4EE5;Reader&#x4E3A;&#x4F8B;, &#x770B;golang&#x7684;&#x6D3E;&#x751F;</h2>
<p>io&#x91CC;&#x9762;&#x7684;&#x65B9;&#x6CD5;&#x548C;&#x7ED3;&#x6784;, &#x5145;&#x5206;&#x5C55;&#x793A;&#x4E86;golang&#x5B9E;&#x73B0;&#x57FA;&#x7C7B;&#x548C;&#x6D3E;&#x751F;&#x7C7B;&#x7684;&#x65B9;&#x5F0F;.
C++&#x7684;&#x6D3E;&#x751F;&#x662F;&#x9760;&#x8840;&#x7F18;&#x65B9;&#x5F0F;, &#x5BB6;&#x65CF;&#x5F0F;&#x7684;
Go&#x7684;&#x6D3E;&#x751F;&#x662F;&#x515A;&#x6D3E;&#x65B9;&#x5F0F;, &#x53EA;&#x8981;&#x4F60;&#x7684;&#x65B9;&#x6CD5;&#x548C;&#x6211;&#x7684;&#x4E00;&#x6837;, &#x5C31;&#x662F;&#x81EA;&#x5DF1;&#x4EBA;.</p>
<p>Reader, &#x53EF;&#x4EE5;&#x8BA4;&#x4E3A;&#x662F;&#x4E2A;&#x57FA;&#x7C7B;
&#x6BD4;&#x5982;, &#x53EA;&#x8981;&#x5B9E;&#x73B0;&#x4E86;Read&#x65B9;&#x6CD5;&#x7684;&#x7C7B;&#x578B;, &#x90FD;&#x662F;Reader:</p>
<pre class="language-"><code class="lang-go"><span class="token comment">//read&#x5230;p&#x91CC;, &#x6700;&#x5927;len(p)</span>
<span class="token keyword">type</span> Reader <span class="token keyword">interface</span> <span class="token punctuation">{</span>
    <span class="token function">Read</span><span class="token punctuation">(</span>p <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">byte</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>n <span class="token builtin">int</span><span class="token punctuation">,</span> err <span class="token builtin">error</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre>
<p>&#x6CE8;:</p>
<ul>
<li>Read, &#x5C31;&#x662F;&#x4ECE;&#x4EC0;&#x4E48;&#x5730;&#x65B9;, &#x628A;data&#x8BFB;&#x51FA;&#x6765;, &#x653E;&#x5230;&#x4E00;&#x4E2A;buf&#x91CC;. 
&#x548C;C&#x7684;read&#x4E00;&#x6837;, &#x7528;&#x6237;&#x8981;&#x4F20;&#x5165;&#x4E00;&#x4E2A;buf, &#x5728;&#x8FD9;&#x91CC;&#x662F;&#x4E2A;&#x5207;&#x7247;<code>p []byte</code>, go&#x7684;&#x5207;&#x7247;&#x81EA;&#x5E26;&#x5927;&#x5C0F;, &#x6240;&#x4EE5;&#x4E0D;&#x7528;&#x4F20;size</li>
<li>Read&#x4E0D;&#x7528;&#x7B49;&#x5230;&#x5230;&#x6700;&#x5927;size, &#x5373;len(p)&#x624D;&#x8FD4;&#x56DE;. &#x53EA;&#x8981;&#x8FD9;&#x6B21;&#x7684;data&#x5230;&#x4F4D;&#x4E86;, &#x5C31;&#x8FD4;&#x56DE;.</li>
<li>Read&#x7684;&#x5B9E;&#x73B0;&#x4E2D;, &#x4E0D;&#x80FD;&#x6301;&#x6709;p, &#x5373;&#x4E0D;&#x80FD;&#x5BF9;p&#x589E;&#x52A0;&#x5F15;&#x7528;.</li>
</ul>
<h2 id="pipereader-&#x6D3E;&#x751F;&#x7C7B;"><a name="pipereader-&#x6D3E;&#x751F;&#x7C7B;" class="anchor-navigation-ex-anchor" href="#pipereader-&#x6D3E;&#x751F;&#x7C7B;"><i class="fa fa-link" aria-hidden="true"></i></a>22.3. PipeReader, &#x6D3E;&#x751F;&#x7C7B;</h2>
<p>Reader&#x7684;&#x6D3E;&#x751F;&#x7C7B;, PipeReader&#x5B9E;&#x73B0;&#x4E86;Read&#x65B9;&#x6CD5;. 
&#x6240;&#x4EE5;&#x867D;&#x7136;&#x5F62;&#x5F0F;&#x4E0A;PipeReader&#x662F;&#x4E2A;struct, &#x800C;Reader&#x662F;interface, &#x4F46;&#x56E0;&#x4E3A;interface&#x53EF;&#x4EE5;&#x662F;&#x4EFB;&#x4F55;&#x4E1C;&#x897F;, &#x6709;&#x70B9;&#x7C7B;&#x4F3C;C&#x8BED;&#x8A00;&#x7684;<code>void *</code>
&#x6240;&#x4EE5;, PipeReader&#x4E5F;&#x662F;Reader. &#x6240;&#x6709;Reader&#x80FD;&#x9002;&#x7528;&#x7684;&#x5730;&#x65B9;, PipeReader&#x4E00;&#x6837;&#x9002;&#x7528;.</p>
<pre class="language-"><code class="lang-go"><span class="token keyword">type</span> PipeReader <span class="token keyword">struct</span> <span class="token punctuation">{</span>
    <span class="token comment">// contains filtered or unexported fields</span>
<span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>r <span class="token operator">*</span>PipeReader<span class="token punctuation">)</span> <span class="token function">Read</span><span class="token punctuation">(</span>data <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">byte</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>n <span class="token builtin">int</span><span class="token punctuation">,</span> err <span class="token builtin">error</span><span class="token punctuation">)</span>
</code></pre>
<hr>
<p>Writer&#x548C;Reader&#x7C7B;&#x4F3C;, &#x5B83;&#x6709;&#x6D3E;&#x751F;&#x7C7B;:
<code>PipeWriter StringWriter ByteWriter</code>&#x7B49;&#x7B49;</p>
<h2 id="readwriter"><a name="readwriter" class="anchor-navigation-ex-anchor" href="#readwriter"><i class="fa fa-link" aria-hidden="true"></i></a>22.4. ReadWriter</h2>
<p>ReadWriter&#x662F;Reader&#x548C;Writer&#x7684;&#x7EC4;&#x5408;</p>
<pre class="language-"><code class="lang-go"><span class="token keyword">type</span> ReadWriter <span class="token keyword">interface</span> <span class="token punctuation">{</span>
    Reader
    Writer
<span class="token punctuation">}</span>
</code></pre>
<h3 id="writerto"><a name="writerto" class="anchor-navigation-ex-anchor" href="#writerto"><i class="fa fa-link" aria-hidden="true"></i></a>22.4.1. WriterTo</h3>
<p>&#x4E00;&#x4E2A;&#x5B9E;&#x73B0;&#x4E86;Reader&#x7684;&#x7C7B;&#x578B;, &#x4E5F;&#x53EF;&#x4EE5;&#x5B9E;&#x73B0;WriteTo&#x65B9;&#x6CD5;, &#x4ECE;&#x800C;&#x4E5F;&#x662F;WriterTo
&#x5B9A;&#x4E49;&#x8FD9;&#x4E2A;WriterTo&#x7C7B;&#x578B;, &#x7C7B;&#x578B;&#x65AD;&#x8A00;&#x4F1A;&#x7528;&#x5230;.</p>
<pre class="language-"><code class="lang-go"><span class="token keyword">type</span> WriterTo <span class="token keyword">interface</span> <span class="token punctuation">{</span>
    <span class="token function">WriteTo</span><span class="token punctuation">(</span>w Writer<span class="token punctuation">)</span> <span class="token punctuation">(</span>n <span class="token builtin">int64</span><span class="token punctuation">,</span> err <span class="token builtin">error</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre>
<h2 id="readerat"><a name="readerat" class="anchor-navigation-ex-anchor" href="#readerat"><i class="fa fa-link" aria-hidden="true"></i></a>22.5. ReaderAt</h2>
<p>&#x5E26;offset&#x7684;Reader, &#x662F;&#x4E2A;&#x63A5;&#x53E3;.</p>
<h2 id="&#x5176;&#x4ED6;&#x57FA;&#x7C7B;"><a name="&#x5176;&#x4ED6;&#x57FA;&#x7C7B;" class="anchor-navigation-ex-anchor" href="#&#x5176;&#x4ED6;&#x57FA;&#x7C7B;"><i class="fa fa-link" aria-hidden="true"></i></a>22.6. &#x5176;&#x4ED6;&#x57FA;&#x7C7B;</h2>
<ul>
<li>Closer: &#x5305;&#x88C5;&#x4E86;Close&#x65B9;&#x6CD5;&#x7684;interface<pre class="language-"><code class="lang-go"><span class="token keyword">type</span> Closer <span class="token keyword">interface</span> <span class="token punctuation">{</span>
  <span class="token function">Close</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token builtin">error</span>
<span class="token punctuation">}</span>
</code></pre>
</li>
<li>&#x4ECE;C&#x7684;&#x6982;&#x5FF5;&#x6765;&#x7684;, &#x6307;&#x5B9A;&#x4E0B;&#x6B21;&#x7684;&#x8BFB;&#x5199;&#x4ECE;&#x54EA;&#x91CC;&#x5F00;&#x59CB; <pre class="language-"><code class="lang-go"><span class="token keyword">type</span> Seeker <span class="token keyword">interface</span> <span class="token punctuation">{</span>
  <span class="token function">Seek</span><span class="token punctuation">(</span>offset <span class="token builtin">int64</span><span class="token punctuation">,</span> whence <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token builtin">int64</span><span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre>
&#x7B49;&#x7B49;</li>
</ul>
<h2 id="seeker"><a name="seeker" class="anchor-navigation-ex-anchor" href="#seeker"><i class="fa fa-link" aria-hidden="true"></i></a>22.7. Seeker</h2>
<p>Seeker&#x51B3;&#x5B9A;&#x4E0B;&#x6B21;&#x8BFB;&#x5199;&#x7684;offset. whence&#x8868;&#x793A;offset&#x7684;&#x76F8;&#x5BF9;&#x4F4D;&#x7F6E;, &#x53EF;&#x4EE5;&#x76F8;&#x5BF9;&#x6587;&#x4EF6;&#x5F00;&#x5934;, &#x5F53;&#x524D;, &#x548C;&#x7ED3;&#x5C3E;.</p>
<pre class="language-"><code class="lang-go"><span class="token keyword">type</span> Seeker <span class="token keyword">interface</span> <span class="token punctuation">{</span>
    <span class="token function">Seek</span><span class="token punctuation">(</span>offset <span class="token builtin">int64</span><span class="token punctuation">,</span> whence <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token builtin">int64</span><span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre>
<h2 id="io&#x5305;&#x7684;&#x65B9;&#x6CD5;"><a name="io&#x5305;&#x7684;&#x65B9;&#x6CD5;" class="anchor-navigation-ex-anchor" href="#io&#x5305;&#x7684;&#x65B9;&#x6CD5;"><i class="fa fa-link" aria-hidden="true"></i></a>22.8. io&#x5305;&#x7684;&#x65B9;&#x6CD5;</h2>
<h3 id="copy"><a name="copy" class="anchor-navigation-ex-anchor" href="#copy"><i class="fa fa-link" aria-hidden="true"></i></a>22.8.1. Copy</h3>
<pre class="language-"><code class="lang-go"><span class="token keyword">func</span> <span class="token function">Copy</span><span class="token punctuation">(</span>dst Writer<span class="token punctuation">,</span> src Reader<span class="token punctuation">)</span> <span class="token punctuation">(</span>written <span class="token builtin">int64</span><span class="token punctuation">,</span> err <span class="token builtin">error</span><span class="token punctuation">)</span>
</code></pre>
<p>&#x4E3E;&#x4F8B;, &#x8FD9;&#x91CC;&#x53EA;&#x662F;&#x6F14;&#x793A;, &#x628A;&#x4E00;&#x6BB5;&#x5B57;&#x7B26;&#x4E32;, copy&#x5230;&#x6807;&#x51C6;&#x8F93;&#x51FA;.
&#x56E0;&#x4E3A;&#x6807;&#x51C6;&#x8F93;&#x51FA;&#x4E5F;&#x662F;&#x4E00;&#x4E2A;Writer</p>
<pre class="language-"><code class="lang-go"><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
    <span class="token string">&quot;io&quot;</span>
    <span class="token string">&quot;log&quot;</span>
    <span class="token string">&quot;os&quot;</span>
    <span class="token string">&quot;strings&quot;</span>
<span class="token punctuation">)</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    r <span class="token operator">:=</span> strings<span class="token punctuation">.</span><span class="token function">NewReader</span><span class="token punctuation">(</span><span class="token string">&quot;some io.Reader stream to be read\n&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token boolean">_</span><span class="token punctuation">,</span> err <span class="token operator">:=</span> io<span class="token punctuation">.</span><span class="token function">Copy</span><span class="token punctuation">(</span>os<span class="token punctuation">.</span>Stdout<span class="token punctuation">,</span> r<span class="token punctuation">)</span><span class="token punctuation">;</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
        log<span class="token punctuation">.</span><span class="token function">Fatal</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<hr>
<p>Copy&#x7684;&#x5B9E;&#x73B0;:
&#x4E0A;&#x9762;&#x63D0;&#x5230;&#x8FC7;, WriterTo&#x548C;Reader&#x53EF;&#x4EE5;&#x662F;&#x540C;&#x4E00;&#x4E2A;&#x7C7B;&#x578B;, &#x5728;Copy&#x7684;&#x5B9E;&#x73B0;&#x4E2D;, &#x6709;&#x8FD9;&#x6837;&#x7684;&#x7C7B;&#x578B;&#x65AD;&#x8A00;</p>
<pre class="language-"><code class="lang-go"><span class="token comment">// copyBuffer is the actual implementation of Copy and CopyBuffer.</span>
<span class="token comment">// if buf is nil, one is allocated.</span>
<span class="token keyword">func</span> <span class="token function">copyBuffer</span><span class="token punctuation">(</span>dst Writer<span class="token punctuation">,</span> src Reader<span class="token punctuation">,</span> buf <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">byte</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>written <span class="token builtin">int64</span><span class="token punctuation">,</span> err <span class="token builtin">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// If the reader has a WriteTo method, use it to do the copy.</span>
    <span class="token comment">// Avoids an allocation and a copy.</span>
    <span class="token keyword">if</span> wt<span class="token punctuation">,</span> ok <span class="token operator">:=</span> src<span class="token punctuation">.</span><span class="token punctuation">(</span>WriterTo<span class="token punctuation">)</span><span class="token punctuation">;</span> ok <span class="token punctuation">{</span>
        <span class="token keyword">return</span> wt<span class="token punctuation">.</span><span class="token function">WriteTo</span><span class="token punctuation">(</span>dst<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// Similarly, if the writer has a ReadFrom method, use it to do the copy.</span>
    <span class="token keyword">if</span> rt<span class="token punctuation">,</span> ok <span class="token operator">:=</span> dst<span class="token punctuation">.</span><span class="token punctuation">(</span>ReaderFrom<span class="token punctuation">)</span><span class="token punctuation">;</span> ok <span class="token punctuation">{</span>
        <span class="token keyword">return</span> rt<span class="token punctuation">.</span><span class="token function">ReadFrom</span><span class="token punctuation">(</span>src<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span> buf <span class="token operator">==</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
        <span class="token comment">//&#x9ED8;&#x8BA4;32K&#x7684;buf</span>
        buf <span class="token operator">=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">byte</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token operator">*</span><span class="token number">1024</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">for</span> <span class="token punctuation">{</span>
        nr<span class="token punctuation">,</span> er <span class="token operator">:=</span> src<span class="token punctuation">.</span><span class="token function">Read</span><span class="token punctuation">(</span>buf<span class="token punctuation">)</span>
        <span class="token keyword">if</span> nr <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token punctuation">{</span>
            <span class="token comment">//&#x8FD9;&#x91CC;&#x76F4;&#x63A5;&#x4F20;&#x5165;&#x5207;&#x7247; buf[0:nr]</span>
            nw<span class="token punctuation">,</span> ew <span class="token operator">:=</span> dst<span class="token punctuation">.</span><span class="token function">Write</span><span class="token punctuation">(</span>buf<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span>nr<span class="token punctuation">]</span><span class="token punctuation">)</span>
            <span class="token keyword">if</span> nw <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token punctuation">{</span>
                written <span class="token operator">+=</span> <span class="token function">int64</span><span class="token punctuation">(</span>nw<span class="token punctuation">)</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">if</span> ew <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
                err <span class="token operator">=</span> ew
                <span class="token keyword">break</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">if</span> nr <span class="token operator">!=</span> nw <span class="token punctuation">{</span>
                err <span class="token operator">=</span> ErrShortWrite
                <span class="token keyword">break</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">if</span> er <span class="token operator">==</span> EOF <span class="token punctuation">{</span>
            <span class="token keyword">break</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">if</span> er <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
            err <span class="token operator">=</span> er
            <span class="token keyword">break</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> written<span class="token punctuation">,</span> err
<span class="token punctuation">}</span>
</code></pre>
<h3 id="pipe"><a name="pipe" class="anchor-navigation-ex-anchor" href="#pipe"><i class="fa fa-link" aria-hidden="true"></i></a>22.8.2. Pipe</h3>
<p>Pipe&#x8FD4;&#x56DE;&#x4E00;&#x4E2A;&#x7BA1;&#x9053;&#x5BF9;, &#x4E00;&#x4E2A;&#x7528;&#x6765;&#x8BFB;, &#x4E00;&#x4E2A;&#x7528;&#x6765;&#x5199;</p>
<pre class="language-"><code class="lang-go"><span class="token keyword">func</span> <span class="token function">Pipe</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token operator">*</span>PipeReader<span class="token punctuation">,</span> <span class="token operator">*</span>PipeWriter<span class="token punctuation">)</span>
</code></pre>
<p>&#x4E3E;&#x4F8B;, &#x521B;&#x5EFA;&#x4E00;&#x5BF9;&#x8BFB;&#x5199;pipe, &#x4E00;&#x4E2A;go routine&#x5199;, &#x4E3B;&#x7A0B;&#x5E8F;&#x8BFB;.</p>
<pre class="language-"><code class="lang-go"><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
    <span class="token string">&quot;bytes&quot;</span>
    <span class="token string">&quot;fmt&quot;</span>
    <span class="token string">&quot;io&quot;</span>
<span class="token punctuation">)</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    r<span class="token punctuation">,</span> w <span class="token operator">:=</span> io<span class="token punctuation">.</span><span class="token function">Pipe</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token keyword">go</span> <span class="token keyword">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        fmt<span class="token punctuation">.</span><span class="token function">Fprint</span><span class="token punctuation">(</span>w<span class="token punctuation">,</span> <span class="token string">&quot;some text to be read\n&quot;</span><span class="token punctuation">)</span>
        w<span class="token punctuation">.</span><span class="token function">Close</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

    buf <span class="token operator">:=</span> <span class="token function">new</span><span class="token punctuation">(</span>bytes<span class="token punctuation">.</span>Buffer<span class="token punctuation">)</span>
    buf<span class="token punctuation">.</span><span class="token function">ReadFrom</span><span class="token punctuation">(</span>r<span class="token punctuation">)</span>
    fmt<span class="token punctuation">.</span><span class="token function">Print</span><span class="token punctuation">(</span>buf<span class="token punctuation">.</span><span class="token function">String</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre>
<h3 id="teereader"><a name="teereader" class="anchor-navigation-ex-anchor" href="#teereader"><i class="fa fa-link" aria-hidden="true"></i></a>22.8.3. TeeReader</h3>
<pre class="language-"><code class="lang-go"><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
    <span class="token string">&quot;bytes&quot;</span>
    <span class="token string">&quot;fmt&quot;</span>
    <span class="token string">&quot;io&quot;</span>
    <span class="token string">&quot;io/ioutil&quot;</span>
    <span class="token string">&quot;log&quot;</span>
    <span class="token string">&quot;strings&quot;</span>
<span class="token punctuation">)</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    r <span class="token operator">:=</span> strings<span class="token punctuation">.</span><span class="token function">NewReader</span><span class="token punctuation">(</span><span class="token string">&quot;some io.Reader stream to be read\n&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">var</span> buf bytes<span class="token punctuation">.</span>Buffer
    tee <span class="token operator">:=</span> io<span class="token punctuation">.</span><span class="token function">TeeReader</span><span class="token punctuation">(</span>r<span class="token punctuation">,</span> <span class="token operator">&amp;</span>buf<span class="token punctuation">)</span>

    printall <span class="token operator">:=</span> <span class="token keyword">func</span><span class="token punctuation">(</span>r io<span class="token punctuation">.</span>Reader<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        b<span class="token punctuation">,</span> err <span class="token operator">:=</span> ioutil<span class="token punctuation">.</span><span class="token function">ReadAll</span><span class="token punctuation">(</span>r<span class="token punctuation">)</span>
        <span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
            log<span class="token punctuation">.</span><span class="token function">Fatal</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
        <span class="token punctuation">}</span>

        fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;%s&quot;</span><span class="token punctuation">,</span> b<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

    <span class="token function">printall</span><span class="token punctuation">(</span>tee<span class="token punctuation">)</span>
    <span class="token function">printall</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>buf<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">//&#x8F93;&#x51FA;:</span>
some io<span class="token punctuation">.</span>Reader stream to be read
some io<span class="token punctuation">.</span>Reader stream to be read
</code></pre>
<h1 id="containerring"><a name="containerring" class="anchor-navigation-ex-anchor" href="#containerring"><i class="fa fa-link" aria-hidden="true"></i></a>23. container/ring</h1>
<p>ring&#x662F;&#x4E2A;&#x5FAA;&#x73AF;&#x94FE;&#x8868;. &#x91CC;&#x9762;&#x7684;&#x4EFB;&#x4F55;&#x4E00;&#x4E2A;&#x5143;&#x7D20;&#x90FD;&#x53EF;&#x4EE5;&#x88AB;&#x7528;&#x6765;&#x5F15;&#x7528;&#x8FD9;&#x4E2A;ring.
&#x6240;&#x4EE5;&#x4E0D;&#x50CF;&#x94FE;&#x8868;&#x6709;&#x5143;&#x7D20;&#x548C;list&#x4E24;&#x4E2A;&#x6982;&#x5FF5;, ring&#x53EA;&#x6709;&#x4E00;&#x4E2A;&#x7C7B;&#x578B;: Ring</p>
<h2 id="api_5"><a name="api_5" class="anchor-navigation-ex-anchor" href="#api_5"><i class="fa fa-link" aria-hidden="true"></i></a>23.1. api</h2>
<pre class="language-"><code class="lang-go"><span class="token keyword">type</span> Ring <span class="token keyword">struct</span> <span class="token punctuation">{</span>
    Value <span class="token keyword">interface</span><span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token comment">// for use by client; untouched by this library</span>
    <span class="token comment">// contains filtered or unexported fields</span>
<span class="token punctuation">}</span>

<span class="token keyword">type</span> Ring
    <span class="token keyword">func</span> <span class="token function">New</span><span class="token punctuation">(</span>n <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token operator">*</span>Ring
    <span class="token comment">//&#x5BF9;&#x6BCF;&#x4E2A;&#x5143;&#x7D20;&#x6267;&#x884C;f, f&#x4E0D;&#x80FD;&#x6539;&#x53D8;ring&#x672C;&#x8EAB;</span>
    <span class="token keyword">func</span> <span class="token punctuation">(</span>r <span class="token operator">*</span>Ring<span class="token punctuation">)</span> <span class="token function">Do</span><span class="token punctuation">(</span>f <span class="token keyword">func</span><span class="token punctuation">(</span><span class="token keyword">interface</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">func</span> <span class="token punctuation">(</span>r <span class="token operator">*</span>Ring<span class="token punctuation">)</span> <span class="token function">Len</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token builtin">int</span>
    <span class="token comment">//&#x94FE;&#x63A5;&#x8FDE;&#x4E2A;ring</span>
    <span class="token keyword">func</span> <span class="token punctuation">(</span>r <span class="token operator">*</span>Ring<span class="token punctuation">)</span> <span class="token function">Link</span><span class="token punctuation">(</span>s <span class="token operator">*</span>Ring<span class="token punctuation">)</span> <span class="token operator">*</span>Ring
    <span class="token keyword">func</span> <span class="token punctuation">(</span>r <span class="token operator">*</span>Ring<span class="token punctuation">)</span> <span class="token function">Move</span><span class="token punctuation">(</span>n <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token operator">*</span>Ring
    <span class="token keyword">func</span> <span class="token punctuation">(</span>r <span class="token operator">*</span>Ring<span class="token punctuation">)</span> <span class="token function">Next</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span>Ring
    <span class="token keyword">func</span> <span class="token punctuation">(</span>r <span class="token operator">*</span>Ring<span class="token punctuation">)</span> <span class="token function">Prev</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span>Ring
    <span class="token keyword">func</span> <span class="token punctuation">(</span>r <span class="token operator">*</span>Ring<span class="token punctuation">)</span> <span class="token function">Unlink</span><span class="token punctuation">(</span>n <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token operator">*</span>Ring
</code></pre>
<h2 id="&#x4F8B;&#x5B50;-&#x8FDE;&#x63A5;&#x4E24;&#x4E2A;ring"><a name="&#x4F8B;&#x5B50;-&#x8FDE;&#x63A5;&#x4E24;&#x4E2A;ring" class="anchor-navigation-ex-anchor" href="#&#x4F8B;&#x5B50;-&#x8FDE;&#x63A5;&#x4E24;&#x4E2A;ring"><i class="fa fa-link" aria-hidden="true"></i></a>23.2. &#x4F8B;&#x5B50;: &#x8FDE;&#x63A5;&#x4E24;&#x4E2A;ring</h2>
<pre class="language-"><code class="lang-go"><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
    <span class="token string">&quot;container/ring&quot;</span>
    <span class="token string">&quot;fmt&quot;</span>
<span class="token punctuation">)</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Create two rings, r and s, of size 2</span>
    r <span class="token operator">:=</span> ring<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
    s <span class="token operator">:=</span> ring<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>

    <span class="token comment">// Get the length of the ring</span>
    lr <span class="token operator">:=</span> r<span class="token punctuation">.</span><span class="token function">Len</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    ls <span class="token operator">:=</span> s<span class="token punctuation">.</span><span class="token function">Len</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token comment">// Initialize r with 0s</span>
    <span class="token keyword">for</span> i <span class="token operator">:=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> lr<span class="token punctuation">;</span> i<span class="token operator">++</span> <span class="token punctuation">{</span>
        r<span class="token punctuation">.</span>Value <span class="token operator">=</span> <span class="token number">0</span>
        r <span class="token operator">=</span> r<span class="token punctuation">.</span><span class="token function">Next</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// Initialize s with 1s</span>
    <span class="token keyword">for</span> j <span class="token operator">:=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> ls<span class="token punctuation">;</span> j<span class="token operator">++</span> <span class="token punctuation">{</span>
        s<span class="token punctuation">.</span>Value <span class="token operator">=</span> <span class="token number">1</span>
        s <span class="token operator">=</span> s<span class="token punctuation">.</span><span class="token function">Next</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// Link ring r and ring s</span>
    rs <span class="token operator">:=</span> r<span class="token punctuation">.</span><span class="token function">Link</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span>

    <span class="token comment">// Iterate through the combined ring and print its contents</span>
    rs<span class="token punctuation">.</span><span class="token function">Do</span><span class="token punctuation">(</span><span class="token keyword">func</span><span class="token punctuation">(</span>p <span class="token keyword">interface</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>p<span class="token punctuation">.</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token punctuation">}</span>

<span class="token comment">//&#x8F93;&#x51FA;</span>
<span class="token number">0</span>
<span class="token number">0</span>
<span class="token number">1</span>
<span class="token number">1</span>
</code></pre>
<h1 id="containerlist"><a name="containerlist" class="anchor-navigation-ex-anchor" href="#containerlist"><i class="fa fa-link" aria-hidden="true"></i></a>24. container/list</h1>
<p>&#x5B9E;&#x73B0;&#x4E86;&#x4E00;&#x4E2A;&#x53CC;&#x5411;&#x94FE;&#x8868;
&#x5BF9;&#x8FD9;&#x4E2A;&#x94FE;&#x8868;&#x7684;&#x904D;&#x5386;:</p>
<pre class="language-"><code class="lang-go"><span class="token keyword">for</span> e <span class="token operator">:=</span> l<span class="token punctuation">.</span><span class="token function">Front</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> e <span class="token operator">!=</span> <span class="token boolean">nil</span><span class="token punctuation">;</span> e <span class="token operator">=</span> e<span class="token punctuation">.</span><span class="token function">Next</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// do something with e.Value</span>
<span class="token punctuation">}</span>
</code></pre>
<h2 id="api_6"><a name="api_6" class="anchor-navigation-ex-anchor" href="#api_6"><i class="fa fa-link" aria-hidden="true"></i></a>24.1. api</h2>
<pre class="language-"><code class="lang-go"><span class="token comment">//&#x8FD9;&#x662F;&#x4E2A;struct, Value&#x5E76;&#x4E0D;&#x5173;&#x5FC3;&#x5177;&#x4F53;&#x7684;&#x6570;&#x636E;&#x7C7B;&#x578B;, &#x53EA;&#x662F;&#x4EE5;&#x4E07;&#x80FD;&#x7C7B;&#x578B;interface&#x5B58;&#x50A8;.</span>
<span class="token keyword">type</span> Element <span class="token keyword">struct</span> <span class="token punctuation">{</span>
    <span class="token comment">// The value stored with this element.</span>
    Value <span class="token keyword">interface</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token comment">// contains filtered or unexported fields</span>
<span class="token punctuation">}</span>

<span class="token keyword">type</span> Element
    <span class="token keyword">func</span> <span class="token punctuation">(</span>e <span class="token operator">*</span>Element<span class="token punctuation">)</span> <span class="token function">Next</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span>Element
    <span class="token keyword">func</span> <span class="token punctuation">(</span>e <span class="token operator">*</span>Element<span class="token punctuation">)</span> <span class="token function">Prev</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span>Element

<span class="token comment">//&#x4E5F;&#x662F;&#x4E2A;struct</span>
<span class="token keyword">type</span> List
    <span class="token keyword">func</span> <span class="token function">New</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span>List
    <span class="token keyword">func</span> <span class="token punctuation">(</span>l <span class="token operator">*</span>List<span class="token punctuation">)</span> <span class="token function">Back</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span>Element
    <span class="token keyword">func</span> <span class="token punctuation">(</span>l <span class="token operator">*</span>List<span class="token punctuation">)</span> <span class="token function">Front</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span>Element
    <span class="token keyword">func</span> <span class="token punctuation">(</span>l <span class="token operator">*</span>List<span class="token punctuation">)</span> <span class="token function">Init</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span>List
    <span class="token keyword">func</span> <span class="token punctuation">(</span>l <span class="token operator">*</span>List<span class="token punctuation">)</span> <span class="token function">InsertAfter</span><span class="token punctuation">(</span>v <span class="token keyword">interface</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> mark <span class="token operator">*</span>Element<span class="token punctuation">)</span> <span class="token operator">*</span>Element
    <span class="token keyword">func</span> <span class="token punctuation">(</span>l <span class="token operator">*</span>List<span class="token punctuation">)</span> <span class="token function">InsertBefore</span><span class="token punctuation">(</span>v <span class="token keyword">interface</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> mark <span class="token operator">*</span>Element<span class="token punctuation">)</span> <span class="token operator">*</span>Element
    <span class="token keyword">func</span> <span class="token punctuation">(</span>l <span class="token operator">*</span>List<span class="token punctuation">)</span> <span class="token function">Len</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token builtin">int</span>
    <span class="token keyword">func</span> <span class="token punctuation">(</span>l <span class="token operator">*</span>List<span class="token punctuation">)</span> <span class="token function">MoveAfter</span><span class="token punctuation">(</span>e<span class="token punctuation">,</span> mark <span class="token operator">*</span>Element<span class="token punctuation">)</span>
    <span class="token keyword">func</span> <span class="token punctuation">(</span>l <span class="token operator">*</span>List<span class="token punctuation">)</span> <span class="token function">MoveBefore</span><span class="token punctuation">(</span>e<span class="token punctuation">,</span> mark <span class="token operator">*</span>Element<span class="token punctuation">)</span>
    <span class="token keyword">func</span> <span class="token punctuation">(</span>l <span class="token operator">*</span>List<span class="token punctuation">)</span> <span class="token function">MoveToBack</span><span class="token punctuation">(</span>e <span class="token operator">*</span>Element<span class="token punctuation">)</span>
    <span class="token keyword">func</span> <span class="token punctuation">(</span>l <span class="token operator">*</span>List<span class="token punctuation">)</span> <span class="token function">MoveToFront</span><span class="token punctuation">(</span>e <span class="token operator">*</span>Element<span class="token punctuation">)</span>
    <span class="token keyword">func</span> <span class="token punctuation">(</span>l <span class="token operator">*</span>List<span class="token punctuation">)</span> <span class="token function">PushBack</span><span class="token punctuation">(</span>v <span class="token keyword">interface</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">*</span>Element
    <span class="token keyword">func</span> <span class="token punctuation">(</span>l <span class="token operator">*</span>List<span class="token punctuation">)</span> <span class="token function">PushBackList</span><span class="token punctuation">(</span>other <span class="token operator">*</span>List<span class="token punctuation">)</span>
    <span class="token keyword">func</span> <span class="token punctuation">(</span>l <span class="token operator">*</span>List<span class="token punctuation">)</span> <span class="token function">PushFront</span><span class="token punctuation">(</span>v <span class="token keyword">interface</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">*</span>Element
    <span class="token keyword">func</span> <span class="token punctuation">(</span>l <span class="token operator">*</span>List<span class="token punctuation">)</span> <span class="token function">PushFrontList</span><span class="token punctuation">(</span>other <span class="token operator">*</span>List<span class="token punctuation">)</span>
    <span class="token keyword">func</span> <span class="token punctuation">(</span>l <span class="token operator">*</span>List<span class="token punctuation">)</span> <span class="token function">Remove</span><span class="token punctuation">(</span>e <span class="token operator">*</span>Element<span class="token punctuation">)</span> <span class="token keyword">interface</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
</code></pre>
<h2 id="&#x4F7F;&#x7528;&#x4E3E;&#x4F8B;"><a name="&#x4F7F;&#x7528;&#x4E3E;&#x4F8B;" class="anchor-navigation-ex-anchor" href="#&#x4F7F;&#x7528;&#x4E3E;&#x4F8B;"><i class="fa fa-link" aria-hidden="true"></i></a>24.2. &#x4F7F;&#x7528;&#x4E3E;&#x4F8B;</h2>
<pre class="language-"><code class="lang-go"><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
    <span class="token string">&quot;container/list&quot;</span>
    <span class="token string">&quot;fmt&quot;</span>
<span class="token punctuation">)</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Create a new list and put some numbers in it.</span>
    l <span class="token operator">:=</span> list<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    e4 <span class="token operator">:=</span> l<span class="token punctuation">.</span><span class="token function">PushBack</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span>
    e1 <span class="token operator">:=</span> l<span class="token punctuation">.</span><span class="token function">PushFront</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
    l<span class="token punctuation">.</span><span class="token function">InsertBefore</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> e4<span class="token punctuation">)</span>
    l<span class="token punctuation">.</span><span class="token function">InsertAfter</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> e1<span class="token punctuation">)</span>

    <span class="token comment">// Iterate through list and print its contents.</span>
    <span class="token keyword">for</span> e <span class="token operator">:=</span> l<span class="token punctuation">.</span><span class="token function">Front</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> e <span class="token operator">!=</span> <span class="token boolean">nil</span><span class="token punctuation">;</span> e <span class="token operator">=</span> e<span class="token punctuation">.</span><span class="token function">Next</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>Value<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<h1 id="containerheap"><a name="containerheap" class="anchor-navigation-ex-anchor" href="#containerheap"><i class="fa fa-link" aria-hidden="true"></i></a>25. container/heap</h1>
<p>&#x53C2;&#x8003;: <a href="https://golang.org/pkg/container/heap/" target="_blank">https://golang.org/pkg/container/heap/</a>
heap&#x662F;&#x4E2A;&#x6811;, &#x6BCF;&#x4E2A;node&#x7684;&#x503C;&#x90FD;&#x662F;&#x5B83;&#x7684;&#x5B50;&#x6811;&#x7684;&quot;&#x6700;&#x5C0F;&#x503C;&quot;. &#x6240;&#x4EE5;&#x6839;&#x8282;&#x70B9;&#x662F;&#x6700;&#x5C0F;&#x7684;. </p>
<pre class="language-"><code class="lang-go"><span class="token keyword">import</span> <span class="token string">&quot;container/heap&quot;</span>
<span class="token keyword">type</span> Interface <span class="token keyword">interface</span> <span class="token punctuation">{</span>
        sort<span class="token punctuation">.</span>Interface
        <span class="token function">Push</span><span class="token punctuation">(</span>x <span class="token keyword">interface</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token comment">// add x as element Len()</span>
        <span class="token function">Pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">interface</span><span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token comment">// remove and return element Len()</span>
<span class="token punctuation">}</span>
</code></pre>
<p>&#x6CE8;&#x610F;, &#x8FD9;&#x91CC;&#x7684;&quot;&#x6700;&#x5C0F;&#x503C;&quot;&#x7684;&#x82F1;&#x6587;&#x8868;&#x8FF0;&#x4E3A;&quot;minimum-valued&quot; node, &#x4F55;&#x4E3A;&#x6700;&#x5C0F;&#x503C;? &#x7531;heap.Interface&#x91CC;&#x9762;&#x7684;sort.Interface&#x8BF4;&#x4E86;&#x7B97;.
&#x5C31;&#x662F;&#x8BF4;, heap&#x5305;&#x7684;&#x903B;&#x8F91;&#x662F;, &#x6309;&#x7167;sort&#x7684;&#x65B9;&#x6CD5;, &#x505A;&#x6210;&#x4E00;&#x4E2A;&#x6700;&#x5C0F;&#x6811;.
&#x5B9E;&#x73B0;&#x4E86;heap.Interface&#x7684;&#x4EFB;&#x4F55;type&#x90FD;&#x53EF;&#x4EE5;&#x662F;heap</p>
<ul>
<li>Push&#x628A;&#x4E00;&#x4E2A;&#x5143;&#x7D20;&#x6392;&#x5E8F;&#x540E;&#x653E;&#x5165;&#x6811;&#x4E2D;.</li>
<li>Pop&#x628A;&#x6811;&#x4E2D;&#x7684;&#x4E00;&#x4E2A;&#x5143;&#x7D20;&#x8FD4;&#x56DE;. Less()&#x65B9;&#x6CD5;&#x51B3;&#x5B9A;&#x8FD4;&#x56DE;&#x54EA;&#x4E2A;&#x5143;&#x7D20;. </li>
</ul>
<h2 id="&#x6811;&#x7684;&#x6570;&#x7EC4;&#x8868;&#x8FBE;"><a name="&#x6811;&#x7684;&#x6570;&#x7EC4;&#x8868;&#x8FBE;" class="anchor-navigation-ex-anchor" href="#&#x6811;&#x7684;&#x6570;&#x7EC4;&#x8868;&#x8FBE;"><i class="fa fa-link" aria-hidden="true"></i></a>25.1. &#x6811;&#x7684;&#x6570;&#x7EC4;&#x8868;&#x8FBE;</h2>
<blockquote>
<p>&#x8282;&#x70B9;&#x5728;&#x6570;&#x7EC4;&#x4E2D;&#x7684;&#x4F4D;&#x7F6E;&#x5BF9;&#x5E94;&#x5B83;&#x5728;&#x6811;&#x4E2D;&#x7684;&#x4F4D;&#x7F6E;,&#x4E0B;&#x6807;&#x4E3A;0 &#x7684;&#x8282;&#x70B9;&#x4E3A;&#x6839;&#x8282;&#x70B9;,&#x4E0B;&#x6807;&#x4E3A;1&#x662F;&#x6839;&#x7684;&#x5DE6;&#x8282;&#x70B9;,2&#x4E3A;&#x6839;&#x8282;&#x70B9;&#x7684;&#x53F3;&#x8282;&#x70B9;,&#x4F9D;&#x6B21;&#x7C7B;&#x63A8;,&#x4ECE;&#x5DE6;&#x5230;&#x53F3;&#x7684;&#x987A;&#x5E8F;&#x5B58;&#x50A8;&#x6811;&#x7684;&#x6BCF;&#x4E00;&#x5C42;,&#x5305;&#x62EC;&#x7A7A;&#x8282;&#x70B9;.</p>
</blockquote>
<p><img src="img/golang_&#x6807;&#x51C6;&#x5E93;_20220905001208.png" alt="">  </p>
<p><img src="img/golang_&#x6807;&#x51C6;&#x5E93;_20220905001238.png" alt="">  </p>
<h2 id="min-int&#x6811;"><a name="min-int&#x6811;" class="anchor-navigation-ex-anchor" href="#min-int&#x6811;"><i class="fa fa-link" aria-hidden="true"></i></a>25.2. min-int&#x6811;</h2>
<pre class="language-"><code class="lang-go"><span class="token comment">// This example demonstrates an integer heap built using the heap interface.</span>
<span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
    <span class="token string">&quot;container/heap&quot;</span>
    <span class="token string">&quot;fmt&quot;</span>
<span class="token punctuation">)</span>

<span class="token comment">// An IntHeap is a min-heap of ints.</span>
<span class="token keyword">type</span> IntHeap <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">int</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>h IntHeap<span class="token punctuation">)</span> <span class="token function">Len</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token builtin">int</span>           <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token function">len</span><span class="token punctuation">(</span>h<span class="token punctuation">)</span> <span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>h IntHeap<span class="token punctuation">)</span> <span class="token function">Less</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> j <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token builtin">bool</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> h<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&lt;</span> h<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>h IntHeap<span class="token punctuation">)</span> <span class="token function">Swap</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> j <span class="token builtin">int</span><span class="token punctuation">)</span>      <span class="token punctuation">{</span> h<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> h<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> h<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">,</span> h<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token punctuation">}</span>

<span class="token comment">//&#x6CE8;&#x610F;: &#x8FD9;&#x91CC;&#x7684;Push&#x548C;Pop&#x662F;&#x7ED9;heap&#x5305;&#x8C03;&#x52A8;&#x7528;&#x7684;, &#x548C;heap.Push, heap.Pop&#x4E0D;&#x4E00;&#x6837;.</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>h <span class="token operator">*</span>IntHeap<span class="token punctuation">)</span> <span class="token function">Push</span><span class="token punctuation">(</span>x <span class="token keyword">interface</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Push and Pop use pointer receivers because they modify the slice&apos;s length,</span>
    <span class="token comment">// not just its contents.</span>
    <span class="token operator">*</span>h <span class="token operator">=</span> <span class="token function">append</span><span class="token punctuation">(</span><span class="token operator">*</span>h<span class="token punctuation">,</span> x<span class="token punctuation">.</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>h <span class="token operator">*</span>IntHeap<span class="token punctuation">)</span> <span class="token function">Pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">interface</span><span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token punctuation">{</span>
    old <span class="token operator">:=</span> <span class="token operator">*</span>h
    n <span class="token operator">:=</span> <span class="token function">len</span><span class="token punctuation">(</span>old<span class="token punctuation">)</span>
    x <span class="token operator">:=</span> old<span class="token punctuation">[</span>n<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>
    <span class="token operator">*</span>h <span class="token operator">=</span> old<span class="token punctuation">[</span><span class="token number">0</span> <span class="token punctuation">:</span> n<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>
    <span class="token comment">//&#x6839;&#x636E;&#x4E0B;&#x6587;&#x7684;&#x89E3;&#x91CA;, &#x5728;&#x8C03;&#x7528;&#x8FD9;&#x4E2A;&#x5B9E;&#x4F8B;i&#x7684;Pop&#x4E4B;&#x524D;, heap.Pop&#x5DF2;&#x7ECF;&#x91CD;&#x65B0;&#x6392;&#x5E8F;&#x4E86;</span>
    <span class="token comment">//&#x8FD9;&#x91CC;&#x91CD;&#x65B0;&#x6392;&#x5E8F;&#x7684;&#x903B;&#x8F91;&#x662F;, &#x628A;&#x5E95;&#x5C42;&#x6570;&#x7EC4;&#x7684;&#x7B2C;n&#x4E2A;&#x7A7A;&#x51FA;&#x6765;, &#x653E;&#x6700;&#x5C0F;&#x503C;; &#x8FD9;&#x4E2A;&#x5F88;&#x5BB9;&#x6613;, &#x5C31;&#x628A;0&#x53F7;&#x548C;n-1&#x53F7;&#x4E92;&#x6362;&#x5C31;&#x884C;.</span>
    <span class="token comment">//&#x7136;&#x540E;&#x628A;&#x5269;&#x4E0B;&#x7684;n-1&#x4E2A;&#x91CD;&#x65B0;&#x6392;&#x5E8F;.</span>
    <span class="token comment">//&#x6700;&#x540E;&#x5E95;&#x5C42;&#x6570;&#x7EC4;&#x7684;&#x5E8F;&#x53F7;n-1&#x5C31;&#x662F;&#x6700;&#x5C0F;&#x503C;, &#x4F1A;&#x88AB;heap.Pop&#x8FD4;&#x56DE;.</span>
    <span class="token keyword">return</span> x
<span class="token punctuation">}</span>

<span class="token comment">// This example inserts several ints into an IntHeap, checks the minimum,</span>
<span class="token comment">// and removes them in order of priority.</span>
<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    h <span class="token operator">:=</span> <span class="token operator">&amp;</span>IntHeap<span class="token punctuation">{</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">}</span>
    heap<span class="token punctuation">.</span><span class="token function">Init</span><span class="token punctuation">(</span>h<span class="token punctuation">)</span>
    heap<span class="token punctuation">.</span><span class="token function">Push</span><span class="token punctuation">(</span>h<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span>
    fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;minimum: %d\n&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token operator">*</span>h<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token keyword">for</span> h<span class="token punctuation">.</span><span class="token function">Len</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token punctuation">{</span>
        fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;%d &quot;</span><span class="token punctuation">,</span> heap<span class="token punctuation">.</span><span class="token function">Pop</span><span class="token punctuation">(</span>h<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">//&#x7ED3;&#x679C;</span>
minimum<span class="token punctuation">:</span> <span class="token number">1</span>
<span class="token number">1</span> <span class="token number">2</span> <span class="token number">3</span> <span class="token number">5</span>
</code></pre>
<h2 id="&#x53EF;&#x4EE5;&#x7528;heap&#x6765;&#x5B9E;&#x73B0;&#x4F18;&#x5148;&#x7EA7;&#x961F;&#x5217;"><a name="&#x53EF;&#x4EE5;&#x7528;heap&#x6765;&#x5B9E;&#x73B0;&#x4F18;&#x5148;&#x7EA7;&#x961F;&#x5217;" class="anchor-navigation-ex-anchor" href="#&#x53EF;&#x4EE5;&#x7528;heap&#x6765;&#x5B9E;&#x73B0;&#x4F18;&#x5148;&#x7EA7;&#x961F;&#x5217;"><i class="fa fa-link" aria-hidden="true"></i></a>25.3. &#x53EF;&#x4EE5;&#x7528;heap&#x6765;&#x5B9E;&#x73B0;&#x4F18;&#x5148;&#x7EA7;&#x961F;&#x5217;</h2>
<p><img src="img/golang_&#x6807;&#x51C6;&#x5E93;_20220905001329.png" alt="">  </p>
<pre class="language-"><code class="lang-go"><span class="token comment">// This example demonstrates a priority queue built using the heap interface.</span>
<span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
    <span class="token string">&quot;container/heap&quot;</span>
    <span class="token string">&quot;fmt&quot;</span>
<span class="token punctuation">)</span>

<span class="token comment">// An Item is something we manage in a priority queue.</span>
<span class="token keyword">type</span> Item <span class="token keyword">struct</span> <span class="token punctuation">{</span>
    value    <span class="token builtin">string</span> <span class="token comment">// The value of the item; arbitrary.</span>
    priority <span class="token builtin">int</span>    <span class="token comment">// The priority of the item in the queue.</span>
    <span class="token comment">// The index is needed by update and is maintained by the heap.Interface methods.</span>
    index <span class="token builtin">int</span> <span class="token comment">// The index of the item in the heap.</span>
<span class="token punctuation">}</span>

<span class="token comment">//&#x8FD9;&#x4E2A;heap&#x6765;&#x5B58;&#x50A8;&#x4E0A;&#x662F;&#x5EFA;&#x7ACB;&#x5728;slice&#x4E0A;&#x7684;?</span>
<span class="token comment">// A PriorityQueue implements heap.Interface and holds Items.</span>
<span class="token keyword">type</span> PriorityQueue <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">*</span>Item

<span class="token keyword">func</span> <span class="token punctuation">(</span>pq PriorityQueue<span class="token punctuation">)</span> <span class="token function">Len</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token builtin">int</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token function">len</span><span class="token punctuation">(</span>pq<span class="token punctuation">)</span> <span class="token punctuation">}</span>

<span class="token comment">//&#x539F;&#x672C;head&#x662F;node&#x7684;&#x503C;&#x6BD4;&#x5176;&#x5B50;&#x6811;&#x8981;&#x5C0F;, &#x8FD9;&#x91CC;&quot;&#x91CD;&#x8F7D;&quot;&#x4E86;Less&#x65B9;&#x6CD5;, &#x8FD4;&#x56DE;&#x5927;&#x7684;&#x503C;, &#x4ECE;&#x800C;&#x5B9E;&#x73B0;&#x5148;pop&#x5927;&#x7684;</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>pq PriorityQueue<span class="token punctuation">)</span> <span class="token function">Less</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> j <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token builtin">bool</span> <span class="token punctuation">{</span>
    <span class="token comment">// We want Pop to give us the highest, not lowest, priority so we use greater than here.</span>
    <span class="token keyword">return</span> pq<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>priority <span class="token operator">&gt;</span> pq<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">.</span>priority
<span class="token punctuation">}</span>

<span class="token comment">//&#x4E3A;&#x4EC0;&#x4E48;&#x4E0D;&#x662F;&#x6307;&#x9488;&#x4F20;&#x9012;? &#x56E0;&#x4E3A;pq&#x662F;slice&#x5417;?</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>pq PriorityQueue<span class="token punctuation">)</span> <span class="token function">Swap</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> j <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    pq<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> pq<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> pq<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">,</span> pq<span class="token punctuation">[</span>i<span class="token punctuation">]</span>
    pq<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>index <span class="token operator">=</span> i
    pq<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">.</span>index <span class="token operator">=</span> j
<span class="token punctuation">}</span>

<span class="token comment">//&#x5B9E;&#x73B0;&#x4E86;Push&#x548C;Pop&#x5C31;&#x662F;heap</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>pq <span class="token operator">*</span>PriorityQueue<span class="token punctuation">)</span> <span class="token function">Push</span><span class="token punctuation">(</span>x <span class="token keyword">interface</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    n <span class="token operator">:=</span> <span class="token function">len</span><span class="token punctuation">(</span><span class="token operator">*</span>pq<span class="token punctuation">)</span>
    <span class="token comment">//&#x7C7B;&#x578B;&#x65AD;&#x8A00;</span>
    item <span class="token operator">:=</span> x<span class="token punctuation">.</span><span class="token punctuation">(</span><span class="token operator">*</span>Item<span class="token punctuation">)</span>
    item<span class="token punctuation">.</span>index <span class="token operator">=</span> n
    <span class="token comment">//&#x7528;append&#x5C31;&#x80FD;push&#x8FDB;&#x6811;&#x7ED3;&#x6784;?</span>

    <span class="token operator">*</span>pq <span class="token operator">=</span> <span class="token function">append</span><span class="token punctuation">(</span><span class="token operator">*</span>pq<span class="token punctuation">,</span> item<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">//&#x5B9E;&#x73B0;&#x4E86;Push&#x548C;Pop&#x5C31;&#x662F;heap</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>pq <span class="token operator">*</span>PriorityQueue<span class="token punctuation">)</span> <span class="token function">Pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">interface</span><span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token punctuation">{</span>
    <span class="token comment">//&#x600E;&#x4E48;&#x9690;&#x7EA6;&#x611F;&#x89C9;&#x8FD9;&#x91CC;&#x662F;deep copy</span>

    old <span class="token operator">:=</span> <span class="token operator">*</span>pq
    n <span class="token operator">:=</span> <span class="token function">len</span><span class="token punctuation">(</span>old<span class="token punctuation">)</span>
    <span class="token comment">//&#x8FD9;&#x6837;&#x5C31;&#x884C;&#x4E86;?</span>

    item <span class="token operator">:=</span> old<span class="token punctuation">[</span>n<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>
    item<span class="token punctuation">.</span>index <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token comment">// for safety</span>
    <span class="token comment">//&#x8FD4;&#x56DE;&#x4E00;&#x4E2A;&#x5207;&#x7247;?</span>

    <span class="token operator">*</span>pq <span class="token operator">=</span> old<span class="token punctuation">[</span><span class="token number">0</span> <span class="token punctuation">:</span> n<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>
    <span class="token keyword">return</span> item
<span class="token punctuation">}</span>

<span class="token comment">// update modifies the priority and value of an Item in the queue.</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>pq <span class="token operator">*</span>PriorityQueue<span class="token punctuation">)</span> <span class="token function">update</span><span class="token punctuation">(</span>item <span class="token operator">*</span>Item<span class="token punctuation">,</span> value <span class="token builtin">string</span><span class="token punctuation">,</span> priority <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    item<span class="token punctuation">.</span>value <span class="token operator">=</span> value
    item<span class="token punctuation">.</span>priority <span class="token operator">=</span> priority
    heap<span class="token punctuation">.</span><span class="token function">Fix</span><span class="token punctuation">(</span>pq<span class="token punctuation">,</span> item<span class="token punctuation">.</span>index<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// This example creates a PriorityQueue with some items, adds and manipulates an item,</span>
<span class="token comment">// and then removes the items in priority order.</span>
<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Some items and their priorities.</span>
    items <span class="token operator">:=</span> <span class="token keyword">map</span><span class="token punctuation">[</span><span class="token builtin">string</span><span class="token punctuation">]</span><span class="token builtin">int</span><span class="token punctuation">{</span>
        <span class="token string">&quot;banana&quot;</span><span class="token punctuation">:</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token string">&quot;apple&quot;</span><span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">&quot;pear&quot;</span><span class="token punctuation">:</span> <span class="token number">4</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// Create a priority queue, put the items in it, and</span>
    <span class="token comment">// establish the priority queue (heap) invariants.</span>
    pq <span class="token operator">:=</span> <span class="token function">make</span><span class="token punctuation">(</span>PriorityQueue<span class="token punctuation">,</span> <span class="token function">len</span><span class="token punctuation">(</span>items<span class="token punctuation">)</span><span class="token punctuation">)</span>
    i <span class="token operator">:=</span> <span class="token number">0</span>
    <span class="token keyword">for</span> value<span class="token punctuation">,</span> priority <span class="token operator">:=</span> <span class="token keyword">range</span> items <span class="token punctuation">{</span>
        pq<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token operator">&amp;</span>Item<span class="token punctuation">{</span>
            value<span class="token punctuation">:</span>    value<span class="token punctuation">,</span>
            priority<span class="token punctuation">:</span> priority<span class="token punctuation">,</span>
            index<span class="token punctuation">:</span>    i<span class="token punctuation">,</span>
        <span class="token punctuation">}</span>
        i<span class="token operator">++</span>
    <span class="token punctuation">}</span>
    heap<span class="token punctuation">.</span><span class="token function">Init</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>pq<span class="token punctuation">)</span>
    <span class="token comment">// Insert a new item and then modify its priority.</span>
    item <span class="token operator">:=</span> <span class="token operator">&amp;</span>Item<span class="token punctuation">{</span>
        value<span class="token punctuation">:</span>    <span class="token string">&quot;orange&quot;</span><span class="token punctuation">,</span>
        priority<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
    heap<span class="token punctuation">.</span><span class="token function">Push</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>pq<span class="token punctuation">,</span> item<span class="token punctuation">)</span>
    pq<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span>item<span class="token punctuation">,</span> item<span class="token punctuation">.</span>value<span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span>
    <span class="token comment">// Take the items out; they arrive in decreasing priority order.</span>
    <span class="token keyword">for</span> pq<span class="token punctuation">.</span><span class="token function">Len</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token punctuation">{</span>
        item <span class="token operator">:=</span> heap<span class="token punctuation">.</span><span class="token function">Pop</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>pq<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token punctuation">(</span><span class="token operator">*</span>Item<span class="token punctuation">)</span>
        fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;%.2d:%s &quot;</span><span class="token punctuation">,</span> item<span class="token punctuation">.</span>priority<span class="token punctuation">,</span> item<span class="token punctuation">.</span>value<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p>&#x5BF9;&#x4E0A;&#x9762;&#x51E0;&#x4E2A;&#x95EE;&#x9898;&#x7684;&#x89E3;&#x91CA;:</p>
<ul>
<li>&#x8FD9;&#x91CC;&#x7684;head&#x7528;&#x6570;&#x7EC4;slice&#x505A;&#x5E95;&#x5C42;&#x5B58;&#x50A8;</li>
<li>heap.Push()&#x5148;&#x8C03;&#x7528;&#x5177;&#x4F53;&#x5B9E;&#x4F8B;&#x7684;Push()&#x5B9E;&#x73B0;, &#x518D;&#x8C03;&#x7528;up()&#x6392;&#x5E8F;</li>
<li>heap.Pop()&#x5148;&#x8C03;&#x7528;&#x5177;&#x4F53;&#x5B9E;&#x4F8B;&#x7684;Swap()&#x65B9;&#x6CD5;, &#x518D;&#x7528;down&#x65B9;&#x6CD5;&#x6392;&#x5E8F;, &#x518D;&#x8C03;&#x7528;&#x5177;&#x4F53;&#x5B9E;&#x4F8B;&#x7684;Pop()</li>
<li>up()&#x548C;down()&#x662F;<code>src/container/heap/heap.go</code>&#x7684;&#x6392;&#x5E8F;&#x5B9E;&#x73B0;</li>
</ul>
<pre class="language-"><code class="lang-go"><span class="token comment">// Push pushes the element x onto the heap.</span>
<span class="token comment">// The complexity is O(log n) where n = h.Len().</span>
<span class="token keyword">func</span> <span class="token function">Push</span><span class="token punctuation">(</span>h Interface<span class="token punctuation">,</span> x <span class="token keyword">interface</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    h<span class="token punctuation">.</span><span class="token function">Push</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span>
    <span class="token function">up</span><span class="token punctuation">(</span>h<span class="token punctuation">,</span> h<span class="token punctuation">.</span><span class="token function">Len</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// Pop removes and returns the minimum element (according to Less) from the heap.</span>
<span class="token comment">// The complexity is O(log n) where n = h.Len().</span>
<span class="token comment">// Pop is equivalent to Remove(h, 0).</span>
<span class="token keyword">func</span> <span class="token function">Pop</span><span class="token punctuation">(</span>h Interface<span class="token punctuation">)</span> <span class="token keyword">interface</span><span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token punctuation">{</span>
    n <span class="token operator">:=</span> h<span class="token punctuation">.</span><span class="token function">Len</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span>
    <span class="token comment">//&#x8FD9;&#x91CC;&#x628A;0&#x53F7;node&#x548C;len()-1&#x4E92;&#x6362;&#x4E86;, &#x6B63;&#x597D;&#x5BF9;&#x5E94;&#x4E0A;&#x9762;&#x7684;item := old[n-1]&#x76F4;&#x63A5;&#x53D6;</span>

    h<span class="token punctuation">.</span><span class="token function">Swap</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> n<span class="token punctuation">)</span>
    <span class="token comment">//&#x5934;&#x8282;&#x70B9;&#x6CA1;&#x4E86;, &#x80AF;&#x5B9A;&#x8981;&#x91CD;&#x65B0;&#x6392;&#x5E8F;</span>
    <span class="token function">down</span><span class="token punctuation">(</span>h<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> n<span class="token punctuation">)</span>
    <span class="token keyword">return</span> h<span class="token punctuation">.</span><span class="token function">Pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre>
<h1 id="sort"><a name="sort" class="anchor-navigation-ex-anchor" href="#sort"><i class="fa fa-link" aria-hidden="true"></i></a>26. sort</h1>
<p>&#x63D0;&#x4F9B;&#x5BF9;&#x5207;&#x7247;&#x548C;&#x81EA;&#x5B9A;&#x4E49;&#x7684;&#x7ED3;&#x6784;&#x7684;&#x6392;&#x5E8F;.</p>
<h2 id="&#x652F;&#x6301;&#x5BF9;&#x57FA;&#x672C;&#x7C7B;&#x578B;&#x7684;&#x6392;&#x5E8F;"><a name="&#x652F;&#x6301;&#x5BF9;&#x57FA;&#x672C;&#x7C7B;&#x578B;&#x7684;&#x6392;&#x5E8F;" class="anchor-navigation-ex-anchor" href="#&#x652F;&#x6301;&#x5BF9;&#x57FA;&#x672C;&#x7C7B;&#x578B;&#x7684;&#x6392;&#x5E8F;"><i class="fa fa-link" aria-hidden="true"></i></a>26.1. &#x652F;&#x6301;&#x5BF9;&#x57FA;&#x672C;&#x7C7B;&#x578B;&#x7684;&#x6392;&#x5E8F;</h2>
<p>&#x6392;&#x5E8F;&#x662F;&#x539F;&#x5730;&#x6392;&#x5E8F;, &#x5373;&#x76F4;&#x63A5;&#x4FEE;&#x6539;&#x5E95;&#x5C42;&#x7684;&#x6570;&#x7EC4;</p>
<pre class="language-"><code class="lang-go"><span class="token keyword">func</span> <span class="token function">Float64s</span><span class="token punctuation">(</span>a <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">float64</span><span class="token punctuation">)</span>
<span class="token keyword">func</span> <span class="token function">Ints</span><span class="token punctuation">(</span>a <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">int</span><span class="token punctuation">)</span>
<span class="token keyword">func</span> <span class="token function">IsSorted</span><span class="token punctuation">(</span>data Interface<span class="token punctuation">)</span> <span class="token builtin">bool</span>
<span class="token comment">//&#x8FD4;&#x56DE;&#x6EE1;&#x8DB3;&#x6761;&#x4EF6;&#x7684;&#x4E0B;&#x6807;</span>
<span class="token keyword">func</span> <span class="token function">Search</span><span class="token punctuation">(</span>n <span class="token builtin">int</span><span class="token punctuation">,</span> f <span class="token keyword">func</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token builtin">bool</span><span class="token punctuation">)</span> <span class="token builtin">int</span>
<span class="token comment">//&#x5728;&#x5DF2;&#x7ECF;&#x6392;&#x597D;&#x5E8F;&#x7684;slice&#x91CC;search</span>
<span class="token keyword">func</span> <span class="token function">SearchInts</span><span class="token punctuation">(</span>a <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">int</span><span class="token punctuation">,</span> x <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token builtin">int</span>
<span class="token keyword">func</span> <span class="token function">SearchStrings</span><span class="token punctuation">(</span>a <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">,</span> x <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token builtin">int</span>

<span class="token keyword">func</span> <span class="token function">Strings</span><span class="token punctuation">(</span>a <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">)</span>
</code></pre>
<p>&#x6BD4;&#x5982;:</p>
<pre class="language-"><code class="lang-go"><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
    <span class="token string">&quot;fmt&quot;</span>
    <span class="token string">&quot;math&quot;</span>
    <span class="token string">&quot;sort&quot;</span>
<span class="token punctuation">)</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    s <span class="token operator">:=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">float64</span><span class="token punctuation">{</span><span class="token number">5.2</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1.3</span><span class="token punctuation">,</span> <span class="token number">0.7</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">3.8</span><span class="token punctuation">,</span> <span class="token number">2.6</span><span class="token punctuation">}</span> <span class="token comment">// unsorted</span>
    <span class="token comment">//&#x5BF9;s&#x6392;&#x5E8F;, &#x5347;&#x5E8F;&#x6392;&#x5E8F;</span>
    sort<span class="token punctuation">.</span><span class="token function">Float64s</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span>
    <span class="token comment">//&#x6392;&#x597D;&#x5E8F;&#x540E;&#x8FD8;&#x662F;s</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span>

    s <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">float64</span><span class="token punctuation">{</span>math<span class="token punctuation">.</span><span class="token function">Inf</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> math<span class="token punctuation">.</span><span class="token function">NaN</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> math<span class="token punctuation">.</span><span class="token function">Inf</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0.0</span><span class="token punctuation">}</span> <span class="token comment">// unsorted</span>
    sort<span class="token punctuation">.</span><span class="token function">Float64s</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span>

<span class="token punctuation">}</span>

<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">3.8</span> <span class="token operator">-</span><span class="token number">1.3</span> <span class="token number">0.7</span> <span class="token number">2.6</span> <span class="token number">5.2</span><span class="token punctuation">]</span>
<span class="token punctuation">[</span>NaN <span class="token operator">-</span>Inf <span class="token number">0</span> <span class="token operator">+</span>Inf<span class="token punctuation">]</span>
</code></pre>
<h2 id="&#x5BF9;struct&#x6392;&#x5E8F;"><a name="&#x5BF9;struct&#x6392;&#x5E8F;" class="anchor-navigation-ex-anchor" href="#&#x5BF9;struct&#x6392;&#x5E8F;"><i class="fa fa-link" aria-hidden="true"></i></a>26.2. &#x5BF9;struct&#x6392;&#x5E8F;</h2>
<pre class="language-"><code class="lang-go"><span class="token comment">//&#x4F20;&#x5165;&#x4E00;&#x4E2A;slice, &#x6309;&#x7167;less&#x51FD;&#x6570;&#x6392;&#x5E8F;</span>
<span class="token keyword">func</span> <span class="token function">Slice</span><span class="token punctuation">(</span>slice <span class="token keyword">interface</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> less <span class="token keyword">func</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> j <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token builtin">bool</span><span class="token punctuation">)</span>
<span class="token comment">//&#x5E26;stable&#x5B57;&#x773C;&#x7684;&#x8868;&#x793A;&#x6392;&#x5E8F;&#x662F;&#x7A33;&#x5B9A;&#x7684;</span>
<span class="token keyword">func</span> <span class="token function">SliceStable</span><span class="token punctuation">(</span>slice <span class="token keyword">interface</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> less <span class="token keyword">func</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> j <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token builtin">bool</span><span class="token punctuation">)</span>
</code></pre>
<p>&#x6BD4;&#x5982;:</p>
<pre class="language-"><code class="lang-go"><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
    <span class="token string">&quot;fmt&quot;</span>
    <span class="token string">&quot;sort&quot;</span>
<span class="token punctuation">)</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    people <span class="token operator">:=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token keyword">struct</span> <span class="token punctuation">{</span>
        Name <span class="token builtin">string</span>
        Age  <span class="token builtin">int</span>
    <span class="token punctuation">}</span><span class="token punctuation">{</span>
        <span class="token punctuation">{</span><span class="token string">&quot;Gopher&quot;</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span><span class="token string">&quot;Alice&quot;</span><span class="token punctuation">,</span> <span class="token number">55</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span><span class="token string">&quot;Vera&quot;</span><span class="token punctuation">,</span> <span class="token number">24</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span><span class="token string">&quot;Bob&quot;</span><span class="token punctuation">,</span> <span class="token number">75</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
    sort<span class="token punctuation">.</span><span class="token function">Slice</span><span class="token punctuation">(</span>people<span class="token punctuation">,</span> <span class="token keyword">func</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> j <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token builtin">bool</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> people<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>Name <span class="token operator">&lt;</span> people<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">.</span>Name <span class="token punctuation">}</span><span class="token punctuation">)</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;By name:&quot;</span><span class="token punctuation">,</span> people<span class="token punctuation">)</span>

    sort<span class="token punctuation">.</span><span class="token function">Slice</span><span class="token punctuation">(</span>people<span class="token punctuation">,</span> <span class="token keyword">func</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> j <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token builtin">bool</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> people<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>Age <span class="token operator">&lt;</span> people<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">.</span>Age <span class="token punctuation">}</span><span class="token punctuation">)</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;By age:&quot;</span><span class="token punctuation">,</span> people<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre>
<h2 id="&#x901A;&#x7528;&#x6392;&#x5E8F;"><a name="&#x901A;&#x7528;&#x6392;&#x5E8F;" class="anchor-navigation-ex-anchor" href="#&#x901A;&#x7528;&#x6392;&#x5E8F;"><i class="fa fa-link" aria-hidden="true"></i></a>26.3. &#x901A;&#x7528;&#x6392;&#x5E8F;</h2>
<pre class="language-"><code class="lang-go"><span class="token comment">//&#x901A;&#x8FC7;&#x8C03;&#x7528;data.Len, data.Less, data.Swap&#x6765;&#x8FDB;&#x884C;&#x6392;&#x5E8F;</span>
<span class="token keyword">func</span> <span class="token function">Sort</span><span class="token punctuation">(</span>data Interface<span class="token punctuation">)</span>
<span class="token keyword">func</span> <span class="token function">Stable</span><span class="token punctuation">(</span>data Interface<span class="token punctuation">)</span>
</code></pre>
<h2 id="&#x5BF9;&#x5916;&#x63A5;&#x53E3;"><a name="&#x5BF9;&#x5916;&#x63A5;&#x53E3;" class="anchor-navigation-ex-anchor" href="#&#x5BF9;&#x5916;&#x63A5;&#x53E3;"><i class="fa fa-link" aria-hidden="true"></i></a>26.4. &#x5BF9;&#x5916;&#x63A5;&#x53E3;</h2>
<p>&#x4E00;&#x4E2A;&#x7528;&#x6237;&#x81EA;&#x5B9A;&#x4E49;&#x7684;&#x6570;&#x636E;&#x8868;&#x8FBE;, &#x8981;&#x6EE1;&#x8DB3;sort.Interface&#x8981;&#x6C42;, &#x5C31;&#x80FD;&#x88AB;&#x6392;&#x5E8F;.
&#x8981;&#x6C42;&#x5E95;&#x5C42;&#x627F;&#x8F7D;&#x6570;&#x636E;&#x7684;&#x4E1C;&#x897F;, &#x662F;&#x6309;&#x6574;&#x6570;index&#x5BFB;&#x5740;&#x7684;. &#x4E5F;&#x5C31;&#x662F;&#x8BF4;, &#x5FC5;&#x987B;&#x662F;&#x6570;&#x7EC4;.</p>
<pre class="language-"><code class="lang-go"><span class="token keyword">type</span> Interface <span class="token keyword">interface</span> <span class="token punctuation">{</span>
    <span class="token comment">// Len is the number of elements in the collection.</span>
    <span class="token function">Len</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token builtin">int</span>
    <span class="token comment">// Less reports whether the element with</span>
    <span class="token comment">// index i should sort before the element with index j.</span>
    <span class="token function">Less</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> j <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token builtin">bool</span>
    <span class="token comment">// Swap swaps the elements with indexes i and j.</span>
    <span class="token function">Swap</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> j <span class="token builtin">int</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="golang_内存分配.html" class="navigation navigation-prev " aria-label="Previous page: 内存分配(网摘)">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="golang_我的反射代码.html" class="navigation navigation-next " aria-label="Next page: 我的反射代码">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"标准库","level":"1.2.3","depth":2,"next":{"title":"我的反射代码","level":"1.2.4","depth":2,"path":"notes/golang_我的反射代码.md","ref":"notes/golang_我的反射代码.md","articles":[]},"previous":{"title":"内存分配(网摘)","level":"1.2.2.2","depth":3,"path":"notes/golang_内存分配.md","ref":"notes/golang_内存分配.md","articles":[]},"dir":"ltr"},"config":{"plugins":["-sharing","-lunr","-search","search-plus","-highlight","prism","prism-themes","expandable-chapters-small","github","disqus","splitter","wide-page","hide-navigation-buttons","anchor-navigation-ex"],"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"pluginsConfig":{"prism":{"css":["prism-themes/themes/prism-coldark-cold.css"]},"disqus":{"useIdentifier":false,"shortName":"bai-yingjie-notes"},"github":{"url":"https://github.com/Bai-Yingjie/Bai-Yingjie.github.io"},"splitter":{},"wide-page":{},"fontsettings":{"theme":"white","family":"sans","size":2},"hide-navigation-buttons":{},"anchor-navigation-ex":{"mode":"float","pageTop":{"level1Icon":"","level2Icon":"","level3Icon":"","showLevelIcon":false},"isRewritePageTitle":true,"showLevel":true,"tocLevel1Icon":"fa fa-hand-o-right","tocLevel2Icon":"fa fa-hand-o-right","tocLevel3Icon":"fa fa-hand-o-right","showGoTop":true,"isShowTocTitleIcon":true,"printLog":false,"multipleH1":true,"associatedWithSummary":true,"float":{"floatIcon":"fa fa-navicon","level1Icon":"","level2Icon":"","level3Icon":"","showLevelIcon":false}},"prism-themes":{},"expandable-chapters-small":{},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false},"search-plus":{}},"theme":"default","author":"Bai Yingjie","pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"variables":{},"title":"My Notes","language":"zh-hans","gitbook":"*"},"file":{"path":"notes/golang_标准库.md","mtime":"2022-09-09T16:45:14.038Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2022-09-09T16:46:12.288Z"},"basePath":"..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../gitbook/gitbook.js"></script>
    <script src="../gitbook/theme.js"></script>
    
        
        <script src="../gitbook/gitbook-plugin-search-plus/jquery.mark.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search-plus/search.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-expandable-chapters-small/expandable-chapters-small.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-github/plugin.js"></script>
        
    
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/URI.js/1.16.1/URI.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-disqus/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-splitter/splitter.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

