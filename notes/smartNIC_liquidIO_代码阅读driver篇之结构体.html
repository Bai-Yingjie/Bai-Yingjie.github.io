
<!DOCTYPE HTML>
<html lang="zh-hans" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>PCI-NIC 代码阅读 --driver篇之结构体 · My Notes</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        <meta name="author" content="Bai Yingjie">
        
        
    
    <link rel="stylesheet" href="../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-search-plus/search.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-expandable-chapters-small/expandable-chapters-small.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-disqus/plugin.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-splitter/splitter.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-wide-page/wide.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-hide-navigation-buttons/index.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-anchor-navigation-ex/style/plugin.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="smartNIC_liquidIO_代码阅读driver篇.html" />
    
    
    <link rel="prev" href="smartNIC_liquidIO_代码阅读api篇.html" />
    

    </head>
    <body>
        


<div class="book">
    <div class="book-summary">
        
            <div class="theme-code-header">
                <a href="" class="link">
                    <h1 class="title">My Notes</h1>
                </a>
            </div>
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="输入并搜索" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../">
            
                <a href="../">
            
                    
                    简介
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="as_title.html">
            
                <a href="as_title.html">
            
                    
                    开源
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1" data-path="my_opensource.html">
            
                <a href="my_opensource.html">
            
                    
                    我的开源项目
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2" data-path="my_upstream.html">
            
                <a href="my_upstream.html">
            
                    
                    我的upstream commit
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="as_title.html">
            
                <a href="as_title.html">
            
                    
                    系统分析和性能
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1" data-path="system_analysis_bcc和ebpf.html">
            
                <a href="system_analysis_bcc和ebpf.html">
            
                    
                    bcc和ebpf(starting)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2" data-path="performance_ovs进程调查.html">
            
                <a href="performance_ovs进程调查.html">
            
                    
                    OVS进程调查
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3" data-path="performance_ping流程和函数调用解析.html">
            
                <a href="performance_ping流程和函数调用解析.html">
            
                    
                    ping流程和函数调用解析
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.4" data-path="CentOS_系统性能优化配置.html">
            
                <a href="CentOS_系统性能优化配置.html">
            
                    
                    CentOS 性能优化系统配置
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="as_title.html">
            
                <a href="as_title.html">
            
                    
                    ARM server
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1" data-path="arm_server_杂记.html">
            
                <a href="arm_server_杂记.html">
            
                    
                    Arm server 杂记
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="as_title.html">
            
                <a href="as_title.html">
            
                    
                    嵌入式系统开发调试
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.1" data-path="embedded_debugging.html">
            
                <a href="embedded_debugging.html">
            
                    
                    嵌入式调试杂记
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2" data-path="uboot_杂记.html">
            
                <a href="uboot_杂记.html">
            
                    
                    uboot杂记
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.3" data-path="buildroot_杂记.html">
            
                <a href="buildroot_杂记.html">
            
                    
                    buildroot杂记
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.4" data-path="toolchain_升级gcc问题解决.html">
            
                <a href="toolchain_升级gcc问题解决.html">
            
                    
                    升级GCC7.3问题解决
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.6" data-path="as_title.html">
            
                <a href="as_title.html">
            
                    
                    Linux工程实践
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.6.1" data-path="linux_日常使用.html">
            
                <a href="linux_日常使用.html">
            
                    
                    日常linux使用
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.2" data-path="git_日常使用.html">
            
                <a href="git_日常使用.html">
            
                    
                    日常git使用
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.3" data-path="向kernel提交补丁.html">
            
                <a href="向kernel提交补丁.html">
            
                    
                    向kernel提交补丁
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.4" data-path="linux_ssh_relay.html">
            
                <a href="linux_ssh_relay.html">
            
                    
                    ssh relay
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.5" data-path="gitlab_ci.html">
            
                <a href="gitlab_ci.html">
            
                    
                    gitlab CI
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.6" data-path="docker_操作记录.html">
            
                <a href="docker_操作记录.html">
            
                    
                    docker操作记录
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.7" data-path="centos_操作记录.html">
            
                <a href="centos_操作记录.html">
            
                    
                    centos操作记录
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.7" data-path="as_title.html">
            
                <a href="as_title.html">
            
                    
                    Golang
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.7.1" data-path="as_title.html">
            
                <a href="as_title.html">
            
                    
                    入门
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.7.1.1" data-path="golang_语法基础.html">
            
                <a href="golang_语法基础.html">
            
                    
                    Golang 语法基础
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.1.2" data-path="golang_json性能.html">
            
                <a href="golang_json性能.html">
            
                    
                    Golang json性能比较
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.7.2" data-path="golang_原理.html">
            
                <a href="golang_原理.html">
            
                    
                    Golang 原理相关
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.7.2.1" data-path="golang_interface原理.html">
            
                <a href="golang_interface原理.html">
            
                    
                    Golang interface原理(网摘)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.2.2" data-path="golang_内存分配.html">
            
                <a href="golang_内存分配.html">
            
                    
                    Golang 内存分配(网摘)
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.7.3" data-path="golang_标准库.html">
            
                <a href="golang_标准库.html">
            
                    
                    Golang 标准库
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.4" data-path="golang_我的反射代码.html">
            
                <a href="golang_我的反射代码.html">
            
                    
                    Golang 我的反射代码
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.5" data-path="golang_问答.html">
            
                <a href="golang_问答.html">
            
                    
                    Golang 问答
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.6" data-path="golang_高效go.html">
            
                <a href="golang_高效go.html">
            
                    
                    Golang 高效go
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.7" data-path="golang_进阶.html">
            
                <a href="golang_进阶.html">
            
                    
                    Golang 进阶
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.8" data-path="as_title.html">
            
                <a href="as_title.html">
            
                    
                    Golang 杂记
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.7.8.1" data-path="golang_杂记1.html">
            
                <a href="golang_杂记1.html">
            
                    
                    Golang 杂记1
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.8.2" data-path="golang_杂记2.html">
            
                <a href="golang_杂记2.html">
            
                    
                    Golang 杂记2
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.8.3" data-path="golang_杂记3.html">
            
                <a href="golang_杂记3.html">
            
                    
                    Golang 杂记3
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.8.4" data-path="golang_lib选型.html">
            
                <a href="golang_lib选型.html">
            
                    
                    Golang lib选型
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.8.5" data-path="golang_mod_proxy.html">
            
                <a href="golang_mod_proxy.html">
            
                    
                    go mod和go proxy
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.8.6" data-path="golang_汇编_arm64.html">
            
                <a href="golang_汇编_arm64.html">
            
                    
                    Golang 汇编语法和arm64小知识
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.8.7" data-path="golang_cgo_swig.html">
            
                <a href="golang_cgo_swig.html">
            
                    
                    go调用c可以用swig
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.7.9" data-path="as_title.html">
            
                <a href="as_title.html">
            
                    
                    Golang 环境和工具链生成
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.7.9.1" data-path="golang_toolchain_ppc.html">
            
                <a href="golang_toolchain_ppc.html">
            
                    
                    go tools增加ppc32支持.md
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.9.2" data-path="golang_toolchain_compile_gccgo.html">
            
                <a href="golang_toolchain_compile_gccgo.html">
            
                    
                    编译gccgo
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.9.3" data-path="golang_go_on_mips.html">
            
                <a href="golang_go_on_mips.html">
            
                    
                    go on mips boards(not so updated)
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.7.9.3.1" data-path="golang_go_on_mips_part1.html">
            
                <a href="golang_go_on_mips_part1.html">
            
                    
                    part 1: cross compile go
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.9.3.2" data-path="golang_go_on_mips_part2.html">
            
                <a href="golang_go_on_mips_part2.html">
            
                    
                    part 2: build native go compiler
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.9.3.3" data-path="golang_go_on_mips_part3.html">
            
                <a href="golang_go_on_mips_part3.html">
            
                    
                    part 3: gccgo experiments
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.9.3.4" data-path="golang_go_on_mips_part4.html">
            
                <a href="golang_go_on_mips_part4.html">
            
                    
                    part 4: Golang json performance
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.9.3.5" data-path="golang_gentoo_on_mips_board_and_build_go.html">
            
                <a href="golang_gentoo_on_mips_board_and_build_go.html">
            
                    
                    Gentoo on mips board and build go
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.7.10" data-path="as_title.html">
            
                <a href="as_title.html">
            
                    
                    微服务
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.7.10.1" data-path="golang_micro.html">
            
                <a href="golang_micro.html">
            
                    
                    go-micro和micro
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.10.2" data-path="golang_微服务概念.html">
            
                <a href="golang_微服务概念.html">
            
                    
                    微服务概念
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.7.11" data-path="as_title.html">
            
                <a href="as_title.html">
            
                    
                    解释器和编解码
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.7.11.1" data-path="golang_yeagi.html">
            
                <a href="golang_yeagi.html">
            
                    
                    解释器yeagi
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.11.2" data-path="golang_tengo.html">
            
                <a href="golang_tengo.html">
            
                    
                    解释器tengo
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.11.3" data-path="golang_govaluate.html">
            
                <a href="golang_govaluate.html">
            
                    
                    解释器govaluate
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.11.4" data-path="golang_encoding_gotiny.html">
            
                <a href="golang_encoding_gotiny.html">
            
                    
                    gotiny编解码
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.11.5" data-path="golang_abs.html">
            
                <a href="golang_abs.html">
            
                    
                    解释器abs
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.7.12" data-path="as_title.html">
            
                <a href="as_title.html">
            
                    
                    调试和性能
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.7.12.1" data-path="golang_调试记录.html">
            
                <a href="golang_调试记录.html">
            
                    
                    Golang 调试记录
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.12.2" data-path="golang_topid性能优化.html">
            
                <a href="golang_topid性能优化.html">
            
                    
                    Golang topid性能优化
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.12.3" data-path="golang_gshell性能调试.html">
            
                <a href="golang_gshell性能调试.html">
            
                    
                    Golang gshell性能调试
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.7.13" data-path="as_title.html">
            
                <a href="as_title.html">
            
                    
                    网络和消息中间件
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.7.13.1" data-path="golang_zmq.html">
            
                <a href="golang_zmq.html">
            
                    
                    消息中间件基本概念和zero mq
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.13.2" data-path="golang_mango.html">
            
                <a href="golang_mango.html">
            
                    
                    消息中间件mango
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.13.3" data-path="golang_libp2p.html">
            
                <a href="golang_libp2p.html">
            
                    
                    Golang p2p网络
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.8" data-path="as_title.html">
            
                <a href="as_title.html">
            
                    
                    Rust
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.8.1" data-path="rust_入门_brief.html">
            
                <a href="rust_入门_brief.html">
            
                    
                    Rust 入门系列
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.8.1.1" data-path="rust_books.html">
            
                <a href="rust_books.html">
            
                    
                    Rust reference books
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.1.2" data-path="rust_入门1.html">
            
                <a href="rust_入门1.html">
            
                    
                    Rust 安装和基础语法
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.1.3" data-path="rust_入门2.html">
            
                <a href="rust_入门2.html">
            
                    
                    Rust 泛型和内存所有权
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.1.4" data-path="rust_入门3.html">
            
                <a href="rust_入门3.html">
            
                    
                    Rust 闭包 容器 迭代器 生成器 线程
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.1.5" data-path="rust_工程构建.html">
            
                <a href="rust_工程构建.html">
            
                    
                    Rust 工程构建
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.8.2" data-path="rust_coding_brief.html">
            
                <a href="rust_coding_brief.html">
            
                    
                    Rust 代码积累
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.8.2.1" data-path="rust_序列化.html">
            
                <a href="rust_序列化.html">
            
                    
                    Rust 序列化原理
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.2.2" data-path="rust_知识点积累.html">
            
                <a href="rust_知识点积累.html">
            
                    
                    Rust 知识点更新
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.2.3" data-path="rust_adaptiveservice.html">
            
                <a href="rust_adaptiveservice.html">
            
                    
                    rust版本的adaptiveservice探索
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.2.4" data-path="rust_常用设施.html">
            
                <a href="rust_常用设施.html">
            
                    
                    Rust 常用设施
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.2.5" data-path="rust_代码小段.html">
            
                <a href="rust_代码小段.html">
            
                    
                    Rust 代码小段
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.8.3" data-path="others.html">
            
                <a href="others.html">
            
                    
                    其他
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.8.3.1" data-path="rust_mdbook_使用.html">
            
                <a href="rust_mdbook_使用.html">
            
                    
                    Rust 使用mdbook
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.9" data-path="as_title.html">
            
                <a href="as_title.html">
            
                    
                    C开发
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.9.1" data-path="c_automake_autoconf.html">
            
                <a href="c_automake_autoconf.html">
            
                    
                    automake autoconf
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.2" data-path="makefile_原理和实践.html">
            
                <a href="makefile_原理和实践.html">
            
                    
                    makefile
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.3" data-path="c_编程杂记高级篇.html">
            
                <a href="c_编程杂记高级篇.html">
            
                    
                    C编程杂记高级篇
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.4" data-path="c_编程杂记基础篇.html">
            
                <a href="c_编程杂记基础篇.html">
            
                    
                    C编程杂记基础篇
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.5" data-path="c_networking_socket高阶用法.html">
            
                <a href="c_networking_socket高阶用法.html">
            
                    
                    网络编程: Advanced Socket Topics(网摘)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.6" data-path="c_protobuf介绍.html">
            
                <a href="c_protobuf介绍.html">
            
                    
                    序列化: protobuf介绍
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.7" data-path="c_进程间通信_共享文件和共享内存.html">
            
                <a href="c_进程间通信_共享文件和共享内存.html">
            
                    
                    进程间通信: 共享文件和共享内存(网摘)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.8" data-path="c_pthread_condition和mutex.html">
            
                <a href="c_pthread_condition和mutex.html">
            
                    
                    并发 任务 事件 和锁.md
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.9" data-path="kernel_user_space_howto.html">
            
                <a href="kernel_user_space_howto.html">
            
                    
                    kernel space和user space交互(网摘, linux2.6)
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.10" data-path="as_title.html">
            
                <a href="as_title.html">
            
                    
                    脚本
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.10.1" data-path="shell_变量.html">
            
                <a href="shell_变量.html">
            
                    
                    shell变量
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.2" data-path="shell_基础篇.html">
            
                <a href="shell_基础篇.html">
            
                    
                    shell命令和脚本记录-基础篇
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.3" data-path="shell_高级篇.html">
            
                <a href="shell_高级篇.html">
            
                    
                    shell命令和脚本记录-高级篇
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.4" data-path="shell_脚本片段.html">
            
                <a href="shell_脚本片段.html">
            
                    
                    shell脚本片段
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.5" data-path="python_记录.html">
            
                <a href="python_记录.html">
            
                    
                    python记录
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.6" data-path="lua_记录.html">
            
                <a href="lua_记录.html">
            
                    
                    lua记录
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.7" data-path="shell_rds脚本阅读.html">
            
                <a href="shell_rds脚本阅读.html">
            
                    
                    RDS脚本阅读
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.8" data-path="Project_Euler.html">
            
                <a href="Project_Euler.html">
            
                    
                    Project Euler
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.11" data-path="as_title.html">
            
                <a href="as_title.html">
            
                    
                    cloud和容器相关
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.11.1" data-path="cloud_杂记.html">
            
                <a href="cloud_杂记.html">
            
                    
                    云杂记
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11.2" data-path="container_当代容器读书笔记.html">
            
                <a href="container_当代容器读书笔记.html">
            
                    
                    当代容器读书笔记
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.12" data-path="as_title.html">
            
                <a href="as_title.html">
            
                    
                    Operating System
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.12.1" data-path="system_libc_part1.html">
            
                <a href="system_libc_part1.html">
            
                    
                    libc概览1
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.2" data-path="system_libc_part2.html">
            
                <a href="system_libc_part2.html">
            
                    
                    libc概览2
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.3" data-path="system_libc_part3.html">
            
                <a href="system_libc_part3.html">
            
                    
                    libc概览3
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.4" data-path="system_原理杂记.html">
            
                <a href="system_原理杂记.html">
            
                    
                    系统原理杂记
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.5" data-path="system_alpine.html">
            
                <a href="system_alpine.html">
            
                    
                    Alpine Linux
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.6" data-path="system_进程间通信.html">
            
                <a href="system_进程间通信.html">
            
                    
                    进程间通信
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.7" data-path="system_特殊功能fd.html">
            
                <a href="system_特殊功能fd.html">
            
                    
                    eventfd timerfd signalfd和fd共享
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.13" data-path="as_title.html">
            
                <a href="as_title.html">
            
                    
                    CPU和device虚拟化
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.13.1" data-path="as_title.html">
            
                <a href="as_title.html">
            
                    
                    gvisor
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.13.1.1" data-path="golang_gvisor代码_KVM.html">
            
                <a href="golang_gvisor代码_KVM.html">
            
                    
                    gvisor KVM模式代码
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.13.1.2" data-path="golang_gvisor调试.html">
            
                <a href="golang_gvisor调试.html">
            
                    
                    gvisor调试
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.13.1.3" data-path="golang_gvisor_ptrace.html">
            
                <a href="golang_gvisor_ptrace.html">
            
                    
                    gvisor ptrace模式介绍(网摘)
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.13.2" data-path="rust_vmm_brief.html">
            
                <a href="rust_vmm_brief.html">
            
                    
                    rust VMM(virtual machine monitor)
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.13.2.1" data-path="rust_vmm_简介.html">
            
                <a href="rust_vmm_简介.html">
            
                    
                    rust-vmm简介
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.13.2.2" data-path="rust_firecracker_代码.html">
            
                <a href="rust_firecracker_代码.html">
            
                    
                    firecracker代码
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.13.2.3" data-path="rust_firecracker_使用.html">
            
                <a href="rust_firecracker_使用.html">
            
                    
                    firecracker使用
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.13.2.4" data-path="rust_cloud-hypervisor_代码.html">
            
                <a href="rust_cloud-hypervisor_代码.html">
            
                    
                    cloud hypervisor代码
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.13.2.5" data-path="rust_cloud-hypervisor_使用.html">
            
                <a href="rust_cloud-hypervisor_使用.html">
            
                    
                    cloud hypervisor使用
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.13.2.6" data-path="rust_cloud-hypervisor_问题与解决.html">
            
                <a href="rust_cloud-hypervisor_问题与解决.html">
            
                    
                    cloud hypervisor问题与解决
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.13.3" data-path="virtualization_virtio规范阅读笔记.html">
            
                <a href="virtualization_virtio规范阅读笔记.html">
            
                    
                    virtio规范阅读笔记.md
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.13.4" data-path="qemu_ovs_虚拟化环境.html">
            
                <a href="qemu_ovs_虚拟化环境.html">
            
                    
                    qemu OVS 虚拟化环境准备
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.13.5" data-path="qemu使用.html">
            
                <a href="qemu使用.html">
            
                    
                    Qemu使用(old)
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.14" data-path="as_title.html">
            
                <a href="as_title.html">
            
                    
                    计算机网络相关
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.14.1" data-path="networking_杂记1.html">
            
                <a href="networking_杂记1.html">
            
                    
                    networking杂记1
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.14.2" data-path="as_title.html">
            
                <a href="as_title.html">
            
                    
                    Qemu OVS和DPDK
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.14.2.1" data-path="OVS_DPDK_编译运行.html">
            
                <a href="OVS_DPDK_编译运行.html">
            
                    
                    OVS-DPDK编译运行
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.14.2.2" data-path="OVS_架构和代码.html">
            
                <a href="OVS_架构和代码.html">
            
                    
                    OVS架构和代码
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.14.2.3" data-path="OVS_DPDK_performance_HXT_ARM_server.html">
            
                <a href="OVS_DPDK_performance_HXT_ARM_server.html">
            
                    
                    OVS-DPDK for ARM server 性能测试环境
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.14.2.4" data-path="DPDK_Mellanox.html">
            
                <a href="DPDK_Mellanox.html">
            
                    
                    DPDK Mellanox
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.14.2.5" data-path="OVS_phy-vm-phy.html">
            
                <a href="OVS_phy-vm-phy.html">
            
                    
                    OVS PHY-VM-PHY
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.14.2.6" data-path="networking_网络虚拟化用例记录.html">
            
                <a href="networking_网络虚拟化用例记录.html">
            
                    
                    网络虚拟化用例记录
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.14.2.7" data-path="networking_网络虚拟化操作记录.html">
            
                <a href="networking_网络虚拟化操作记录.html">
            
                    
                    网络虚拟化操作记录
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.14.3" data-path="as_title.html">
            
                <a href="as_title.html">
            
                    
                    虚拟化网络
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.14.3.1" data-path="networking_tc_filter_连接veth和tap.html">
            
                <a href="networking_tc_filter_连接veth和tap.html">
            
                    
                    Connecting a veth device to tap
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.14.3.2" data-path="networking_multicast_vxlan_flannel.html">
            
                <a href="networking_multicast_vxlan_flannel.html">
            
                    
                    multicast vxlan和flannel
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.14.3.3" data-path="networking_virtio网络介绍.html">
            
                <a href="networking_virtio网络介绍.html">
            
                    
                    virtio网络介绍(网摘): vhost-net virtio-net vhost-user SRIOV
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.14.3.4" data-path="networking_virtualization_杂记.html">
            
                <a href="networking_virtualization_杂记.html">
            
                    
                    虚拟化网络杂记
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.14.3.5" data-path="networking_linux虚拟网络接口.html">
            
                <a href="networking_linux虚拟网络接口.html">
            
                    
                    linux虚拟网络接口(网摘)
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.15" data-path="as_title.html">
            
                <a href="as_title.html">
            
                    
                    内核 设备和驱动相关
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.15.1" data-path="driver_驱动中使用工作队列轮询.html">
            
                <a href="driver_驱动中使用工作队列轮询.html">
            
                    
                    驱动中使用工作队列轮询
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.15.2" data-path="device_driver_杂记.html">
            
                <a href="device_driver_杂记.html">
            
                    
                    驱动调试杂记
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.15.3" data-path="device_driver_原理相关.html">
            
                <a href="device_driver_原理相关.html">
            
                    
                    kernel和驱动原理相关
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.15.4" data-path="device_localbus_16bit读写.html">
            
                <a href="device_localbus_16bit读写.html">
            
                    
                    CPLD做8bit到16bit转换
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.15.5" data-path="as_title.html">
            
                <a href="as_title.html">
            
                    
                    nand
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.15.5.1" data-path="device_driver_octeon_nand.html">
            
                <a href="device_driver_octeon_nand.html">
            
                    
                    octeon nand flash驱动
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.15.5.2" data-path="device_driver_nand概率写失败问题分析.html">
            
                <a href="device_driver_nand概率写失败问题分析.html">
            
                    
                    Nand flash概率写失败问题分析
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.15.6" data-path="octeon_remote_pci.html">
            
                <a href="octeon_remote_pci.html">
            
                    
                    octeon remote-pci.c阅读
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.15.7" data-path="Device_VFIO_notes.html">
            
                <a href="Device_VFIO_notes.html">
            
                    
                    VFIO简介
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.15.8" data-path="as_title.html">
            
                <a href="as_title.html">
            
                    
                    智能网卡和DPDK
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.15.8.1" data-path="smartNIC_智能网卡对比.html">
            
                <a href="smartNIC_智能网卡对比.html">
            
                    
                    智能网卡对比
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.15.8.2" data-path="octeon_pci_NIC.html">
            
                <a href="octeon_pci_NIC.html">
            
                    
                    octeon PCI NIC
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.15.8.3" data-path="as_title.html">
            
                <a href="as_title.html">
            
                    
                    octeon liquidIO
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.15.8.3.1" data-path="smartNIC_liquidIO_代码阅读app篇.html">
            
                <a href="smartNIC_liquidIO_代码阅读app篇.html">
            
                    
                    PCI-NIC 代码阅读 --app篇
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.15.8.3.2" data-path="smartNIC_liquidIO_代码阅读api篇.html">
            
                <a href="smartNIC_liquidIO_代码阅读api篇.html">
            
                    
                    PCI-NIC 代码阅读 --api篇
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="1.15.8.3.3" data-path="smartNIC_liquidIO_代码阅读driver篇之结构体.html">
            
                <a href="smartNIC_liquidIO_代码阅读driver篇之结构体.html">
            
                    
                    PCI-NIC 代码阅读 --driver篇之结构体
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.15.8.3.4" data-path="smartNIC_liquidIO_代码阅读driver篇.html">
            
                <a href="smartNIC_liquidIO_代码阅读driver篇.html">
            
                    
                    PCI-NIC 代码阅读 --driver篇
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.15.8.3.5" data-path="smartNIC_liquidIO_代码阅读真NIC篇.html">
            
                <a href="smartNIC_liquidIO_代码阅读真NIC篇.html">
            
                    
                    PCI-NIC 代码阅读 --真NIC篇
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.15.8.4" data-path="networking_dpdk使用_2014.html">
            
                <a href="networking_dpdk使用_2014.html">
            
                    
                    DPDK使用(2014)
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.15.9" data-path="device_nvme要点介绍.html">
            
                <a href="device_nvme要点介绍.html">
            
                    
                    nvme要点介绍
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.16" data-path="as_title.html">
            
                <a href="as_title.html">
            
                    
                    CPU Arch相关
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.16.1" data-path="as_title.html">
            
                <a href="as_title.html">
            
                    
                    ARM64
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.16.1.1" data-path="CPU_ARM64_thunder_overview.html">
            
                <a href="CPU_ARM64_thunder_overview.html">
            
                    
                    thunder 概览
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.16.1.2" data-path="CPU_ARM64_thunder_开发板操作记录.html">
            
                <a href="CPU_ARM64_thunder_开发板操作记录.html">
            
                    
                    thunder 开发板操作记录
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.16.1.3" data-path="CPU_ARM64_thunder_bdk.html">
            
                <a href="CPU_ARM64_thunder_bdk.html">
            
                    
                    thunder BDK
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.16.1.4" data-path="CPU_ARM64_thunder_efi_rtc.html">
            
                <a href="CPU_ARM64_thunder_efi_rtc.html">
            
                    
                    thunder RTC时间和efi
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.16.1.5" data-path="CPU_ARM64_thunder_uefi_fdt.html">
            
                <a href="CPU_ARM64_thunder_uefi_fdt.html">
            
                    
                    thunder uefi和fdt
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.16.1.6" data-path="CPU_ARM64_thunder_atf.html">
            
                <a href="CPU_ARM64_thunder_atf.html">
            
                    
                    thunder atf
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.16.1.7" data-path="CPU_ARM64_thunder_kernel_boot.html">
            
                <a href="CPU_ARM64_thunder_kernel_boot.html">
            
                    
                    thunder kernel启动打印流程
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.16.2" data-path="as_title.html">
            
                <a href="as_title.html">
            
                    
                    PPC
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.16.2.1" data-path="CPU_PPC启动多核Linux_流程和内存映射.html">
            
                <a href="CPU_PPC启动多核Linux_流程和内存映射.html">
            
                    
                    PPC启动多核linux: 流程和内存映射
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.16.2.2" data-path="CPU_PPC_kernel升级记录.html">
            
                <a href="CPU_PPC_kernel升级记录.html">
            
                    
                    PPC kernel升级记录
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.16.3" data-path="as_title.html">
            
                <a href="as_title.html">
            
                    
                    MIPS
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.16.3.1" data-path="CPU_MIPS_octeon地址空间和寄存器访问.html">
            
                <a href="CPU_MIPS_octeon地址空间和寄存器访问.html">
            
                    
                    octeon 地址空间和寄存器访问
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.16.3.2" data-path="CPU_MIPS_octeon操作记录.html">
            
                <a href="CPU_MIPS_octeon操作记录.html">
            
                    
                    octeon 操作记录
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.16.3.3" data-path="CPU_MIPS_octeon_包处理性能.html">
            
                <a href="CPU_MIPS_octeon_包处理性能.html">
            
                    
                    octeon 系列处理器包处理性能
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.16.3.4" data-path="CPU_MIPS_octeon_ddr调试记录.html">
            
                <a href="CPU_MIPS_octeon_ddr调试记录.html">
            
                    
                    octeon DDR调试
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.16.3.5" data-path="CPU_MIPS_octeon_BDK.html">
            
                <a href="CPU_MIPS_octeon_BDK.html">
            
                    
                    octeon CN78xx BDK
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.16.3.6" data-path="kernel_增加ECC中断.html">
            
                <a href="kernel_增加ECC中断.html">
            
                    
                    octeon 增加ECC中断
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.16.3.7" data-path="CPU_MIPS_octeon_hw-ddr2代码走读.html">
            
                <a href="CPU_MIPS_octeon_hw-ddr2代码走读.html">
            
                    
                    octeon hw-ddr2代码走读
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.16.3.8" data-path="CPU_MIPS_octeon_reboot调试和ddr中断.html">
            
                <a href="CPU_MIPS_octeon_reboot调试和ddr中断.html">
            
                    
                    octeon reboot调试和DDR中断
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.16.3.9" data-path="CPU_MIPS_octeon中断.html">
            
                <a href="CPU_MIPS_octeon中断.html">
            
                    
                    octeon 中断
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.16.3.10" data-path="CPU_MIPS_octeon原子操作.html">
            
                <a href="CPU_MIPS_octeon原子操作.html">
            
                    
                    octeon 原子操作
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.16.3.11" data-path="CPU_MIPS_octeon网口代码分析.html">
            
                <a href="CPU_MIPS_octeon网口代码分析.html">
            
                    
                    octeon 网口代码分析
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="" target="_blank" class="gitbook-link">
            Author: Bai Yingjie
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".." >PCI-NIC 代码阅读 --driver篇之结构体</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div class="search-plus" id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <div id="anchor-navigation-ex-navbar"><i class="fa fa-navicon"></i><ul><li><span class="title-icon "></span><a href="#insmod-log"><b>1. </b>insmod log</a></li><li><span class="title-icon "></span><a href="#&#x4E3B;&#x7ED3;&#x6784;&#x4F53;octeondevicet"><b>2. </b>&#x4E3B;&#x7ED3;&#x6784;&#x4F53;octeon_device_t</a></li><li><span class="title-icon "></span><a href="#a&#x63CF;&#x8FF0;pcie&#x7A7A;&#x95F4;&#x7684;&#x7ED3;&#x6784;&#x4F53;"><b>3. </b>A.&#x63CF;&#x8FF0;PCIE&#x7A7A;&#x95F4;&#x7684;&#x7ED3;&#x6784;&#x4F53;</a></li><li><span class="title-icon "></span><a href="#b&#x95F4;&#x63A5;&#x8BBF;&#x95EE;&#x5BC4;&#x5B58;&#x5668;-sliwin"><b>4. </b>B.&#x95F4;&#x63A5;&#x8BBF;&#x95EE;&#x5BC4;&#x5B58;&#x5668;, SLI_WIN*</a></li><li><span class="title-icon "></span><a href="#c&#x7528;&#x6765;&#x9002;&#x914D;&#x4E0D;&#x540C;&#x7684;octeon&#x578B;&#x53F7;"><b>5. </b>C.&#x7528;&#x6765;&#x9002;&#x914D;&#x4E0D;&#x540C;&#x7684;octeon&#x578B;&#x53F7;</a></li><li><span class="title-icon "></span><a href="#d&#x8868;&#x793A;&#x4E00;&#x4E2A;input-ring"><b>6. </b>D.&#x8868;&#x793A;&#x4E00;&#x4E2A;input ring</a></li><li><span class="title-icon "></span><a href="#e&#x5BF9;&#x5E94;&#x4E3B;&#x7ED3;&#x6784;&#x4F53;&#x7684;plist&#x57DF;"><b>7. </b>E.&#x5BF9;&#x5E94;&#x4E3B;&#x7ED3;&#x6784;&#x4F53;&#x7684;plist&#x57DF;</a></li><ul><li><span class="title-icon "></span><a href="#e1octeonpendingentryt"><b>7.1. </b>E1.octeon_pending_entry_t</a></li><ul><li><span class="title-icon "></span><a href="#e11&#x8FD9;&#x4E2A;&#x5C31;&#x662F;&#x548C;&#x786C;&#x4EF6;&#x6700;&#x63A5;&#x8FD1;&#x7684;&#x7ED3;&#x6784;"><b>7.1.1. </b>E11.&#x8FD9;&#x4E2A;&#x5C31;&#x662F;&#x548C;&#x786C;&#x4EF6;&#x6700;&#x63A5;&#x8FD1;&#x7684;&#x7ED3;&#x6784;?</a></li></ul></ul><li><span class="title-icon "></span><a href="#f&#x5934;&#x6307;&#x9488;-&#x8868;&#x793A;&#x4E00;&#x4E2A;response&#x94FE;&#x8868;"><b>8. </b>F.&#x5934;&#x6307;&#x9488;, &#x8868;&#x793A;&#x4E00;&#x4E2A;response&#x94FE;&#x8868;</a></li><li><span class="title-icon "></span><a href="#g&#x8868;&#x793A;output-ring&#x63CF;&#x8FF0;&#x7B26;"><b>9. </b>G.&#x8868;&#x793A;output ring&#x63CF;&#x8FF0;&#x7B26;</a></li><ul><li><span class="title-icon "></span><a href="#g1octeondroqopst"><b>9.1. </b>G1.octeon_droq_ops_t</a></li><li><span class="title-icon "></span><a href="#g2cvmkthreadt"><b>9.2. </b>G2.cvm_kthread_t</a></li><li><span class="title-icon "></span><a href="#g3&#x771F;&#x6B63;&#x7684;&#x7B26;&#x5408;&#x786C;&#x4EF6;&#x7684;&#x5B9A;&#x4E49;&#x7684;&#x7ED3;&#x6784;&#x4F53;"><b>9.3. </b>G3.&#x771F;&#x6B63;&#x7684;&#x7B26;&#x5408;&#x786C;&#x4EF6;&#x7684;&#x5B9A;&#x4E49;&#x7684;&#x7ED3;&#x6784;&#x4F53;</a></li><li><span class="title-icon "></span><a href="#g4octeondroqinfot"><b>9.4. </b>G4.octeon_droq_info_t</a></li><ul><li><span class="title-icon "></span><a href="#g41octeonresphdrt"><b>9.4.1. </b>G41.octeon_resp_hdr_t</a></li></ul><li><span class="title-icon "></span><a href="#g5&#x9A71;&#x52A8;&#x7528;&#x8FD9;&#x4E2A;&#x6765;&#x8868;&#x793A;buffer-&#x7528;&#x7684;&#x662F;&#x865A;&#x62DF;&#x5730;&#x5740;"><b>9.5. </b>G5.&#x9A71;&#x52A8;&#x7528;&#x8FD9;&#x4E2A;&#x6765;&#x8868;&#x793A;buffer, &#x7528;&#x7684;&#x662F;&#x865A;&#x62DF;&#x5730;&#x5740;</a></li><li><span class="title-icon "></span><a href="#g6-octdroqstatst"><b>9.6. </b>G6. oct_droq_stats_t</a></li></ul><li><span class="title-icon "></span><a href="#h-octeondmaopst"><b>10. </b>H. octeon_dma_ops_t</a></li><li><span class="title-icon "></span><a href="#i-octeonrangetablet"><b>11. </b>I. octeon_range_table_t</a></li><li><span class="title-icon "></span><a href="#j&#x6536;&#x5230;&#x62A5;&#x6587;&#x540E;&#x6309;opcode&#x5206;&#x53D1;"><b>12. </b>J.&#x6536;&#x5230;&#x62A5;&#x6587;&#x540E;&#x6309;opcode&#x5206;&#x53D1;</a></li><li><span class="title-icon "></span><a href="#k-buffer-pool"><b>13. </b>K. buffer pool</a></li><li><span class="title-icon "></span><a href="#l-buffer-pool&#x7684;fragment"><b>14. </b>L. buffer pool&#x7684;fragment</a></li><li><span class="title-icon "></span><a href="#museddoqthreads"><b>15. </b>M.USE_DDOQ_THREADS</a></li><li><span class="title-icon "></span><a href="#octeonmodulehandlert"><b>16. </b>octeon_module_handler_t</a></li><li><span class="title-icon "></span><a href="#octeoncn6xxxt"><b>17. </b>octeon_cn6xxx_t</a></li><ul><li><span class="title-icon "></span><a href="#2acn6xxxconfigt"><b>17.1. </b>2A.cn6xxx_config_t</a></li></ul></ul></div><a href="#insmod-log" id="anchorNavigationExGoTop"><i class="fa fa-arrow-up"></i></a><ul>
<li><a href="#insmod-log">insmod log</a></li>
<li><a href="#&#x4E3B;&#x7ED3;&#x6784;&#x4F53;octeon_device_t">&#x4E3B;&#x7ED3;&#x6784;&#x4F53;<code>octeon_device_t</code></a></li>
<li><a href="#a&#x63CF;&#x8FF0;pcie&#x7A7A;&#x95F4;&#x7684;&#x7ED3;&#x6784;&#x4F53;">A.&#x63CF;&#x8FF0;PCIE&#x7A7A;&#x95F4;&#x7684;&#x7ED3;&#x6784;&#x4F53;</a></li>
<li><a href="#b&#x95F4;&#x63A5;&#x8BBF;&#x95EE;&#x5BC4;&#x5B58;&#x5668;-sli_win">B.&#x95F4;&#x63A5;&#x8BBF;&#x95EE;&#x5BC4;&#x5B58;&#x5668;, SLI_WIN*</a></li>
<li><a href="#c&#x7528;&#x6765;&#x9002;&#x914D;&#x4E0D;&#x540C;&#x7684;octeon&#x578B;&#x53F7;">C.&#x7528;&#x6765;&#x9002;&#x914D;&#x4E0D;&#x540C;&#x7684;octeon&#x578B;&#x53F7;</a></li>
<li><a href="#d&#x8868;&#x793A;&#x4E00;&#x4E2A;input-ring">D.&#x8868;&#x793A;&#x4E00;&#x4E2A;input ring</a></li>
<li><a href="#e&#x5BF9;&#x5E94;&#x4E3B;&#x7ED3;&#x6784;&#x4F53;&#x7684;plist&#x57DF;">E.&#x5BF9;&#x5E94;&#x4E3B;&#x7ED3;&#x6784;&#x4F53;&#x7684;plist&#x57DF;</a><ul>
<li><a href="#e1octeon_pending_entry_t">E1.octeon_pending_entry_t</a><ul>
<li><a href="#e11&#x8FD9;&#x4E2A;&#x5C31;&#x662F;&#x548C;&#x786C;&#x4EF6;&#x6700;&#x63A5;&#x8FD1;&#x7684;&#x7ED3;&#x6784;">E11.&#x8FD9;&#x4E2A;&#x5C31;&#x662F;&#x548C;&#x786C;&#x4EF6;&#x6700;&#x63A5;&#x8FD1;&#x7684;&#x7ED3;&#x6784;?</a><ul>
<li><a href="#e111octeon_request_info_t">E111.octeon_request_info_t</a></li>
<li><a href="#e112&#x5BF9;&#x5E94;&#x5230;&#x786C;&#x4EF6;&#x5BC4;&#x5B58;&#x5668;dpi_inst_hdr">E112.&#x5BF9;&#x5E94;&#x5230;&#x786C;&#x4EF6;&#x5BC4;&#x5B58;&#x5668;DPI_INST_HDR</a></li>
<li><a href="#e113input-request-header">E113.Input Request Header</a></li>
<li><a href="#e114&#x8FD9;&#x4E2A;&#x5C31;&#x662F;input-ring&#x7684;&#x4E00;&#x4E2A;instruction">E114.&#x8FD9;&#x4E2A;&#x5C31;&#x662F;input ring&#x7684;&#x4E00;&#x4E2A;instruction</a></li>
<li><a href="#e115extra-header">E115.extra header</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a href="#f&#x5934;&#x6307;&#x9488;-&#x8868;&#x793A;&#x4E00;&#x4E2A;response&#x94FE;&#x8868;">F.&#x5934;&#x6307;&#x9488;, &#x8868;&#x793A;&#x4E00;&#x4E2A;response&#x94FE;&#x8868;</a></li>
<li><a href="#g&#x8868;&#x793A;output-ring&#x63CF;&#x8FF0;&#x7B26;">G.&#x8868;&#x793A;output ring&#x63CF;&#x8FF0;&#x7B26;</a><ul>
<li><a href="#g1octeon_droq_ops_t">G1.octeon_droq_ops_t</a></li>
<li><a href="#g2cvm_kthread_t">G2.cvm_kthread_t</a></li>
<li><a href="#g3&#x771F;&#x6B63;&#x7684;&#x7B26;&#x5408;&#x786C;&#x4EF6;&#x7684;&#x5B9A;&#x4E49;&#x7684;&#x7ED3;&#x6784;&#x4F53;">G3.&#x771F;&#x6B63;&#x7684;&#x7B26;&#x5408;&#x786C;&#x4EF6;&#x7684;&#x5B9A;&#x4E49;&#x7684;&#x7ED3;&#x6784;&#x4F53;</a></li>
<li><a href="#g4octeon_droq_info_t">G4.octeon_droq_info_t</a><ul>
<li><a href="#g41octeon_resp_hdr_t">G41.octeon_resp_hdr_t</a></li>
</ul>
</li>
<li><a href="#g5&#x9A71;&#x52A8;&#x7528;&#x8FD9;&#x4E2A;&#x6765;&#x8868;&#x793A;buffer-&#x7528;&#x7684;&#x662F;&#x865A;&#x62DF;&#x5730;&#x5740;">G5.&#x9A71;&#x52A8;&#x7528;&#x8FD9;&#x4E2A;&#x6765;&#x8868;&#x793A;buffer, &#x7528;&#x7684;&#x662F;&#x865A;&#x62DF;&#x5730;&#x5740;</a></li>
<li><a href="#g6-oct_droq_stats_t">G6. oct_droq_stats_t</a></li>
</ul>
</li>
<li><a href="#h-octeon_dma_ops_t">H. octeon_dma_ops_t</a></li>
<li><a href="#i-octeon_range_table_t">I. octeon_range_table_t</a></li>
<li><a href="#j&#x6536;&#x5230;&#x62A5;&#x6587;&#x540E;&#x6309;opcode&#x5206;&#x53D1;">J.&#x6536;&#x5230;&#x62A5;&#x6587;&#x540E;&#x6309;opcode&#x5206;&#x53D1;</a></li>
<li><a href="#k-buffer-pool">K. buffer pool</a></li>
<li><a href="#l-buffer-pool&#x7684;fragment">L. buffer pool&#x7684;fragment</a></li>
<li><a href="#muse_ddoq_threads">M.USE_DDOQ_THREADS</a></li>
<li><a href="#octeon_module_handler_t">octeon_module_handler_t</a></li>
<li><a href="#octeon_cn6xxx_t">octeon_cn6xxx_t</a><ul>
<li><a href="#2acn6xxx_config_t">2A.cn6xxx_config_t</a></li>
</ul>
</li>
</ul>
<h1 id="insmod-log"><a name="insmod-log" class="anchor-navigation-ex-anchor" href="#insmod-log"><i class="fa fa-link" aria-hidden="true"></i></a>1. insmod log</h1>
<pre><code>octeon_drv: module license &apos;Cavium Networks&apos; taints kernel.
Disabling lock debugging due to kernel taint
-- OCTEON: Loading Octeon PCI driver (base module)
OCTEON: Driver Version: PCI BASE RELEASE 2.3.0 build 84
OCTEON: System is Little endian (1000 ticks/sec)
OCTEON: PCI Driver compile options:  DEBUG 


OCTEON: Found device 177d:92..Initializing...
OCTEON: Setting up Octeon device 0 
Octeon 0000:08:00.0: PCI INT A -&gt; GSI 16 (level, low) -&gt; IRQ 16
Octeon 0000:08:00.0: setting latency timer to 64
OCTEON[0]: CN66XX PASS1.2
OCTEON[0]: Using PCIE Port 0
OCTEON[0]: BIST enabled for soft reset
OCTEON[0]: Reset completed
OCTEON[0] Poll Function (Module Starter arg: 0x0) registered
OCTEON[0]: Enabling PCI-E error reporting..
OCTEON: Initializing droq tasklet
OCTEON: Initializing completion on interrupt tasklet
  alloc irq_desc for 146 on node 0
  alloc kstat_irqs on node 0
alloc irq_2_iommu on node 0
Octeon 0000:08:00.0: irq 146 for MSI/MSI-X
OCTEON[0]: MSI enabled
OCTEON: Octeon device 0 is ready

-- OCTEON: Octeon Poll Thread starting execution now!
-- OCTEON: Octeon PCI driver (base module) is ready!
</code></pre><h1 id="&#x4E3B;&#x7ED3;&#x6784;&#x4F53;octeondevicet"><a name="&#x4E3B;&#x7ED3;&#x6784;&#x4F53;octeondevicet" class="anchor-navigation-ex-anchor" href="#&#x4E3B;&#x7ED3;&#x6784;&#x4F53;octeondevicet"><i class="fa fa-link" aria-hidden="true"></i></a>2. &#x4E3B;&#x7ED3;&#x6784;&#x4F53;octeon_device_t</h1>
<p>&#x5728;<code>components/driver/host/driver/osi/octeon_device.c</code>&#x4E2D;<br>&#x5B9A;&#x4E49;&#x4E86;<code>octeon_device[]</code>&#x6570;&#x7EC4;, &#x6700;&#x591A;&#x652F;&#x6301;<code>MAX_OCTEON_DEVICES(4)</code>&#x540C;&#x65F6;&#x5B58;&#x5728;</p>
<pre><code class="lang-c">octeon_device_t *octeon_device[MAX_OCTEON_DEVICES];
typedef struct _OCTEON_DEVICE octeon_device_t;
</code></pre>
<p>&#x6BCF;&#x4E2A;octeon device&#x88AB;&#x62BD;&#x8C61;&#x4E3A;&#x4E00;&#x4E2A;<code>octeon_device_t</code>&#x7ED3;&#x6784;&#x4F53;, &#x6CE8;&#x610F;&#x8FD9;&#x4E2A;&#x4E3B;&#x7ED3;&#x6784;&#x662F;osi&#x7684;</p>
<pre><code class="lang-c">/** The Octeon device. 
 *  Each Octeon device has this structure to represent all its
 *  components.
 */
struct _OCTEON_DEVICE {
   /** Lock for this Octeon device */
   cavium_spinlock_t        oct_lock; //&#x5B9E;&#x9645;&#x662F;spinlock_t
   /** OS dependent PCI device pointer */ 
   cavium_pci_device_t     *pci_dev; //linux&#x4E0B;&#x9762;&#x662F;struct pci_dev
   /** Chip specific information. */
   void                    *chip;
   /** Octeon Chip type. */
   uint16_t                 chip_id;
   uint16_t                 rev_id;
   /** This device&apos;s id - set by the driver. */
   uint16_t                 octeon_id;
   /** This device&apos;s PCIe port used for traffic. */
   uint16_t                 pcie_port;
   /** The state of this device */
   cavium_atomic_t          status; //&#x662F;atomic_t
   /** memory mapped io range */
   octeon_mmio              mmio[OCT_MEM_REGIONS]; //3&#x4E2A;, &#x7ED3;&#x6784;&#x4F53;&#x5B9A;&#x4E49;&#x89C1;A
   struct octeon_reg_list   reg_list; //&#x89C1;B
   struct octeon_fn_list    fn_list; //&#x89C1;C
   cavium_atomic_t          interrupts;
   cavium_atomic_t          in_interrupt;
   int                      num_iqs;
   /** The 4 input instruction queues */
   octeon_instr_queue_t     *instr_queue[MAX_OCTEON_INSTR_QUEUES]; //32&#x4E2A;, &#x7ED3;&#x6784;&#x4F53;&#x5B9A;&#x4E49;&#x5728;D,&#x5F88;&#x5173;&#x952E;
   int                       pend_list_size;
   octeon_pending_list_t    *plist; //&#x89C1;E
   /** The doubly-linked list of instruction response */
   octeon_response_list_t    response_list[MAX_RESPONSE_LISTS]; //3&#x4E2A;, &#x4E00;&#x4E2A;ordered, &#x4E00;&#x4E2A;unordered-blocking, &#x4E00;&#x4E2A;unordered-nonblocking, &#x7ED3;&#x6784;&#x4F53;&#x89C1;F
   int                        num_oqs;
   /** The 4 output queues  */
   octeon_droq_t            *droq[MAX_OCTEON_OUTPUT_QUEUES]; //32&#x4E2A;, droq&#x662F;Descriptor Ring Output Queue, &#x7ED3;&#x6784;&#x4F53;&#x89C1;G
#if  !defined(USE_DROQ_THREADS)
   /** Tasklet structures for this device. */
   struct tasklet_struct     droq_tasklet;
#endif
   struct tasklet_struct     comp_tasklet;
   uint32_t                  napi_mask;
   void                     *poll_list;
   cavium_spinlock_t         poll_lock;
   struct tasklet_struct     cntq_tasklet;
   uint32_t                  cntq_ready;
   /* The 2 Octeon DMA Counter Queues */
   void                     *cntq[MAX_OCTEON_DMA_QUEUES]; //2&#x4E2A;
   /* The DDOQ lookup table */
   void                     *ddoq_list;
   /** Operations on the DMA queues */
   octeon_dma_ops_t          dma_ops; //&#x89C1;H
   /** A table maintaining maps of core-addr to BAR1 mapped address. */
   octeon_range_table_t      range_table[MAX_OCTEON_MAPS]; //&#x6700;&#x591A;32&#x4E2A;map, &#x89C1;I
   /** Total number of core-address ranges mapped (Upto 32). */
   uint32_t                  map_count;
   octeon_io_enable_t        io_qmask; //&#x4E09;&#x4E2A;uint32_t, iq, oq, iq64B
   /** List of dispatch functions */
   octeon_dispatch_list_t    dispatch; //&#x9A71;&#x52A8;&#x6536;&#x5230;&#x62A5;&#x6587;&#x540E;,&#x4F1A;&#x4F9D;&#x6B21;&#x8C03;&#x8FD9;&#x4E2A;&#x94FE;&#x8868;&#x91CC;&#x9762;&#x7684;&#x51FD;&#x6570;, &#x6CE8;&#x610F;&#x91CC;&#x9762;&#x7684;opcode, &#x89C1;J
#ifdef USE_BUFFER_POOL //&#x5982;&#x4F55;&#x6253;&#x5F00;buffer pool???
   /** The buffer pool implementation */
   cavium_buffer_t           buf[BUF_POOLS]; //6&#x4E2A;pool, &#x5206;&#x522B;&#x662F;32k,16k,8k,4k,2k,1k&#x5927;&#x5C0F;&#x7684;pool, &#x89C1;K
   cavium_frag_buf_t         fragments[MAX_BUFFER_CHUNKS]; //1500&#x4E2A;, &#x89C1;L
   uint16_t                  fragment_free_list[MAX_BUFFER_CHUNKS];
   uint16_t                  fragment_free_list_index;
   cavium_spinlock_t         fragment_lock;
#endif
   /** The /proc file entries */
   void                     *proc_root_dir;
   /** Statistics for this octeon device. Does not include IQ, DROQ stats */
   oct_dev_stats_t           stats; //&#x7EDF;&#x8BA1;&#x4FE1;&#x606F;, &#x90FD;&#x662F;64&#x4F4D;, interrupts poll_count comp_tasklet_count droq_tasklet_count cntq_tasklet_count
   /** IRQ assigned to this device. */
   int                       irq;
   int                       msi_on;
   /** The core application is running in this mode. See octeon-drv-opcodes.h
       for values. */
   int                       app_mode;
#ifdef CVMCS_DMA_IC
   /* When DMA interrupt raised we have these many packets DMAed by Octeon */
   cavium_atomic_t          dma_cnt_to_process;
#endif
#ifdef USE_DDOQ_THREADS
   cvm_ddoq_thread_t         ddoq_thread[CVM_MAX_DDOQ_THREADS]; //8&#x4E2A;&#x6216;16&#x4E2A;, &#x89C1;M
#endif
   /** The name given to this device. */
   char                      device_name[32];
};
</code></pre>
<h1 id="a&#x63CF;&#x8FF0;pcie&#x7A7A;&#x95F4;&#x7684;&#x7ED3;&#x6784;&#x4F53;"><a name="a&#x63CF;&#x8FF0;pcie&#x7A7A;&#x95F4;&#x7684;&#x7ED3;&#x6784;&#x4F53;" class="anchor-navigation-ex-anchor" href="#a&#x63CF;&#x8FF0;pcie&#x7A7A;&#x95F4;&#x7684;&#x7ED3;&#x6784;&#x4F53;"><i class="fa fa-link" aria-hidden="true"></i></a>3. A.&#x63CF;&#x8FF0;PCIE&#x7A7A;&#x95F4;&#x7684;&#x7ED3;&#x6784;&#x4F53;</h1>
<pre><code class="lang-c">/** PCI address space mapping information.
 *  Each of the 3 address spaces given by BAR0, BAR2 and BAR4 of
 *  Octeon gets mapped to different physical address spaces in
 *  the kernel. 
 */
typedef struct  {
  /** PCI address to which the BAR is mapped. */
   unsigned long   start;
  /** Length of this PCI address space. */
   unsigned long   len;
  /** Length that has been mapped to phys. address space. */
   unsigned long   mapped_len;
  /** The physical address to which the PCI address space is mapped. */
   void           *hw_addr;
  /** Flag indicating the mapping was successful. */
   int             done;
}octeon_mmio;
</code></pre>
<h1 id="b&#x95F4;&#x63A5;&#x8BBF;&#x95EE;&#x5BC4;&#x5B58;&#x5668;-sliwin"><a name="b&#x95F4;&#x63A5;&#x8BBF;&#x95EE;&#x5BC4;&#x5B58;&#x5668;-sliwin" class="anchor-navigation-ex-anchor" href="#b&#x95F4;&#x63A5;&#x8BBF;&#x95EE;&#x5BC4;&#x5B58;&#x5668;-sliwin"><i class="fa fa-link" aria-hidden="true"></i></a>4. B.&#x95F4;&#x63A5;&#x8BBF;&#x95EE;&#x5BC4;&#x5B58;&#x5668;, SLI_WIN*</h1>
<pre><code>struct octeon_reg_list {

    uint32_t    *pci_win_wr_addr_hi;
    uint32_t    *pci_win_wr_addr_lo;
    uint64_t    *pci_win_wr_addr;

    uint32_t    *pci_win_rd_addr_hi;
    uint32_t    *pci_win_rd_addr_lo;
    uint64_t    *pci_win_rd_addr;

    uint32_t    *pci_win_wr_data_hi;
    uint32_t    *pci_win_wr_data_lo;
    uint64_t    *pci_win_wr_data;

    uint32_t    *pci_win_rd_data_hi;
    uint32_t    *pci_win_rd_data_lo;
    uint64_t    *pci_win_rd_data;
};
</code></pre><h1 id="c&#x7528;&#x6765;&#x9002;&#x914D;&#x4E0D;&#x540C;&#x7684;octeon&#x578B;&#x53F7;"><a name="c&#x7528;&#x6765;&#x9002;&#x914D;&#x4E0D;&#x540C;&#x7684;octeon&#x578B;&#x53F7;" class="anchor-navigation-ex-anchor" href="#c&#x7528;&#x6765;&#x9002;&#x914D;&#x4E0D;&#x540C;&#x7684;octeon&#x578B;&#x53F7;"><i class="fa fa-link" aria-hidden="true"></i></a>5. C.&#x7528;&#x6765;&#x9002;&#x914D;&#x4E0D;&#x540C;&#x7684;octeon&#x578B;&#x53F7;</h1>
<p>&#x6700;&#x57FA;&#x672C;&#x7684;&#x8BBE;&#x7F6E;&#x5BC4;&#x5B58;&#x5668;&#x7684;&#x63A5;&#x53E3;</p>
<pre><code class="lang-c">struct octeon_fn_list {

    void                (* setup_iq_regs)(struct _OCTEON_DEVICE *, int);
    void                (* setup_oq_regs)(struct _OCTEON_DEVICE *, int);

    cvm_intr_return_t   (* interrupt_handler)(void *);
    int                 (* soft_reset)(struct _OCTEON_DEVICE *);
    int                 (* setup_device_regs)(struct _OCTEON_DEVICE *);
    void                (* reinit_regs)(struct _OCTEON_DEVICE *);
    void                (* bar1_idx_setup)(struct _OCTEON_DEVICE *, uint64_t, int, int);
    void                (* bar1_idx_write)(struct _OCTEON_DEVICE *, int, uint32_t);
    uint32_t            (* bar1_idx_read)(struct _OCTEON_DEVICE *, int);
    uint32_t            (* update_iq_read_idx)(octeon_instr_queue_t  *);

    void                (* enable_oq_pkt_time_intr)(octeon_device_t *, int );
    void                (* disable_oq_pkt_time_intr)(octeon_device_t *, int );

    void                (* enable_interrupt)(void  *);
    void                (* disable_interrupt)(void  *);

    void                (* enable_io_queues)(struct _OCTEON_DEVICE  *);
    void                (* disable_io_queues)(struct _OCTEON_DEVICE  *);
};
</code></pre>
<h1 id="d&#x8868;&#x793A;&#x4E00;&#x4E2A;input-ring"><a name="d&#x8868;&#x793A;&#x4E00;&#x4E2A;input-ring" class="anchor-navigation-ex-anchor" href="#d&#x8868;&#x793A;&#x4E00;&#x4E2A;input-ring"><i class="fa fa-link" aria-hidden="true"></i></a>6. D.&#x8868;&#x793A;&#x4E00;&#x4E2A;input ring</h1>
<pre><code class="lang-c">/** The instruction (input) queue. 
    The input queue is used to post raw (instruction) mode data or packet
    data to Octeon device from the host. Each input queue (upto 4) for
    a Octeon device has one such structure to represent it.
*/
typedef struct   {
  /** A spinlock to protect access to the input ring.  */
   cavium_spinlock_t     lock;
  /** Flag that indicates if the queue uses 64 byte commands. */
  uint32_t               iqcmd_64B:1;
  /** Queue Number. */
  uint32_t               iq_no:5;
  uint32_t               rsvd:18;
  uint32_t               status:8;
  /** Maximum no. of instructions in this queue. */
   uint32_t              max_count;
#if !defined(DISABLE_PCIE14425_ERRATAFIX)
   /** Count of packets that were not sent due to backpressure.  */
   uint32_t              bp_hits;
#endif
  /** Index in input ring where the driver should write the next packet. */
   uint32_t              host_write_index;
  /** Index in input ring where Octeon is expected to read the next packet. */
   uint32_t              octeon_read_index;
  /** This index aids in finding the window in the queue where Octeon 
      has read the commands. */
   uint32_t              flush_index;
  /** This field keeps track of the instructions pending in this queue. */
   cavium_atomic_t       instr_pending;
   uint32_t              reset_instr_cnt;
  /** Pointer to the Virtual Base addr of the input ring. */
   uint8_t              *base_addr;
   octeon_noresponse_list_t    *nrlist; //int buftype, void * buf, &#x8868;&#x793A;NORESPONSE&#x7684;&#x8BF7;&#x6C42;&#x88AB;octeon&#x6267;&#x884C;&#x4E86;, &#x4F46;&#x9A71;&#x52A8;&#x8FD8;&#x6CA1;&#x6709;&#x628A;&#x8D44;&#x6E90;&#x91CA;&#x653E;&#x6389;
   struct oct_noresp_free_list nr_free; //octeon_noresponse_list_t *q, int put_idx, get_idx;&#x8868;&#x793A;&#x9700;&#x8981;free&#x7684;NORESPONSE list?
  /** Octeon doorbell register for the ring. */
   void                 *doorbell_reg;
  /** Octeon instruction count register for this ring. */
   void                 *inst_cnt_reg;
  /** Number of instructions pending to be posted to Octeon. */
   uint32_t              fill_cnt;
  /** The max. number of instructions that can be held pending by the driver. */
   uint32_t              fill_threshold;
  /** The last time that the doorbell was rung. The unit is OS-dependent. */
   unsigned long         last_db_time;
  /** The doorbell timeout. If the doorbell was not rung for this time and 
      fill_cnt is non-zero, ring the doorbell again. */
   unsigned long         db_timeout;
  /** Statistics for this input queue. */
  oct_iq_stats_t         stats;
  /** DMA mapped base address of the input descriptor ring. */
   unsigned long          base_addr_dma;
}  octeon_instr_queue_t;
</code></pre>
<h1 id="e&#x5BF9;&#x5E94;&#x4E3B;&#x7ED3;&#x6784;&#x4F53;&#x7684;plist&#x57DF;"><a name="e&#x5BF9;&#x5E94;&#x4E3B;&#x7ED3;&#x6784;&#x4F53;&#x7684;plist&#x57DF;" class="anchor-navigation-ex-anchor" href="#e&#x5BF9;&#x5E94;&#x4E3B;&#x7ED3;&#x6784;&#x4F53;&#x7684;plist&#x57DF;"><i class="fa fa-link" aria-hidden="true"></i></a>7. E.&#x5BF9;&#x5E94;&#x4E3B;&#x7ED3;&#x6784;&#x4F53;&#x7684;plist&#x57DF;</h1>
<p>pending list&#x662F;&#x7528;&#x6765;&#x5904;&#x7406;&#x9700;&#x8981;response&#x7684;request&#x7684;, &#x548C;output ring&#x6709;&#x5173;&#x5417;? --not only, but also input ring</p>
<pre><code class="lang-c">/** Pending list implementation for each Octeon device. */
typedef  struct  {
   /** Pending list for input instructions */
   octeon_pending_entry_t   *list; //&#x89C1;E1
   /** A list which indicates which entry in the pending_list above is free */
   uint32_t                 *free_list; //free_list&#x662F;&#x4E2A;&#x6570;&#x7EC4;, &#x6709;count&#x4E2A;uint32
   /** The next location in pending_free_list where an index into pending_list
      can be saved */
   uint32_t                  free_index;
   /** Number of pending list entries. */
   uint32_t                  entries;
   /** Count of pending instructions */
   cavium_atomic_t           instr_count;
   /** A lock to control access to the pending list */
   cavium_spinlock_t         lock; 
} octeon_pending_list_t;
</code></pre>
<h2 id="e1octeonpendingentryt"><a name="e1octeonpendingentryt" class="anchor-navigation-ex-anchor" href="#e1octeonpendingentryt"><i class="fa fa-link" aria-hidden="true"></i></a>7.1. E1.octeon_pending_entry_t</h2>
<pre><code class="lang-c">/** Structure of an entry in pending list.
 */
typedef struct  {
  /** Used to add/delete this entry to one of the 3 response lists. */
   cavium_list_t                    list; //&#x53CC;&#x5411;&#x94FE;&#x8868;
  /** Index in the input queue where this request was posted */
   uint16_t                         queue_index;
  /** Queue into which request was posted. */
   uint16_t                         iq_no;
  /** Index into pending_list that is returned to the user (for polling) */
   uint32_t                         request_id;
  /** Status of this entry */
   OCTEON_PENDING_ENTRY_STATUS      status; //&#x6709;4&#x79CD;&#x72B6;&#x6001;, FREE USED TIMEOUT REMOVE
  /** The instruction itself (not in the format that Octeon sees it)*/
   octeon_soft_instruction_t       *instr; //&#x89C1;E11, &#x975E;&#x5E38;&#x91CD;&#x8981;
}octeon_pending_entry_t;
</code></pre>
<h3 id="e11&#x8FD9;&#x4E2A;&#x5C31;&#x662F;&#x548C;&#x786C;&#x4EF6;&#x6700;&#x63A5;&#x8FD1;&#x7684;&#x7ED3;&#x6784;"><a name="e11&#x8FD9;&#x4E2A;&#x5C31;&#x662F;&#x548C;&#x786C;&#x4EF6;&#x6700;&#x63A5;&#x8FD1;&#x7684;&#x7ED3;&#x6784;" class="anchor-navigation-ex-anchor" href="#e11&#x8FD9;&#x4E2A;&#x5C31;&#x662F;&#x548C;&#x786C;&#x4EF6;&#x6700;&#x63A5;&#x8FD1;&#x7684;&#x7ED3;&#x6784;"><i class="fa fa-link" aria-hidden="true"></i></a>7.1.1. E11.&#x8FD9;&#x4E2A;&#x5C31;&#x662F;&#x548C;&#x786C;&#x4EF6;&#x6700;&#x63A5;&#x8FD1;&#x7684;&#x7ED3;&#x6784;?</h3>
<p>--no, &#x8FD8;&#x53EA;&#x662F;&#x4E2A;&#x5F00;&#x59CB;</p>
<pre><code class="lang-c">/** Format of a instruction presented to the driver. This structure has the
    values that get posted to Octeon in addition to other fields that are
    used by the driver to keep track of the instruction&apos;s progress.
*/
typedef struct {
    cavium_list_t                    list;
#define COMPLETION_WORD_INIT    0xffffffffffffffffULL
    /** Pointer to the completion status word */
    volatile uint64_t               *status_word;
    /** The timestamp (in ticks) till we wait for a response for this
        instruction. */
    unsigned long                    timeout;
    /**How the response for the instruction should be handled.*/
    octeon_request_info_t            req_info; //&#x89C1;E111
    /** Input data pointer. It is either pointing directly to input data
        or to a gather list which is a list of addresses where data is present. */
    void                            *dptr; //&#x53EF;&#x4EE5;&#x662F;&#x76F4;&#x63A5;&#x4E00;&#x4E2A;&#x6307;&#x9488;&#x5730;&#x5740;, &#x4E5F;&#x53EF;&#x4EE5;&#x662F;octeon_sg_entry_t &#x7684;&#x94FE;&#x8868;
    /** Response from Octeon comes at this address. It is either pointing to 
        output data buffer directly or to a scatter list which in turn points 
        to output data buffers. */
    void                            *rptr; //&#x53EF;&#x4EE5;&#x662F;soft_instr-&gt;rptr = SOFT_REQ_OUTBUF(soft_req, 0), &#x4E5F;&#x53EF;&#x4EE5;&#x662F;octeon_sg_entry_t &#x7684;&#x94FE;&#x8868;
    /** The instruction header. All input commands have this field. */
    octeon_instr_ih_t                ih; //&#x89C1;E112
    /** Input request header. */
    octeon_instr_irh_t               irh; //&#x89C1;E113
    /** The PCI instruction to be sent to Octeon. This is stored in the instr
        to retrieve the physical address of buffers when instr is freed. */
    octeon_instr_64B_t               command; //&#x89C1;E114, &#x91CD;&#x8981;! input ring &#x7684;64&#x5B57;&#x8282;&#x547D;&#x4EE4;&#x5B57;
    /** These headers are used to create a 64-byte instruction  */
    uint64_t                         exhdr[4];
    /** Information about the extra headers. */
    octeon_exhdr_info_t              exhdr_info; //&#x89C1;E115
    /** Flags to indicate memory allocated for this instruction. Used by driver
        when freeing the soft instruction.  */
    uint32_t                         alloc_flags;
    /** If a gather list was allocated, this ptr points to the buffer used for
        the gather list. The gather list has to be 8B aligned, so this value
        may be different from dptr.
    */
    void                            *gather_ptr;
    /** Total data bytes transferred in the gather mode request. */
    uint32_t                         gather_bytes;
    /** If a scatter list was allocated, this ptr points to the buffer used for
        the scatter list. The scatter list has to be 8B aligned, so this value
        may be different from rptr.
    */
    void                            *scatter_ptr;
    /** Total data bytes to be received in the scatter mode request. */
    uint32_t                         scatter_bytes;
}octeon_soft_instruction_t;
</code></pre>
<h4 id="e111octeonrequestinfot"><a name="e111octeonrequestinfot" class="anchor-navigation-ex-anchor" href="#e111octeonrequestinfot"><i class="fa fa-link" aria-hidden="true"></i></a>E111.octeon_request_info_t</h4>
<pre><code class="lang-c">/** Information about the request sent to driver by kernel mode applications. */
typedef struct  {
  /** The Octeon device to use for this request */
   uint32_t                  octeon_id;
  /** The request mask */
   octeon_request_mask_t     req_mask; //&#x4E00;&#x5171;32bit, resp_mode:2,dma_mode:2,resp_order:2,ignore_signal:2,iq_no:5,rsvd:19
  /** timeout for this request */
   uint32_t                  timeout;
  /** Status of this request */
   octeon_req_status_t       status; //&#x4E00;&#x4E2A;u32
  /** The request id assigned by driver to this request */
   uint32_t                  request_id;
  /** The callback function to call after request completion */
   instr_callback_t          callback; //&#x539F;&#x578B;&#x662F;void(* instr_callback_t)(octeon_req_status_t, void *); 
  /** Argument passed to callback */
   void                     *callback_arg;
} octeon_request_info_t;
</code></pre>
<h4 id="e112&#x5BF9;&#x5E94;&#x5230;&#x786C;&#x4EF6;&#x5BC4;&#x5B58;&#x5668;dpiinsthdr"><a name="e112&#x5BF9;&#x5E94;&#x5230;&#x786C;&#x4EF6;&#x5BC4;&#x5B58;&#x5668;dpiinsthdr" class="anchor-navigation-ex-anchor" href="#e112&#x5BF9;&#x5E94;&#x5230;&#x786C;&#x4EF6;&#x5BC4;&#x5B58;&#x5668;dpiinsthdr"><i class="fa fa-link" aria-hidden="true"></i></a>E112.&#x5BF9;&#x5E94;&#x5230;&#x786C;&#x4EF6;&#x5BC4;&#x5B58;&#x5668;DPI_INST_HDR</h4>
<p>&#x597D;&#x50CF;&#x662F;&#x5C0F;&#x7AEF;&#x6A21;&#x5F0F;</p>
<pre><code class="lang-c">typedef struct  {
  /** Tag Value */
  uint64_t     tag:32;
  /** Tag type */
  uint64_t     tagtype:2;
  /** Short Raw Packet Indicator 1=short raw pkt */
  uint64_t     rs:1;
  /** Core group selection (1 of 16) */
  uint64_t     grp:4;
  /** Packet Order / Work Unit selection (1 of 8)*/
  uint64_t     qos:3;
  /** Front Data size */
  uint64_t     fsz:6;
  /** Data length OR no. of entries in gather list */
  uint64_t     dlengsz:14;
  /** Gather indicator 1=gather*/
  uint64_t     gather:1;
  /** Raw mode indicator 1 = RAW */ 
  uint64_t     raw:1;
}octeon_instr_ih_t;
</code></pre>
<h4 id="e113input-request-header"><a name="e113input-request-header" class="anchor-navigation-ex-anchor" href="#e113input-request-header"><i class="fa fa-link" aria-hidden="true"></i></a>E113.Input Request Header</h4>
<pre><code class="lang-c">/** Input Request Header in LITTLE ENDIAN format */

typedef struct  {
  /** Request ID  */
  uint64_t     rid:16;
  /** PCIe port to use for response */
  uint64_t     pcie_port:3;
  /** Scatter indicator  1=scatter */
  uint64_t     scatter:1;
  /** Size of Expected result OR no. of entries in scatter list */
  uint64_t     rlenssz:14;
  /** Desired destination port for result */
  uint64_t     dport:6;
  /** Opcode Specific parameters */
  uint64_t     param:8;
  /** Opcode for the return packet  */
  uint64_t     opcode:16;
} octeon_instr_irh_t;
</code></pre>
<h4 id="e114&#x8FD9;&#x4E2A;&#x5C31;&#x662F;input-ring&#x7684;&#x4E00;&#x4E2A;instruction"><a name="e114&#x8FD9;&#x4E2A;&#x5C31;&#x662F;input-ring&#x7684;&#x4E00;&#x4E2A;instruction" class="anchor-navigation-ex-anchor" href="#e114&#x8FD9;&#x4E2A;&#x5C31;&#x662F;input-ring&#x7684;&#x4E00;&#x4E2A;instruction"><i class="fa fa-link" aria-hidden="true"></i></a>E114.&#x8FD9;&#x4E2A;&#x5C31;&#x662F;input ring&#x7684;&#x4E00;&#x4E2A;instruction</h4>
<pre><code class="lang-c">/** 64-byte instruction format.
    Format of instruction for a 64-byte mode input queue.
*/
typedef struct  {
  /** Pointer where the input data is available. */
  uint64_t             dptr;
  /** Instruction Header. */
  uint64_t             ih;
  /** Pointer where the response for a RAW mode packet will be written
      by Octeon. */
  uint64_t             rptr;
  /** Input Request Header. */
  uint64_t             irh;
  /** Additional headers available in a 64-byte instruction. */
  uint64_t             exhdr[4];
}octeon_instr_64B_t;
</code></pre>
<h4 id="e115extra-header"><a name="e115extra-header" class="anchor-navigation-ex-anchor" href="#e115extra-header"><i class="fa fa-link" aria-hidden="true"></i></a>E115.extra header</h4>
<pre><code class="lang-c">/** Information about each of the extra headers added for a 64-byte
    instruction. */
typedef struct {
   /** The number of 64-bit extra header words in this request. */
   uint64_t    exhdr_count:4;
   /** Use a value of type OCTEON_EXHDR_FMT */
   uint64_t    exhdr1_op:2;
   uint64_t    exhdr2_op:2;
   uint64_t    exhdr3_op:2;
   uint64_t    exhdr4_op:2;
   uint64_t    rsvd:52;
} octeon_exhdr_info_t;
</code></pre>
<h1 id="f&#x5934;&#x6307;&#x9488;-&#x8868;&#x793A;&#x4E00;&#x4E2A;response&#x94FE;&#x8868;"><a name="f&#x5934;&#x6307;&#x9488;-&#x8868;&#x793A;&#x4E00;&#x4E2A;response&#x94FE;&#x8868;" class="anchor-navigation-ex-anchor" href="#f&#x5934;&#x6307;&#x9488;-&#x8868;&#x793A;&#x4E00;&#x4E2A;response&#x94FE;&#x8868;"><i class="fa fa-link" aria-hidden="true"></i></a>8. F.&#x5934;&#x6307;&#x9488;, &#x8868;&#x793A;&#x4E00;&#x4E2A;response&#x94FE;&#x8868;</h1>
<pre><code class="lang-c">typedef struct {
  /** List structure to add delete pending entries to */
   cavium_list_t head;
  /** A lock for this response list */
   cavium_spinlock_t lock;
} octeon_response_list_t;
</code></pre>
<h1 id="g&#x8868;&#x793A;output-ring&#x63CF;&#x8FF0;&#x7B26;"><a name="g&#x8868;&#x793A;output-ring&#x63CF;&#x8FF0;&#x7B26;" class="anchor-navigation-ex-anchor" href="#g&#x8868;&#x793A;output-ring&#x63CF;&#x8FF0;&#x7B26;"><i class="fa fa-link" aria-hidden="true"></i></a>9. G.&#x8868;&#x793A;output ring&#x63CF;&#x8FF0;&#x7B26;</h1>
<pre><code class="lang-c">/** The Descriptor Ring Output Queue structure.
    This structure has all the information required to implement a 
    Octeon DROQ.
*/
typedef struct  {
  /** A spinlock to protect access to this ring. */
   cavium_spinlock_t        lock;
   uint32_t                 q_no;
   uint32_t                 fastpath_on;
   octeon_droq_ops_t        ops; //&#x89C1;G1
   octeon_device_t         *oct_dev; //&#x6307;&#x5411;&#x4E3B;&#x7ED3;&#x6784;&#x4F53;&#x7684;&#x6307;&#x9488;
#ifdef  USE_DROQ_THREADS
   cvm_kthread_t            thread; //&#x89C1;G2
   cavium_wait_channel      wc; //&#x5C31;&#x662F;wait_queue_head_t
   int                      stop_thread;
   cavium_atomic_t          thread_active;
#endif
  /** The 8B aligned descriptor ring starts at this address. */
   octeon_droq_desc_t      *desc_ring; //&#x89C1;G3, &#x8FD9;&#x4E2A;&#x624D;&#x662F;&#x786C;&#x4EF6;&#x5BC4;&#x5B58;&#x5668;
  /** Index in the ring where the driver should read the next packet */
   uint32_t                 host_read_index;
  /** Index in the ring where Octeon will write the next packet */
   uint32_t                 octeon_write_index;
  /** Index in the ring where the driver will refill the descriptor&apos;s buffer */
   uint32_t                 host_refill_index;
  /** Packets pending to be processed - tasklet implementation */
   cavium_atomic_t          pkts_pending;
  /** Number of  descriptors in this ring. */
   uint32_t                 max_count;
  /** The number of descriptors pending refill. */
   uint32_t                 refill_count;
   uint32_t                 pkts_per_intr;
   uint32_t                 refill_threshold;
  /** The max number of descriptors in DROQ without a buffer.
      This field is used to keep track of empty space threshold. If the
      refill_count reaches this value, the DROQ cannot accept a max-sized
      (64K) packet. */
   uint32_t                 max_empty_descs;
   /** The 8B aligned info ptrs begin from this address. */
   octeon_droq_info_t      *info_list; //&#x89C1;G4
  /** The receive buffer list. This list has the virtual addresses of the
      buffers.  */
   octeon_recv_buffer_t    *recv_buf_list; //&#x89C1;G5, &#x9A71;&#x52A8;&#x7528;&#x6765;&#x4FDD;&#x5B58;&#x865A;&#x62DF;buffer&#x5730;&#x5740;
  /** The size of each buffer pointed by the buffer pointer. */
   uint32_t                 buffer_size;
  /** Pointer to the mapped packet credit register.
       Host writes number of info/buffer ptrs available to this register */
   void                    *pkts_credit_reg;
  /** Pointer to the mapped packet sent register.
      Octeon writes the number of packets DMA&apos;ed to host memory
      in this register. */
   void                    *pkts_sent_reg;
#if  defined(ENABLE_PCIE_2G4G_FIX)
   void                    *buffer_block;
#endif
   cavium_list_t            dispatch_list; //&#x53CC;&#x5411;&#x94FE;&#x8868;
  /** Statistics for this DROQ. */
   oct_droq_stats_t         stats; //&#x89C1;G6
  /** DMA mapped address of the DROQ descriptor ring. */
   unsigned long            desc_ring_dma;
  /** Info ptr list are allocated at this virtual address. */
   unsigned long            info_base_addr;
  /** Allocated size of info list. */
   uint32_t                 info_alloc_size;
}octeon_droq_t;
</code></pre>
<h2 id="g1octeondroqopst"><a name="g1octeondroqopst" class="anchor-navigation-ex-anchor" href="#g1octeondroqopst"><i class="fa fa-link" aria-hidden="true"></i></a>9.1. G1.octeon_droq_ops_t</h2>
<pre><code class="lang-c">/** Used by NIC module to register packet handler and to get device
  * information for each octeon device.
  */
typedef struct {
    /** This registered function will be called by the driver with
        the octeon id, pointer to buffer from droq and length of 
        data in the buffer. The response header gives the port 
        number to the caller.  Function pointer is set by caller.  */
    void       (*fptr)(int, void *, uint32_t, octeon_resp_hdr_t *);
    /* This function will be called by the driver for all NAPI related
       events. The first param is the octeon id. The second param is the
       output queue number. The third is the NAPI event that occurred. */
    void       (*napi_fn)(int, int, int );
    int        poll_mode;
    /** Flag indicating if the DROQ handler should drop packets that
        it cannot handle in one iteration. Set by caller. */
    int        drop_on_max;
    uint16_t   op_mask;
    uint16_t   op_major;
} octeon_droq_ops_t;
</code></pre>
<h2 id="g2cvmkthreadt"><a name="g2cvmkthreadt" class="anchor-navigation-ex-anchor" href="#g2cvmkthreadt"><i class="fa fa-link" aria-hidden="true"></i></a>9.2. G2.cvm_kthread_t</h2>
<pre><code class="lang-c">typedef  struct {
#if LINUX_VERSION_CODE &lt; KERNEL_VERSION(2,6,18)
    cavium_pid_t      id; //&#x5C31;&#x662F;pid_t               
#else
    cavium_ostask_t  *id; //&#x5C31;&#x662F;struct task_struct
#endif
    int               (*fn)(void *);
    void              *fn_arg;
    char               fn_string[80];
    int                exec_on_create;
} cvm_kthread_t;
</code></pre>
<h2 id="g3&#x771F;&#x6B63;&#x7684;&#x7B26;&#x5408;&#x786C;&#x4EF6;&#x7684;&#x5B9A;&#x4E49;&#x7684;&#x7ED3;&#x6784;&#x4F53;"><a name="g3&#x771F;&#x6B63;&#x7684;&#x7B26;&#x5408;&#x786C;&#x4EF6;&#x7684;&#x5B9A;&#x4E49;&#x7684;&#x7ED3;&#x6784;&#x4F53;" class="anchor-navigation-ex-anchor" href="#g3&#x771F;&#x6B63;&#x7684;&#x7B26;&#x5408;&#x786C;&#x4EF6;&#x7684;&#x5B9A;&#x4E49;&#x7684;&#x7ED3;&#x6784;&#x4F53;"><i class="fa fa-link" aria-hidden="true"></i></a>9.3. G3.&#x771F;&#x6B63;&#x7684;&#x7B26;&#x5408;&#x786C;&#x4EF6;&#x7684;&#x5B9A;&#x4E49;&#x7684;&#x7ED3;&#x6784;&#x4F53;</h2>
<pre><code class="lang-c">/** Octeon descriptor format.
    The descriptor ring is made of descriptors which have 2 64-bit values:
    -# Physical (bus) address of the data buffer.
    -# Physical (bus) address of a octeon_droq_info_t structure.
    The Octeon device DMA&apos;s incoming packets and its information at the address
    given by these descriptor fields.
 */
typedef struct  {
  /** The buffer pointer */
   uint64_t        buffer_ptr;
  /** The Info pointer */
   uint64_t        info_ptr; //octeon_droq_info_t&#x7684;&#x5730;&#x5740;, &#x89C1;G4
}octeon_droq_desc_t;
</code></pre>
<h2 id="g4octeondroqinfot"><a name="g4octeondroqinfot" class="anchor-navigation-ex-anchor" href="#g4octeondroqinfot"><i class="fa fa-link" aria-hidden="true"></i></a>9.4. G4.octeon_droq_info_t</h2>
<pre><code class="lang-c">/** Information about packet DMA&apos;ed by Octeon.
    The format of the information available at Info Pointer after Octeon 
    has posted a packet. Not all descriptors have valid information. Only
    the Info field of the first descriptor for a packet has information
    about the packet. */
typedef struct {
  /** The Output Response Header. */
   octeon_resp_hdr_t    resp_hdr; //&#x89C1;G41
  /** The Length of the packet. */
   uint64_t             length;
}octeon_droq_info_t;
</code></pre>
<h3 id="g41octeonresphdrt"><a name="g41octeonresphdrt" class="anchor-navigation-ex-anchor" href="#g41octeonresphdrt"><i class="fa fa-link" aria-hidden="true"></i></a>9.4.1. G41.octeon_resp_hdr_t</h3>
<pre><code class="lang-c">/** Response Header in LITTLE ENDIAN format */
typedef struct {
  /** The request id for a packet thats in response to pkt sent by host. */
   uint64_t        request_id:16;
  /** Reserved. */
   uint64_t        reserved:4;
  /** The destination Queue port. */
   uint64_t        dest_qport:22;
  /** The source port for a packet thats in response to pkt sent by host. */
   uint64_t        src_port:6;
  /** Opcode for this packet. */
   uint64_t        opcode:16;
} octeon_resp_hdr_t;
</code></pre>
<h2 id="g5&#x9A71;&#x52A8;&#x7528;&#x8FD9;&#x4E2A;&#x6765;&#x8868;&#x793A;buffer-&#x7528;&#x7684;&#x662F;&#x865A;&#x62DF;&#x5730;&#x5740;"><a name="g5&#x9A71;&#x52A8;&#x7528;&#x8FD9;&#x4E2A;&#x6765;&#x8868;&#x793A;buffer-&#x7528;&#x7684;&#x662F;&#x865A;&#x62DF;&#x5730;&#x5740;" class="anchor-navigation-ex-anchor" href="#g5&#x9A71;&#x52A8;&#x7528;&#x8FD9;&#x4E2A;&#x6765;&#x8868;&#x793A;buffer-&#x7528;&#x7684;&#x662F;&#x865A;&#x62DF;&#x5730;&#x5740;"><i class="fa fa-link" aria-hidden="true"></i></a>9.5. G5.&#x9A71;&#x52A8;&#x7528;&#x8FD9;&#x4E2A;&#x6765;&#x8868;&#x793A;buffer, &#x7528;&#x7684;&#x662F;&#x865A;&#x62DF;&#x5730;&#x5740;</h2>
<pre><code class="lang-c">/** Pointer to data buffer.
    Driver keeps a pointer to the data buffer that it made available to 
    the Octeon device. Since the descriptor ring keeps physical (bus)
    addresses, this field is required for the driver to keep track of
    the virtual address pointers. The fields are operated by
    OS-dependent routines.
*/
typedef struct  {
  /** Pointer to the packet buffer. Hidden by void * to make it OS independent.
         */
     void        *buffer;
  /** Pointer to the data in the packet buffer.
      This could be different or same as the buffer pointer depending
      on the OS for which the code is compiled. */
     uint8_t        *data;
} octeon_recv_buffer_t;
</code></pre>
<h2 id="g6-octdroqstatst"><a name="g6-octdroqstatst" class="anchor-navigation-ex-anchor" href="#g6-octdroqstatst"><i class="fa fa-link" aria-hidden="true"></i></a>9.6. G6. oct_droq_stats_t</h2>
<pre><code class="lang-c">/** Output Queue statistics. Each output queue has four stats fields. */
typedef struct {
  uint64_t   pkts_received; /**&lt; Number of packets received in this queue. */
  uint64_t   bytes_received;/**&lt; Bytes received by this queue. */
  uint64_t   dropped_nodispatch; /**&lt; Packets dropped due to no dispatch function. */
  uint64_t   dropped_nomem; /**&lt; Packets dropped due to no memory available. */
  uint64_t   dropped_toomany; /**&lt; Packets dropped due to large number of pkts to process. */
} oct_droq_stats_t;
</code></pre>
<h1 id="h-octeondmaopst"><a name="h-octeondmaopst" class="anchor-navigation-ex-anchor" href="#h-octeondmaopst"><i class="fa fa-link" aria-hidden="true"></i></a>10. H. octeon_dma_ops_t</h1>
<pre><code class="lang-c">/** Used by CNTQ module to register DMA queue interrupt handler, tasklets
  * and statistics routines for each octeon device.
  */
typedef struct {
    /** Tasklet to be scheduled for CNTQ bottom half processing. */
    void      (*bh)(unsigned long);
    /** Interrupt Handler for DMA Queue interrupts. */
    int       (*intr_handler)(void  *, uint64_t);
    /** Read DMA Counter Queue and DDOQ list statistics into a structure */
    int       (* read_statsb)(int, oct_stats_t *);
    /** Format and print DMA Counter Queue and DDOQ list statistics into a buffer */
    int       (* read_stats)(int, char *);
} octeon_dma_ops_t;
</code></pre>
<h1 id="i-octeonrangetablet"><a name="i-octeonrangetablet" class="anchor-navigation-ex-anchor" href="#i-octeonrangetablet"><i class="fa fa-link" aria-hidden="true"></i></a>11. I. octeon_range_table_t</h1>
<pre><code class="lang-c">/** Map of Octeon core memory address to Octeon BAR1 indexed space. */
typedef  struct  {
  /** Starting Core address mapped */
  uint64_t      core_addr;
  /** Physical address (of the BAR1 mapped space) 
      corressponding to core_addr. */
  void       *mapped_addr;
  /** Indicator that the mapping is valid. */
  int         valid;
} octeon_range_table_t;
</code></pre>
<h1 id="j&#x6536;&#x5230;&#x62A5;&#x6587;&#x540E;&#x6309;opcode&#x5206;&#x53D1;"><a name="j&#x6536;&#x5230;&#x62A5;&#x6587;&#x540E;&#x6309;opcode&#x5206;&#x53D1;" class="anchor-navigation-ex-anchor" href="#j&#x6536;&#x5230;&#x62A5;&#x6587;&#x540E;&#x6309;opcode&#x5206;&#x53D1;"><i class="fa fa-link" aria-hidden="true"></i></a>12. J.&#x6536;&#x5230;&#x62A5;&#x6587;&#x540E;&#x6309;opcode&#x5206;&#x53D1;</h1>
<pre><code class="lang-c">/** The dispatch list entry.
 *  The driver keeps a record of functions registered for each 
 *  response header opcode in this structure. Since the opcode is
 *  hashed to index into the driver&apos;s list, more than one opcode
 *  can hash to the same entry, in which case the list field points
 *  to a linked list with the other entries.
 */
typedef struct {
  /** List head for this entry */
    cavium_list_t             list;
  /** The opcode for which the above dispatch function &amp; arg should be
      used */
    octeon_opcode_t           opcode;
  /** The function to be called for a packet received by the driver */
    octeon_dispatch_fn_t      dispatch_fn;
  /** The application specified argument to be passed to the above
      function along with the received packet */
    void                      *arg;
} octeon_dispatch_t;


/** The dispatch list structure. */
typedef struct {
    cavium_spinlock_t      lock;
    /** Count of dispatch functions currently registered */
    uint32_t               count;
    /** The list of dispatch functions */
    octeon_dispatch_t     *dlist;
} octeon_dispatch_list_t;
</code></pre>
<h1 id="k-buffer-pool"><a name="k-buffer-pool" class="anchor-navigation-ex-anchor" href="#k-buffer-pool"><i class="fa fa-link" aria-hidden="true"></i></a>13. K. buffer pool</h1>
<pre><code class="lang-c">/** Each buffer pool is represented by this structure.
 */
typedef struct {
  /** Lock for this pool. */
   cavium_spinlock_t buffer_lock;
  /** Number of chunks in this pool. */
   int chunks;
  /** Size of each chunk available for use after allocation. */
   int chunk_size;
  /** Actual size of each chunk. (includes size of buffer tag)*/
   int real_size;
   uint8_t *base;
  /** Address of each chunk. */
   uint8_t *address[MAX_BUFFER_CHUNKS];
  /** Address of usable space in chunk ( chunk - buffer tag) */
   uint8_t *address_trans[MAX_BUFFER_CHUNKS];
  /** Free list for this pool. */
   uint16_t free_list[MAX_BUFFER_CHUNKS];
  /** The next location in free list where a buffer is available. */
   int free_list_index;
  /** Start of head for this pool&apos;s fragment list.  */
   cavium_list_t frags_list;
} cavium_buffer_t;
</code></pre>
<h1 id="l-buffer-pool&#x7684;fragment"><a name="l-buffer-pool&#x7684;fragment" class="anchor-navigation-ex-anchor" href="#l-buffer-pool&#x7684;fragment"><i class="fa fa-link" aria-hidden="true"></i></a>14. L. buffer pool&#x7684;fragment</h1>
<pre><code class="lang-c">/** List to keep track of fragmented buffers in the buffer pool. */
typedef struct {
    cavium_list_t list;
    cavium_list_t alloc_list;
    uint8_t *big_buf;
    int frags_count;
    int index;
    OCTEON_BUFPOOL p;
    uint16_t free_list[MAX_FRAGMENTS];
    uint8_t *address[MAX_FRAGMENTS];
    int free_list_index;
    int not_allocated;
} cavium_frag_buf_t;
</code></pre>
<h1 id="museddoqthreads"><a name="museddoqthreads" class="anchor-navigation-ex-anchor" href="#museddoqthreads"><i class="fa fa-link" aria-hidden="true"></i></a>15. M.USE_DDOQ_THREADS</h1>
<pre><code class="lang-c">typedef struct cvm_ddoq_thread_info {
    int ddoq_id;
    int req_id;
    int num_pkts;
} octeon_ddoq_thread_info_t;

typedef struct cvm_ddoq_thread {
   octeon_device_t         *oct_dev; //&#x4E3B;&#x7ED3;&#x6784;&#x4F53;&#x7684;&#x6307;&#x9488;
   cvm_kthread_t         thread; //&#x89C1;G2
   cavium_wait_channel     wc; //&#x8FD8;&#x662F;wait_queue_head_t
   int                  stop_thread;
   cavium_atomic_t         thread_active;
   cavium_atomic_t      ddoq_pkts_queued;

   cavium_spinlock_t    th_lock;
   int                  th_read_idx;
   int                  th_write_idx;

   /* On each interrupt we can handle at most */
   octeon_ddoq_thread_info_t th_info[CVM_DDOQ_MAX_THREAD_PKTS];
} cvm_ddoq_thread_t;
</code></pre>
<h1 id="octeonmodulehandlert"><a name="octeonmodulehandlert" class="anchor-navigation-ex-anchor" href="#octeonmodulehandlert"><i class="fa fa-link" aria-hidden="true"></i></a>16. octeon_module_handler_t</h1>
<p>&#x5F53;octeon device&#x88AB;&#x521D;&#x59CB;&#x5316; &#x88AB;&#x590D;&#x4F4D; &#x88AB;&#x505C;&#x6B62;&#x65F6;&#x8C03;&#x7528;&#x7684;&#x9644;&#x52A0;&#x51FD;&#x6570;</p>
<pre><code class="lang-c">/** Structure passed by kernel application when registering a module with
    the driver. */
typedef struct {

    /* Application type for which handler is being registered. */
    uint32_t   app_type;

    /* Call this routine to perform add-on module related setup activities
       when a octeon device is being initialized.
     */
    int   (*startptr)(int, void *);

    /* Call this routine to perform add-on module related reset activities
       when a octeon device is being reset.
     */
    int   (*resetptr)(int, void *);

    /* Call this routine to perform add-on module related shutdown 
       activities when a octeon device is being removed or the driver is 
       being unloaded.
         */
    int   (*stopptr)(int, void *);

} octeon_module_handler_t;
</code></pre>
<h1 id="octeoncn6xxxt"><a name="octeoncn6xxxt" class="anchor-navigation-ex-anchor" href="#octeoncn6xxxt"><i class="fa fa-link" aria-hidden="true"></i></a>17. octeon_cn6xxx_t</h1>
<pre><code class="lang-c">/* Register address and configuration for a CN6XXX devices. */
/* If device specific changes need to be made then add a struct to include
   device specific fields as shown in the commented section */
typedef struct {

    /** PCI interrupt summary register */
    uint8_t            *intr_sum_reg64;

    /** PCI interrupt enable register */
    uint8_t            *intr_enb_reg64;

    /** The PCI interrupt mask used by interrupt handler */
    uint64_t            intr_mask64;

    cn6xxx_config_t    *conf; //&#x89C1;2A

    /* Example additional fields - not used currently
    struct {
    }cn6xyz;
    */

} octeon_cn6xxx_t;
</code></pre>
<h2 id="2acn6xxxconfigt"><a name="2acn6xxxconfigt" class="anchor-navigation-ex-anchor" href="#2acn6xxxconfigt"><i class="fa fa-link" aria-hidden="true"></i></a>17.1. 2A.cn6xxx_config_t</h2>
<pre><code class="lang-c">/** Structure to define the configuration for CN61XX,CN63XX,CN66XX &amp; CN68XX Octeon processors. */
typedef  struct {
    /** Common attributes. */
    octeon_common_config_t  c; //num_iqs num_oqs pending_list_size
    /** Input Queue attributes. */
    /*num_descs: &#x6BCF;&#x4E2A;ring&#x6709;&#x591A;&#x5C11;&#x4E2A;&#x547D;&#x4EE4;
    **instr_type: &#x662F;32bit&#x8FD8;&#x662F;64bit&#x683C;&#x5F0F;&#x7684;
    **db_min: &#x53D1;doorbell&#x4E4B;&#x524D;&#x9700;&#x8981;&#x51C6;&#x5907;&#x597D;&#x591A;&#x5C11;&#x4E2A;command
    **db_timeout: &#x5728;&#x67E5;&#x8BE2;pending&#x7684;command&#x4E4B;&#x524D;&#x7684;&#x8D85;&#x65F6;&#x65F6;&#x95F4;
    */
    octeon_iq_config_t      iq[CN6XXX_MAX_INPUT_QUEUES];

    /** Some of the Output Queue attributes. */
    /*num_descs: &#x6BCF;&#x4E2A;ring&#x591A;&#x5C11;&#x4E2A;&#x63CF;&#x8FF0;&#x7B26;
    **info_ptr: &#x9ED8;&#x8BA4;&#x662F;1, &#x8868;&#x793A;&#x4F7F;&#x7528;info&#x6307;&#x9488;&#x6A21;&#x5F0F;
    **buf_size: buffer&#x5927;&#x5C0F;
    **pkts_per_intr: &#x6BCF;&#x6B21;&#x8C03;&#x7528;driver&#x7684;tasklet&#x8981;&#x5904;&#x7406;&#x591A;&#x5C11;&#x4E2A;packets
    **refill_threshold: &#x5C0F;&#x4E8E;&#x6B64;&#x503C;, &#x9A71;&#x52A8;&#x9700;&#x8981;&#x5145;&#x586B;(replenish)
    */
    cn6xxx_oq_config_t      oq[CN6XXX_MAX_OUTPUT_QUEUES];
    /** Interrupt Coalescing (Packet Count). Octeon will interrupt the host
        only if it sent as many packets as specified by this field. The driver
        usually does not use packet count interrupt coalescing. 
        All output queues have the same packet count setting. */
    //&#x4E24;&#x79CD;&#x4E2D;&#x65AD;&#x673A;&#x5236;&#x4E4B;&#x4E00;, &#x65F6;&#x95F4;&#x95F4;&#x9694;
    uint32_t                oq_intr_pkt;
    /** Interrupt Coalescing (Time Interval). Octeon will interrupt the host
        if atleast one packet was sent in the time interval specified by this
        field. The driver uses time interval interrupt coalescing by default.
        The time is specified in microseconds.
        All output queues have the same time interval setting. */
    uint32_t                oq_intr_time;
#ifdef CVMCS_DMA_IC
    /** Interrupt Coalescing (Packet Count). Octeon will interrupt the host
        only if it DMAed as many packets as specified by this field. */
    //&#x4E24;&#x79CD;&#x4E2D;&#x65AD;&#x673A;&#x5236;&#x4E4B;&#x4E8C;, &#x5DF2;&#x7ECF;DMA&#x7684;&#x62A5;&#x6587;&#x6570;
    uint32_t                dma_intr_pkt;
    /** Interrupt Coalescing (Time Interval). Octeon will interrupt the host
        if atleast one packet was DMAed in the time interval specified by this
        field. */ 
    uint32_t                dma_intr_time;
#endif
} cn6xxx_config_t;
</code></pre>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="smartNIC_liquidIO_代码阅读api篇.html" class="navigation navigation-prev " aria-label="Previous page: PCI-NIC 代码阅读 --api篇">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="smartNIC_liquidIO_代码阅读driver篇.html" class="navigation navigation-next " aria-label="Next page: PCI-NIC 代码阅读 --driver篇">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"PCI-NIC 代码阅读 --driver篇之结构体","level":"1.15.8.3.3","depth":4,"next":{"title":"PCI-NIC 代码阅读 --driver篇","level":"1.15.8.3.4","depth":4,"path":"notes/smartNIC_liquidIO_代码阅读driver篇.md","ref":"notes/smartNIC_liquidIO_代码阅读driver篇.md","articles":[]},"previous":{"title":"PCI-NIC 代码阅读 --api篇","level":"1.15.8.3.2","depth":4,"path":"notes/smartNIC_liquidIO_代码阅读api篇.md","ref":"notes/smartNIC_liquidIO_代码阅读api篇.md","articles":[]},"dir":"ltr"},"config":{"plugins":["-sharing","-lunr","-search","search-plus","-highlight","theme-code","expandable-chapters-small","github","disqus","splitter","wide-page","hide-navigation-buttons","anchor-navigation-ex","sequence"],"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"pluginsConfig":{"disqus":{"useIdentifier":false,"shortName":"bai-yingjie-notes"},"sequence":{"theme":"simple"},"github":{"url":"https://github.com/Bai-Yingjie/Bai-Yingjie.github.io"},"splitter":{},"wide-page":{},"theme-code":{"showLevel":false,"styles":{"ebook":"styles/ebook.css","epub":"styles/epub.css","mobi":"styles/mobi.css","pdf":"styles/pdf.css","print":"styles/print.css","website":"styles/website.css"}},"fontsettings":{"theme":"white","family":"sans","size":2},"hide-navigation-buttons":{},"anchor-navigation-ex":{"mode":"float","pageTop":{"level1Icon":"","level2Icon":"","level3Icon":"","showLevelIcon":false},"isRewritePageTitle":true,"showLevel":true,"tocLevel1Icon":"fa fa-hand-o-right","tocLevel2Icon":"fa fa-hand-o-right","tocLevel3Icon":"fa fa-hand-o-right","showGoTop":true,"isShowTocTitleIcon":true,"printLog":false,"multipleH1":true,"associatedWithSummary":true,"float":{"floatIcon":"fa fa-navicon","level1Icon":"","level2Icon":"","level3Icon":"","showLevelIcon":false}},"expandable-chapters-small":{},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false},"search-plus":{}},"theme":"default","author":"Bai Yingjie","pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"variables":{},"title":"My Notes","language":"zh-hans","gitbook":"*"},"file":{"path":"notes/smartNIC_liquidIO_代码阅读driver篇之结构体.md","mtime":"2022-10-11T15:10:43.018Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2022-10-11T15:11:40.551Z"},"basePath":"..","book":{"language":""}});
        });
    </script>
</div>


        
    <script src="../gitbook/gitbook.js"></script>
    <script src="../gitbook/theme.js"></script>
    
        
        <script src="../gitbook/gitbook-plugin-search-plus/jquery.mark.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search-plus/search.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-expandable-chapters-small/expandable-chapters-small.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-github/plugin.js"></script>
        
    
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/URI.js/1.16.1/URI.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-disqus/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-splitter/splitter.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

        
    </body>
</html>

