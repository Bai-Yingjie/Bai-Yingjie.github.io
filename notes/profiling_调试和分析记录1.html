
<!DOCTYPE HTML>
<html lang="zh-hans" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>调试和分析记录1 · My Notes</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        <meta name="author" content="Bai Yingjie">
        
        
    
    
    <link rel="stylesheet" href="../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-search-plus/search.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-prism/prism.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-code/plugin.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-chapter-fold/chapter-fold.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-splitter/splitter.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-wide-page/wide.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-hide-navigation-buttons/index.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-anchor-navigation-ex/style/plugin.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-mermaid-gb3/mermaid/mermaid.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-theme-comscore/test.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    


    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="调试和分析工具概览.html" />
    
    
    <link rel="prev" href="profiling_调试和分析记录2.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="输入并搜索" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../">
            
                <a href="../">
            
                    
                    简介
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="as_title_kaiyuan.html">
            
                <a href="as_title_kaiyuan.html">
            
                    
                    开源
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1" data-path="my_opensource.html">
            
                <a href="my_opensource.html">
            
                    
                    我的开源项目
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2" data-path="my_upstream.html">
            
                <a href="my_upstream.html">
            
                    
                    我的upstream commit
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="as_title_system.html">
            
                <a href="as_title_system.html">
            
                    
                    系统分析和性能
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1" data-path="as_title_perf_misc.html">
            
                <a href="as_title_perf_misc.html">
            
                    
                    调试和分析记录系列
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1.1" data-path="profiling_调试和分析记录5.html">
            
                <a href="profiling_调试和分析记录5.html">
            
                    
                    调试和分析记录5
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.1.2" data-path="profiling_调试和分析记录4.html">
            
                <a href="profiling_调试和分析记录4.html">
            
                    
                    调试和分析记录4
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.1.3" data-path="profiling_调试和分析记录3.html">
            
                <a href="profiling_调试和分析记录3.html">
            
                    
                    调试和分析记录3
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.1.4" data-path="profiling_调试和分析记录2.html">
            
                <a href="profiling_调试和分析记录2.html">
            
                    
                    调试和分析记录2
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="1.3.1.5" data-path="profiling_调试和分析记录1.html">
            
                <a href="profiling_调试和分析记录1.html">
            
                    
                    调试和分析记录1
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3.2" data-path="调试和分析工具概览.html">
            
                <a href="调试和分析工具概览.html">
            
                    
                    profiling和debugging工具相关
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.2.1" data-path="profiling_Linux内核调试的方式以及工具集锦.html">
            
                <a href="profiling_Linux内核调试的方式以及工具集锦.html">
            
                    
                    Linux内核调试的方式以及工具集锦(网摘)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2.2" data-path="profiling_user_space_Ptrace_Utrace_Uprobes.html">
            
                <a href="profiling_user_space_Ptrace_Utrace_Uprobes.html">
            
                    
                    Ptrace, Utrace, Uprobes: Lightweight, Dynamic Tracing of User Apps
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2.3" data-path="debugging_gdb备忘录.html">
            
                <a href="debugging_gdb备忘录.html">
            
                    
                    gdb备忘录
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2.4" data-path="profiling_perf命令备忘录.html">
            
                <a href="profiling_perf命令备忘录.html">
            
                    
                    perf命令备忘录
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2.5" data-path="profiling_perf命令备忘录2.html">
            
                <a href="profiling_perf命令备忘录2.html">
            
                    
                    perf命令备忘录2
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2.6" data-path="profiling_perf学习笔记之实战篇.html">
            
                <a href="profiling_perf学习笔记之实战篇.html">
            
                    
                    perf学习笔记之实战篇
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2.7" data-path="profiling_perf学习笔记之入门篇.html">
            
                <a href="profiling_perf学习笔记之入门篇.html">
            
                    
                    perf学习笔记之入门篇
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2.8" data-path="profiling_ftrace和trace-cmd记录.html">
            
                <a href="profiling_ftrace和trace-cmd记录.html">
            
                    
                    ftrace和trace-cmd记录
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2.9" data-path="profiling_ftrace使用实例.html">
            
                <a href="profiling_ftrace使用实例.html">
            
                    
                    ftrace使用实例
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2.10" data-path="profiling_systemtap实例.html">
            
                <a href="profiling_systemtap实例.html">
            
                    
                    systemtap实例
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2.11" data-path="profiling_Comparing_SystemTap_and_bpftrace.html">
            
                <a href="profiling_Comparing_SystemTap_and_bpftrace.html">
            
                    
                    Comparing SystemTap and bpftrace(网摘)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2.12" data-path="system_analysis_bcc和ebpf.html">
            
                <a href="system_analysis_bcc和ebpf.html">
            
                    
                    bcc和ebpf(starting)
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3.3" data-path="as_title_os_perf.html">
            
                <a href="as_title_os_perf.html">
            
                    
                    profiling和debugging实例
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.3.1" data-path="performance_ovs进程调查.html">
            
                <a href="performance_ovs进程调查.html">
            
                    
                    OVS进程调查
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3.2" data-path="performance_ping流程和函数调用解析.html">
            
                <a href="performance_ping流程和函数调用解析.html">
            
                    
                    ping流程和函数调用解析
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3.3" data-path="profiling_VM互相ping场景下的延迟分析.html">
            
                <a href="profiling_VM互相ping场景下的延迟分析.html">
            
                    
                    VM互相ping场景下的延迟分析
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3.4" data-path="debugging_ftrace_谁创建了bond0设备.html">
            
                <a href="debugging_ftrace_谁创建了bond0设备.html">
            
                    
                    谁创建了bond0设备: ftrace kprobe uprobe perf综合使用
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3.5" data-path="profiling_unixbench之filecopy分析.html">
            
                <a href="profiling_unixbench之filecopy分析.html">
            
                    
                    unixbench之file copy分析
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3.4" data-path="as_title_arch_perf.html">
            
                <a href="as_title_arch_perf.html">
            
                    
                    CPU ARCH相关
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.4.1" data-path="performance_CPU_microarchiteture_pmu.html">
            
                <a href="performance_CPU_microarchiteture_pmu.html">
            
                    
                    Top-down Microarchitecture Analysis Method(网摘)
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="as_title_cloud.html">
            
                <a href="as_title_cloud.html">
            
                    
                    Cloud和容器相关
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1" data-path="cloud_杂记.html">
            
                <a href="cloud_杂记.html">
            
                    
                    云杂记
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2" data-path="container_当代容器读书笔记.html">
            
                <a href="container_当代容器读书笔记.html">
            
                    
                    当代容器读书笔记
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="as_title_vdevice.html">
            
                <a href="as_title_vdevice.html">
            
                    
                    CPU和device虚拟化
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.1" data-path="as_title_gvisor.html">
            
                <a href="as_title_gvisor.html">
            
                    
                    gvisor
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.1.1" data-path="golang_gvisor代码_KVM.html">
            
                <a href="golang_gvisor代码_KVM.html">
            
                    
                    gvisor KVM模式代码
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.1.2" data-path="golang_gvisor调试.html">
            
                <a href="golang_gvisor调试.html">
            
                    
                    gvisor调试
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.1.3" data-path="golang_gvisor_ptrace.html">
            
                <a href="golang_gvisor_ptrace.html">
            
                    
                    gvisor ptrace模式介绍(网摘)
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5.2" data-path="rust_vmm_brief.html">
            
                <a href="rust_vmm_brief.html">
            
                    
                    rust VMM(virtual machine monitor)
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.2.1" data-path="rust_vmm_简介.html">
            
                <a href="rust_vmm_简介.html">
            
                    
                    rust-vmm简介
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2.2" data-path="rust_firecracker_代码.html">
            
                <a href="rust_firecracker_代码.html">
            
                    
                    firecracker代码
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2.3" data-path="rust_firecracker_使用.html">
            
                <a href="rust_firecracker_使用.html">
            
                    
                    firecracker使用
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2.4" data-path="rust_cloud-hypervisor_代码.html">
            
                <a href="rust_cloud-hypervisor_代码.html">
            
                    
                    cloud hypervisor代码
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2.5" data-path="rust_cloud-hypervisor_使用.html">
            
                <a href="rust_cloud-hypervisor_使用.html">
            
                    
                    cloud hypervisor使用
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2.6" data-path="rust_cloud-hypervisor_问题与解决.html">
            
                <a href="rust_cloud-hypervisor_问题与解决.html">
            
                    
                    cloud hypervisor问题与解决
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5.3" data-path="virtualization_virtio规范阅读笔记.html">
            
                <a href="virtualization_virtio规范阅读笔记.html">
            
                    
                    virtio规范阅读笔记.md
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.4" data-path="qemu_ovs_虚拟化环境.html">
            
                <a href="qemu_ovs_虚拟化环境.html">
            
                    
                    qemu OVS 虚拟化环境准备
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.5" data-path="qemu使用.html">
            
                <a href="qemu使用.html">
            
                    
                    Qemu使用(old)
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.6" data-path="as_title_networking.html">
            
                <a href="as_title_networking.html">
            
                    
                    计算机网络相关
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.6.1" data-path="networking_杂记1.html">
            
                <a href="networking_杂记1.html">
            
                    
                    networking杂记1
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.2" data-path="as_title_qemu_ovs.html">
            
                <a href="as_title_qemu_ovs.html">
            
                    
                    Qemu OVS和DPDK
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.6.2.1" data-path="OVS_DPDK_编译运行.html">
            
                <a href="OVS_DPDK_编译运行.html">
            
                    
                    OVS-DPDK编译运行
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.2.2" data-path="OVS_架构和代码.html">
            
                <a href="OVS_架构和代码.html">
            
                    
                    OVS架构和代码
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.2.3" data-path="OVS_DPDK_performance_HXT_ARM_server.html">
            
                <a href="OVS_DPDK_performance_HXT_ARM_server.html">
            
                    
                    OVS-DPDK for ARM server 性能测试环境
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.2.4" data-path="DPDK_Mellanox.html">
            
                <a href="DPDK_Mellanox.html">
            
                    
                    DPDK Mellanox
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.2.5" data-path="OVS_phy-vm-phy.html">
            
                <a href="OVS_phy-vm-phy.html">
            
                    
                    OVS PHY-VM-PHY
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.2.6" data-path="networking_网络虚拟化用例记录.html">
            
                <a href="networking_网络虚拟化用例记录.html">
            
                    
                    网络虚拟化用例记录
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.2.7" data-path="networking_网络虚拟化操作记录.html">
            
                <a href="networking_网络虚拟化操作记录.html">
            
                    
                    网络虚拟化操作记录
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.6.3" data-path="as_title_virtnet.html">
            
                <a href="as_title_virtnet.html">
            
                    
                    虚拟化网络
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.6.3.1" data-path="networking_tc_filter_连接veth和tap.html">
            
                <a href="networking_tc_filter_连接veth和tap.html">
            
                    
                    Connecting a veth device to tap
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.3.2" data-path="networking_multicast_vxlan_flannel.html">
            
                <a href="networking_multicast_vxlan_flannel.html">
            
                    
                    multicast vxlan和flannel
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.3.3" data-path="networking_virtio网络介绍.html">
            
                <a href="networking_virtio网络介绍.html">
            
                    
                    virtio网络介绍(网摘): vhost-net virtio-net vhost-user SRIOV
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.3.4" data-path="networking_virtualization_杂记.html">
            
                <a href="networking_virtualization_杂记.html">
            
                    
                    虚拟化网络杂记
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.3.5" data-path="networking_linux虚拟网络接口.html">
            
                <a href="networking_linux虚拟网络接口.html">
            
                    
                    linux虚拟网络接口(网摘)
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.7" data-path="as_title_arm_server.html">
            
                <a href="as_title_arm_server.html">
            
                    
                    ARM server
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.7.1" data-path="arm_server_杂记.html">
            
                <a href="arm_server_杂记.html">
            
                    
                    Arm server 杂记
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.8" data-path="as_title_embedded.html">
            
                <a href="as_title_embedded.html">
            
                    
                    嵌入式系统开发调试
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.8.1" data-path="embedded_debugging.html">
            
                <a href="embedded_debugging.html">
            
                    
                    嵌入式调试杂记
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.2" data-path="uboot_杂记.html">
            
                <a href="uboot_杂记.html">
            
                    
                    uboot杂记
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.3" data-path="buildroot_杂记.html">
            
                <a href="buildroot_杂记.html">
            
                    
                    buildroot杂记
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.4" data-path="toolchain_升级gcc问题解决.html">
            
                <a href="toolchain_升级gcc问题解决.html">
            
                    
                    升级GCC7.3问题解决
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.5" data-path="kernel_异常打印分析实例.html">
            
                <a href="kernel_异常打印分析实例.html">
            
                    
                    kernel bug异常打印分析
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.9" data-path="as_title_linuxdaily.html">
            
                <a href="as_title_linuxdaily.html">
            
                    
                    Linux工程实践
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.9.1" data-path="linux_日常使用.html">
            
                <a href="linux_日常使用.html">
            
                    
                    日常linux使用
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.2" data-path="git_日常使用.html">
            
                <a href="git_日常使用.html">
            
                    
                    日常git使用
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.3" data-path="向kernel提交补丁.html">
            
                <a href="向kernel提交补丁.html">
            
                    
                    向kernel提交补丁
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.4" data-path="linux_ssh_relay.html">
            
                <a href="linux_ssh_relay.html">
            
                    
                    ssh relay
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.5" data-path="gitlab_ci.html">
            
                <a href="gitlab_ci.html">
            
                    
                    gitlab CI
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.6" data-path="docker_操作记录.html">
            
                <a href="docker_操作记录.html">
            
                    
                    docker操作记录
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.7" data-path="centos_操作记录.html">
            
                <a href="centos_操作记录.html">
            
                    
                    centos操作记录
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.10" data-path="as_title_golang.html">
            
                <a href="as_title_golang.html">
            
                    
                    Golang
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.10.1" data-path="as_title_golang1.html">
            
                <a href="as_title_golang1.html">
            
                    
                    入门
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.10.1.1" data-path="golang_语法基础.html">
            
                <a href="golang_语法基础.html">
            
                    
                    Golang 语法基础
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.1.2" data-path="golang_json性能.html">
            
                <a href="golang_json性能.html">
            
                    
                    Golang json性能比较
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.10.2" data-path="golang_原理.html">
            
                <a href="golang_原理.html">
            
                    
                    Golang 原理相关
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.10.2.1" data-path="golang_interface原理.html">
            
                <a href="golang_interface原理.html">
            
                    
                    Golang interface原理(网摘)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.2.2" data-path="golang_内存分配.html">
            
                <a href="golang_内存分配.html">
            
                    
                    Golang 内存分配(网摘)
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.10.3" data-path="golang_标准库.html">
            
                <a href="golang_标准库.html">
            
                    
                    Golang 标准库
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.4" data-path="golang_我的反射代码.html">
            
                <a href="golang_我的反射代码.html">
            
                    
                    Golang 我的反射代码
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.5" data-path="golang_问答.html">
            
                <a href="golang_问答.html">
            
                    
                    Golang 问答
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.6" data-path="golang_高效go.html">
            
                <a href="golang_高效go.html">
            
                    
                    Golang 高效go
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.7" data-path="golang_进阶.html">
            
                <a href="golang_进阶.html">
            
                    
                    Golang 进阶
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.8" data-path="as_title_golang2.html">
            
                <a href="as_title_golang2.html">
            
                    
                    Golang 杂记
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.10.8.1" data-path="golang_杂记1.html">
            
                <a href="golang_杂记1.html">
            
                    
                    Golang 杂记1
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.8.2" data-path="golang_杂记2.html">
            
                <a href="golang_杂记2.html">
            
                    
                    Golang 杂记2
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.8.3" data-path="golang_杂记3.html">
            
                <a href="golang_杂记3.html">
            
                    
                    Golang 杂记3
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.8.4" data-path="golang_lib选型.html">
            
                <a href="golang_lib选型.html">
            
                    
                    Golang lib选型
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.8.5" data-path="golang_mod_proxy.html">
            
                <a href="golang_mod_proxy.html">
            
                    
                    go mod和go proxy
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.8.6" data-path="golang_汇编_arm64.html">
            
                <a href="golang_汇编_arm64.html">
            
                    
                    Golang 汇编语法和arm64小知识
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.8.7" data-path="golang_cgo_swig.html">
            
                <a href="golang_cgo_swig.html">
            
                    
                    go调用c可以用swig
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.10.9" data-path="as_title_golang3.html">
            
                <a href="as_title_golang3.html">
            
                    
                    Golang 环境和工具链生成
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.10.9.1" data-path="golang_toolchain_ppc.html">
            
                <a href="golang_toolchain_ppc.html">
            
                    
                    go tools增加ppc32支持.md
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.9.2" data-path="golang_toolchain_compile_gccgo.html">
            
                <a href="golang_toolchain_compile_gccgo.html">
            
                    
                    编译gccgo
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.9.3" data-path="golang_go_on_mips.html">
            
                <a href="golang_go_on_mips.html">
            
                    
                    go on mips boards(not so updated)
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.10.9.3.1" data-path="golang_go_on_mips_part1.html">
            
                <a href="golang_go_on_mips_part1.html">
            
                    
                    part 1: cross compile go
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.9.3.2" data-path="golang_go_on_mips_part2.html">
            
                <a href="golang_go_on_mips_part2.html">
            
                    
                    part 2: build native go compiler
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.9.3.3" data-path="golang_go_on_mips_part3.html">
            
                <a href="golang_go_on_mips_part3.html">
            
                    
                    part 3: gccgo experiments
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.9.3.4" data-path="golang_go_on_mips_part4.html">
            
                <a href="golang_go_on_mips_part4.html">
            
                    
                    part 4: Golang json performance
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.9.3.5" data-path="golang_gentoo_on_mips_board_and_build_go.html">
            
                <a href="golang_gentoo_on_mips_board_and_build_go.html">
            
                    
                    Gentoo on mips board and build go
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.10.10" data-path="as_title_golang4.html">
            
                <a href="as_title_golang4.html">
            
                    
                    微服务
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.10.10.1" data-path="golang_micro.html">
            
                <a href="golang_micro.html">
            
                    
                    go-micro和micro
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.10.2" data-path="golang_微服务概念.html">
            
                <a href="golang_微服务概念.html">
            
                    
                    微服务概念
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.10.11" data-path="as_title_golang5.html">
            
                <a href="as_title_golang5.html">
            
                    
                    解释器和编解码
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.10.11.1" data-path="golang_yeagi.html">
            
                <a href="golang_yeagi.html">
            
                    
                    解释器yeagi
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.11.2" data-path="golang_tengo.html">
            
                <a href="golang_tengo.html">
            
                    
                    解释器tengo
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.11.3" data-path="golang_govaluate.html">
            
                <a href="golang_govaluate.html">
            
                    
                    解释器govaluate
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.11.4" data-path="golang_encoding_gotiny.html">
            
                <a href="golang_encoding_gotiny.html">
            
                    
                    gotiny编解码
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.11.5" data-path="golang_abs.html">
            
                <a href="golang_abs.html">
            
                    
                    解释器abs
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.10.12" data-path="as_title_golang6.html">
            
                <a href="as_title_golang6.html">
            
                    
                    调试和性能
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.10.12.1" data-path="golang_调试记录.html">
            
                <a href="golang_调试记录.html">
            
                    
                    Golang 调试记录
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.12.2" data-path="golang_topid性能优化.html">
            
                <a href="golang_topid性能优化.html">
            
                    
                    Golang topid性能优化
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.12.3" data-path="golang_gshell性能调试.html">
            
                <a href="golang_gshell性能调试.html">
            
                    
                    Golang gshell性能调试
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.10.13" data-path="as_title_golang7.html">
            
                <a href="as_title_golang7.html">
            
                    
                    网络和消息中间件
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.10.13.1" data-path="golang_zmq.html">
            
                <a href="golang_zmq.html">
            
                    
                    消息中间件基本概念和zero mq
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.13.2" data-path="golang_mango.html">
            
                <a href="golang_mango.html">
            
                    
                    消息中间件mango
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.13.3" data-path="golang_libp2p.html">
            
                <a href="golang_libp2p.html">
            
                    
                    Golang p2p网络
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.11" data-path="as_title_rust.html">
            
                <a href="as_title_rust.html">
            
                    
                    Rust
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.11.1" data-path="rust_入门_brief.html">
            
                <a href="rust_入门_brief.html">
            
                    
                    Rust 入门系列
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.11.1.1" data-path="rust_books.html">
            
                <a href="rust_books.html">
            
                    
                    Rust reference books
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11.1.2" data-path="rust_入门1.html">
            
                <a href="rust_入门1.html">
            
                    
                    Rust 安装和基础语法
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11.1.3" data-path="rust_入门2.html">
            
                <a href="rust_入门2.html">
            
                    
                    Rust 泛型和内存所有权
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11.1.4" data-path="rust_入门3.html">
            
                <a href="rust_入门3.html">
            
                    
                    Rust 闭包 容器 迭代器 生成器 线程
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11.1.5" data-path="rust_工程构建.html">
            
                <a href="rust_工程构建.html">
            
                    
                    Rust 工程构建
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.11.2" data-path="rust_coding_brief.html">
            
                <a href="rust_coding_brief.html">
            
                    
                    Rust 代码积累
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.11.2.1" data-path="rust_序列化.html">
            
                <a href="rust_序列化.html">
            
                    
                    Rust 序列化原理
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11.2.2" data-path="rust_知识点积累.html">
            
                <a href="rust_知识点积累.html">
            
                    
                    Rust 知识点更新
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11.2.3" data-path="rust_adaptiveservice.html">
            
                <a href="rust_adaptiveservice.html">
            
                    
                    rust版本的adaptiveservice探索
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11.2.4" data-path="rust_常用设施.html">
            
                <a href="rust_常用设施.html">
            
                    
                    Rust 常用设施
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11.2.5" data-path="rust_代码小段.html">
            
                <a href="rust_代码小段.html">
            
                    
                    Rust 代码小段
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.11.3" data-path="others.html">
            
                <a href="others.html">
            
                    
                    其他
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.11.3.1" data-path="rust_mdbook_使用.html">
            
                <a href="rust_mdbook_使用.html">
            
                    
                    Rust 使用mdbook
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.12" data-path="as_title_scripts.html">
            
                <a href="as_title_scripts.html">
            
                    
                    脚本
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.12.1" data-path="shell_变量.html">
            
                <a href="shell_变量.html">
            
                    
                    shell变量
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.2" data-path="shell_基础篇.html">
            
                <a href="shell_基础篇.html">
            
                    
                    shell命令和脚本记录-基础篇
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.3" data-path="shell_高级篇.html">
            
                <a href="shell_高级篇.html">
            
                    
                    shell命令和脚本记录-高级篇
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.4" data-path="shell_脚本片段.html">
            
                <a href="shell_脚本片段.html">
            
                    
                    shell脚本片段
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.5" data-path="python_记录.html">
            
                <a href="python_记录.html">
            
                    
                    python记录
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.6" data-path="lua_记录.html">
            
                <a href="lua_记录.html">
            
                    
                    lua记录
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.7" data-path="shell_rds脚本阅读.html">
            
                <a href="shell_rds脚本阅读.html">
            
                    
                    RDS脚本阅读
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.8" data-path="Project_Euler.html">
            
                <a href="Project_Euler.html">
            
                    
                    Project Euler
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.13" data-path="as_title_app.html">
            
                <a href="as_title_app.html">
            
                    
                    应用相关
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.13.1" data-path="app_sysbench代码分析.html">
            
                <a href="app_sysbench代码分析.html">
            
                    
                    sysbench代码分析
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.14" data-path="as_title_cos.html">
            
                <a href="as_title_cos.html">
            
                    
                    C和Operating System
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.14.1" data-path="system_libc_part1.html">
            
                <a href="system_libc_part1.html">
            
                    
                    libc概览1
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.14.2" data-path="system_libc_part2.html">
            
                <a href="system_libc_part2.html">
            
                    
                    libc概览2
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.14.3" data-path="system_libc_part3.html">
            
                <a href="system_libc_part3.html">
            
                    
                    libc概览3
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.14.4" data-path="system_原理杂记.html">
            
                <a href="system_原理杂记.html">
            
                    
                    系统原理杂记
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.14.5" data-path="system_alpine.html">
            
                <a href="system_alpine.html">
            
                    
                    Alpine Linux
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.14.6" data-path="system_进程间通信.html">
            
                <a href="system_进程间通信.html">
            
                    
                    进程间通信
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.14.7" data-path="system_特殊功能fd.html">
            
                <a href="system_特殊功能fd.html">
            
                    
                    eventfd timerfd signalfd和fd共享
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.14.8" data-path="c_automake_autoconf.html">
            
                <a href="c_automake_autoconf.html">
            
                    
                    automake autoconf
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.14.9" data-path="makefile_原理和实践.html">
            
                <a href="makefile_原理和实践.html">
            
                    
                    makefile
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.14.10" data-path="c_编程杂记高级篇.html">
            
                <a href="c_编程杂记高级篇.html">
            
                    
                    C编程杂记高级篇
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.14.11" data-path="c_编程杂记基础篇.html">
            
                <a href="c_编程杂记基础篇.html">
            
                    
                    C编程杂记基础篇
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.14.12" data-path="c_networking_socket高阶用法.html">
            
                <a href="c_networking_socket高阶用法.html">
            
                    
                    网络编程: Advanced Socket Topics(网摘)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.14.13" data-path="c_protobuf介绍.html">
            
                <a href="c_protobuf介绍.html">
            
                    
                    序列化: protobuf介绍
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.14.14" data-path="c_进程间通信_共享文件和共享内存.html">
            
                <a href="c_进程间通信_共享文件和共享内存.html">
            
                    
                    进程间通信: 共享文件和共享内存(网摘)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.14.15" data-path="c_pthread_condition和mutex.html">
            
                <a href="c_pthread_condition和mutex.html">
            
                    
                    并发 任务 事件 和锁.md
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.14.16" data-path="kernel_user_space_howto.html">
            
                <a href="kernel_user_space_howto.html">
            
                    
                    kernel space和user space交互(网摘, linux2.6)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.14.17" data-path="CentOS_系统性能优化配置.html">
            
                <a href="CentOS_系统性能优化配置.html">
            
                    
                    CentOS 性能优化系统配置
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.15" data-path="as_title_driver.html">
            
                <a href="as_title_driver.html">
            
                    
                    内核 设备和驱动相关
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.15.1" data-path="platform_device_driver.html">
            
                <a href="platform_device_driver.html">
            
                    
                    平台驱动杂记
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.15.2" data-path="device_driver_杂记.html">
            
                <a href="device_driver_杂记.html">
            
                    
                    驱动调试杂记
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.15.3" data-path="device_localbus_16bit读写.html">
            
                <a href="device_localbus_16bit读写.html">
            
                    
                    CPLD做8bit到16bit转换
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.15.4" data-path="as_title_driver1.html">
            
                <a href="as_title_driver1.html">
            
                    
                    nand
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.15.4.1" data-path="device_driver_octeon_nand.html">
            
                <a href="device_driver_octeon_nand.html">
            
                    
                    octeon nand flash驱动
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.15.4.2" data-path="device_driver_nand概率写失败问题分析.html">
            
                <a href="device_driver_nand概率写失败问题分析.html">
            
                    
                    Nand flash概率写失败问题分析
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.15.5" data-path="octeon_remote_pci.html">
            
                <a href="octeon_remote_pci.html">
            
                    
                    octeon remote-pci.c阅读
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.15.6" data-path="Device_VFIO_notes.html">
            
                <a href="Device_VFIO_notes.html">
            
                    
                    VFIO简介
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.15.7" data-path="as_title_driver2.html">
            
                <a href="as_title_driver2.html">
            
                    
                    智能网卡和DPDK
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.15.7.1" data-path="smartNIC_智能网卡对比.html">
            
                <a href="smartNIC_智能网卡对比.html">
            
                    
                    智能网卡对比
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.15.7.2" data-path="octeon_pci_NIC.html">
            
                <a href="octeon_pci_NIC.html">
            
                    
                    octeon PCI NIC
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.15.7.3" data-path="as_title_driver3.html">
            
                <a href="as_title_driver3.html">
            
                    
                    octeon liquidIO
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.15.7.3.1" data-path="smartNIC_liquidIO_代码阅读app篇.html">
            
                <a href="smartNIC_liquidIO_代码阅读app篇.html">
            
                    
                    PCI-NIC 代码阅读 --app篇
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.15.7.3.2" data-path="smartNIC_liquidIO_代码阅读api篇.html">
            
                <a href="smartNIC_liquidIO_代码阅读api篇.html">
            
                    
                    PCI-NIC 代码阅读 --api篇
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.15.7.3.3" data-path="smartNIC_liquidIO_代码阅读driver篇之结构体.html">
            
                <a href="smartNIC_liquidIO_代码阅读driver篇之结构体.html">
            
                    
                    PCI-NIC 代码阅读 --driver篇之结构体
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.15.7.3.4" data-path="smartNIC_liquidIO_代码阅读driver篇.html">
            
                <a href="smartNIC_liquidIO_代码阅读driver篇.html">
            
                    
                    PCI-NIC 代码阅读 --driver篇
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.15.7.3.5" data-path="smartNIC_liquidIO_代码阅读真NIC篇.html">
            
                <a href="smartNIC_liquidIO_代码阅读真NIC篇.html">
            
                    
                    PCI-NIC 代码阅读 --真NIC篇
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.15.7.4" data-path="networking_dpdk使用_2014.html">
            
                <a href="networking_dpdk使用_2014.html">
            
                    
                    DPDK使用(2014)
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.15.8" data-path="device_nvme要点介绍.html">
            
                <a href="device_nvme要点介绍.html">
            
                    
                    nvme要点介绍
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.16" data-path="as_title_cpu.html">
            
                <a href="as_title_cpu.html">
            
                    
                    CPU Arch相关
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.16.1" data-path="cache_CPU和cache一致性原理.html">
            
                <a href="cache_CPU和cache一致性原理.html">
            
                    
                    CPU和cache一致性原理
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.16.2" data-path="as_title_cpu1.html">
            
                <a href="as_title_cpu1.html">
            
                    
                    ARM64
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.16.2.1" data-path="CPU_ARM64_thunder_overview.html">
            
                <a href="CPU_ARM64_thunder_overview.html">
            
                    
                    thunder 概览
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.16.2.2" data-path="CPU_ARM64_thunder_开发板操作记录.html">
            
                <a href="CPU_ARM64_thunder_开发板操作记录.html">
            
                    
                    thunder 开发板操作记录
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.16.2.3" data-path="CPU_ARM64_thunder_bdk.html">
            
                <a href="CPU_ARM64_thunder_bdk.html">
            
                    
                    thunder BDK
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.16.2.4" data-path="CPU_ARM64_thunder_efi_rtc.html">
            
                <a href="CPU_ARM64_thunder_efi_rtc.html">
            
                    
                    thunder RTC时间和efi
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.16.2.5" data-path="CPU_ARM64_thunder_uefi_fdt.html">
            
                <a href="CPU_ARM64_thunder_uefi_fdt.html">
            
                    
                    thunder uefi和fdt
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.16.2.6" data-path="CPU_ARM64_thunder_atf.html">
            
                <a href="CPU_ARM64_thunder_atf.html">
            
                    
                    thunder atf
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.16.2.7" data-path="CPU_ARM64_thunder_kernel_boot.html">
            
                <a href="CPU_ARM64_thunder_kernel_boot.html">
            
                    
                    thunder kernel启动打印流程
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.16.3" data-path="as_title_cpu2.html">
            
                <a href="as_title_cpu2.html">
            
                    
                    PPC
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.16.3.1" data-path="CPU_PPC启动多核Linux_流程和内存映射.html">
            
                <a href="CPU_PPC启动多核Linux_流程和内存映射.html">
            
                    
                    PPC启动多核linux: 流程和内存映射
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.16.3.2" data-path="CPU_PPC_kernel升级记录.html">
            
                <a href="CPU_PPC_kernel升级记录.html">
            
                    
                    PPC kernel升级记录
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.16.4" data-path="as_title_cpu3.html">
            
                <a href="as_title_cpu3.html">
            
                    
                    MIPS
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.16.4.1" data-path="CPU_MIPS_octeon地址空间和寄存器访问.html">
            
                <a href="CPU_MIPS_octeon地址空间和寄存器访问.html">
            
                    
                    octeon 地址空间和寄存器访问
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.16.4.2" data-path="CPU_MIPS_octeon操作记录.html">
            
                <a href="CPU_MIPS_octeon操作记录.html">
            
                    
                    octeon 操作记录
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.16.4.3" data-path="CPU_MIPS_octeon_包处理性能.html">
            
                <a href="CPU_MIPS_octeon_包处理性能.html">
            
                    
                    octeon 系列处理器包处理性能
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.16.4.4" data-path="CPU_MIPS_octeon_ddr调试记录.html">
            
                <a href="CPU_MIPS_octeon_ddr调试记录.html">
            
                    
                    octeon DDR调试
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.16.4.5" data-path="CPU_MIPS_octeon_BDK.html">
            
                <a href="CPU_MIPS_octeon_BDK.html">
            
                    
                    octeon CN78xx BDK
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.16.4.6" data-path="kernel_增加ECC中断.html">
            
                <a href="kernel_增加ECC中断.html">
            
                    
                    octeon 增加ECC中断
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.16.4.7" data-path="CPU_MIPS_octeon_hw-ddr2代码走读.html">
            
                <a href="CPU_MIPS_octeon_hw-ddr2代码走读.html">
            
                    
                    octeon hw-ddr2代码走读
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.16.4.8" data-path="CPU_MIPS_octeon_reboot调试和ddr中断.html">
            
                <a href="CPU_MIPS_octeon_reboot调试和ddr中断.html">
            
                    
                    octeon reboot调试和DDR中断
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.16.4.9" data-path="CPU_MIPS_octeon中断.html">
            
                <a href="CPU_MIPS_octeon中断.html">
            
                    
                    octeon 中断
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.16.4.10" data-path="CPU_MIPS_octeon原子操作.html">
            
                <a href="CPU_MIPS_octeon原子操作.html">
            
                    
                    octeon 原子操作
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.16.4.11" data-path="CPU_MIPS_octeon网口代码分析.html">
            
                <a href="CPU_MIPS_octeon网口代码分析.html">
            
                    
                    octeon 网口代码分析
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            本书使用 GitBook 发布
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".." >调试和分析记录1</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div class="search-plus" id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <div id="anchor-navigation-ex-navbar"><i class="fa fa-navicon"></i><ul><li><span class="title-icon "></span><a href="#&#x8C03;&#x8BD5;usb&#x9519;&#x8BEF;"><b>1. </b>&#x8C03;&#x8BD5;usb&#x9519;&#x8BEF;</a></li><li><span class="title-icon "></span><a href="#&#x53CD;&#x5411;&#x5DE5;&#x7A0B;anbox&#x7684;abs&#x547D;&#x4EE4;"><b>2. </b>&#x53CD;&#x5411;&#x5DE5;&#x7A0B;Anbox&#x7684;abs&#x547D;&#x4EE4;</a></li><ul><li><span class="title-icon "></span><a href="#&#x542F;&#x52A8;gdb"><b>2.1. </b>&#x542F;&#x52A8;gdb</a></li></ul><li><span class="title-icon "></span><a href="#uftrace&#x4F7F;&#x7528;"><b>3. </b>uftrace&#x4F7F;&#x7528;</a></li><ul><li><span class="title-icon "></span><a href="#&#x7F16;&#x8BD1;&#x5B89;&#x88C5;"><b>3.1. </b>&#x7F16;&#x8BD1;&#x5B89;&#x88C5;</a></li><li><span class="title-icon "></span><a href="#&#x4F7F;&#x7528;"><b>3.2. </b>&#x4F7F;&#x7528;</a></li><li><span class="title-icon "></span><a href="#&#x548C;flamegraph&#x914D;&#x5408;&#x751F;&#x6210;svg"><b>3.3. </b>&#x548C;flamegraph&#x914D;&#x5408;&#x751F;&#x6210;svg</a></li><li><span class="title-icon "></span><a href="#chrome-tracing&#x6A21;&#x5F0F;-&#x4EE3;&#x7801;&#x754C;&#x7684;&#x793A;&#x6CE2;&#x5668;"><b>3.4. </b>chrome tracing&#x6A21;&#x5F0F;, &quot;&#x4EE3;&#x7801;&#x754C;&#x7684;&#x793A;&#x6CE2;&#x5668;&quot;</a></li><li><span class="title-icon "></span><a href="#&#x5B9E;&#x4F8B;-&#x5206;&#x6790;redis"><b>3.5. </b>&#x5B9E;&#x4F8B;, &#x5206;&#x6790;redis</a></li><ul><li><span class="title-icon "></span><a href="#redis-benchmark&#x5BA2;&#x6237;&#x7AEF;&#x90E8;&#x5206;"><b>3.5.1. </b>redis benchmark(&#x5BA2;&#x6237;&#x7AEF;)&#x90E8;&#x5206;</a></li><li><span class="title-icon "></span><a href="#redis-server&#x90E8;&#x5206;"><b>3.5.2. </b>redis server&#x90E8;&#x5206;</a></li></ul></ul><li><span class="title-icon "></span><a href="#&#x8C03;&#x8BD5;&#x7A0B;&#x5E8F;&#x5361;&#x4F4F;"><b>4. </b>&#x8C03;&#x8BD5;&#x7A0B;&#x5E8F;&#x5361;&#x4F4F;</a></li><ul><li><span class="title-icon "></span><a href="#pstack"><b>4.1. </b>pstack</a></li><li><span class="title-icon "></span><a href="#proc"><b>4.2. </b>proc</a></li></ul><li><span class="title-icon "></span><a href="#perf"><b>5. </b>perf</a></li><ul><li><span class="title-icon "></span><a href="#perf&#x9700;&#x8981;&#x7684;&#x5185;&#x6838;&#x914D;&#x7F6E;"><b>5.1. </b>perf&#x9700;&#x8981;&#x7684;&#x5185;&#x6838;&#x914D;&#x7F6E;</a></li><li><span class="title-icon "></span><a href="#perf-top"><b>5.2. </b>perf top</a></li><li><span class="title-icon "></span><a href="#kernelgettimeofday"><b>5.3. </b>__kernel_gettimeofday</a></li><li><span class="title-icon "></span><a href="#perf&#x53EF;&#x4EE5;&#x91CD;&#x590D;run&#x4E00;&#x4E2A;&#x7A0B;&#x5E8F;-&#x5E76;&#x7ED9;&#x51FA;&#x5DEE;&#x5F02;"><b>5.4. </b>perf&#x53EF;&#x4EE5;&#x91CD;&#x590D;run&#x4E00;&#x4E2A;&#x7A0B;&#x5E8F;, &#x5E76;&#x7ED9;&#x51FA;&#x5DEE;&#x5F02;</a></li><li><span class="title-icon "></span><a href="#frontend-stall-backend-stall"><b>5.5. </b>frontend stall, backend stall</a></li><li><span class="title-icon "></span><a href="#perf--e"><b>5.6. </b>perf -e</a></li><li><span class="title-icon "></span><a href="#perf-top&#x91CC;&#x9762;&#x7684;children&#x662F;&#x4EC0;&#x4E48;&#x610F;&#x601D;"><b>5.7. </b>perf top&#x91CC;&#x9762;&#x7684;children&#x662F;&#x4EC0;&#x4E48;&#x610F;&#x601D;?</a></li></ul><li><span class="title-icon "></span><a href="#strace-&#x8DDF;&#x8E2A;&#x591A;&#x7EBF;&#x7A0B;"><b>6. </b>strace &#x8DDF;&#x8E2A;&#x591A;&#x7EBF;&#x7A0B;</a></li></ul></div><a href="#&#x8C03;&#x8BD5;usb&#x9519;&#x8BEF;" id="anchorNavigationExGoTop"><i class="fa fa-arrow-up"></i></a><ul>
<li><a href="#&#x8C03;&#x8BD5;usb&#x9519;&#x8BEF;">&#x8C03;&#x8BD5;usb&#x9519;&#x8BEF;</a></li>
<li><a href="#&#x53CD;&#x5411;&#x5DE5;&#x7A0B;anbox&#x7684;abs&#x547D;&#x4EE4;">&#x53CD;&#x5411;&#x5DE5;&#x7A0B;Anbox&#x7684;abs&#x547D;&#x4EE4;</a><ul>
<li><a href="#&#x542F;&#x52A8;gdb">&#x542F;&#x52A8;gdb</a></li>
</ul>
</li>
<li><a href="#uftrace&#x4F7F;&#x7528;">uftrace&#x4F7F;&#x7528;</a><ul>
<li><a href="#&#x7F16;&#x8BD1;&#x5B89;&#x88C5;">&#x7F16;&#x8BD1;&#x5B89;&#x88C5;</a></li>
<li><a href="#&#x4F7F;&#x7528;">&#x4F7F;&#x7528;</a></li>
<li><a href="#&#x548C;flamegraph&#x914D;&#x5408;&#x751F;&#x6210;svg">&#x548C;flamegraph&#x914D;&#x5408;&#x751F;&#x6210;svg</a></li>
<li><a href="#chrome-tracing&#x6A21;&#x5F0F;-&#x4EE3;&#x7801;&#x754C;&#x7684;&#x793A;&#x6CE2;&#x5668;">chrome tracing&#x6A21;&#x5F0F;, &quot;&#x4EE3;&#x7801;&#x754C;&#x7684;&#x793A;&#x6CE2;&#x5668;&quot;</a></li>
<li><a href="#&#x5B9E;&#x4F8B;-&#x5206;&#x6790;redis">&#x5B9E;&#x4F8B;, &#x5206;&#x6790;redis</a><ul>
<li><a href="#redis-benchmark&#x5BA2;&#x6237;&#x7AEF;&#x90E8;&#x5206;">redis benchmark(&#x5BA2;&#x6237;&#x7AEF;)&#x90E8;&#x5206;</a></li>
<li><a href="#redis-server&#x90E8;&#x5206;">redis server&#x90E8;&#x5206;</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#&#x8C03;&#x8BD5;&#x7A0B;&#x5E8F;&#x5361;&#x4F4F;">&#x8C03;&#x8BD5;&#x7A0B;&#x5E8F;&#x5361;&#x4F4F;</a><ul>
<li><a href="#pstack">pstack</a></li>
<li><a href="#proc">proc</a></li>
</ul>
</li>
<li><a href="#perf">perf</a><ul>
<li><a href="#perf&#x9700;&#x8981;&#x7684;&#x5185;&#x6838;&#x914D;&#x7F6E;">perf&#x9700;&#x8981;&#x7684;&#x5185;&#x6838;&#x914D;&#x7F6E;</a></li>
<li><a href="#perf-top">perf top</a></li>
<li><a href="#__kernel_gettimeofday"><code>__kernel_gettimeofday</code></a></li>
<li><a href="#perf&#x53EF;&#x4EE5;&#x91CD;&#x590D;run&#x4E00;&#x4E2A;&#x7A0B;&#x5E8F;-&#x5E76;&#x7ED9;&#x51FA;&#x5DEE;&#x5F02;">perf&#x53EF;&#x4EE5;&#x91CD;&#x590D;run&#x4E00;&#x4E2A;&#x7A0B;&#x5E8F;, &#x5E76;&#x7ED9;&#x51FA;&#x5DEE;&#x5F02;</a></li>
<li><a href="#frontend-stall-backend-stall">frontend stall, backend stall</a></li>
<li><a href="#perf--e">perf -e</a></li>
<li><a href="#perf-top&#x91CC;&#x9762;&#x7684;children&#x662F;&#x4EC0;&#x4E48;&#x610F;&#x601D;">perf top&#x91CC;&#x9762;&#x7684;children&#x662F;&#x4EC0;&#x4E48;&#x610F;&#x601D;?</a></li>
</ul>
</li>
<li><a href="#strace-&#x8DDF;&#x8E2A;&#x591A;&#x7EBF;&#x7A0B;">strace &#x8DDF;&#x8E2A;&#x591A;&#x7EBF;&#x7A0B;</a></li>
</ul>
<h1 id="&#x8C03;&#x8BD5;usb&#x9519;&#x8BEF;"><a name="&#x8C03;&#x8BD5;usb&#x9519;&#x8BEF;" class="anchor-navigation-ex-anchor" href="#&#x8C03;&#x8BD5;usb&#x9519;&#x8BEF;"><i class="fa fa-link" aria-hidden="true"></i></a>1. &#x8C03;&#x8BD5;usb&#x9519;&#x8BEF;</h1>
<pre class="language-"><code class="lang-sh"><span class="token builtin class-name">echo</span> <span class="token parameter variable">-n</span> <span class="token string">&apos;module xhci_hcd =p&apos;</span> <span class="token operator">&gt;</span> /sys/kernel/debug/dynamic_debug/control
<span class="token builtin class-name">echo</span> xhci-hcd <span class="token operator">&gt;&gt;</span> /sys/kernel/debug/tracing/set_event
</code></pre>
<p>0) Reboot the machine in order to put it in a consistent state;
1) <code>echo &quot;module xhci_hcd +flpt&quot; &gt; /sys/kernel/debug/dynamic_debug/control</code>
2) <code>echo nop &gt; /sys/kernel/debug/tracing/current_tracer</code>
3) <code>echo 81920 &gt; /sys/kernel/debug/tracing/buffer_size_kb</code>
4) <code>echo 0 &gt; /sys/kernel/debug/tracing/trace</code>
5) <code>echo 1 &gt; /sys/kernel/debug/tracing/tracing_on</code>
6) <code>echo 1 &gt; /sys/kernel/debug/tracing/events/xhci-hcd/enable</code></p>
<p>After reproduce the issue, you should collect <code>/sys/kernel/debug/tracing/trace</code>. Problem is that the file might be huge, much larger than the kernel log you provided for instance.</p>
<h1 id="&#x53CD;&#x5411;&#x5DE5;&#x7A0B;anbox&#x7684;abs&#x547D;&#x4EE4;"><a name="&#x53CD;&#x5411;&#x5DE5;&#x7A0B;anbox&#x7684;abs&#x547D;&#x4EE4;" class="anchor-navigation-ex-anchor" href="#&#x53CD;&#x5411;&#x5DE5;&#x7A0B;anbox&#x7684;abs&#x547D;&#x4EE4;"><i class="fa fa-link" aria-hidden="true"></i></a>2. &#x53CD;&#x5411;&#x5DE5;&#x7A0B;Anbox&#x7684;abs&#x547D;&#x4EE4;</h1>
<blockquote>
<p>Canonical &#x63D0;&#x4F9B;&#x7684;Android container&#x65B9;&#x6848;&#x91CC;&#x9762;, &#x6240;&#x6709;&#x7684;&#x547D;&#x4EE4;&#x90FD;&#x7528;&#x4E8C;&#x8FDB;&#x5236;&#x7A0B;&#x5E8F;abs&#x8FDB;&#x884C;&#x4E86;&#x5C01;&#x88C5;, &#x5305;&#x62EC;setup, start, stop, &#x8FD0;&#x884C;demo&#x90FD;&#x5728;&#x91CC;&#x9762;, &#x76EE;&#x7684;&#x662F;&#x5BF9;&#x5176;&#x5185;&#x90E8;&#x64CD;&#x4F5C;&#x548C;&#x539F;&#x7406;&#x4FDD;&#x5BC6;. &#x5728;&#x6B64;&#x6211;&#x4EEC;&#x5C1D;&#x8BD5;&#x5BF9;&#x5176;&#x53CD;&#x5411;&#x5DE5;&#x7A0B;, &#x76EE;&#x7684;&#x662F;&#x80FD;&#x591F;&#x8BA9;&#x6211;&#x4EEC;&#x6709;&#x80FD;&#x529B;&#x4E0D;&#x4F9D;&#x8D56;&#x8FD9;&#x4E2A;&#x4E8C;&#x8FDB;&#x5236;&#x7A0B;&#x5E8F;, &#x80FD;&#x591F;&#x624B;&#x52A8;&#x8FD0;&#x884C;cantainer&#x7684;&#x547D;&#x4EE4;, &#x6BD4;&#x5982;openarena&#x7684;&#x5B89;&#x88C5;&#x548C;demo&#x7684;&#x8FD0;&#x884C;. </p>
</blockquote>
<p>&#x521D;&#x6B65;&#x5206;&#x6790;&#x8FD9;&#x4E2A;abs&#x7A0B;&#x5E8F;&#x662F;&#x7528;go&#x8BED;&#x8A00;&#x5199;&#x7684;. &#x4F46;&#x6211;&#x81EA;&#x5DF1;&#x5BF9;go&#x8BED;&#x8A00;&#x4E5F;&#x4ECE;&#x672A;&#x63A5;&#x89E6;, &#x4E0B;&#x9762;&#x7684;&#x5185;&#x5BB9;&#x6709;&#x9519;&#x8BEF;&#x5728;&#x6240;&#x96BE;&#x514D;.</p>
<p>&#x9700;&#x8981;&#x51C6;&#x5907;:</p>
<ul>
<li>gdb, ubuntu&#x81EA;&#x5E26;</li>
<li>&#x53CD;&#x5411;&#x7684;&#x8FC7;&#x7A0B;&#x4E5F;&#x662F;&#x8C03;&#x8BD5;&#x7684;&#x8FC7;&#x7A0B;, &#x9700;&#x8981;&#x5B89;&#x88C5;golang&#x7684;&#x57FA;&#x7840;&#x73AF;&#x5883; <code>apt install golang</code></li>
<li>&#x53C2;&#x8003;&#x7F51;&#x4E0A;&#x6587;&#x7AE0;
<a href="https://golang.org/doc/gdb" target="_blank">https://golang.org/doc/gdb</a>
<a href="http://web.cecs.pdx.edu/~jrb/cs201/lectures/handouts/gdbcomm.txt" target="_blank">http://web.cecs.pdx.edu/~jrb/cs201/lectures/handouts/gdbcomm.txt</a></li>
</ul>
<h2 id="&#x542F;&#x52A8;gdb"><a name="&#x542F;&#x52A8;gdb" class="anchor-navigation-ex-anchor" href="#&#x542F;&#x52A8;gdb"><i class="fa fa-link" aria-hidden="true"></i></a>2.1. &#x542F;&#x52A8;gdb</h2>
<p><code>gdb abs</code><br>&#x56E0;&#x4E3A;GDB&#x5BF9;go&#x652F;&#x6301;&#x4E0D;&#x662F;&#x592A;&#x597D;, &#x9700;&#x8981;&#x52A0;&#x8F7D;&#x4E00;&#x4E2A;extention&#x624D;&#x80FD;&#x770B;go&#x5167;&#x5EFA;&#x7684;&#x6570;&#x636E;&#x7ED3;&#x6784;.<br>&#x4E0B;&#x9762;&#x8FD9;&#x4E2A;runtime-gdb.py&#x5C31;&#x662F;.<br><code>source /usr/share/go-1.6/src/runtime/runtime-gdb.py</code></p>
<p>&#x53E6;&#x5916;&#x4E3A;&#x4E86;&#x6253;&#x5370;&#x597D;&#x770B;&#x4E9B;, &#x6211;&#x4E00;&#x822C;&#x559C;&#x6B22;
<code>set print pretty on</code><br>&#x6211;&#x4EEC;&#x9700;&#x8981;&#x4E86;&#x89E3;abs&#x7684;&#x5927;&#x6982;&#x7B26;&#x53F7;&#x8868;&#x7684;&#x60C5;&#x51B5;, &#x6240;&#x4EE5;&#x5217;&#x51FA;&#x6240;&#x6709;&#x51FD;&#x6570;<br><code>info functions</code><br>&#x53EF;&#x4EE5;&#x627E;&#x5230;main&#x6253;&#x5934;&#x7684;&#x51FD;&#x6570;&#x5982;&#x4E0B;, abs&#x7684;&#x7ED3;&#x6784;&#x5F88;&#x7B80;&#x5355;:</p>
<pre class="language-"><code class="lang-c"><span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">void</span> main<span class="token punctuation">.</span><span class="token function">allocBinderNode</span><span class="token punctuation">(</span><span class="token keyword">struct</span> <span class="token class-name">string</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">void</span> main<span class="token punctuation">.</span><span class="token function">bootstrapBaseImage</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">void</span> main<span class="token punctuation">.</span><span class="token function">cleanupAllContainers</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">void</span> main<span class="token punctuation">.</span>cleanupAllContainers<span class="token punctuation">.</span><span class="token function">func1</span><span class="token punctuation">(</span><span class="token keyword">struct</span> <span class="token class-name">string</span><span class="token punctuation">,</span> map<span class="token punctuation">[</span>string<span class="token punctuation">]</span>interface <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">void</span> main<span class="token punctuation">.</span><span class="token function">createContainer</span><span class="token punctuation">(</span><span class="token keyword">struct</span> <span class="token class-name">string</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">void</span> main<span class="token punctuation">.</span><span class="token function">ensureBinderNodes</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">void</span> main<span class="token punctuation">.</span><span class="token function">ensureStateDirExists</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">void</span> main<span class="token punctuation">.</span><span class="token function">ensureUserIsRoot</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">void</span> main<span class="token punctuation">.</span><span class="token function">forEachLxdContainer</span><span class="token punctuation">(</span><span class="token function">func</span><span class="token punctuation">(</span>string<span class="token punctuation">,</span> map<span class="token punctuation">[</span>string<span class="token punctuation">]</span>interface <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">void</span> main<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">void</span> main<span class="token punctuation">.</span><span class="token function">lxcCmd</span><span class="token punctuation">(</span><span class="token keyword">struct</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>string<span class="token punctuation">,</span> <span class="token keyword">struct</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>uint8<span class="token punctuation">,</span> error<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">void</span> main<span class="token punctuation">.</span><span class="token function">lxcCmdOrFail</span><span class="token punctuation">(</span><span class="token keyword">struct</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>string<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">void</span> main<span class="token punctuation">.</span><span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">void</span> main<span class="token punctuation">.</span><span class="token function">parallelize</span><span class="token punctuation">(</span><span class="token keyword">struct</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token function">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">void</span> main<span class="token punctuation">.</span>parallelize<span class="token punctuation">.</span><span class="token function">func1</span><span class="token punctuation">(</span><span class="token keyword">struct</span> <span class="token class-name">sync</span><span class="token punctuation">.</span>WaitGroup <span class="token operator">*</span><span class="token punctuation">,</span> <span class="token function">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">void</span> main<span class="token punctuation">.</span><span class="token function">removeContainer</span><span class="token punctuation">(</span><span class="token keyword">struct</span> <span class="token class-name">string</span><span class="token punctuation">,</span> map<span class="token punctuation">[</span>string<span class="token punctuation">]</span>interface <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">void</span> main<span class="token punctuation">.</span><span class="token function">removeDirAndItsContent</span><span class="token punctuation">(</span><span class="token keyword">struct</span> <span class="token class-name">string</span><span class="token punctuation">,</span> error<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">void</span> main<span class="token punctuation">.</span><span class="token function">restartAnbox</span><span class="token punctuation">(</span><span class="token keyword">struct</span> <span class="token class-name">string</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">void</span> main<span class="token punctuation">.</span><span class="token function">runCleanup</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">void</span> main<span class="token punctuation">.</span><span class="token function">runInParallel</span><span class="token punctuation">(</span><span class="token function">func</span><span class="token punctuation">(</span>string<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">void</span> main<span class="token punctuation">.</span>runInParallel<span class="token punctuation">.</span><span class="token function">func1</span><span class="token punctuation">(</span><span class="token keyword">struct</span> <span class="token class-name">string</span><span class="token punctuation">,</span> map<span class="token punctuation">[</span>string<span class="token punctuation">]</span>interface <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">void</span> main<span class="token punctuation">.</span>runInParallel<span class="token punctuation">.</span>func1<span class="token punctuation">.</span><span class="token number">1</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">void</span> main<span class="token punctuation">.</span><span class="token function">runRestartAnbox</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">void</span> main<span class="token punctuation">.</span><span class="token function">runSetup</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">void</span> main<span class="token punctuation">.</span><span class="token function">runSetupDemo1</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">void</span> main<span class="token punctuation">.</span><span class="token function">runStart</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">void</span> main<span class="token punctuation">.</span><span class="token function">runStartDemo1</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">void</span> main<span class="token punctuation">.</span><span class="token function">runStop</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">void</span> main<span class="token punctuation">.</span><span class="token function">setupDemo1</span><span class="token punctuation">(</span><span class="token keyword">struct</span> <span class="token class-name">string</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">void</span> main<span class="token punctuation">.</span><span class="token function">startContainer</span><span class="token punctuation">(</span><span class="token keyword">struct</span> <span class="token class-name">string</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">void</span> main<span class="token punctuation">.</span><span class="token function">startDemo1</span><span class="token punctuation">(</span><span class="token keyword">struct</span> <span class="token class-name">string</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">void</span> main<span class="token punctuation">.</span><span class="token function">stopContainer</span><span class="token punctuation">(</span><span class="token keyword">struct</span> <span class="token class-name">string</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">void</span> main<span class="token punctuation">.</span><span class="token function">waitForAndroidToBoot</span><span class="token punctuation">(</span><span class="token keyword">struct</span> <span class="token class-name">string</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p>&#x6211;&#x4EEC;&#x91CD;&#x70B9;&#x5173;&#x6CE8;<code>main.lxcCmd</code>, &#x7528;&#x6765;&#x53D1;&#x771F;&#x6B63;&#x7684;&#x547D;&#x4EE4;&#x7ED9;container, &#x7528;abs&#x7684;stop&#x547D;&#x4EE4;&#x8BD5;&#x4E00;&#x4E0B;, &#x6211;&#x4EEC;&#x7684;&#x57FA;&#x672C;&#x5224;&#x65AD;&#x662F;&#x8FD9;&#x4E2A;stop&#x547D;&#x4EE4;&#x5E95;&#x5C42;&#x4F1A;&#x5411;&#x6BCF;&#x4E2A;container&#x5B9E;&#x4F8B;&#x53D1;&#x9001;<code>lxc stop</code>&#x547D;&#x4EE4;, &#x770B;&#x770B;&#x662F;&#x4E0D;&#x662F;:</p>
<pre class="language-"><code class="lang-sh"><span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> b main.lxcCmd
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> r stop
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> bt
<span class="token comment">#0  main.lxcCmd (args= []string = {...}, ~r1= []uint8, ~r2=...) at /tmp/tmp.E2wa2oqEu9/abs/abs.go:60</span>
<span class="token comment">#1  0x00000000000c616c in main.forEachLxdContainer (run={void (struct string, map[string]interface {})} 0x4420071e18) at /tmp/tmp.E2wa2oqEu9/abs/abs.go:105</span>
<span class="token comment">#2  0x00000000000c836c in main.runInParallel (action={void (struct string)} 0x4420071ee8) at /tmp/tmp.E2wa2oqEu9/abs/abs.go:360</span>
<span class="token comment">#3  0x00000000000c8804 in main.runStop () at /tmp/tmp.E2wa2oqEu9/abs/abs.go:408</span>
<span class="token comment">#4  0x00000000000c9838 in main.main () at /tmp/tmp.E2wa2oqEu9/abs/abs.go:504</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> info args
args <span class="token operator">=</span>  <span class="token punctuation">[</span><span class="token punctuation">]</span>string <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">&quot;list&quot;</span>, <span class="token string">&quot;--format=json&quot;</span><span class="token punctuation">}</span>
~r1 <span class="token operator">=</span>  <span class="token punctuation">[</span><span class="token punctuation">]</span>uint8
~r2 <span class="token operator">=</span> <span class="token punctuation">{</span>
  tab <span class="token operator">=</span> 0x0,
  data <span class="token operator">=</span> 0xbeafb <span class="token operator">&lt;</span>flag.<span class="token punctuation">(</span>*FlagSet<span class="token punctuation">)</span>.Var+10<span class="token operator"><span class="token file-descriptor important">7</span>&gt;</span>
<span class="token punctuation">}</span>
</code></pre>
<p>&#x53EF;&#x4EE5;&#x770B;&#x5230;&#x9996;&#x5148;&#x4F1A;list&#x51FA;&#x6240;&#x6709;&#x7684;container<br>&#x540E;&#x9762;&#x4E0D;&#x65AD;&#x6267;&#x884C;</p>
<pre class="language-"><code>c
bt
info args
</code></pre><p>&#x53EF;&#x4EE5;&#x770B;&#x5230;&#x5B8C;&#x6574;&#x7684;&#x6307;&#x4EE4;&#x5E8F;&#x5217;, &#x673A;&#x5668;&#x4E0A;&#x53EA;&#x8D77;&#x4E86;&#x4E00;&#x4E2A;&#x5B9E;&#x4F8B;</p>
<pre class="language-"><code class="lang-sh"><span class="token string">&quot;list&quot;</span>, <span class="token string">&quot;--format=json&quot;</span>
<span class="token string">&quot;info&quot;</span>, <span class="token string">&quot;abs-anbox-0&quot;</span>
<span class="token string">&quot;stop&quot;</span>, <span class="token string">&quot;-f&quot;</span>, <span class="token string">&quot;abs-anbox-0&quot;</span>
</code></pre>
<p><code>./abs -num-containers=1 setup</code>&#x7684;&#x547D;&#x4EE4;&#x5E8F;&#x5217;:</p>
<pre class="language-"><code class="lang-sh"><span class="token string">&quot;list&quot;</span>, <span class="token string">&quot;--format=json&quot;</span>
<span class="token string">&quot;delete&quot;</span>, <span class="token string">&quot;-f&quot;</span>, <span class="token string">&quot;abs-anbox-base&quot;</span>
<span class="token string">&quot;init&quot;</span>, <span class="token string">&quot;anbox&quot;</span>, <span class="token string">&quot;abs-anbox-base&quot;</span>, <span class="token string">&quot;-s&quot;</span>, <span class="token string">&quot;default&quot;</span>, <span class="token string">&quot;-c&quot;</span>, <span class="token string">&quot;security.nesting=true&quot;</span>
<span class="token string">&quot;config&quot;</span>, <span class="token string">&quot;set&quot;</span>, <span class="token string">&quot;abs-anbox-base&quot;</span>, <span class="token string">&quot;raw.lxc&quot;</span>, <span class="token string">&quot;lxc.cap.drop=&quot;</span>
<span class="token string">&quot;config&quot;</span>, <span class="token string">&quot;set&quot;</span>, <span class="token string">&quot;abs-anbox-base&quot;</span>, <span class="token string">&quot;user.anbox.platform&quot;</span>, <span class="token string">&quot;null&quot;</span>
<span class="token string">&quot;config&quot;</span>, <span class="token string">&quot;set&quot;</span>, <span class="token string">&quot;abs-anbox-base&quot;</span>, <span class="token string">&quot;user.anbox.gles_driver&quot;</span>, <span class="token string">&quot;null&quot;</span>
<span class="token string">&quot;config&quot;</span>, <span class="token string">&quot;device&quot;</span>, <span class="token string">&quot;add&quot;</span>, <span class="token string">&quot;abs-anbox-base&quot;</span>, <span class="token string">&quot;ashmem&quot;</span>, <span class="token string">&quot;unix-char&quot;</span>, <span class="token string">&quot;path=/dev/ashmem&quot;</span>, <span class="token string">&quot;mode=0666&quot;</span>
<span class="token string">&quot;config&quot;</span>, <span class="token string">&quot;device&quot;</span>, <span class="token string">&quot;add&quot;</span>, <span class="token string">&quot;abs-anbox-base&quot;</span>, <span class="token string">&quot;eth0&quot;</span>, <span class="token string">&quot;nic&quot;</span>, <span class="token string">&quot;nictype=bridged&quot;</span>, <span class="token string">&quot;parent=lxdbr0&quot;</span>, <span class="token string">&quot;name=eth0&quot;</span>
<span class="token string">&quot;config&quot;</span>, <span class="token string">&quot;device&quot;</span>, <span class="token string">&quot;add&quot;</span>, <span class="token string">&quot;abs-anbox-base&quot;</span>, <span class="token string">&quot;binder&quot;</span>, <span class="token string">&quot;unix-char&quot;</span>, <span class="token string">&quot;path=/dev/binder&quot;</span>, <span class="token string">&quot;mode=0666&quot;</span>
<span class="token string">&quot;info&quot;</span>, <span class="token string">&quot;abs-anbox-base&quot;</span>
<span class="token string">&quot;start&quot;</span>, <span class="token string">&quot;abs-anbox-base&quot;</span>
<span class="token string">&quot;exec&quot;</span>, <span class="token string">&quot;abs-anbox-base&quot;</span>, <span class="token string">&quot;--&quot;</span>, <span class="token string">&quot;pidof&quot;</span>, <span class="token string">&quot;com.android.systemui&quot;</span>
<span class="token string">&quot;exec&quot;</span>, <span class="token string">&quot;abs-anbox-base&quot;</span>, <span class="token string">&quot;--&quot;</span>, <span class="token string">&quot;adb&quot;</span>, <span class="token string">&quot;install&quot;</span>, <span class="token string">&quot;/userdata/openarena.apk&quot;</span>
<span class="token string">&quot;exec&quot;</span>, <span class="token string">&quot;abs-anbox-base&quot;</span>, <span class="token string">&quot;--&quot;</span>, <span class="token string">&quot;adb&quot;</span>, <span class="token string">&quot;shell&quot;</span>, <span class="token string">&quot;pm&quot;</span>, <span class="token string">&quot;grant&quot;</span>, <span class="token string">&quot;ws.openarena.sdl&quot;</span>, <span class="token string">&quot;android.permission.WRITE_EXTERNAL_STORAGE&quot;</span>
<span class="token string">&quot;exec&quot;</span>, <span class="token string">&quot;abs-anbox-base&quot;</span>, <span class="token string">&quot;--&quot;</span>, <span class="token string">&quot;adb&quot;</span>, <span class="token string">&quot;shell&quot;</span>, <span class="token string">&quot;pm&quot;</span>, <span class="token string">&quot;grant&quot;</span>, <span class="token string">&quot;ws.openarena.sdl&quot;</span>, <span class="token string">&quot;android.permission.READ_EXTERNAL_STORAGE&quot;</span>
<span class="token string">&quot;exec&quot;</span>, <span class="token string">&quot;abs-anbox-base&quot;</span>, <span class="token string">&quot;--&quot;</span>, <span class="token string">&quot;adb&quot;</span>, <span class="token string">&quot;shell&quot;</span>, <span class="token string">&quot;pm&quot;</span>, <span class="token string">&quot;grant&quot;</span>, <span class="token string">&quot;ws.openarena.sdl&quot;</span>, <span class="token string">&quot;android.permission.RECORD_AUDIO&quot;</span>
<span class="token string">&quot;exec&quot;</span>, <span class="token string">&quot;abs-anbox-base&quot;</span>, <span class="token string">&quot;--&quot;</span>, <span class="token string">&quot;mkdir&quot;</span>, <span class="token string">&quot;-p&quot;</span>, <span class="token string">&quot;/var/lib/anbox/data/media/0/Android/data/&quot;</span>
<span class="token string">&quot;exec&quot;</span>, <span class="token string">&quot;abs-anbox-base&quot;</span>, <span class="token string">&quot;--&quot;</span>, <span class="token string">&quot;tar&quot;</span>, <span class="token string">&quot;xJf&quot;</span>, <span class="token string">&quot;/userdata/openarena-data.tar.xz&quot;</span>, <span class="token string">&quot;-C&quot;</span>, <span class="token string">&quot;/var/lib/anbox/data/media/0/Android/data/&quot;</span>
<span class="token string">&quot;exec&quot;</span>, <span class="token string">&quot;abs-anbox-base&quot;</span>, <span class="token string">&quot;--&quot;</span>, <span class="token string">&quot;chown&quot;</span>, <span class="token string">&quot;-R&quot;</span>, <span class="token string">&quot;1023:1023&quot;</span>, <span class="token string">&quot;/var/lib/anbox/data/media/0/Android/data/ws.openarena.sdl&quot;</span>
<span class="token string">&quot;exec&quot;</span>, <span class="token string">&quot;abs-anbox-base&quot;</span>, <span class="token string">&quot;--&quot;</span>, <span class="token string">&quot;adb&quot;</span>, <span class="token string">&quot;shell&quot;</span>, <span class="token string">&quot;mkdir&quot;</span>, <span class="token string">&quot;-p&quot;</span>, <span class="token string">&quot;/sdcard/Android/data/ws.openarena.sdl/files/.openarena/baseoa/demos/&quot;</span>
<span class="token string">&quot;exec&quot;</span>, <span class="token string">&quot;abs-anbox-base&quot;</span>, <span class="token string">&quot;--&quot;</span>, <span class="token string">&quot;adb&quot;</span>, <span class="token string">&quot;push&quot;</span>, <span class="token string">&quot;/userdata/demo0002.dm_71&quot;</span>, <span class="token string">&quot;/sdcard/Android/data/ws.openarena.sdl/files/.openarena/baseoa/demos/demo0002.dm_71&quot;</span>
<span class="token string">&quot;exec&quot;</span>, <span class="token string">&quot;abs-anbox-base&quot;</span>, <span class="token string">&quot;--&quot;</span>, <span class="token string">&quot;adb&quot;</span>, <span class="token string">&quot;shell&quot;</span>, <span class="token string">&quot;am&quot;</span>, <span class="token string">&quot;force-stop&quot;</span>, <span class="token string">&quot;ws.openarena.sdl&quot;</span>
<span class="token string">&quot;exec&quot;</span>, <span class="token string">&quot;abs-anbox-base&quot;</span>, <span class="token string">&quot;--&quot;</span>, <span class="token string">&quot;adb&quot;</span>, <span class="token string">&quot;shell&quot;</span>, <span class="token string">&quot;am&quot;</span>, <span class="token string">&quot;start&quot;</span>, <span class="token string">&quot;ws.openarena.sdl/.MainActivity&quot;</span>
<span class="token string">&quot;info&quot;</span>, <span class="token string">&quot;abs-anbox-base&quot;</span>
<span class="token string">&quot;stop&quot;</span>, <span class="token string">&quot;-f&quot;</span>, <span class="token string">&quot;abs-anbox-base&quot;</span>
<span class="token string">&quot;config&quot;</span>, <span class="token string">&quot;device&quot;</span>, <span class="token string">&quot;remove&quot;</span>, <span class="token string">&quot;abs-anbox-base&quot;</span>, <span class="token string">&quot;binder&quot;</span>
<span class="token string">&quot;info&quot;</span>, <span class="token string">&quot;abs-anbox-base&quot;</span>
<span class="token string">&quot;copy&quot;</span>, <span class="token string">&quot;--container-only&quot;</span>, <span class="token string">&quot;abs-anbox-base&quot;</span>, <span class="token string">&quot;abs-anbox-0&quot;</span>
<span class="token string">&quot;config&quot;</span>, <span class="token string">&quot;device&quot;</span>, <span class="token string">&quot;add&quot;</span>, <span class="token string">&quot;abs-anbox-0&quot;</span>, <span class="token string">&quot;binder&quot;</span>, <span class="token string">&quot;unix-char&quot;</span>, <span class="token string">&quot;source=/dev/binder1&quot;</span>, <span class="token string">&quot;path=/dev/binder&quot;</span>, <span class="token string">&quot;mode=0666&quot;</span>
</code></pre>
<p><code>./abs start</code>&#x7684;&#x547D;&#x4EE4;&#x5E8F;&#x5217;:</p>
<pre class="language-"><code class="lang-sh"><span class="token string">&quot;list&quot;</span>, <span class="token string">&quot;--format=json&quot;</span>
<span class="token string">&quot;start&quot;</span>, <span class="token string">&quot;abs-anbox-0&quot;</span>
<span class="token string">&quot;exec&quot;</span>, <span class="token string">&quot;abs-anbox-0&quot;</span>, <span class="token string">&quot;--&quot;</span>, <span class="token string">&quot;pidof&quot;</span>, <span class="token string">&quot;com.android.systemui&quot;</span>
</code></pre>
<p><code>./abs start-demo1</code>&#x6307;&#x4EE4;&#x5E8F;&#x5217;:</p>
<pre class="language-"><code class="lang-sh"><span class="token string">&quot;list&quot;</span>, <span class="token string">&quot;--format=json&quot;</span>
<span class="token string">&quot;exec&quot;</span>, <span class="token string">&quot;abs-anbox-0&quot;</span>, <span class="token string">&quot;--&quot;</span>, <span class="token string">&quot;adb&quot;</span>, <span class="token string">&quot;shell&quot;</span>, <span class="token string">&quot;am&quot;</span>, <span class="token string">&quot;force-stop&quot;</span>, <span class="token string">&quot;ws.openarena.sdl&quot;</span>
<span class="token string">&quot;exec&quot;</span>, <span class="token string">&quot;abs-anbox-0&quot;</span>, <span class="token string">&quot;--&quot;</span>, <span class="token string">&quot;adb&quot;</span>, <span class="token string">&quot;shell&quot;</span>, <span class="token string">&quot;am&quot;</span>, <span class="token string">&quot;start&quot;</span>, <span class="token string">&quot;ws.openarena.sdl/.MainActivity&quot;</span>
</code></pre>
<h1 id="uftrace&#x4F7F;&#x7528;"><a name="uftrace&#x4F7F;&#x7528;" class="anchor-navigation-ex-anchor" href="#uftrace&#x4F7F;&#x7528;"><i class="fa fa-link" aria-hidden="true"></i></a>3. uftrace&#x4F7F;&#x7528;</h1>
<p>uftrace&#x80FD;&#x591F;&#x6309;&#x65F6;&#x95F4;&#x7EBF;&#x8BB0;&#x5F55;&#x6BCF;&#x4E2A;&#x51FD;&#x6570;&#x6267;&#x884C;&#x65F6;&#x95F4;<br><a href="https://github.com/namhyung/uftrace/wiki/Tutorial" target="_blank">https://github.com/namhyung/uftrace/wiki/Tutorial</a></p>
<h2 id="&#x7F16;&#x8BD1;&#x5B89;&#x88C5;"><a name="&#x7F16;&#x8BD1;&#x5B89;&#x88C5;" class="anchor-navigation-ex-anchor" href="#&#x7F16;&#x8BD1;&#x5B89;&#x88C5;"><i class="fa fa-link" aria-hidden="true"></i></a>3.1. &#x7F16;&#x8BD1;&#x5B89;&#x88C5;</h2>
<p><code>git clone https://github.com/namhyung/uftrace.git</code></p>
<p>&#x5728;64K pagesize&#x7684;&#x7CFB;&#x7EDF;&#x4E0A;, &#x9700;&#x8981;&#x6539;&#x4E0B;&#x4EE3;&#x7801;, &#x5426;&#x5219;&#x4F1A;&#x6709;mprotect&#x9519;&#x8BEF;</p>
<pre class="language-"><code class="lang-diff">diff --git a/libmcount/plthook.c b/libmcount/plthook.c
index eb3c541..f88244c 100644
<span class="token coord">--- a/libmcount/plthook.c</span>
<span class="token coord">+++ b/libmcount/plthook.c</span>
@@ -26,7 +26,7 @@ static bool *plthook_dynsym_resolved;
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">static unsigned long got_addr;
</span><span class="token prefix unchanged"> </span><span class="token line">static volatile bool segv_handled;
</span></span><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">#define PAGE_SIZE  4096
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">#define PAGE_SIZE getpagesize()
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">#define PAGE_ADDR(addr)  ((void *)((addr) &amp; ~(PAGE_SIZE - 1)))
</span><span class="token prefix unchanged"> </span><span class="token line">static void segv_handler(int sig, siginfo_t *si, void *ctx)
</span></span></code></pre>
<p>&#x5982;&#x679C;&#x9700;&#x8981;&#x770B;kernel&#x7684;, &#x9700;&#x8981;root&#x8FD0;&#x884C;, &#x5E26;-k, &#x5E76;&#x4E14;&#x8981;&#x6C42;kernel&#x6709;CONFIG_FUNCTION_GRAPH_TRACER=y</p>
<pre class="language-"><code>make
sudo make install
</code></pre><h2 id="&#x4F7F;&#x7528;"><a name="&#x4F7F;&#x7528;" class="anchor-navigation-ex-anchor" href="#&#x4F7F;&#x7528;"><i class="fa fa-link" aria-hidden="true"></i></a>3.2. &#x4F7F;&#x7528;</h2>
<p>&#x88AB;&#x8C03;&#x8BD5;&#x7684;&#x7A0B;&#x5E8F;&#x9700;&#x8981;&#x7528;-pg&#x9009;&#x9879;&#x6765;&#x7F16;&#x8BD1;, &#x66F4;&#x591A;&#x4FE1;&#x606F;&#x53EF;&#x641C;&#x7D22;<code>mcount</code></p>
<pre class="language-"><code class="lang-sh"><span class="token parameter variable">-pg</span>
Generate extra code to <span class="token function">write</span> profile information suitable <span class="token keyword">for</span> the analysis program gprof. You must use this option when compiling the <span class="token builtin class-name">source</span> files you want data about, and you must also use it when linking.
</code></pre>
<p>Makefile&#x52A0;-pg&#x4E4B;&#x540E;, &#x5C31;&#x53EF;&#x4EE5;&#x8C03;&#x8BD5;&#x4E86;:</p>
<pre class="language-"><code class="lang-sh"><span class="token function">sudo</span> /usr/local/bin/uftrace <span class="token parameter variable">-F</span> main record src/redis-server redis.conf
&#x6309;&#x65F6;&#x95F4;&#x7EBF;replay
<span class="token function">sudo</span> /usr/local/bin/uftrace replay
replay, &#x663E;&#x793A;&#x65F6;&#x95F4;&#x7EBF;
<span class="token function">sudo</span> /usr/local/bin/uftrace replay <span class="token parameter variable">-f</span> elapsed,duration,tid
<span class="token function">sudo</span> /usr/local/bin/uftrace replay <span class="token parameter variable">-t</span> 5us
&#x6309;&#x5360;&#x7528;&#x65F6;&#x95F4;report
<span class="token function">sudo</span> /usr/local/bin/uftrace report
&#x663E;&#x793A;&#x8C03;&#x7528;&#x5173;&#x7CFB;
<span class="token function">sudo</span> /usr/local/bin/uftrace graph
</code></pre>
<ul>
<li>&#x548C;perf&#x57FA;&#x4E8E;&#x91C7;&#x6837;&#x7684;&#x6A21;&#x578B;&#x76F8;&#x6BD4;, &#x8FD9;&#x4E2A;&#x662F;&#x5B8C;&#x6574;&#x65F6;&#x95F4;&#x7EBF;&#x7684;, &#x6240;&#x6709;&#x7684;&#x5E26;-pg&#x7F16;&#x8BD1;&#x7684;&#x51FD;&#x6570;&#x90FD;&#x8BB0;&#x5F55;&#x5728;&#x6848;. &#x53EF;&#x4EE5;&#x8BF4;uftrace&#x66F4;&#x5B8F;&#x89C2;.</li>
<li>&#x6BCF;&#x4E2A;&#x51FD;&#x6570;&#x90FD;&#x4F1A;&#x88AB;&#x8BB0;&#x5F55;, &#x6BD4;&#x5982;&#x4E00;&#x4E2A;for&#x5FAA;&#x73AF;&#x91CC;&#x9762;&#x8C03;&#x7528;memcpy&#x51FD;&#x6570;, &#x65F6;&#x95F4;&#x662F;&#x7D2F;&#x52A0;&#x7684;.</li>
</ul>
<h2 id="&#x548C;flamegraph&#x914D;&#x5408;&#x751F;&#x6210;svg"><a name="&#x548C;flamegraph&#x914D;&#x5408;&#x751F;&#x6210;svg" class="anchor-navigation-ex-anchor" href="#&#x548C;flamegraph&#x914D;&#x5408;&#x751F;&#x6210;svg"><i class="fa fa-link" aria-hidden="true"></i></a>3.3. &#x548C;flamegraph&#x914D;&#x5408;&#x751F;&#x6210;svg</h2>
<pre class="language-"><code class="lang-sh"><span class="token function">sudo</span> /usr/local/bin/uftrace dump --flame-graph <span class="token operator">|</span> ~/yingjieb/git/FlameGraph/flamegraph.pl <span class="token operator">&gt;</span> redis.svg
</code></pre>
<h2 id="chrome-tracing&#x6A21;&#x5F0F;-&#x4EE3;&#x7801;&#x754C;&#x7684;&#x793A;&#x6CE2;&#x5668;"><a name="chrome-tracing&#x6A21;&#x5F0F;-&#x4EE3;&#x7801;&#x754C;&#x7684;&#x793A;&#x6CE2;&#x5668;" class="anchor-navigation-ex-anchor" href="#chrome-tracing&#x6A21;&#x5F0F;-&#x4EE3;&#x7801;&#x754C;&#x7684;&#x793A;&#x6CE2;&#x5668;"><i class="fa fa-link" aria-hidden="true"></i></a>3.4. chrome tracing&#x6A21;&#x5F0F;, &quot;&#x4EE3;&#x7801;&#x754C;&#x7684;&#x793A;&#x6CE2;&#x5668;&quot;</h2>
<pre class="language-"><code class="lang-sh"><span class="token function">sudo</span> /usr/local/bin/uftrace dump <span class="token parameter variable">--chrome</span> <span class="token operator">&gt;</span> redis.json
</code></pre>
<p>&#x7528;chrome:tracing&#x6A21;&#x5F0F;&#x6253;&#x5F00;&#x8FD9;&#x4E2A;json&#x6587;&#x4EF6;<br><img src="img/profiling_&#x8C03;&#x8BD5;&#x548C;&#x5206;&#x6790;&#x8BB0;&#x5F55;1_20221019112540.png" alt="">  </p>
<ul>
<li>ALT+&#x9F20;&#x6807;&#x6EDA;&#x8F6E;, zoom in and out</li>
<li>w s &#x653E;&#x5927;&#x7F29;&#x5C0F;, a d &#x5DE6;&#x53F3;</li>
<li>&#x5DE6;&#x4E0A;&#x89D2;&#x95EE;&#x53F7;&#x662F;help</li>
</ul>
<h2 id="&#x5B9E;&#x4F8B;-&#x5206;&#x6790;redis"><a name="&#x5B9E;&#x4F8B;-&#x5206;&#x6790;redis" class="anchor-navigation-ex-anchor" href="#&#x5B9E;&#x4F8B;-&#x5206;&#x6790;redis"><i class="fa fa-link" aria-hidden="true"></i></a>3.5. &#x5B9E;&#x4F8B;, &#x5206;&#x6790;redis</h2>
<p>&#x8D77;redis server, &#x7136;&#x540E;&#x7528;redis benchmark&#x6765;&#x505A;&#x5BA2;&#x6237;&#x7AEF;&#x538B;&#x529B;&#x6D4B;&#x8BD5;</p>
<pre class="language-"><code class="lang-sh"><span class="token function">sudo</span> /usr/local/bin/uftrace <span class="token parameter variable">-d</span> redis-server.data record src/redis-server redis.conf
<span class="token function">sudo</span> /usr/local/bin/uftrace <span class="token parameter variable">-d</span> redis-benchmark.data record src/redis-benchmark <span class="token parameter variable">-t</span> <span class="token builtin class-name">set</span> <span class="token parameter variable">-n</span> <span class="token number">10000</span> <span class="token parameter variable">-r</span> <span class="token number">100000000</span>
</code></pre>
<pre class="language-"><code class="lang-sh"><span class="token function">sudo</span> /usr/local/bin/uftrace dump <span class="token parameter variable">--chrome</span> <span class="token parameter variable">-d</span> redis-benchmark.data <span class="token operator">&gt;</span> redis-benchmark.json
<span class="token function">sudo</span> /usr/local/bin/uftrace dump <span class="token parameter variable">--chrome</span> <span class="token parameter variable">-d</span> redis-server.data <span class="token operator">&gt;</span> redis-server.json
&#x53EA;&#x5173;&#x6CE8;23&#x79D2;&#x5230;25&#x79D2;
<span class="token function">sudo</span> /usr/local/bin/uftrace dump <span class="token parameter variable">--chrome</span> <span class="token parameter variable">-d</span> redis-server.data <span class="token parameter variable">-r</span> 23s~25s <span class="token operator">&gt;</span> redis-server-2s.json
</code></pre>
<h3 id="redis-benchmark&#x5BA2;&#x6237;&#x7AEF;&#x90E8;&#x5206;"><a name="redis-benchmark&#x5BA2;&#x6237;&#x7AEF;&#x90E8;&#x5206;" class="anchor-navigation-ex-anchor" href="#redis-benchmark&#x5BA2;&#x6237;&#x7AEF;&#x90E8;&#x5206;"><i class="fa fa-link" aria-hidden="true"></i></a>3.5.1. redis benchmark(&#x5BA2;&#x6237;&#x7AEF;)&#x90E8;&#x5206;</h3>
<p>&#x7528;chrome&#x6253;&#x5F00;&#x8FD9;&#x4E24;&#x4E2A;json&#x6587;&#x4EF6;, &#x5148;&#x6765;&#x770B;redis benchmark: &#x6574;&#x4F53;&#x5206;&#x4E3A;&#x4E09;&#x90E8;&#x5206;: </p>
<ul>
<li>&#x5148;&#x5EFA;&#x7ACB;50&#x4E2A;&#x5230;server&#x7684;&#x8FDE;&#x63A5;, &#x5E76;&#x52A0;&#x5165;epoll </li>
<li>epoll_wait&#x6765;&#x7B49;&#x5F85;&#x4E8B;&#x4EF6;, random&#x6765;&#x751F;&#x6210;key, value&#x9ED8;&#x8BA4;&#x7528;xxx, &#x5148;50&#x4E2A;write, &#x7B49;50&#x4E2A;read, &#x521A;&#x5F00;&#x59CB;&#x662F;&#x5F88;&#x6574;&#x9F50;&#x7684;. &#x8FD9;&#x8BF4;&#x660E;&#x8FD9;&#x662F;&#x4E2A;&#x540C;&#x6B65;&#x7684;&#x8FC7;&#x7A0B;, 50&#x4E2A;client, &#x6BCF;&#x4E2A;client&#x90FD;&#x662F;&#x53D1;&#x9001;request, &#x7B49;&#x5F85;server&#x56DE;&#x590D;, &#x518D;&#x53D1;&#x4E0B;&#x4E00;&#x4E2A;request. &#x5230;&#x540E;&#x671F;&#x56E0;&#x4E3A;server&#x7AEF;&#x8C03;&#x5EA6;&#x7684;&#x5173;&#x7CFB;, &#x8FD9;50&#x4E2A;client&#x7684;&#x8BFB;&#x5199;&#x6DF7;&#x5728;&#x4E00;&#x8D77;&#x4E86;, &#x4F46;&#x5BF9;&#x6BCF;&#x4E2A;client&#x6765;&#x8BF4;, &#x8FD8;&#x662F;&#x540C;&#x6B65;&#x7684;.  <blockquote>
<p>Clients and Servers are connected via a networking link. Such a link can be very fast (a loopback interface) or very slow (a connection established over the Internet with many hops between the two hosts). Whatever the network latency is, there is a time for the packets to travel from the client to the server, and back from the server to the client to carry the reply.
This time is called RTT (Round Trip Time). It is very easy to see how this can affect the performances when a client needs to perform many requests in a row (for instance adding many elements to the same list, or populating a database with many keys). For instance if the RTT time is 250 milliseconds (in the case of a very slow link over the Internet), even if the server is able to process 100k requests per second, we&apos;ll be able to process at max four requests per second.</p>
</blockquote>
</li>
<li>&#x6240;&#x4EE5;&#x8FD9;&#x91CC;&#x5C31;&#x8981;&#x8BF4;&#x4E00;&#x4E0B;pipeline, redis&#x652F;&#x6301;pipeline, &#x6BD4;&#x5982;-P 16, &#x662F;&#x8BF4;&#x4E00;&#x6B21;&#x7F51;&#x7EDC;&#x6765;&#x56DE;&#x91CC;&#x9762;, &#x6267;&#x884C;16&#x4E2A;command, &#x8FD9;&#x6BD4;&#x9ED8;&#x8BA4;&#x7684;&#x4E00;&#x4E2A;&#x6765;&#x56DE;&#x4E00;&#x4E2A;command&#x8981;&#x9AD8;&#x6548;&#x7684;&#x591A;, &#x9664;&#x4E86;&#x8282;&#x7701;&#x7F51;&#x7EDC;&#x6765;&#x56DE;&#x7684;&#x65F6;&#x95F4;, &#x8FD8;&#x8282;&#x7701;&#x4E86;socket&#x7684;read write&#x5F00;&#x9500;, &#x901A;&#x5E38;&#x8FD9;&#x4E9B;&#x5F00;&#x9500;&#x5305;&#x62EC;&#x7528;&#x6237;&#x6001;&#x548C;&#x5185;&#x6838;&#x6001;&#x7684;&#x5207;&#x6362;&#x5F00;&#x9500;.</li>
<li>&#x6BCF;&#x4E2A;&#x5904;&#x7406;&#x90FD;&#x7528;gettimeofday&#x6765;&#x6253;&#x65F6;&#x95F4;&#x6233;</li>
<li>&#x90FD;&#x5904;&#x7406;&#x5B8C;&#x6BD5;, close&#x8FD9;&#x4E9B;&#x8FDE;&#x63A5;, &#x5E76;&#x6309;latency&#x6392;&#x5E8F;</li>
</ul>
<p><img src="img/profiling_&#x8C03;&#x8BD5;&#x548C;&#x5206;&#x6790;&#x8BB0;&#x5F55;1_20221019112722.png" alt="">  </p>
<h3 id="redis-server&#x90E8;&#x5206;"><a name="redis-server&#x90E8;&#x5206;" class="anchor-navigation-ex-anchor" href="#redis-server&#x90E8;&#x5206;"><i class="fa fa-link" aria-hidden="true"></i></a>3.5.2. redis server&#x90E8;&#x5206;</h3>
<p>&#x4ECE;&#x5B8F;&#x89C2;&#x4E0A;&#x770B;, server&#x5728;24&#x79D2;&#x7684;&#x65F6;&#x5019;&#x5F00;&#x59CB;&#x771F;&#x6B63;&#x5E72;&#x6D3B;<br><img src="img/profiling_&#x8C03;&#x8BD5;&#x548C;&#x5206;&#x6790;&#x8BB0;&#x5F55;1_20221019112753.png" alt="">  </p>
<ul>
<li>&#x524D;&#x9762;&#x662F;&#x521D;&#x59CB;&#x5316;, &#x7136;&#x540E;epoll&#x7B49;&#x5F85;, &#x76F4;&#x5230;client&#x53D1;&#x51FA;10000&#x4E2A;set&#x8BF7;&#x6C42;</li>
<li>&#x521D;&#x59CB;&#x5316;&#x5185;&#x5BB9;&#x5305;&#x62EC;&#x89E3;&#x6790;&#x547D;&#x4EE4;&#x884C;, server&#x914D;&#x7F6E;, lua&#x811A;&#x672C;&#x5F15;&#x64CE;, &#x5171;&#x4EAB;&#x5BF9;&#x8C61;, &#x8D77;&#x5757;&#x5B58;&#x50A8;bio&#x7EBF;&#x7A0B;(&#x4E09;&#x4E2A;), &#x76D1;&#x542C;&#x670D;&#x52A1;&#x7AEF;&#x53E3;, &#x4ECE;&#x78C1;&#x76D8;&#x52A0;&#x8F7D;&#x6570;&#x636E;&#x7B49;&#x7B49;,</li>
<li>&#x521D;&#x59CB;&#x5316;&#x91CC;&#x9762;&#x6709;&#x5F88;&#x591A;zmalloc/zrealloc&#x8C03;&#x7528;, &#x5176;&#x4E2D;&#x6709;&#x4E00;&#x4E9B;&#x7ADF;&#x7136;&#x6709;pthread<em>mutex_lock, &#x800C;&#x5176;&#x4ED6;&#x6CA1;&#x6709;<br>![](img/profiling</em>&#x8C03;&#x8BD5;&#x548C;&#x5206;&#x6790;&#x8BB0;&#x5F55;1_20221019112837.png)  </li>
<li>&#x5728;aeProcessEvents&#x91CC;&#x9762;&#x5904;&#x7406;&#x4E8B;&#x4EF6;, &#x5148;accept TCP&#x7684;&#x8FDE;&#x63A5;, &#x5E94;&#x8BE5;&#x662F;50&#x4E2A;(&#x5BF9;&#x5E94;client&#x8D77;50&#x4E2A;&#x5E76;&#x53D1;)<br><img src="img/profiling_&#x8C03;&#x8BD5;&#x548C;&#x5206;&#x6790;&#x8BB0;&#x5F55;1_20221019112858.png" alt=""><br><code>sudo /usr/local/bin/uftrace replay -f elapsed,duration,tid -d redis-server.data -F acceptTcpHandler</code><br>tcpnodelay keepalive setsockopt aeCreateFileEvent zmalloc listcreate dictcreate</li>
<li>readQueryFromClient&#x4E00;&#x5171;&#x8C03;&#x7528;&#x4E86;10050&#x6B21;, &#x5E94;&#x8BE5;&#x662F;&#x5904;&#x7406;&#x6BCF;&#x4E2A;client&#x7684;set&#x8BF7;&#x6C42;&#x7684;&#x6838;&#x5FC3;&#x51FD;&#x6570;, &#x800C;&#x6BCF;&#x4E2A;epoll<em>wait&#x540E;, &#x4E00;&#x822C;&#x60C5;&#x51B5;&#x4E0B;, &#x90FD;&#x5904;&#x7406;50&#x4E2A;Query, &#x548C;client&#x7684;&#x5E76;&#x53D1;&#x6570;&#x4E00;&#x81F4;. &#x4F46;&#x5076;&#x5C14;&#x6709;&#x4F8B;&#x5916;.
![](img/profiling</em>&#x8C03;&#x8BD5;&#x548C;&#x5206;&#x6790;&#x8BB0;&#x5F55;1_20221019112921.png)  </li>
<li>&#x6BCF;&#x4E2A;Query&#x90FD;&#x5148;&#x4ECE;socket read, gettimeofday, malloc&#x5185;&#x5B58;, &#x521B;&#x5EFA;string&#x5BF9;&#x8C61;, &#x5B57;&#x7B26;&#x4E32;&#x64CD;&#x4F5C;, lookup, hash, dbAdd, &#x79FB;&#x9664;&#x8FC7;&#x671F;&#x7684;, &#x51C6;&#x5907;&#x4E2A;client&#x7684;reply&#x5230;&#x94FE;&#x8868;
<img src="img/profiling_&#x8C03;&#x8BD5;&#x548C;&#x5206;&#x6790;&#x8BB0;&#x5F55;1_20221019112937.png" alt="">  </li>
<li>&#x8FD9;&#x6B21;&#x7684;50&#x4E2A;set&#x8BF7;&#x6C42;&#x5168;&#x90E8;&#x5904;&#x7406;&#x5B8C;&#x6BD5;&#x540E;, reply&#x8BB0;&#x5F55;&#x5230;&#x4E00;&#x4E2A;&#x94FE;&#x8868;&#x91CC;&#x9762;, &#x7136;&#x540E;&#x9A6C;&#x4E0A;&#x53D1;&#x9001;&#x56DE;client<br><img src="img/profiling_&#x8C03;&#x8BD5;&#x548C;&#x5206;&#x6790;&#x8BB0;&#x5F55;1_20221019112952.png" alt="">  </li>
<li>&#x6700;&#x540E;&#x628A;&#x8FD9;50&#x4E2A;&#x8FDE;&#x63A5;close&#x6389;</li>
</ul>
<h1 id="&#x8C03;&#x8BD5;&#x7A0B;&#x5E8F;&#x5361;&#x4F4F;"><a name="&#x8C03;&#x8BD5;&#x7A0B;&#x5E8F;&#x5361;&#x4F4F;" class="anchor-navigation-ex-anchor" href="#&#x8C03;&#x8BD5;&#x7A0B;&#x5E8F;&#x5361;&#x4F4F;"><i class="fa fa-link" aria-hidden="true"></i></a>4. &#x8C03;&#x8BD5;&#x7A0B;&#x5E8F;&#x5361;&#x4F4F;</h1>
<h2 id="pstack"><a name="pstack" class="anchor-navigation-ex-anchor" href="#pstack"><i class="fa fa-link" aria-hidden="true"></i></a>4.1. pstack</h2>
<p>&#x5F53;&#x4E00;&#x4E2A;&#x7A0B;&#x5E8F;&#x5361;&#x4F4F;&#x4E0D;&#x52A8;, &#x7528;pstack&#x6765;&#x770B;&#x4ED6;&#x5F53;&#x524D;&#x7684;&#x8C03;&#x7528;&#x6808;
&#x6BD4;&#x5982;:</p>
<pre class="language-"><code class="lang-sh">$ pstack <span class="token number">33451</span>
<span class="token comment">#0  0x0000ffff8a694f34 in __accept_nocancel () from /lib64/libc.so.6</span>
<span class="token comment">#1  0x0000000000401d94 in tcp_accept ()</span>
<span class="token comment">#2  0x0000000000401a1c in server_main ()</span>
<span class="token comment">#3  0x0000000000401adc in main ()</span>
</code></pre>
<p>&#x5176;&#x5B9E;pstack&#x53EA;&#x662F;&#x4E2A;&#x811A;&#x672C;, &#x5B83;&#x7528;&#x7684;&#x662F;gdb, &#x5C31;&#x662F;&#x4E0B;&#x9762;&#x7684;&#x6548;&#x679C;</p>
<pre class="language-"><code class="lang-sh">/usr/bin/gdb <span class="token parameter variable">--quiet</span> <span class="token parameter variable">-nx</span> /proc/33451/exe <span class="token number">33451</span>
&#x5728;gdb&#x91CC;&#x6267;&#x884C;
bt
</code></pre>
<p><code>gdb prog progID</code>&#x548C;<code>gdb -p progID</code>&#x662F;&#x4E00;&#x6837;&#x7684;</p>
<p>&#x6CA1;&#x6709;pstack&#x7528;&#x4E0B;&#x9762;&#x547D;&#x4EE4;&#x4E5F;&#x884C;:
<code>gdb -batch -ex bt -p 1234</code></p>
<h2 id="proc"><a name="proc" class="anchor-navigation-ex-anchor" href="#proc"><i class="fa fa-link" aria-hidden="true"></i></a>4.2. proc</h2>
<p><code>/proc/PID/stack</code>&#x91CC;&#x9762;&#x6709;kenel&#x7684;&#x6808;</p>
<pre class="language-"><code class="lang-sh">$ <span class="token function">cat</span> /proc/33451/stack
<span class="token punctuation">[</span><span class="token operator">&lt;</span>ffff00000808602<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span><span class="token punctuation">]</span> __switch_to+0x6c/0x78
<span class="token punctuation">[</span><span class="token operator">&lt;</span>ffff00000877035<span class="token operator"><span class="token file-descriptor important">8</span>&gt;</span><span class="token punctuation">]</span> inet_csk_accept+0x24c/0x2b0
<span class="token punctuation">[</span><span class="token operator">&lt;</span>ffff0000087a278<span class="token operator"><span class="token file-descriptor important">8</span>&gt;</span><span class="token punctuation">]</span> inet_accept+0x50/0x168
<span class="token punctuation">[</span><span class="token operator">&lt;</span>ffff0000086fbc8c<span class="token operator">&gt;</span><span class="token punctuation">]</span> SyS_accept4+0xf4/0x1e8
<span class="token punctuation">[</span><span class="token operator">&lt;</span>ffff0000086fbdb<span class="token operator"><span class="token file-descriptor important">4</span>&gt;</span><span class="token punctuation">]</span> SyS_accept+0x34/0x40
<span class="token punctuation">[</span><span class="token operator">&lt;</span>ffff0000080835f<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span><span class="token punctuation">]</span> el0_svc_naked+0x24/0x28
<span class="token punctuation">[</span><span class="token operator">&lt;</span>ffffffffffffffff<span class="token operator">&gt;</span><span class="token punctuation">]</span> 0xffffffffffffffff
</code></pre>
<h1 id="perf"><a name="perf" class="anchor-navigation-ex-anchor" href="#perf"><i class="fa fa-link" aria-hidden="true"></i></a>5. perf</h1>
<p>perf&#x9ED8;&#x8BA4;&#x662F;per-thread mode, &#x5728;&#x8FD9;&#x4E2A;thread&#x8FD0;&#x884C;&#x65F6;&#x8BA1;&#x6570;, &#x4E0D;&#x8FD0;&#x884C;&#x65F6;&#x4E0D;&#x8BA1;&#x6570;. &#x52A0;-a&#x8868;&#x793A;&#x7EDF;&#x8BA1;&#x6574;&#x4E2A;&#x7CFB;&#x7EDF;</p>
<p>cycle&#x662F;CPU&#x8FD0;&#x884C;&#x65F6;&#x7684;cycle, &#x4E0D;&#x8BA1;idle<br>&#x7528;-p attach &#x4E00;&#x4E2A;&#x8FDB;&#x7A0B;, &#x9ED8;&#x8BA4;&#x7EDF;&#x8BA1;&#x8FD9;&#x4E2A;&#x8FDB;&#x7A0B;&#x7684;&#x6240;&#x6709;&#x7EBF;&#x7A0B;&#x548C;&#x5B50;&#x8FDB;&#x7A0B;<br>&#x7528;-t attach&#x4E00;&#x4E2A;&#x7EBF;&#x7A0B;<br>perf report -k &#x6307;&#x5B9A;vmlinux, &#x7528;&#x6765;&#x89E3;&#x6790;&#x5185;&#x6838;<br>perf top -C &#x6307;&#x5B9A;core, &quot;Z&quot;&#x952E;&#x5237;&#x65B0;<br>perf record -c 1000, &#x662F;&#x6307;&#x8FD9;&#x4E2A;event&#x6BCF;1000&#x6B21;&#x8BB0;&#x5F55;&#x4E00;&#x6B21;, &#x56E0;&#x4E3A;&#x5168;&#x8BB0;&#x5F55;&#x5F00;&#x9500;&#x5927;.</p>
<h2 id="perf&#x9700;&#x8981;&#x7684;&#x5185;&#x6838;&#x914D;&#x7F6E;"><a name="perf&#x9700;&#x8981;&#x7684;&#x5185;&#x6838;&#x914D;&#x7F6E;" class="anchor-navigation-ex-anchor" href="#perf&#x9700;&#x8981;&#x7684;&#x5185;&#x6838;&#x914D;&#x7F6E;"><i class="fa fa-link" aria-hidden="true"></i></a>5.1. perf&#x9700;&#x8981;&#x7684;&#x5185;&#x6838;&#x914D;&#x7F6E;</h2>
<blockquote>
<p>For kernel analysis, I&apos;m using CONFIG_KPROBES=y and CONFIG_KPROBE_EVENTS=y, to enable kernel dynamic tracing, and CONFIG_FRAME_POINTER=y, for frame pointer-based kernel stacks. For user-level analysis, CONFIG_UPROBES=y and CONFIG_UPROBE_EVENTS=y, for user-level dynamic tracing.</p>
</blockquote>
<h2 id="perf-top"><a name="perf-top" class="anchor-navigation-ex-anchor" href="#perf-top"><i class="fa fa-link" aria-hidden="true"></i></a>5.2. perf top</h2>
<p>perf top -g&#x53EF;&#x4EE5;&#x5E26;&#x8C03;&#x7528;&#x6808;, &#x4F46;&#x9ED8;&#x8BA4;&#x662F;&#x6309;children&#x7D2F;&#x52A0;&#x6A21;&#x5F0F;&#x6392;&#x5E8F;, &#x7528;&#x4E0B;&#x9762;&#x7684;&#x547D;&#x4EE4;&#x53EF;&#x4EE5;&#x6309;self&#x6392;&#x5E8F;<br>&#x6211;&#x4E00;&#x822C;&#x4E60;&#x60EF;&#x662F;&#x52A0;<code>--no-children</code></p>
<pre class="language-"><code class="lang-sh"><span class="token function">sudo</span> perf <span class="token function">top</span> <span class="token parameter variable">-g</span> --no-children
<span class="token function">sudo</span> perf <span class="token function">top</span> <span class="token parameter variable">-g</span> --no-children <span class="token parameter variable">-p</span> <span class="token variable"><span class="token variable">`</span>pidof redis-server<span class="token variable">`</span></span>
</code></pre>
<p><img src="img/profiling_&#x8C03;&#x8BD5;&#x548C;&#x5206;&#x6790;&#x8BB0;&#x5F55;1_20221019113145.png" alt="">  </p>
<h2 id="kernelgettimeofday"><a name="kernelgettimeofday" class="anchor-navigation-ex-anchor" href="#kernelgettimeofday"><i class="fa fa-link" aria-hidden="true"></i></a>5.3. __kernel_gettimeofday</h2>
<blockquote>
<p>So <code>__kernel_gettimeofday</code> being called by AW is actually the VDSO code for ARM64. If we look at that function, we see 3 potentially ugly ops (2 DMBs and an ISB). The profile hit data suggest that the ISB is hurting us the most (we sampled at the mrs 92% of the time but it&#x2019;s most likely the ISB that is the gate). I&#x2019;m not sure if any of this code can be cleaned up:<br><img src="img/profiling_&#x8C03;&#x8BD5;&#x548C;&#x5206;&#x6790;&#x8BB0;&#x5F55;1_20221019113212.png" alt=""><br>We started to look at this test and before getting to deep into the analysis, we looked at the profiles of the x86 2699v4 system (on the left side of the screen capture below) and Amberwing (on the right)<br>What caught our attention was X86&#x2019;s use of the __vdso_gettimeofday function. I&#x2019;m hoping some of the kernel experts on copy can shed light on whether we support VDSO (Virtual Dynamic Shared Object) on AW. My understanding is that this is a far more efficient way of system calling some commonly used kernel system call function like gettimeofday. I found the following link on the web which helps explain VDSO:<br><a href="http://www.linuxjournal.com/content/" target="_blank">http://www.linuxjournal.com/content/</a>  creating-vdso-colonels-other-chicken<br>The link talks about use of glibc but I&#x2019;m more interested in the hacking of the kernel approach which appears to be the method used by x86. IN short: a program can make a syscall and not have to endure the overhead of the memory-hopping between user and kernel segments that a traditional syscall would require. Do we have such support? If not, is this something we should be providing.</p>
</blockquote>
<h2 id="perf&#x53EF;&#x4EE5;&#x91CD;&#x590D;run&#x4E00;&#x4E2A;&#x7A0B;&#x5E8F;-&#x5E76;&#x7ED9;&#x51FA;&#x5DEE;&#x5F02;"><a name="perf&#x53EF;&#x4EE5;&#x91CD;&#x590D;run&#x4E00;&#x4E2A;&#x7A0B;&#x5E8F;-&#x5E76;&#x7ED9;&#x51FA;&#x5DEE;&#x5F02;" class="anchor-navigation-ex-anchor" href="#perf&#x53EF;&#x4EE5;&#x91CD;&#x590D;run&#x4E00;&#x4E2A;&#x7A0B;&#x5E8F;-&#x5E76;&#x7ED9;&#x51FA;&#x5DEE;&#x5F02;"><i class="fa fa-link" aria-hidden="true"></i></a>5.4. perf&#x53EF;&#x4EE5;&#x91CD;&#x590D;run&#x4E00;&#x4E2A;&#x7A0B;&#x5E8F;, &#x5E76;&#x7ED9;&#x51FA;&#x5DEE;&#x5F02;</h2>
<p>&#x6CE8;&#x610F;&#x4E0B;&#x9762;, -a&#x8868;&#x793A;&#x7EDF;&#x8BA1;&#x6574;&#x4E2A;&#x7CFB;&#x7EDF;, &#x4E0D;&#x52A0;&#x9ED8;&#x8BA4;&#x7684;&#x662F;&#x7EDF;&#x8BA1;&#x540E;&#x9762;command</p>
<pre class="language-"><code class="lang-sh">$ <span class="token function">sudo</span> perf <span class="token function">stat</span> <span class="token parameter variable">-r</span> <span class="token number">5</span> <span class="token parameter variable">-a</span> <span class="token function">sleep</span> <span class="token number">1</span>
Performance counter stats <span class="token keyword">for</span> <span class="token string">&apos;system wide&apos;</span> <span class="token punctuation">(</span><span class="token number">5</span> runs<span class="token punctuation">)</span>:
      <span class="token number">48055.429090</span>      cpu-clock <span class="token punctuation">(</span>msec<span class="token punctuation">)</span>          <span class="token comment">#   47.417 CPUs utilized            ( +-  0.01% )</span>
               <span class="token number">364</span>      context-switches          <span class="token comment">#    0.008 K/sec                    ( +-  7.83% )</span>
                 <span class="token number">7</span>      cpu-migrations            <span class="token comment">#    0.000 K/sec                    ( +- 16.08% )</span>
                <span class="token number">26</span>      page-faults               <span class="token comment">#    0.001 K/sec                    ( +-  8.77% )</span>
       <span class="token number">137,412</span>,037      cycles                    <span class="token comment">#    0.003 GHz                      ( +- 10.30% )</span>
        <span class="token number">57,080</span>,600      instructions              <span class="token comment">#    0.42  insn per cycle           ( +- 22.67% )</span>
                 <span class="token number">3</span>      branches                  <span class="token comment">#    0.000 K/sec                    ( +- 44.72% )</span>
           <span class="token number">398,150</span>      branch-misses             <span class="token comment"># 13271653.33% of all branches      ( +- 13.29% )</span>
       <span class="token number">1.013468517</span> seconds <span class="token function">time</span> elapsed                                          <span class="token punctuation">(</span> +-  <span class="token number">0.08</span>% <span class="token punctuation">)</span>
</code></pre>
<pre class="language-"><code class="lang-sh">$ <span class="token function">sudo</span> perf <span class="token function">stat</span> <span class="token parameter variable">-r</span> <span class="token number">5</span> <span class="token function">sleep</span> <span class="token number">1</span>
 Performance counter stats <span class="token keyword">for</span> <span class="token string">&apos;sleep 1&apos;</span> <span class="token punctuation">(</span><span class="token number">5</span> runs<span class="token punctuation">)</span>:
          <span class="token number">0.605980</span>      task-clock <span class="token punctuation">(</span>msec<span class="token punctuation">)</span>         <span class="token comment">#    0.001 CPUs utilized            ( +-  2.47% )</span>
                 <span class="token number">1</span>      context-switches          <span class="token comment">#    0.002 M/sec</span>
                 <span class="token number">0</span>      cpu-migrations            <span class="token comment">#    0.000 K/sec</span>
                <span class="token number">54</span>      page-faults               <span class="token comment">#    0.089 M/sec                    ( +-  1.08% )</span>
         <span class="token number">1,502</span>,877      cycles                    <span class="token comment">#    2.480 GHz                      ( +-  2.48% )</span>
           <span class="token number">757,929</span>      instructions              <span class="token comment">#    0.50  insn per cycle           ( +-  2.06% )</span>
                 <span class="token number">0</span>      branches                  <span class="token comment">#    0.000 K/sec</span>
            <span class="token number">15,060</span>      branch-misses             <span class="token comment">#    0.00% of all branches          ( +-  1.94% )</span>
       <span class="token number">1.001679779</span> seconds <span class="token function">time</span> elapsed                                          <span class="token punctuation">(</span> +-  <span class="token number">0.04</span>% <span class="token punctuation">)</span>
</code></pre>
<h2 id="frontend-stall-backend-stall"><a name="frontend-stall-backend-stall" class="anchor-navigation-ex-anchor" href="#frontend-stall-backend-stall"><i class="fa fa-link" aria-hidden="true"></i></a>5.5. frontend stall, backend stall</h2>
<p>frontend stall and backend stall performance counters.<br>&#x8FD9;&#x4E2A;&#x4FE1;&#x606F;&#x5728;kernel4.6&#x4E0A;, &#x7528;perf stat&#x80FD;&#x770B;&#x51FA;&#x6765;.</p>
<ul>
<li>frontend stall&#x8BF4;&#x7684;&#x662F;&#x5206;&#x652F;&#x9884;&#x6D4B;&#x65B9;&#x9762;&#x7684;&#x6307;&#x6807;, &#x63D0;&#x793A;&#x4E86;icache&#x7684;&#x95EE;&#x9898;</li>
<li>backend stall&#x8BF4;&#x7684;&#x662F;data cache&#x65B9;&#x9762;&#x7684;&#x6307;&#x6807;, &#x63D0;&#x793A;&#x6570;&#x636E;miss&#x4E4B;&#x7C7B;&#x7684;.</li>
</ul>
<h2 id="perf--e"><a name="perf--e" class="anchor-navigation-ex-anchor" href="#perf--e"><i class="fa fa-link" aria-hidden="true"></i></a>5.6. perf -e</h2>
<p><code>perf stat -e instructions -p xxx -r37</code><br>&#x89C1;&#x624B;&#x518C;<code>21.6 DAB PMU Enumerations</code></p>
<h2 id="perf-top&#x91CC;&#x9762;&#x7684;children&#x662F;&#x4EC0;&#x4E48;&#x610F;&#x601D;"><a name="perf-top&#x91CC;&#x9762;&#x7684;children&#x662F;&#x4EC0;&#x4E48;&#x610F;&#x601D;" class="anchor-navigation-ex-anchor" href="#perf-top&#x91CC;&#x9762;&#x7684;children&#x662F;&#x4EC0;&#x4E48;&#x610F;&#x601D;"><i class="fa fa-link" aria-hidden="true"></i></a>5.7. perf top&#x91CC;&#x9762;&#x7684;children&#x662F;&#x4EC0;&#x4E48;&#x610F;&#x601D;?</h2>
<p>self&#x662F;&#x672C;&#x51FD;&#x6570;&#x6267;&#x884C;&#x7684;&#x65F6;&#x95F4;, &#x4E0D;&#x5305;&#x62EC;&#x672C;&#x51FD;&#x6570;&#x8C03;&#x7528;&#x7684;&#x5B50;&#x51FD;&#x6570;.<br>children &#x662F;&#x672C;&#x51FD;&#x6570;&#x65F6;&#x95F4;&#x52A0;&#x4E0A;&#x6240;&#x6709;&#x7684;&#x5B50;&#x51FD;&#x6570;&#x65F6;&#x95F4;, &#x5C31;&#x662F;&#x8BF4;, &#x7531;&#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#x8C03;&#x7528;&#x5F00;&#x53BB;&#x7684;&#x6240;&#x6709;&#x65F6;&#x95F4;&#x90FD;&#x7B97;&#x4E0A;.</p>
<pre class="language-"><code class="lang-c">Let me show you an example<span class="token operator">:</span>
  $ cat abc<span class="token punctuation">.</span>c
  <span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name function">barrier</span><span class="token expression"><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">asm</span> <span class="token keyword">volatile</span><span class="token punctuation">(</span></span><span class="token string">&quot;&quot;</span> <span class="token expression"><span class="token operator">::</span><span class="token operator">:</span> </span><span class="token string">&quot;memory&quot;</span><span class="token expression"><span class="token punctuation">)</span></span></span>
  <span class="token keyword">void</span> <span class="token function">a</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
    <span class="token keyword">int</span> i<span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">1000000</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
        <span class="token function">barrier</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">void</span> <span class="token function">b</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
    <span class="token function">a</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">void</span> <span class="token function">c</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
    <span class="token function">b</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
    <span class="token function">c</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
With this simple program I ran perf record and report<span class="token operator">:</span>
  $ perf record <span class="token operator">-</span>g <span class="token operator">-</span>e cycles<span class="token operator">:</span>u <span class="token punctuation">.</span><span class="token operator">/</span>abc
Case <span class="token number">1.</span>
  $ perf report <span class="token operator">--</span>stdio <span class="token operator">--</span>no<span class="token operator">-</span>call<span class="token operator">-</span>graph <span class="token operator">--</span>no<span class="token operator">-</span>children
  <span class="token macro property"><span class="token directive-hash">#</span> <span class="token expression">Overhead Command Shared Object Symbol</span></span>
  # <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
  #
      <span class="token number">91.50</span><span class="token operator">%</span> abc abc <span class="token punctuation">[</span><span class="token punctuation">.</span><span class="token punctuation">]</span> a         
       <span class="token number">8.18</span><span class="token operator">%</span> abc ld<span class="token operator">-</span><span class="token number">2.17</span><span class="token punctuation">.</span>so <span class="token punctuation">[</span><span class="token punctuation">.</span><span class="token punctuation">]</span> strlen    
       <span class="token number">0.31</span><span class="token operator">%</span> abc <span class="token punctuation">[</span>kernel<span class="token punctuation">.</span>kallsyms<span class="token punctuation">]</span> <span class="token punctuation">[</span>k<span class="token punctuation">]</span> page_fault
       <span class="token number">0.01</span><span class="token operator">%</span> abc ld<span class="token operator">-</span><span class="token number">2.17</span><span class="token punctuation">.</span>so <span class="token punctuation">[</span><span class="token punctuation">.</span><span class="token punctuation">]</span> _start    
Case <span class="token number">2.</span> <span class="token punctuation">(</span>current <span class="token keyword">default</span> behavior<span class="token punctuation">)</span>
  $ perf report <span class="token operator">--</span>stdio <span class="token operator">--</span>call<span class="token operator">-</span>graph <span class="token operator">--</span>no<span class="token operator">-</span>children
  <span class="token macro property"><span class="token directive-hash">#</span> <span class="token expression">Overhead Command Shared Object Symbol</span></span>
  # <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
  #
      <span class="token number">91.50</span><span class="token operator">%</span> abc abc <span class="token punctuation">[</span><span class="token punctuation">.</span><span class="token punctuation">]</span> a         
                  <span class="token operator">|</span>
                  <span class="token operator">--</span><span class="token operator">-</span> a
                      b
                      c
                      main
                      __libc_start_main
       <span class="token number">8.18</span><span class="token operator">%</span> abc ld<span class="token operator">-</span><span class="token number">2.17</span><span class="token punctuation">.</span>so <span class="token punctuation">[</span><span class="token punctuation">.</span><span class="token punctuation">]</span> strlen    
                  <span class="token operator">|</span>
                  <span class="token operator">--</span><span class="token operator">-</span> strlen
                      _dl_sysdep_start
       <span class="token number">0.31</span><span class="token operator">%</span> abc <span class="token punctuation">[</span>kernel<span class="token punctuation">.</span>kallsyms<span class="token punctuation">]</span> <span class="token punctuation">[</span>k<span class="token punctuation">]</span> page_fault
                  <span class="token operator">|</span>
                  <span class="token operator">--</span><span class="token operator">-</span> page_fault
                      _start
       <span class="token number">0.01</span><span class="token operator">%</span> abc ld<span class="token operator">-</span><span class="token number">2.17</span><span class="token punctuation">.</span>so <span class="token punctuation">[</span><span class="token punctuation">.</span><span class="token punctuation">]</span> _start    
                  <span class="token operator">|</span>
                  <span class="token operator">--</span><span class="token operator">-</span> _start
Case <span class="token number">3.</span>
  $ perf report <span class="token operator">--</span>no<span class="token operator">-</span>call<span class="token operator">-</span>graph <span class="token operator">--</span>children <span class="token operator">--</span>stdio
  <span class="token macro property"><span class="token directive-hash">#</span> <span class="token expression">Self Children Command Shared Object Symbol</span></span>
  # <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
  #
       <span class="token number">0.00</span><span class="token operator">%</span> <span class="token number">91.50</span><span class="token operator">%</span> abc libc<span class="token operator">-</span><span class="token number">2.17</span><span class="token punctuation">.</span>so <span class="token punctuation">[</span><span class="token punctuation">.</span><span class="token punctuation">]</span> __libc_start_main
       <span class="token number">0.00</span><span class="token operator">%</span> <span class="token number">91.50</span><span class="token operator">%</span> abc abc <span class="token punctuation">[</span><span class="token punctuation">.</span><span class="token punctuation">]</span> main             
       <span class="token number">0.00</span><span class="token operator">%</span> <span class="token number">91.50</span><span class="token operator">%</span> abc abc <span class="token punctuation">[</span><span class="token punctuation">.</span><span class="token punctuation">]</span> c                
       <span class="token number">0.00</span><span class="token operator">%</span> <span class="token number">91.50</span><span class="token operator">%</span> abc abc <span class="token punctuation">[</span><span class="token punctuation">.</span><span class="token punctuation">]</span> b                
      <span class="token number">91.50</span><span class="token operator">%</span> <span class="token number">91.50</span><span class="token operator">%</span> abc abc <span class="token punctuation">[</span><span class="token punctuation">.</span><span class="token punctuation">]</span> a                
       <span class="token number">0.00</span><span class="token operator">%</span> <span class="token number">8.18</span><span class="token operator">%</span> abc ld<span class="token operator">-</span><span class="token number">2.17</span><span class="token punctuation">.</span>so <span class="token punctuation">[</span><span class="token punctuation">.</span><span class="token punctuation">]</span> _dl_sysdep_start 
       <span class="token number">8.18</span><span class="token operator">%</span> <span class="token number">8.18</span><span class="token operator">%</span> abc ld<span class="token operator">-</span><span class="token number">2.17</span><span class="token punctuation">.</span>so <span class="token punctuation">[</span><span class="token punctuation">.</span><span class="token punctuation">]</span> strlen           
       <span class="token number">0.01</span><span class="token operator">%</span> <span class="token number">0.33</span><span class="token operator">%</span> abc ld<span class="token operator">-</span><span class="token number">2.17</span><span class="token punctuation">.</span>so <span class="token punctuation">[</span><span class="token punctuation">.</span><span class="token punctuation">]</span> _start           
       <span class="token number">0.31</span><span class="token operator">%</span> <span class="token number">0.31</span><span class="token operator">%</span> abc <span class="token punctuation">[</span>kernel<span class="token punctuation">.</span>kallsyms<span class="token punctuation">]</span> <span class="token punctuation">[</span>k<span class="token punctuation">]</span> page_fault       
As you can see __libc_start_main <span class="token operator">-&gt;</span> main <span class="token operator">-&gt;</span> c <span class="token operator">-&gt;</span> b <span class="token operator">-&gt;</span> a callchain show
up in the output<span class="token punctuation">.</span>
Finally<span class="token punctuation">,</span> it looks like below with both option enabled<span class="token operator">:</span>
</code></pre>
<h1 id="strace-&#x8DDF;&#x8E2A;&#x591A;&#x7EBF;&#x7A0B;"><a name="strace-&#x8DDF;&#x8E2A;&#x591A;&#x7EBF;&#x7A0B;" class="anchor-navigation-ex-anchor" href="#strace-&#x8DDF;&#x8E2A;&#x591A;&#x7EBF;&#x7A0B;"><i class="fa fa-link" aria-hidden="true"></i></a>6. strace &#x8DDF;&#x8E2A;&#x591A;&#x7EBF;&#x7A0B;</h1>
<pre class="language-"><code>strace -f
</code></pre><p>strace&#x53EF;&#x4EE5;&#x8DDF;&#x8E2A;perl&#x811A;&#x672C;&#xFF0C;&#x4F7F;&#x7528;&#x65B9;&#x6CD5;&#x662F;&#x76F4;&#x63A5;strace xxx.perl</p>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="profiling_调试和分析记录2.html" class="navigation navigation-prev " aria-label="Previous page: 调试和分析记录2">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="调试和分析工具概览.html" class="navigation navigation-next " aria-label="Next page: profiling和debugging工具相关">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"调试和分析记录1","level":"1.3.1.5","depth":3,"next":{"title":"profiling和debugging工具相关","level":"1.3.2","depth":2,"path":"notes/调试和分析工具概览.md","ref":"notes/调试和分析工具概览.md","articles":[{"title":"Linux内核调试的方式以及工具集锦(网摘)","level":"1.3.2.1","depth":3,"path":"notes/profiling_Linux内核调试的方式以及工具集锦.md","ref":"notes/profiling_Linux内核调试的方式以及工具集锦.md","articles":[]},{"title":"Ptrace, Utrace, Uprobes: Lightweight, Dynamic Tracing of User Apps","level":"1.3.2.2","depth":3,"path":"notes/profiling_user_space_Ptrace_Utrace_Uprobes.md","ref":"notes/profiling_user_space_Ptrace_Utrace_Uprobes.md","articles":[]},{"title":"gdb备忘录","level":"1.3.2.3","depth":3,"path":"notes/debugging_gdb备忘录.md","ref":"notes/debugging_gdb备忘录.md","articles":[]},{"title":"perf命令备忘录","level":"1.3.2.4","depth":3,"path":"notes/profiling_perf命令备忘录.md","ref":"notes/profiling_perf命令备忘录.md","articles":[]},{"title":"perf命令备忘录2","level":"1.3.2.5","depth":3,"path":"notes/profiling_perf命令备忘录2.md","ref":"notes/profiling_perf命令备忘录2.md","articles":[]},{"title":"perf学习笔记之实战篇","level":"1.3.2.6","depth":3,"path":"notes/profiling_perf学习笔记之实战篇.md","ref":"notes/profiling_perf学习笔记之实战篇.md","articles":[]},{"title":"perf学习笔记之入门篇","level":"1.3.2.7","depth":3,"path":"notes/profiling_perf学习笔记之入门篇.md","ref":"notes/profiling_perf学习笔记之入门篇.md","articles":[]},{"title":"ftrace和trace-cmd记录","level":"1.3.2.8","depth":3,"path":"notes/profiling_ftrace和trace-cmd记录.md","ref":"notes/profiling_ftrace和trace-cmd记录.md","articles":[]},{"title":"ftrace使用实例","level":"1.3.2.9","depth":3,"path":"notes/profiling_ftrace使用实例.md","ref":"notes/profiling_ftrace使用实例.md","articles":[]},{"title":"systemtap实例","level":"1.3.2.10","depth":3,"path":"notes/profiling_systemtap实例.md","ref":"notes/profiling_systemtap实例.md","articles":[]},{"title":"Comparing SystemTap and bpftrace(网摘)","level":"1.3.2.11","depth":3,"path":"notes/profiling_Comparing_SystemTap_and_bpftrace.md","ref":"notes/profiling_Comparing_SystemTap_and_bpftrace.md","articles":[]},{"title":"bcc和ebpf(starting)","level":"1.3.2.12","depth":3,"path":"notes/system_analysis_bcc和ebpf.md","ref":"notes/system_analysis_bcc和ebpf.md","articles":[]}]},"previous":{"title":"调试和分析记录2","level":"1.3.1.4","depth":3,"path":"notes/profiling_调试和分析记录2.md","ref":"notes/profiling_调试和分析记录2.md","articles":[]},"dir":"ltr"},"config":{"plugins":["-livereload","-sharing","-lunr","-search","search-plus","-highlight","theme-comscore","prism","code","chapter-fold","github","splitter","wide-page","hide-navigation-buttons","anchor-navigation-ex","sequence","mermaid-gb3"],"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"pluginsConfig":{"chapter-fold":{},"prism":{"css":["prismjs/themes/prism.css"],"ignore":["mermaid","sequence"]},"sequence":{"theme":"simple"},"github":{"url":"https://github.com/Bai-Yingjie/Bai-Yingjie.github.io"},"splitter":{},"wide-page":{},"code":{"copyButtons":true},"fontsettings":{"theme":"white","family":"sans","size":2},"hide-navigation-buttons":{},"mermaid-gb3":{},"anchor-navigation-ex":{"mode":"float","pageTop":{"level1Icon":"","level2Icon":"","level3Icon":"","showLevelIcon":false},"isRewritePageTitle":true,"showLevel":true,"tocLevel1Icon":"fa fa-hand-o-right","tocLevel2Icon":"fa fa-hand-o-right","tocLevel3Icon":"fa fa-hand-o-right","showGoTop":true,"isShowTocTitleIcon":true,"printLog":false,"multipleH1":true,"associatedWithSummary":true,"float":{"floatIcon":"fa fa-navicon","level1Icon":"","level2Icon":"","level3Icon":"","showLevelIcon":false}},"theme-comscore":{},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false},"search-plus":{}},"theme":"default","author":"Bai Yingjie","pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"variables":{},"title":"My Notes","language":"zh-hans","gitbook":"*"},"file":{"path":"notes/profiling_调试和分析记录1.md","mtime":"2022-10-21T16:44:34.000Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2022-10-21T16:45:38.319Z"},"basePath":"..","book":{"language":""}});
        });
    </script>
</div>

        
    
    <script src="../gitbook/gitbook.js"></script>
    <script src="../gitbook/theme.js"></script>
    
        
        <script src="../gitbook/gitbook-plugin-search-plus/jquery.mark.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search-plus/search.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-code/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-chapter-fold/chapter-fold.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-github/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-splitter/splitter.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-mermaid-gb3/book/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-theme-comscore/test.js"></script>
        
    

    <script src="../gitbook/gitbook-plugin-mermaid-gb3/mermaid/mermaid.min.js"></script>

    </body>
</html>

