
<!DOCTYPE HTML>
<html lang="zh-hans" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>Arm server 杂记 · My Notes</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        <meta name="author" content="Bai Yingjie">
        
        
    
    
    <link rel="stylesheet" href="../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-search-plus/search.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-prism/prism.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-code/plugin.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-chapter-fold/chapter-fold.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-splitter/splitter.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-wide-page/wide.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-hide-navigation-buttons/index.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-anchor-navigation-ex/style/plugin.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-mermaid-gb3/mermaid/mermaid.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-theme-comscore/test.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    


    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="as_title_embedded.html" />
    
    
    <link rel="prev" href="as_title_arm_server.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="输入并搜索" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../">
            
                <a href="../">
            
                    
                    简介
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="as_title_kaiyuan.html">
            
                <a href="as_title_kaiyuan.html">
            
                    
                    开源
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1" data-path="my_opensource.html">
            
                <a href="my_opensource.html">
            
                    
                    我的开源项目
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2" data-path="my_upstream.html">
            
                <a href="my_upstream.html">
            
                    
                    我的upstream commit
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="as_title_system.html">
            
                <a href="as_title_system.html">
            
                    
                    系统分析和性能
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1" data-path="as_title_perf_misc.html">
            
                <a href="as_title_perf_misc.html">
            
                    
                    调试和分析记录系列
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1.1" data-path="profiling_调试和分析记录5.html">
            
                <a href="profiling_调试和分析记录5.html">
            
                    
                    调试和分析记录5
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.1.2" data-path="profiling_调试和分析记录4.html">
            
                <a href="profiling_调试和分析记录4.html">
            
                    
                    调试和分析记录4
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.1.3" data-path="profiling_调试和分析记录3.html">
            
                <a href="profiling_调试和分析记录3.html">
            
                    
                    调试和分析记录3
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.1.4" data-path="profiling_调试和分析记录2.html">
            
                <a href="profiling_调试和分析记录2.html">
            
                    
                    调试和分析记录2
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.1.5" data-path="profiling_调试和分析记录1.html">
            
                <a href="profiling_调试和分析记录1.html">
            
                    
                    调试和分析记录1
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3.2" data-path="调试和分析工具概览.html">
            
                <a href="调试和分析工具概览.html">
            
                    
                    profiling和debugging工具相关
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.2.1" data-path="debugging_gdb备忘录.html">
            
                <a href="debugging_gdb备忘录.html">
            
                    
                    gdb备忘录
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2.2" data-path="profiling_perf命令备忘录.html">
            
                <a href="profiling_perf命令备忘录.html">
            
                    
                    perf命令备忘录
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2.3" data-path="profiling_perf命令备忘录2.html">
            
                <a href="profiling_perf命令备忘录2.html">
            
                    
                    perf命令备忘录2
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2.4" data-path="profiling_perf学习笔记之实战篇.html">
            
                <a href="profiling_perf学习笔记之实战篇.html">
            
                    
                    perf学习笔记之实战篇
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2.5" data-path="profiling_perf学习笔记之入门篇.html">
            
                <a href="profiling_perf学习笔记之入门篇.html">
            
                    
                    perf学习笔记之入门篇
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2.6" data-path="profiling_ftrace和trace-cmd记录.html">
            
                <a href="profiling_ftrace和trace-cmd记录.html">
            
                    
                    ftrace和trace-cmd记录
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2.7" data-path="profiling_ftrace使用实例.html">
            
                <a href="profiling_ftrace使用实例.html">
            
                    
                    ftrace使用实例
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2.8" data-path="profiling_systemtap实例.html">
            
                <a href="profiling_systemtap实例.html">
            
                    
                    systemtap实例
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2.9" data-path="profiling_Comparing_SystemTap_and_bpftrace.html">
            
                <a href="profiling_Comparing_SystemTap_and_bpftrace.html">
            
                    
                    Comparing SystemTap and bpftrace(网摘)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2.10" data-path="system_analysis_bcc和ebpf.html">
            
                <a href="system_analysis_bcc和ebpf.html">
            
                    
                    bcc和ebpf(starting)
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3.3" data-path="as_title_os_perf.html">
            
                <a href="as_title_os_perf.html">
            
                    
                    profiling和debugging实例
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.3.1" data-path="performance_ovs进程调查.html">
            
                <a href="performance_ovs进程调查.html">
            
                    
                    OVS进程调查
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3.2" data-path="performance_ping流程和函数调用解析.html">
            
                <a href="performance_ping流程和函数调用解析.html">
            
                    
                    ping流程和函数调用解析
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3.3" data-path="profiling_VM互相ping场景下的延迟分析.html">
            
                <a href="profiling_VM互相ping场景下的延迟分析.html">
            
                    
                    VM互相ping场景下的延迟分析
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3.4" data-path="debugging_ftrace_谁创建了bond0设备.html">
            
                <a href="debugging_ftrace_谁创建了bond0设备.html">
            
                    
                    谁创建了bond0设备: ftrace kprobe uprobe perf综合使用
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3.5" data-path="profiling_unixbench之filecopy分析.html">
            
                <a href="profiling_unixbench之filecopy分析.html">
            
                    
                    unixbench之file copy分析
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3.4" data-path="as_title_arch_perf.html">
            
                <a href="as_title_arch_perf.html">
            
                    
                    CPU ARCH相关
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.4.1" data-path="performance_CPU_microarchiteture_pmu.html">
            
                <a href="performance_CPU_microarchiteture_pmu.html">
            
                    
                    Top-down Microarchitecture Analysis Method(网摘)
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="as_title_cloud.html">
            
                <a href="as_title_cloud.html">
            
                    
                    Cloud和容器相关
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1" data-path="cloud_杂记.html">
            
                <a href="cloud_杂记.html">
            
                    
                    云杂记
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2" data-path="container_当代容器读书笔记.html">
            
                <a href="container_当代容器读书笔记.html">
            
                    
                    当代容器读书笔记
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="as_title_vdevice.html">
            
                <a href="as_title_vdevice.html">
            
                    
                    CPU和device虚拟化
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.1" data-path="as_title_gvisor.html">
            
                <a href="as_title_gvisor.html">
            
                    
                    gvisor
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.1.1" data-path="golang_gvisor代码_KVM.html">
            
                <a href="golang_gvisor代码_KVM.html">
            
                    
                    gvisor KVM模式代码
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.1.2" data-path="golang_gvisor调试.html">
            
                <a href="golang_gvisor调试.html">
            
                    
                    gvisor调试
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.1.3" data-path="golang_gvisor_ptrace.html">
            
                <a href="golang_gvisor_ptrace.html">
            
                    
                    gvisor ptrace模式介绍(网摘)
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5.2" data-path="rust_vmm_brief.html">
            
                <a href="rust_vmm_brief.html">
            
                    
                    rust VMM(virtual machine monitor)
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.2.1" data-path="rust_vmm_简介.html">
            
                <a href="rust_vmm_简介.html">
            
                    
                    rust-vmm简介
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2.2" data-path="rust_firecracker_代码.html">
            
                <a href="rust_firecracker_代码.html">
            
                    
                    firecracker代码
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2.3" data-path="rust_firecracker_使用.html">
            
                <a href="rust_firecracker_使用.html">
            
                    
                    firecracker使用
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2.4" data-path="rust_cloud-hypervisor_代码.html">
            
                <a href="rust_cloud-hypervisor_代码.html">
            
                    
                    cloud hypervisor代码
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2.5" data-path="rust_cloud-hypervisor_使用.html">
            
                <a href="rust_cloud-hypervisor_使用.html">
            
                    
                    cloud hypervisor使用
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2.6" data-path="rust_cloud-hypervisor_问题与解决.html">
            
                <a href="rust_cloud-hypervisor_问题与解决.html">
            
                    
                    cloud hypervisor问题与解决
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5.3" data-path="virtualization_virtio规范阅读笔记.html">
            
                <a href="virtualization_virtio规范阅读笔记.html">
            
                    
                    virtio规范阅读笔记.md
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.4" data-path="qemu_ovs_虚拟化环境.html">
            
                <a href="qemu_ovs_虚拟化环境.html">
            
                    
                    qemu OVS 虚拟化环境准备
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.5" data-path="qemu使用.html">
            
                <a href="qemu使用.html">
            
                    
                    Qemu使用(old)
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.6" data-path="as_title_networking.html">
            
                <a href="as_title_networking.html">
            
                    
                    计算机网络相关
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.6.1" data-path="networking_杂记1.html">
            
                <a href="networking_杂记1.html">
            
                    
                    networking杂记1
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.2" data-path="as_title_qemu_ovs.html">
            
                <a href="as_title_qemu_ovs.html">
            
                    
                    Qemu OVS和DPDK
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.6.2.1" data-path="OVS_DPDK_编译运行.html">
            
                <a href="OVS_DPDK_编译运行.html">
            
                    
                    OVS-DPDK编译运行
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.2.2" data-path="OVS_架构和代码.html">
            
                <a href="OVS_架构和代码.html">
            
                    
                    OVS架构和代码
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.2.3" data-path="OVS_DPDK_performance_HXT_ARM_server.html">
            
                <a href="OVS_DPDK_performance_HXT_ARM_server.html">
            
                    
                    OVS-DPDK for ARM server 性能测试环境
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.2.4" data-path="DPDK_Mellanox.html">
            
                <a href="DPDK_Mellanox.html">
            
                    
                    DPDK Mellanox
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.2.5" data-path="OVS_phy-vm-phy.html">
            
                <a href="OVS_phy-vm-phy.html">
            
                    
                    OVS PHY-VM-PHY
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.2.6" data-path="networking_网络虚拟化用例记录.html">
            
                <a href="networking_网络虚拟化用例记录.html">
            
                    
                    网络虚拟化用例记录
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.2.7" data-path="networking_网络虚拟化操作记录.html">
            
                <a href="networking_网络虚拟化操作记录.html">
            
                    
                    网络虚拟化操作记录
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.6.3" data-path="as_title_virtnet.html">
            
                <a href="as_title_virtnet.html">
            
                    
                    虚拟化网络
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.6.3.1" data-path="networking_tc_filter_连接veth和tap.html">
            
                <a href="networking_tc_filter_连接veth和tap.html">
            
                    
                    Connecting a veth device to tap
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.3.2" data-path="networking_multicast_vxlan_flannel.html">
            
                <a href="networking_multicast_vxlan_flannel.html">
            
                    
                    multicast vxlan和flannel
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.3.3" data-path="networking_virtio网络介绍.html">
            
                <a href="networking_virtio网络介绍.html">
            
                    
                    virtio网络介绍(网摘): vhost-net virtio-net vhost-user SRIOV
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.3.4" data-path="networking_virtualization_杂记.html">
            
                <a href="networking_virtualization_杂记.html">
            
                    
                    虚拟化网络杂记
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.3.5" data-path="networking_linux虚拟网络接口.html">
            
                <a href="networking_linux虚拟网络接口.html">
            
                    
                    linux虚拟网络接口(网摘)
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.7" data-path="as_title_arm_server.html">
            
                <a href="as_title_arm_server.html">
            
                    
                    ARM server
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter active" data-level="1.7.1" data-path="arm_server_杂记.html">
            
                <a href="arm_server_杂记.html">
            
                    
                    Arm server 杂记
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.8" data-path="as_title_embedded.html">
            
                <a href="as_title_embedded.html">
            
                    
                    嵌入式系统开发调试
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.8.1" data-path="embedded_debugging.html">
            
                <a href="embedded_debugging.html">
            
                    
                    嵌入式调试杂记
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.2" data-path="uboot_杂记.html">
            
                <a href="uboot_杂记.html">
            
                    
                    uboot杂记
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.3" data-path="buildroot_杂记.html">
            
                <a href="buildroot_杂记.html">
            
                    
                    buildroot杂记
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.4" data-path="toolchain_升级gcc问题解决.html">
            
                <a href="toolchain_升级gcc问题解决.html">
            
                    
                    升级GCC7.3问题解决
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.5" data-path="kernel_异常打印分析实例.html">
            
                <a href="kernel_异常打印分析实例.html">
            
                    
                    kernel bug异常打印分析
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.9" data-path="as_title_linuxdaily.html">
            
                <a href="as_title_linuxdaily.html">
            
                    
                    Linux工程实践
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.9.1" data-path="linux_日常使用.html">
            
                <a href="linux_日常使用.html">
            
                    
                    日常linux使用
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.2" data-path="git_日常使用.html">
            
                <a href="git_日常使用.html">
            
                    
                    日常git使用
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.3" data-path="向kernel提交补丁.html">
            
                <a href="向kernel提交补丁.html">
            
                    
                    向kernel提交补丁
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.4" data-path="linux_ssh_relay.html">
            
                <a href="linux_ssh_relay.html">
            
                    
                    ssh relay
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.5" data-path="gitlab_ci.html">
            
                <a href="gitlab_ci.html">
            
                    
                    gitlab CI
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.6" data-path="docker_操作记录.html">
            
                <a href="docker_操作记录.html">
            
                    
                    docker操作记录
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.7" data-path="centos_操作记录.html">
            
                <a href="centos_操作记录.html">
            
                    
                    centos操作记录
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.10" data-path="as_title_golang.html">
            
                <a href="as_title_golang.html">
            
                    
                    Golang
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.10.1" data-path="as_title_golang1.html">
            
                <a href="as_title_golang1.html">
            
                    
                    入门
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.10.1.1" data-path="golang_语法基础.html">
            
                <a href="golang_语法基础.html">
            
                    
                    Golang 语法基础
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.1.2" data-path="golang_json性能.html">
            
                <a href="golang_json性能.html">
            
                    
                    Golang json性能比较
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.10.2" data-path="golang_原理.html">
            
                <a href="golang_原理.html">
            
                    
                    Golang 原理相关
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.10.2.1" data-path="golang_interface原理.html">
            
                <a href="golang_interface原理.html">
            
                    
                    Golang interface原理(网摘)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.2.2" data-path="golang_内存分配.html">
            
                <a href="golang_内存分配.html">
            
                    
                    Golang 内存分配(网摘)
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.10.3" data-path="golang_标准库.html">
            
                <a href="golang_标准库.html">
            
                    
                    Golang 标准库
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.4" data-path="golang_我的反射代码.html">
            
                <a href="golang_我的反射代码.html">
            
                    
                    Golang 我的反射代码
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.5" data-path="golang_问答.html">
            
                <a href="golang_问答.html">
            
                    
                    Golang 问答
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.6" data-path="golang_高效go.html">
            
                <a href="golang_高效go.html">
            
                    
                    Golang 高效go
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.7" data-path="golang_进阶.html">
            
                <a href="golang_进阶.html">
            
                    
                    Golang 进阶
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.8" data-path="as_title_golang2.html">
            
                <a href="as_title_golang2.html">
            
                    
                    Golang 杂记
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.10.8.1" data-path="golang_杂记1.html">
            
                <a href="golang_杂记1.html">
            
                    
                    Golang 杂记1
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.8.2" data-path="golang_杂记2.html">
            
                <a href="golang_杂记2.html">
            
                    
                    Golang 杂记2
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.8.3" data-path="golang_杂记3.html">
            
                <a href="golang_杂记3.html">
            
                    
                    Golang 杂记3
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.8.4" data-path="golang_lib选型.html">
            
                <a href="golang_lib选型.html">
            
                    
                    Golang lib选型
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.8.5" data-path="golang_mod_proxy.html">
            
                <a href="golang_mod_proxy.html">
            
                    
                    go mod和go proxy
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.8.6" data-path="golang_汇编_arm64.html">
            
                <a href="golang_汇编_arm64.html">
            
                    
                    Golang 汇编语法和arm64小知识
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.8.7" data-path="golang_cgo_swig.html">
            
                <a href="golang_cgo_swig.html">
            
                    
                    go调用c可以用swig
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.10.9" data-path="as_title_golang3.html">
            
                <a href="as_title_golang3.html">
            
                    
                    Golang 环境和工具链生成
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.10.9.1" data-path="golang_toolchain_ppc.html">
            
                <a href="golang_toolchain_ppc.html">
            
                    
                    go tools增加ppc32支持.md
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.9.2" data-path="golang_toolchain_compile_gccgo.html">
            
                <a href="golang_toolchain_compile_gccgo.html">
            
                    
                    编译gccgo
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.9.3" data-path="golang_go_on_mips.html">
            
                <a href="golang_go_on_mips.html">
            
                    
                    go on mips boards(not so updated)
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.10.9.3.1" data-path="golang_go_on_mips_part1.html">
            
                <a href="golang_go_on_mips_part1.html">
            
                    
                    part 1: cross compile go
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.9.3.2" data-path="golang_go_on_mips_part2.html">
            
                <a href="golang_go_on_mips_part2.html">
            
                    
                    part 2: build native go compiler
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.9.3.3" data-path="golang_go_on_mips_part3.html">
            
                <a href="golang_go_on_mips_part3.html">
            
                    
                    part 3: gccgo experiments
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.9.3.4" data-path="golang_go_on_mips_part4.html">
            
                <a href="golang_go_on_mips_part4.html">
            
                    
                    part 4: Golang json performance
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.9.3.5" data-path="golang_gentoo_on_mips_board_and_build_go.html">
            
                <a href="golang_gentoo_on_mips_board_and_build_go.html">
            
                    
                    Gentoo on mips board and build go
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.10.10" data-path="as_title_golang4.html">
            
                <a href="as_title_golang4.html">
            
                    
                    微服务
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.10.10.1" data-path="golang_micro.html">
            
                <a href="golang_micro.html">
            
                    
                    go-micro和micro
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.10.2" data-path="golang_微服务概念.html">
            
                <a href="golang_微服务概念.html">
            
                    
                    微服务概念
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.10.11" data-path="as_title_golang5.html">
            
                <a href="as_title_golang5.html">
            
                    
                    解释器和编解码
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.10.11.1" data-path="golang_yeagi.html">
            
                <a href="golang_yeagi.html">
            
                    
                    解释器yeagi
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.11.2" data-path="golang_tengo.html">
            
                <a href="golang_tengo.html">
            
                    
                    解释器tengo
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.11.3" data-path="golang_govaluate.html">
            
                <a href="golang_govaluate.html">
            
                    
                    解释器govaluate
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.11.4" data-path="golang_encoding_gotiny.html">
            
                <a href="golang_encoding_gotiny.html">
            
                    
                    gotiny编解码
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.11.5" data-path="golang_abs.html">
            
                <a href="golang_abs.html">
            
                    
                    解释器abs
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.10.12" data-path="as_title_golang6.html">
            
                <a href="as_title_golang6.html">
            
                    
                    调试和性能
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.10.12.1" data-path="golang_调试记录.html">
            
                <a href="golang_调试记录.html">
            
                    
                    Golang 调试记录
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.12.2" data-path="golang_topid性能优化.html">
            
                <a href="golang_topid性能优化.html">
            
                    
                    Golang topid性能优化
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.12.3" data-path="golang_gshell性能调试.html">
            
                <a href="golang_gshell性能调试.html">
            
                    
                    Golang gshell性能调试
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.10.13" data-path="as_title_golang7.html">
            
                <a href="as_title_golang7.html">
            
                    
                    网络和消息中间件
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.10.13.1" data-path="golang_zmq.html">
            
                <a href="golang_zmq.html">
            
                    
                    消息中间件基本概念和zero mq
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.13.2" data-path="golang_mango.html">
            
                <a href="golang_mango.html">
            
                    
                    消息中间件mango
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.13.3" data-path="golang_libp2p.html">
            
                <a href="golang_libp2p.html">
            
                    
                    Golang p2p网络
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.11" data-path="as_title_rust.html">
            
                <a href="as_title_rust.html">
            
                    
                    Rust
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.11.1" data-path="rust_入门_brief.html">
            
                <a href="rust_入门_brief.html">
            
                    
                    Rust 入门系列
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.11.1.1" data-path="rust_books.html">
            
                <a href="rust_books.html">
            
                    
                    Rust reference books
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11.1.2" data-path="rust_入门1.html">
            
                <a href="rust_入门1.html">
            
                    
                    Rust 安装和基础语法
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11.1.3" data-path="rust_入门2.html">
            
                <a href="rust_入门2.html">
            
                    
                    Rust 泛型和内存所有权
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11.1.4" data-path="rust_入门3.html">
            
                <a href="rust_入门3.html">
            
                    
                    Rust 闭包 容器 迭代器 生成器 线程
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11.1.5" data-path="rust_工程构建.html">
            
                <a href="rust_工程构建.html">
            
                    
                    Rust 工程构建
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.11.2" data-path="rust_coding_brief.html">
            
                <a href="rust_coding_brief.html">
            
                    
                    Rust 代码积累
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.11.2.1" data-path="rust_序列化.html">
            
                <a href="rust_序列化.html">
            
                    
                    Rust 序列化原理
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11.2.2" data-path="rust_知识点积累.html">
            
                <a href="rust_知识点积累.html">
            
                    
                    Rust 知识点更新
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11.2.3" data-path="rust_adaptiveservice.html">
            
                <a href="rust_adaptiveservice.html">
            
                    
                    rust版本的adaptiveservice探索
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11.2.4" data-path="rust_常用设施.html">
            
                <a href="rust_常用设施.html">
            
                    
                    Rust 常用设施
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11.2.5" data-path="rust_代码小段.html">
            
                <a href="rust_代码小段.html">
            
                    
                    Rust 代码小段
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.11.3" data-path="others.html">
            
                <a href="others.html">
            
                    
                    其他
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.11.3.1" data-path="rust_mdbook_使用.html">
            
                <a href="rust_mdbook_使用.html">
            
                    
                    Rust 使用mdbook
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.12" data-path="as_title_scripts.html">
            
                <a href="as_title_scripts.html">
            
                    
                    脚本
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.12.1" data-path="shell_变量.html">
            
                <a href="shell_变量.html">
            
                    
                    shell变量
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.2" data-path="shell_基础篇.html">
            
                <a href="shell_基础篇.html">
            
                    
                    shell命令和脚本记录-基础篇
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.3" data-path="shell_高级篇.html">
            
                <a href="shell_高级篇.html">
            
                    
                    shell命令和脚本记录-高级篇
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.4" data-path="shell_脚本片段.html">
            
                <a href="shell_脚本片段.html">
            
                    
                    shell脚本片段
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.5" data-path="python_记录.html">
            
                <a href="python_记录.html">
            
                    
                    python记录
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.6" data-path="lua_记录.html">
            
                <a href="lua_记录.html">
            
                    
                    lua记录
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.7" data-path="shell_rds脚本阅读.html">
            
                <a href="shell_rds脚本阅读.html">
            
                    
                    RDS脚本阅读
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.8" data-path="Project_Euler.html">
            
                <a href="Project_Euler.html">
            
                    
                    Project Euler
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.13" data-path="as_title_app.html">
            
                <a href="as_title_app.html">
            
                    
                    应用相关
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.13.1" data-path="app_sysbench代码分析.html">
            
                <a href="app_sysbench代码分析.html">
            
                    
                    sysbench代码分析
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.14" data-path="as_title_cos.html">
            
                <a href="as_title_cos.html">
            
                    
                    C和Operating System
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.14.1" data-path="system_libc_part1.html">
            
                <a href="system_libc_part1.html">
            
                    
                    libc概览1
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.14.2" data-path="system_libc_part2.html">
            
                <a href="system_libc_part2.html">
            
                    
                    libc概览2
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.14.3" data-path="system_libc_part3.html">
            
                <a href="system_libc_part3.html">
            
                    
                    libc概览3
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.14.4" data-path="system_原理杂记.html">
            
                <a href="system_原理杂记.html">
            
                    
                    系统原理杂记
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.14.5" data-path="system_alpine.html">
            
                <a href="system_alpine.html">
            
                    
                    Alpine Linux
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.14.6" data-path="system_进程间通信.html">
            
                <a href="system_进程间通信.html">
            
                    
                    进程间通信
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.14.7" data-path="system_特殊功能fd.html">
            
                <a href="system_特殊功能fd.html">
            
                    
                    eventfd timerfd signalfd和fd共享
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.14.8" data-path="c_automake_autoconf.html">
            
                <a href="c_automake_autoconf.html">
            
                    
                    automake autoconf
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.14.9" data-path="makefile_原理和实践.html">
            
                <a href="makefile_原理和实践.html">
            
                    
                    makefile
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.14.10" data-path="c_编程杂记高级篇.html">
            
                <a href="c_编程杂记高级篇.html">
            
                    
                    C编程杂记高级篇
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.14.11" data-path="c_编程杂记基础篇.html">
            
                <a href="c_编程杂记基础篇.html">
            
                    
                    C编程杂记基础篇
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.14.12" data-path="c_networking_socket高阶用法.html">
            
                <a href="c_networking_socket高阶用法.html">
            
                    
                    网络编程: Advanced Socket Topics(网摘)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.14.13" data-path="c_protobuf介绍.html">
            
                <a href="c_protobuf介绍.html">
            
                    
                    序列化: protobuf介绍
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.14.14" data-path="c_进程间通信_共享文件和共享内存.html">
            
                <a href="c_进程间通信_共享文件和共享内存.html">
            
                    
                    进程间通信: 共享文件和共享内存(网摘)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.14.15" data-path="c_pthread_condition和mutex.html">
            
                <a href="c_pthread_condition和mutex.html">
            
                    
                    并发 任务 事件 和锁.md
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.14.16" data-path="kernel_user_space_howto.html">
            
                <a href="kernel_user_space_howto.html">
            
                    
                    kernel space和user space交互(网摘, linux2.6)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.14.17" data-path="CentOS_系统性能优化配置.html">
            
                <a href="CentOS_系统性能优化配置.html">
            
                    
                    CentOS 性能优化系统配置
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.15" data-path="as_title_driver.html">
            
                <a href="as_title_driver.html">
            
                    
                    内核 设备和驱动相关
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.15.1" data-path="platform_device_driver.html">
            
                <a href="platform_device_driver.html">
            
                    
                    平台驱动杂记
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.15.2" data-path="device_driver_杂记.html">
            
                <a href="device_driver_杂记.html">
            
                    
                    驱动调试杂记
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.15.3" data-path="device_localbus_16bit读写.html">
            
                <a href="device_localbus_16bit读写.html">
            
                    
                    CPLD做8bit到16bit转换
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.15.4" data-path="as_title_driver1.html">
            
                <a href="as_title_driver1.html">
            
                    
                    nand
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.15.4.1" data-path="device_driver_octeon_nand.html">
            
                <a href="device_driver_octeon_nand.html">
            
                    
                    octeon nand flash驱动
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.15.4.2" data-path="device_driver_nand概率写失败问题分析.html">
            
                <a href="device_driver_nand概率写失败问题分析.html">
            
                    
                    Nand flash概率写失败问题分析
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.15.5" data-path="octeon_remote_pci.html">
            
                <a href="octeon_remote_pci.html">
            
                    
                    octeon remote-pci.c阅读
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.15.6" data-path="Device_VFIO_notes.html">
            
                <a href="Device_VFIO_notes.html">
            
                    
                    VFIO简介
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.15.7" data-path="as_title_driver2.html">
            
                <a href="as_title_driver2.html">
            
                    
                    智能网卡和DPDK
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.15.7.1" data-path="smartNIC_智能网卡对比.html">
            
                <a href="smartNIC_智能网卡对比.html">
            
                    
                    智能网卡对比
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.15.7.2" data-path="octeon_pci_NIC.html">
            
                <a href="octeon_pci_NIC.html">
            
                    
                    octeon PCI NIC
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.15.7.3" data-path="as_title_driver3.html">
            
                <a href="as_title_driver3.html">
            
                    
                    octeon liquidIO
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.15.7.3.1" data-path="smartNIC_liquidIO_代码阅读app篇.html">
            
                <a href="smartNIC_liquidIO_代码阅读app篇.html">
            
                    
                    PCI-NIC 代码阅读 --app篇
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.15.7.3.2" data-path="smartNIC_liquidIO_代码阅读api篇.html">
            
                <a href="smartNIC_liquidIO_代码阅读api篇.html">
            
                    
                    PCI-NIC 代码阅读 --api篇
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.15.7.3.3" data-path="smartNIC_liquidIO_代码阅读driver篇之结构体.html">
            
                <a href="smartNIC_liquidIO_代码阅读driver篇之结构体.html">
            
                    
                    PCI-NIC 代码阅读 --driver篇之结构体
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.15.7.3.4" data-path="smartNIC_liquidIO_代码阅读driver篇.html">
            
                <a href="smartNIC_liquidIO_代码阅读driver篇.html">
            
                    
                    PCI-NIC 代码阅读 --driver篇
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.15.7.3.5" data-path="smartNIC_liquidIO_代码阅读真NIC篇.html">
            
                <a href="smartNIC_liquidIO_代码阅读真NIC篇.html">
            
                    
                    PCI-NIC 代码阅读 --真NIC篇
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.15.7.4" data-path="networking_dpdk使用_2014.html">
            
                <a href="networking_dpdk使用_2014.html">
            
                    
                    DPDK使用(2014)
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.15.8" data-path="device_nvme要点介绍.html">
            
                <a href="device_nvme要点介绍.html">
            
                    
                    nvme要点介绍
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.16" data-path="as_title_cpu.html">
            
                <a href="as_title_cpu.html">
            
                    
                    CPU Arch相关
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.16.1" data-path="cache_CPU和cache一致性原理.html">
            
                <a href="cache_CPU和cache一致性原理.html">
            
                    
                    CPU和cache一致性原理
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.16.2" data-path="as_title_cpu1.html">
            
                <a href="as_title_cpu1.html">
            
                    
                    ARM64
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.16.2.1" data-path="CPU_ARM64_thunder_overview.html">
            
                <a href="CPU_ARM64_thunder_overview.html">
            
                    
                    thunder 概览
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.16.2.2" data-path="CPU_ARM64_thunder_开发板操作记录.html">
            
                <a href="CPU_ARM64_thunder_开发板操作记录.html">
            
                    
                    thunder 开发板操作记录
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.16.2.3" data-path="CPU_ARM64_thunder_bdk.html">
            
                <a href="CPU_ARM64_thunder_bdk.html">
            
                    
                    thunder BDK
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.16.2.4" data-path="CPU_ARM64_thunder_efi_rtc.html">
            
                <a href="CPU_ARM64_thunder_efi_rtc.html">
            
                    
                    thunder RTC时间和efi
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.16.2.5" data-path="CPU_ARM64_thunder_uefi_fdt.html">
            
                <a href="CPU_ARM64_thunder_uefi_fdt.html">
            
                    
                    thunder uefi和fdt
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.16.2.6" data-path="CPU_ARM64_thunder_atf.html">
            
                <a href="CPU_ARM64_thunder_atf.html">
            
                    
                    thunder atf
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.16.2.7" data-path="CPU_ARM64_thunder_kernel_boot.html">
            
                <a href="CPU_ARM64_thunder_kernel_boot.html">
            
                    
                    thunder kernel启动打印流程
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.16.3" data-path="as_title_cpu2.html">
            
                <a href="as_title_cpu2.html">
            
                    
                    PPC
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.16.3.1" data-path="CPU_PPC启动多核Linux_流程和内存映射.html">
            
                <a href="CPU_PPC启动多核Linux_流程和内存映射.html">
            
                    
                    PPC启动多核linux: 流程和内存映射
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.16.3.2" data-path="CPU_PPC_kernel升级记录.html">
            
                <a href="CPU_PPC_kernel升级记录.html">
            
                    
                    PPC kernel升级记录
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.16.4" data-path="as_title_cpu3.html">
            
                <a href="as_title_cpu3.html">
            
                    
                    MIPS
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.16.4.1" data-path="CPU_MIPS_octeon地址空间和寄存器访问.html">
            
                <a href="CPU_MIPS_octeon地址空间和寄存器访问.html">
            
                    
                    octeon 地址空间和寄存器访问
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.16.4.2" data-path="CPU_MIPS_octeon操作记录.html">
            
                <a href="CPU_MIPS_octeon操作记录.html">
            
                    
                    octeon 操作记录
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.16.4.3" data-path="CPU_MIPS_octeon_包处理性能.html">
            
                <a href="CPU_MIPS_octeon_包处理性能.html">
            
                    
                    octeon 系列处理器包处理性能
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.16.4.4" data-path="CPU_MIPS_octeon_ddr调试记录.html">
            
                <a href="CPU_MIPS_octeon_ddr调试记录.html">
            
                    
                    octeon DDR调试
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.16.4.5" data-path="CPU_MIPS_octeon_BDK.html">
            
                <a href="CPU_MIPS_octeon_BDK.html">
            
                    
                    octeon CN78xx BDK
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.16.4.6" data-path="kernel_增加ECC中断.html">
            
                <a href="kernel_增加ECC中断.html">
            
                    
                    octeon 增加ECC中断
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.16.4.7" data-path="CPU_MIPS_octeon_hw-ddr2代码走读.html">
            
                <a href="CPU_MIPS_octeon_hw-ddr2代码走读.html">
            
                    
                    octeon hw-ddr2代码走读
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.16.4.8" data-path="CPU_MIPS_octeon_reboot调试和ddr中断.html">
            
                <a href="CPU_MIPS_octeon_reboot调试和ddr中断.html">
            
                    
                    octeon reboot调试和DDR中断
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.16.4.9" data-path="CPU_MIPS_octeon中断.html">
            
                <a href="CPU_MIPS_octeon中断.html">
            
                    
                    octeon 中断
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.16.4.10" data-path="CPU_MIPS_octeon原子操作.html">
            
                <a href="CPU_MIPS_octeon原子操作.html">
            
                    
                    octeon 原子操作
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.16.4.11" data-path="CPU_MIPS_octeon网口代码分析.html">
            
                <a href="CPU_MIPS_octeon网口代码分析.html">
            
                    
                    octeon 网口代码分析
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            本书使用 GitBook 发布
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".." >Arm server 杂记</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div class="search-plus" id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <div id="anchor-navigation-ex-navbar"><i class="fa fa-navicon"></i><ul><li><span class="title-icon "></span><a href="#ali-support"><b>1. </b>Ali support</a></li><ul><li><span class="title-icon "></span><a href="#char&#x7C7B;&#x578B;&#x5728;arm&#x548C;x86&#x4E0A;&#x4E0D;&#x4E00;&#x6837;"><b>1.1. </b>char&#x7C7B;&#x578B;&#x5728;arm&#x548C;x86&#x4E0A;&#x4E0D;&#x4E00;&#x6837;</a></li><li><span class="title-icon "></span><a href="#&#x9AD8;&#x7CBE;&#x5EA6;&#x65F6;&#x949F;"><b>1.2. </b>&#x9AD8;&#x7CBE;&#x5EA6;&#x65F6;&#x949F;</a></li><li><span class="title-icon "></span><a href="#io&#x4F18;&#x5316;"><b>1.3. </b>io&#x4F18;&#x5316;</a></li><li><span class="title-icon "></span><a href="#openssl"><b>1.4. </b>openssl</a></li><li><span class="title-icon "></span><a href="#ccpi-lattency"><b>1.5. </b>CCPI lattency</a></li><li><span class="title-icon "></span><a href="#specint-2006"><b>1.6. </b>specint 2006</a></li><li><span class="title-icon "></span><a href="#kernel-&#x6D4B;&#x8BD5;"><b>1.7. </b>kernel &#x6D4B;&#x8BD5;</a></li><li><span class="title-icon "></span><a href="#perf-frontend-backend-stall-from-arm"><b>1.8. </b>perf frontend backend stall from ARM</a></li><li><span class="title-icon "></span><a href="#streamline-from-arm"><b>1.9. </b>streamline from ARM</a></li><li><span class="title-icon "></span><a href="#qemu&#x5982;&#x4F55;&#x8FDB;&#x5165;monitor&#x547D;&#x4EE4;&#x884C;"><b>1.10. </b>qemu&#x5982;&#x4F55;&#x8FDB;&#x5165;monitor&#x547D;&#x4EE4;&#x884C;</a></li><li><span class="title-icon "></span><a href="#&#x66F4;&#x65B0;grub"><b>1.11. </b>&#x66F4;&#x65B0;grub</a></li><li><span class="title-icon "></span><a href="#docker"><b>1.12. </b>docker</a></li><li><span class="title-icon "></span><a href="#kernel-team&#x7684;&#x95EE;&#x9898;"><b>1.13. </b>kernel team&#x7684;&#x95EE;&#x9898;</a></li><ul><li><span class="title-icon "></span><a href="#&#x95EE;&#x9898;"><b>1.13.1. </b>&#x95EE;&#x9898;</a></li><li><span class="title-icon "></span><a href="#&#x56DE;&#x7B54;"><b>1.13.2. </b>&#x56DE;&#x7B54;</a></li></ul><li><span class="title-icon "></span><a href="#pxe&#x8C03;&#x8BD5;"><b>1.14. </b>PXE&#x8C03;&#x8BD5;</a></li><li><span class="title-icon "></span><a href="#driver&#x8C03;&#x8BD5;&#x624B;&#x6BB5;&#x4E4B;trace"><b>1.15. </b>driver&#x8C03;&#x8BD5;&#x624B;&#x6BB5;&#x4E4B;trace</a></li><li><span class="title-icon "></span><a href="#ssh&#x914D;&#x7F6E;&#x6587;&#x4EF6;"><b>1.16. </b>ssh&#x914D;&#x7F6E;&#x6587;&#x4EF6;</a></li><li><span class="title-icon "></span><a href="#efi-grub-&#x548C;-grubcfg"><b>1.17. </b>efi grub &#x548C; grub.cfg</a></li><li><span class="title-icon "></span><a href="#&#x51E0;&#x4F55;&#x5E73;&#x5747;&#x6570;&#x548C;&#x7B97;&#x6570;&#x5E73;&#x5747;&#x6570;"><b>1.18. </b>&#x51E0;&#x4F55;&#x5E73;&#x5747;&#x6570;&#x548C;&#x7B97;&#x6570;&#x5E73;&#x5747;&#x6570;</a></li><li><span class="title-icon "></span><a href="#kernel&#x8865;&#x4E01;"><b>1.19. </b>kernel&#x8865;&#x4E01;</a></li><li><span class="title-icon "></span><a href="#&#x7ED9;alibaba&#x63D0;&#x52A8;kernel&#x8865;&#x4E01;&#x7684;&#x8FC7;&#x7A0B;"><b>1.20. </b>&#x7ED9;alibaba&#x63D0;&#x52A8;kernel&#x8865;&#x4E01;&#x7684;&#x8FC7;&#x7A0B;</a></li><li><span class="title-icon "></span><a href="#&#x542F;&#x52A8;&#x65F6;&#x52A0;&#x6A21;&#x5757;&#x7684;&#x53C2;&#x6570;"><b>1.21. </b>&#x542F;&#x52A8;&#x65F6;&#x52A0;&#x6A21;&#x5757;&#x7684;&#x53C2;&#x6570;</a></li><li><span class="title-icon "></span><a href="#ssd&#x7684;strim&#x662F;&#x4EC0;&#x4E48;&#x4E1C;&#x4E1C;-discard-fstrimdiscard"><b>1.22. </b>ssd&#x7684;strim&#x662F;&#x4EC0;&#x4E48;&#x4E1C;&#x4E1C;? discard? Fstrim/discard</a></li><li><span class="title-icon "></span><a href="#&#x8C03;&#x8BD5;rds-tps&#x53D8;&#x4E3A;0&#x7684;&#x95EE;&#x9898;"><b>1.23. </b>&#x8C03;&#x8BD5;RDS tps&#x53D8;&#x4E3A;0&#x7684;&#x95EE;&#x9898;</a></li><li><span class="title-icon "></span><a href="#&#x7F51;&#x53E3;&#x8BA8;&#x8BBA;-&#x5173;&#x4E8E;&#x7F51;&#x7EDC;&#x5904;&#x7406;&#x7684;&#x57FA;&#x672C;&#x6D41;&#x7A0B;&#x548C;&#x6982;&#x5FF5;"><b>1.24. </b>&#x7F51;&#x53E3;&#x8BA8;&#x8BBA; &#x5173;&#x4E8E;&#x7F51;&#x7EDC;&#x5904;&#x7406;&#x7684;&#x57FA;&#x672C;&#x6D41;&#x7A0B;&#x548C;&#x6982;&#x5FF5;</a></li><li><span class="title-icon "></span><a href="#&#x7F16;&#x8BD1;&#x6A21;&#x5757;&#x7684;kernel&#x901A;&#x7528;&#x8DEF;&#x5F84;"><b>1.25. </b>&#x7F16;&#x8BD1;&#x6A21;&#x5757;&#x7684;kernel&#x901A;&#x7528;&#x8DEF;&#x5F84;</a></li><li><span class="title-icon "></span><a href="#&#x901A;&#x8FC7;&#x5176;&#x4ED6;&#x673A;&#x5668;&#x4E0A;&#x5916;&#x7F51;"><b>1.26. </b>&#x901A;&#x8FC7;&#x5176;&#x4ED6;&#x673A;&#x5668;&#x4E0A;&#x5916;&#x7F51;</a></li><li><span class="title-icon "></span><a href="#&#x89E3;&#x51B3;polkitd&#x7684;&#x95EE;&#x9898;"><b>1.27. </b>&#x89E3;&#x51B3;polkitd&#x7684;&#x95EE;&#x9898;</a></li><li><span class="title-icon "></span><a href="#sysbench&#x91CC;&#x9762;&#x968F;&#x673A;&#x51FD;&#x6570;lrand48&#x95EE;&#x9898;"><b>1.28. </b>sysbench&#x91CC;&#x9762;&#x968F;&#x673A;&#x51FD;&#x6570;lrand48&#x95EE;&#x9898;</a></li><li><span class="title-icon "></span><a href="#ssh-keepalive"><b>1.29. </b>ssh keepalive</a></li><li><span class="title-icon "></span><a href="#git&#x751F;&#x6210;patch"><b>1.30. </b>git&#x751F;&#x6210;patch</a></li><li><span class="title-icon "></span><a href="#&#x6DFB;&#x52A0;&#x548C;&#x5220;&#x9664;&#x7F51;&#x5173;"><b>1.31. </b>&#x6DFB;&#x52A0;&#x548C;&#x5220;&#x9664;&#x7F51;&#x5173;</a></li><li><span class="title-icon "></span><a href="#&#x4E00;&#x6B21;&#x6027;top"><b>1.32. </b>&#x4E00;&#x6B21;&#x6027;top</a></li><li><span class="title-icon "></span><a href="#coredump"><b>1.33. </b>coredump</a></li><li><span class="title-icon "></span><a href="#&#x5728;thunder&#x4E0A;&#x7684;sysdig-&#x597D;&#x50CF;&#x7528;&#x4E0D;&#x8D77;&#x6765;"><b>1.34. </b>&#x5728;thunder&#x4E0A;&#x7684;sysdig &#x597D;&#x50CF;&#x7528;&#x4E0D;&#x8D77;&#x6765;...</a></li><li><span class="title-icon "></span><a href="#sysdig&#x521D;&#x4F53;&#x9A8C;"><b>1.35. </b>sysdig&#x521D;&#x4F53;&#x9A8C;</a></li><li><span class="title-icon "></span><a href="#ulimit&#x8FDB;&#x7A0B;&#x6570;&#x9650;&#x5236;"><b>1.36. </b>ulimit&#x8FDB;&#x7A0B;&#x6570;&#x9650;&#x5236;</a></li><li><span class="title-icon "></span><a href="#&#x5728;thunder&#x4E0A;&#x505A;&#x76D8;"><b>1.37. </b>&#x5728;thunder&#x4E0A;&#x505A;&#x76D8;</a></li><li><span class="title-icon "></span><a href="#rtc&#x65F6;&#x95F4;"><b>1.38. </b>rtc&#x65F6;&#x95F4;</a></li><li><span class="title-icon "></span><a href="#sata-slow-sync&#x95EE;&#x9898;"><b>1.39. </b>SATA slow sync&#x95EE;&#x9898;</a></li><li><span class="title-icon "></span><a href="#&#x4F7F;&#x7528;native-gcc&#x7684;&#x53D8;&#x91CF;&#x8BBE;&#x7F6E;"><b>1.40. </b>&#x4F7F;&#x7528;native gcc&#x7684;&#x53D8;&#x91CF;&#x8BBE;&#x7F6E;</a></li><li><span class="title-icon "></span><a href="#smpaffinity&#x548C;rpscpus"><b>1.41. </b>smp_affinity&#x548C;rps_cpus</a></li><li><span class="title-icon "></span><a href="#mysql&#x8C03;&#x8BD5;&#x65B9;&#x6CD5;&#x8BBA;&#x4E4B;&#x5404;&#x79CD;&#x8C03;&#x8BD5;&#x548C;&#x68C0;&#x6D4B;&#x547D;&#x4EE4;"><b>1.42. </b>mysql&#x8C03;&#x8BD5;&#x65B9;&#x6CD5;&#x8BBA;&#x4E4B;&#x5404;&#x79CD;&#x8C03;&#x8BD5;&#x548C;&#x68C0;&#x6D4B;&#x547D;&#x4EE4;</a></li><li><span class="title-icon "></span><a href="#mysql&#x6027;&#x80FD;&#x63D0;&#x5347;&#x4E4B;&#x7F51;&#x53E3;&#x4E2D;&#x65AD;"><b>1.43. </b>mysql&#x6027;&#x80FD;&#x63D0;&#x5347;&#x4E4B;&#x7F51;&#x53E3;&#x4E2D;&#x65AD;</a></li><li><span class="title-icon "></span><a href="#&#x89E3;&#x51B3;sync-flood&#x95EE;&#x9898;"><b>1.44. </b>&#x89E3;&#x51B3;sync flood&#x95EE;&#x9898;</a></li><li><span class="title-icon "></span><a href="#mysql&#x8C03;&#x4F18;&#x4E4B;&#x74F6;&#x9888;&#x5728;&#x54EA;-&#x7406;&#x8BBA;"><b>1.45. </b>mysql&#x8C03;&#x4F18;&#x4E4B;&#x74F6;&#x9888;&#x5728;&#x54EA;? &#x7406;&#x8BBA;</a></li><li><span class="title-icon "></span><a href="#mysql&#x8C03;&#x4F18;&#x4E4B;innodbspinwaitdelay--30"><b>1.46. </b>mysql&#x8C03;&#x4F18;&#x4E4B;innodb_spin_wait_delay = 30</a></li><li><span class="title-icon "></span><a href="#memcpy&#x548C;strcpy"><b>1.47. </b>memcpy&#x548C;strcpy</a></li><li><span class="title-icon "></span><a href="#perf&#x8C03;&#x8BD5;&#x5355;&#x8FDB;&#x7A0B;-&#x8C03;&#x7528;&#x6808;"><b>1.48. </b>perf&#x8C03;&#x8BD5;&#x5355;&#x8FDB;&#x7A0B;, &#x8C03;&#x7528;&#x6808;?</a></li><li><span class="title-icon "></span><a href="#numactl"><b>1.49. </b>numactl</a></li><li><span class="title-icon "></span><a href="#&#x9884;&#x53D6;-prefetch"><b>1.50. </b>&#x9884;&#x53D6; prefetch</a></li><li><span class="title-icon "></span><a href="#gdb&#x8C03;&#x8BD5;&#x591A;&#x8FDB;&#x7A0B;"><b>1.51. </b>gdb&#x8C03;&#x8BD5;&#x591A;&#x8FDB;&#x7A0B;</a></li><li><span class="title-icon "></span><a href="#aj-kernel-git&#x6362;remote"><b>1.52. </b>aj kernel git&#x6362;remote?</a></li><li><span class="title-icon "></span><a href="#&#x4EA4;&#x53C9;&#x7F16;&#x8BD1;kernel"><b>1.53. </b>&#x4EA4;&#x53C9;&#x7F16;&#x8BD1;kernel</a></li><li><span class="title-icon "></span><a href="#pssh&#x53EF;&#x4EE5;&#x5728;&#x591A;&#x4E2A;&#x673A;&#x5668;&#x540C;&#x65F6;&#x6267;&#x884C;&#x547D;&#x4EE4;"><b>1.54. </b>pssh&#x53EF;&#x4EE5;&#x5728;&#x591A;&#x4E2A;&#x673A;&#x5668;&#x540C;&#x65F6;&#x6267;&#x884C;&#x547D;&#x4EE4;</a></li><li><span class="title-icon "></span><a href="#ssh&#x514D;&#x5BC6;&#x7801;&#x767B;&#x5F55;"><b>1.55. </b>ssh&#x514D;&#x5BC6;&#x7801;&#x767B;&#x5F55;</a></li><li><span class="title-icon "></span><a href="#ssh&#x8FDC;&#x7A0B;&#x6267;&#x884C;&#x547D;&#x4EE4;"><b>1.56. </b>ssh&#x8FDC;&#x7A0B;&#x6267;&#x884C;&#x547D;&#x4EE4;</a></li><li><span class="title-icon "></span><a href="#cpu-offline-&#x52A8;&#x6001;"><b>1.57. </b>cpu offline &#x52A8;&#x6001;</a></li><li><span class="title-icon "></span><a href="#dd&#x539F;&#x7406;-&#x6BCF;&#x4E2A;&#x5B57;&#x8282;&#x90FD;&#x88AB;&#x590D;&#x5236;"><b>1.58. </b>dd&#x539F;&#x7406; &#x6BCF;&#x4E2A;&#x5B57;&#x8282;&#x90FD;&#x88AB;&#x590D;&#x5236;</a></li><li><span class="title-icon "></span><a href="#uuid&#x542F;&#x52A8;-&#x4E0D;&#x7528;sda-sdb"><b>1.59. </b>UUID&#x542F;&#x52A8; &#x4E0D;&#x7528;sda sdb</a></li><li><span class="title-icon "></span><a href="#&#x91CD;&#x505A;fedora"><b>1.60. </b>&#x91CD;&#x505A;fedora</a></li><li><span class="title-icon "></span><a href="#fedora&#x7F51;&#x53E3;&#x914D;&#x7F6E;"><b>1.61. </b>fedora&#x7F51;&#x53E3;&#x914D;&#x7F6E;</a></li><li><span class="title-icon "></span><a href="#&#x67E5;&#x770B;10&#x53F0;&#x7CFB;&#x7EDF;&#x662F;&#x5426;online"><b>1.62. </b>&#x67E5;&#x770B;10&#x53F0;&#x7CFB;&#x7EDF;&#x662F;&#x5426;online</a></li><li><span class="title-icon "></span><a href="#check-cpld-&#x7248;&#x672C;"><b>1.63. </b>check cpld &#x7248;&#x672C;</a></li><li><span class="title-icon "></span><a href="#&#x5199;mac&#x5730;&#x5740;"><b>1.64. </b>&#x5199;mac&#x5730;&#x5740;</a></li><li><span class="title-icon "></span><a href="#&#x7F16;&#x8BD1;gcc"><b>1.65. </b>&#x7F16;&#x8BD1;gcc</a></li><li><span class="title-icon "></span><a href="#96&#x4E2A;&#x6838;&#x7684;&#x5F02;&#x5E38;&#x95EE;&#x9898;"><b>1.66. </b>96&#x4E2A;&#x6838;&#x7684;&#x5F02;&#x5E38;&#x95EE;&#x9898;</a></li><li><span class="title-icon "></span><a href="#&#x5173;&#x4E8E;rpscpus"><b>1.67. </b>&#x5173;&#x4E8E;rps_cpus</a></li><li><span class="title-icon "></span><a href="#xpscpu"><b>1.68. </b>xps_cpu</a></li><li><span class="title-icon "></span><a href="#&#x7F51;&#x7EDC;&#x65F6;&#x95F4;"><b>1.69. </b>&#x7F51;&#x7EDC;&#x65F6;&#x95F4;</a></li><li><span class="title-icon "></span><a href="#irq&#x7ED1;&#x5B9A;"><b>1.70. </b>irq&#x7ED1;&#x5B9A;</a></li><li><span class="title-icon "></span><a href="#tubo&#x9519;&#x8BEF;&#x5206;&#x6790;"><b>1.71. </b>tubo&#x9519;&#x8BEF;&#x5206;&#x6790;</a></li><li><span class="title-icon "></span><a href="#ethtool&#x53EF;&#x4EE5;&#x914D;&#x7F6E;&#x9A71;&#x52A8;"><b>1.72. </b>ethtool&#x53EF;&#x4EE5;&#x914D;&#x7F6E;&#x9A71;&#x52A8;</a></li><li><span class="title-icon "></span><a href="#&#x4E3A;&#x4EC0;&#x4E48;ulimit--n&#x7684;&#x503C;&#x4E0D;&#x80FD;&#x6539;"><b>1.73. </b>&#x4E3A;&#x4EC0;&#x4E48;ulimit -n&#x7684;&#x503C;&#x4E0D;&#x80FD;&#x6539;?</a></li><li><span class="title-icon "></span><a href="#atomic&#x89E3;&#x51B3;mysql&#x5D29;&#x6E83;&#x95EE;&#x9898;-weak-order"><b>1.74. </b>atomic&#x89E3;&#x51B3;mysql&#x5D29;&#x6E83;&#x95EE;&#x9898;, weak order</a></li></ul></ul></div><a href="#ali-support" id="anchorNavigationExGoTop"><i class="fa fa-arrow-up"></i></a><ul>
<li><a href="#ali-support">Ali support</a><ul>
<li><a href="#char&#x7C7B;&#x578B;&#x5728;arm&#x548C;x86&#x4E0A;&#x4E0D;&#x4E00;&#x6837;">char&#x7C7B;&#x578B;&#x5728;arm&#x548C;x86&#x4E0A;&#x4E0D;&#x4E00;&#x6837;</a></li>
<li><a href="#&#x9AD8;&#x7CBE;&#x5EA6;&#x65F6;&#x949F;">&#x9AD8;&#x7CBE;&#x5EA6;&#x65F6;&#x949F;</a></li>
<li><a href="#io&#x4F18;&#x5316;">io&#x4F18;&#x5316;</a></li>
<li><a href="#openssl">openssl</a></li>
<li><a href="#ccpi-lattency">CCPI lattency</a></li>
<li><a href="#specint-2006">specint 2006</a></li>
<li><a href="#kernel-&#x6D4B;&#x8BD5;">kernel &#x6D4B;&#x8BD5;</a></li>
<li><a href="#perf-frontend-backend-stall-from-arm">perf frontend backend stall from ARM</a></li>
<li><a href="#streamline-from-arm">streamline from ARM</a></li>
<li><a href="#qemu&#x5982;&#x4F55;&#x8FDB;&#x5165;monitor&#x547D;&#x4EE4;&#x884C;">qemu&#x5982;&#x4F55;&#x8FDB;&#x5165;monitor&#x547D;&#x4EE4;&#x884C;</a></li>
<li><a href="#&#x66F4;&#x65B0;grub">&#x66F4;&#x65B0;grub</a></li>
<li><a href="#docker">docker</a></li>
<li><a href="#kernel-team&#x7684;&#x95EE;&#x9898;">kernel team&#x7684;&#x95EE;&#x9898;</a><ul>
<li><a href="#&#x95EE;&#x9898;">&#x95EE;&#x9898;</a></li>
<li><a href="#&#x56DE;&#x7B54;">&#x56DE;&#x7B54;</a></li>
</ul>
</li>
<li><a href="#pxe&#x8C03;&#x8BD5;">PXE&#x8C03;&#x8BD5;</a></li>
<li><a href="#driver&#x8C03;&#x8BD5;&#x624B;&#x6BB5;&#x4E4B;trace">driver&#x8C03;&#x8BD5;&#x624B;&#x6BB5;&#x4E4B;trace</a></li>
<li><a href="#ssh&#x914D;&#x7F6E;&#x6587;&#x4EF6;">ssh&#x914D;&#x7F6E;&#x6587;&#x4EF6;</a></li>
<li><a href="#efi-grub-&#x548C;-grubcfg">efi grub &#x548C; grub.cfg</a></li>
<li><a href="#&#x51E0;&#x4F55;&#x5E73;&#x5747;&#x6570;&#x548C;&#x7B97;&#x6570;&#x5E73;&#x5747;&#x6570;">&#x51E0;&#x4F55;&#x5E73;&#x5747;&#x6570;&#x548C;&#x7B97;&#x6570;&#x5E73;&#x5747;&#x6570;</a></li>
<li><a href="#kernel&#x8865;&#x4E01;">kernel&#x8865;&#x4E01;</a></li>
<li><a href="#&#x7ED9;alibaba&#x63D0;&#x52A8;kernel&#x8865;&#x4E01;&#x7684;&#x8FC7;&#x7A0B;">&#x7ED9;alibaba&#x63D0;&#x52A8;kernel&#x8865;&#x4E01;&#x7684;&#x8FC7;&#x7A0B;</a></li>
<li><a href="#&#x542F;&#x52A8;&#x65F6;&#x52A0;&#x6A21;&#x5757;&#x7684;&#x53C2;&#x6570;">&#x542F;&#x52A8;&#x65F6;&#x52A0;&#x6A21;&#x5757;&#x7684;&#x53C2;&#x6570;</a></li>
<li><a href="#ssd&#x7684;strim&#x662F;&#x4EC0;&#x4E48;&#x4E1C;&#x4E1C;-discard-fstrimdiscard">ssd&#x7684;strim&#x662F;&#x4EC0;&#x4E48;&#x4E1C;&#x4E1C;? discard? Fstrim/discard</a></li>
<li><a href="#&#x8C03;&#x8BD5;rds-tps&#x53D8;&#x4E3A;0&#x7684;&#x95EE;&#x9898;">&#x8C03;&#x8BD5;RDS tps&#x53D8;&#x4E3A;0&#x7684;&#x95EE;&#x9898;</a></li>
<li><a href="#&#x7F51;&#x53E3;&#x8BA8;&#x8BBA;-&#x5173;&#x4E8E;&#x7F51;&#x7EDC;&#x5904;&#x7406;&#x7684;&#x57FA;&#x672C;&#x6D41;&#x7A0B;&#x548C;&#x6982;&#x5FF5;">&#x7F51;&#x53E3;&#x8BA8;&#x8BBA; &#x5173;&#x4E8E;&#x7F51;&#x7EDC;&#x5904;&#x7406;&#x7684;&#x57FA;&#x672C;&#x6D41;&#x7A0B;&#x548C;&#x6982;&#x5FF5;</a></li>
<li><a href="#&#x7F16;&#x8BD1;&#x6A21;&#x5757;&#x7684;kernel&#x901A;&#x7528;&#x8DEF;&#x5F84;">&#x7F16;&#x8BD1;&#x6A21;&#x5757;&#x7684;kernel&#x901A;&#x7528;&#x8DEF;&#x5F84;</a></li>
<li><a href="#&#x901A;&#x8FC7;&#x5176;&#x4ED6;&#x673A;&#x5668;&#x4E0A;&#x5916;&#x7F51;">&#x901A;&#x8FC7;&#x5176;&#x4ED6;&#x673A;&#x5668;&#x4E0A;&#x5916;&#x7F51;</a></li>
<li><a href="#&#x89E3;&#x51B3;polkitd&#x7684;&#x95EE;&#x9898;">&#x89E3;&#x51B3;polkitd&#x7684;&#x95EE;&#x9898;</a></li>
<li><a href="#sysbench&#x91CC;&#x9762;&#x968F;&#x673A;&#x51FD;&#x6570;lrand48&#x95EE;&#x9898;">sysbench&#x91CC;&#x9762;&#x968F;&#x673A;&#x51FD;&#x6570;lrand48&#x95EE;&#x9898;</a></li>
<li><a href="#ssh-keepalive">ssh keepalive</a></li>
<li><a href="#git&#x751F;&#x6210;patch">git&#x751F;&#x6210;patch</a></li>
<li><a href="#&#x6DFB;&#x52A0;&#x548C;&#x5220;&#x9664;&#x7F51;&#x5173;">&#x6DFB;&#x52A0;&#x548C;&#x5220;&#x9664;&#x7F51;&#x5173;</a></li>
<li><a href="#&#x4E00;&#x6B21;&#x6027;top">&#x4E00;&#x6B21;&#x6027;top</a></li>
<li><a href="#coredump">coredump</a></li>
<li><a href="#&#x5728;thunder&#x4E0A;&#x7684;sysdig-&#x597D;&#x50CF;&#x7528;&#x4E0D;&#x8D77;&#x6765;">&#x5728;thunder&#x4E0A;&#x7684;sysdig &#x597D;&#x50CF;&#x7528;&#x4E0D;&#x8D77;&#x6765;...</a></li>
<li><a href="#sysdig&#x521D;&#x4F53;&#x9A8C;">sysdig&#x521D;&#x4F53;&#x9A8C;</a></li>
<li><a href="#ulimit&#x8FDB;&#x7A0B;&#x6570;&#x9650;&#x5236;">ulimit&#x8FDB;&#x7A0B;&#x6570;&#x9650;&#x5236;</a></li>
<li><a href="#&#x5728;thunder&#x4E0A;&#x505A;&#x76D8;">&#x5728;thunder&#x4E0A;&#x505A;&#x76D8;</a></li>
<li><a href="#rtc&#x65F6;&#x95F4;">rtc&#x65F6;&#x95F4;</a></li>
<li><a href="#sata-slow-sync&#x95EE;&#x9898;">SATA slow sync&#x95EE;&#x9898;</a></li>
<li><a href="#&#x4F7F;&#x7528;native-gcc&#x7684;&#x53D8;&#x91CF;&#x8BBE;&#x7F6E;">&#x4F7F;&#x7528;native gcc&#x7684;&#x53D8;&#x91CF;&#x8BBE;&#x7F6E;</a></li>
<li><a href="#smp_affinity&#x548C;rps_cpus">smp_affinity&#x548C;rps_cpus</a></li>
<li><a href="#mysql&#x8C03;&#x8BD5;&#x65B9;&#x6CD5;&#x8BBA;&#x4E4B;&#x5404;&#x79CD;&#x8C03;&#x8BD5;&#x548C;&#x68C0;&#x6D4B;&#x547D;&#x4EE4;">mysql&#x8C03;&#x8BD5;&#x65B9;&#x6CD5;&#x8BBA;&#x4E4B;&#x5404;&#x79CD;&#x8C03;&#x8BD5;&#x548C;&#x68C0;&#x6D4B;&#x547D;&#x4EE4;</a></li>
<li><a href="#mysql&#x6027;&#x80FD;&#x63D0;&#x5347;&#x4E4B;&#x7F51;&#x53E3;&#x4E2D;&#x65AD;">mysql&#x6027;&#x80FD;&#x63D0;&#x5347;&#x4E4B;&#x7F51;&#x53E3;&#x4E2D;&#x65AD;</a></li>
<li><a href="#&#x89E3;&#x51B3;sync-flood&#x95EE;&#x9898;">&#x89E3;&#x51B3;sync flood&#x95EE;&#x9898;</a></li>
<li><a href="#mysql&#x8C03;&#x4F18;&#x4E4B;&#x74F6;&#x9888;&#x5728;&#x54EA;-&#x7406;&#x8BBA;">mysql&#x8C03;&#x4F18;&#x4E4B;&#x74F6;&#x9888;&#x5728;&#x54EA;? &#x7406;&#x8BBA;</a></li>
<li><a href="#mysql&#x8C03;&#x4F18;&#x4E4B;innodb_spin_wait_delay--30">mysql&#x8C03;&#x4F18;&#x4E4B;innodb_spin_wait_delay = 30</a></li>
<li><a href="#memcpy&#x548C;strcpy">memcpy&#x548C;strcpy</a></li>
<li><a href="#perf&#x8C03;&#x8BD5;&#x5355;&#x8FDB;&#x7A0B;-&#x8C03;&#x7528;&#x6808;">perf&#x8C03;&#x8BD5;&#x5355;&#x8FDB;&#x7A0B;, &#x8C03;&#x7528;&#x6808;?</a></li>
<li><a href="#numactl">numactl</a></li>
<li><a href="#&#x9884;&#x53D6;-prefetch">&#x9884;&#x53D6; prefetch</a></li>
<li><a href="#gdb&#x8C03;&#x8BD5;&#x591A;&#x8FDB;&#x7A0B;">gdb&#x8C03;&#x8BD5;&#x591A;&#x8FDB;&#x7A0B;</a></li>
<li><a href="#aj-kernel-git&#x6362;remote">aj kernel git&#x6362;remote?</a></li>
<li><a href="#&#x4EA4;&#x53C9;&#x7F16;&#x8BD1;kernel">&#x4EA4;&#x53C9;&#x7F16;&#x8BD1;kernel</a></li>
<li><a href="#pssh&#x53EF;&#x4EE5;&#x5728;&#x591A;&#x4E2A;&#x673A;&#x5668;&#x540C;&#x65F6;&#x6267;&#x884C;&#x547D;&#x4EE4;">pssh&#x53EF;&#x4EE5;&#x5728;&#x591A;&#x4E2A;&#x673A;&#x5668;&#x540C;&#x65F6;&#x6267;&#x884C;&#x547D;&#x4EE4;</a></li>
<li><a href="#ssh&#x514D;&#x5BC6;&#x7801;&#x767B;&#x5F55;">ssh&#x514D;&#x5BC6;&#x7801;&#x767B;&#x5F55;</a></li>
<li><a href="#ssh&#x8FDC;&#x7A0B;&#x6267;&#x884C;&#x547D;&#x4EE4;">ssh&#x8FDC;&#x7A0B;&#x6267;&#x884C;&#x547D;&#x4EE4;</a></li>
<li><a href="#cpu-offline-&#x52A8;&#x6001;">cpu offline &#x52A8;&#x6001;</a></li>
<li><a href="#dd&#x539F;&#x7406;-&#x6BCF;&#x4E2A;&#x5B57;&#x8282;&#x90FD;&#x88AB;&#x590D;&#x5236;">dd&#x539F;&#x7406; &#x6BCF;&#x4E2A;&#x5B57;&#x8282;&#x90FD;&#x88AB;&#x590D;&#x5236;</a></li>
<li><a href="#uuid&#x542F;&#x52A8;-&#x4E0D;&#x7528;sda-sdb">UUID&#x542F;&#x52A8; &#x4E0D;&#x7528;sda sdb</a></li>
<li><a href="#&#x91CD;&#x505A;fedora">&#x91CD;&#x505A;fedora</a></li>
<li><a href="#fedora&#x7F51;&#x53E3;&#x914D;&#x7F6E;">fedora&#x7F51;&#x53E3;&#x914D;&#x7F6E;</a></li>
<li><a href="#&#x67E5;&#x770B;10&#x53F0;&#x7CFB;&#x7EDF;&#x662F;&#x5426;online">&#x67E5;&#x770B;10&#x53F0;&#x7CFB;&#x7EDF;&#x662F;&#x5426;online</a></li>
<li><a href="#check-cpld-&#x7248;&#x672C;">check cpld &#x7248;&#x672C;</a></li>
<li><a href="#&#x5199;mac&#x5730;&#x5740;">&#x5199;mac&#x5730;&#x5740;</a></li>
<li><a href="#&#x7F16;&#x8BD1;gcc">&#x7F16;&#x8BD1;gcc</a></li>
<li><a href="#96&#x4E2A;&#x6838;&#x7684;&#x5F02;&#x5E38;&#x95EE;&#x9898;">96&#x4E2A;&#x6838;&#x7684;&#x5F02;&#x5E38;&#x95EE;&#x9898;</a></li>
<li><a href="#&#x5173;&#x4E8E;rps_cpus">&#x5173;&#x4E8E;rps_cpus</a></li>
<li><a href="#xps_cpu">xps_cpu</a></li>
<li><a href="#&#x7F51;&#x7EDC;&#x65F6;&#x95F4;">&#x7F51;&#x7EDC;&#x65F6;&#x95F4;</a></li>
<li><a href="#irq&#x7ED1;&#x5B9A;">irq&#x7ED1;&#x5B9A;</a></li>
<li><a href="#tubo&#x9519;&#x8BEF;&#x5206;&#x6790;">tubo&#x9519;&#x8BEF;&#x5206;&#x6790;</a></li>
<li><a href="#ethtool&#x53EF;&#x4EE5;&#x914D;&#x7F6E;&#x9A71;&#x52A8;">ethtool&#x53EF;&#x4EE5;&#x914D;&#x7F6E;&#x9A71;&#x52A8;</a></li>
<li><a href="#&#x4E3A;&#x4EC0;&#x4E48;ulimit--n&#x7684;&#x503C;&#x4E0D;&#x80FD;&#x6539;">&#x4E3A;&#x4EC0;&#x4E48;ulimit -n&#x7684;&#x503C;&#x4E0D;&#x80FD;&#x6539;?</a></li>
<li><a href="#atomic&#x89E3;&#x51B3;mysql&#x5D29;&#x6E83;&#x95EE;&#x9898;-weak-order">atomic&#x89E3;&#x51B3;mysql&#x5D29;&#x6E83;&#x95EE;&#x9898;, weak order</a></li>
</ul>
</li>
</ul>
<h1 id="ali-support"><a name="ali-support" class="anchor-navigation-ex-anchor" href="#ali-support"><i class="fa fa-link" aria-hidden="true"></i></a>1. Ali support</h1>
<blockquote>
<p>&#x8BB0;&#x5F55;&#x6211;&#x5728;Alibaba&#x652F;&#x6301;ARM64&#x7684;&#x4E00;&#x4E9B;&#x6280;&#x672F;&#x70B9;</p>
</blockquote>
<h2 id="char&#x7C7B;&#x578B;&#x5728;arm&#x548C;x86&#x4E0A;&#x4E0D;&#x4E00;&#x6837;"><a name="char&#x7C7B;&#x578B;&#x5728;arm&#x548C;x86&#x4E0A;&#x4E0D;&#x4E00;&#x6837;" class="anchor-navigation-ex-anchor" href="#char&#x7C7B;&#x578B;&#x5728;arm&#x548C;x86&#x4E0A;&#x4E0D;&#x4E00;&#x6837;"><i class="fa fa-link" aria-hidden="true"></i></a>1.1. char&#x7C7B;&#x578B;&#x5728;arm&#x548C;x86&#x4E0A;&#x4E0D;&#x4E00;&#x6837;</h2>
<p>toku db&#x6709;&#x51E0;&#x4E2A;&#x6D4B;&#x8BD5;&#x9879;fail</p>
<pre class="language-"><code>rds.tokudb_bug_811, rds.tokudb_file_length, 
rds.tokudb_ftclose_checkpoint and the result mismatch with rds.tokudb_zstd_compression
</code></pre><p>&#x539F;&#x56E0;&#x662F;: <strong>x86&#x7684;char&#x662F;&#x6709;&#x7B26;&#x53F7;&#x7684;, &#x800C;arm&#x4E0A;char&#x662F;&#x65E0;&#x7B26;&#x53F7;&#x7684;!</strong></p>
<pre class="language-"><code class="lang-diff"><span class="token coord">--- a/storage/tokudb/ft-index/ft/serialize/compress.cc</span>
<span class="token coord">+++ b/storage/tokudb/ft-index/ft/serialize/compress.cc</span>
@@ -295,7 +295,7 @@ void toku_decompress (Bytef       *dest,   uLongf 
destLen,
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">         strm.zalloc = Z_NULL;
</span><span class="token prefix unchanged"> </span><span class="token line">         strm.zfree = Z_NULL;
</span><span class="token prefix unchanged"> </span><span class="token line">         strm.opaque = Z_NULL;
</span></span><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">        char windowBits = source[1];
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">        int8_t windowBits = source[1];
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">         int r = inflateInit2(&amp;strm, windowBits);
</span><span class="token prefix unchanged"> </span><span class="token line">         lazy_assert(r == Z_OK);
</span><span class="token prefix unchanged"> </span><span class="token line">         strm.next_out = dest;
</span></span></code></pre>
<h2 id="&#x9AD8;&#x7CBE;&#x5EA6;&#x65F6;&#x949F;"><a name="&#x9AD8;&#x7CBE;&#x5EA6;&#x65F6;&#x949F;" class="anchor-navigation-ex-anchor" href="#&#x9AD8;&#x7CBE;&#x5EA6;&#x65F6;&#x949F;"><i class="fa fa-link" aria-hidden="true"></i></a>1.2. &#x9AD8;&#x7CBE;&#x5EA6;&#x65F6;&#x949F;</h2>
<p>&#x5728;&#x7F16;&#x8BD1;tokudb&#x7684;&#x4EE3;&#x7801;&#x65F6;, &#x9700;&#x8981;&#x5B9E;&#x73B0;&#x4E00;&#x4E2A;&#x51FD;&#x6570;</p>
<pre class="language-"><code class="lang-c"><span class="token keyword">static</span> <span class="token keyword">inline</span> <span class="token class-name">tokutime_t</span> <span class="token function">toku_time_now</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">uint32_t</span> lo<span class="token punctuation">,</span> hi<span class="token punctuation">;</span>
    __asm__ <span class="token function">__volatile__</span> <span class="token punctuation">(</span><span class="token string">&quot;rdtsc&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;=a&quot;</span> <span class="token punctuation">(</span>lo<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&quot;=d&quot;</span> <span class="token punctuation">(</span>hi<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token class-name">uint64_t</span><span class="token punctuation">)</span>hi <span class="token operator">&lt;&lt;</span> <span class="token number">32</span> <span class="token operator">|</span> lo<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<p>&#x8FD9;&#x91CC;&#x9762;&#x7528;&#x4E86;x86&#x7684;&#x6C47;&#x7F16;. &#x9700;&#x8981;&#x5728;ARM64&#x4E0A;&#x5B9E;&#x73B0;&#x8FD9;&#x4E2A;&#x529F;&#x80FD;
&#x5177;&#x4F53;&#x7684;&#x5B9E;&#x73B0;&#x5E94;&#x8BE5;&#x662F;<code>__asm __volatile__ (&quot;mrs %[rt],cntvct_el0&quot; : [rt] &quot;=r&quot; (result));</code>
&#x6216;&#x8005;&#x8FD9;&#x6837;</p>
<pre class="language-"><code class="lang-c"><span class="token keyword">unsigned</span> <span class="token keyword">long</span> <span class="token keyword">long</span> <span class="token function">get_ticks</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">unsigned</span> <span class="token keyword">long</span> <span class="token keyword">long</span> tv<span class="token punctuation">;</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">if</span> <span class="token expression"><span class="token function">defined</span><span class="token punctuation">(</span>AARCH64<span class="token punctuation">)</span></span></span>
    <span class="token keyword">asm</span> <span class="token keyword">volatile</span><span class="token punctuation">(</span><span class="token string">&quot;mrs %0, cntvct_el0&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;=r&quot;</span> <span class="token punctuation">(</span>tv<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">elif</span> <span class="token expression"><span class="token function">defined</span><span class="token punctuation">(</span>X64<span class="token punctuation">)</span></span></span>
    <span class="token keyword">asm</span> <span class="token keyword">volatile</span> <span class="token punctuation">(</span><span class="token string">&quot;rdtsc&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;=a&quot;</span><span class="token punctuation">(</span>tv<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">endif</span></span>
    <span class="token keyword">return</span> tv<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<h2 id="io&#x4F18;&#x5316;"><a name="io&#x4F18;&#x5316;" class="anchor-navigation-ex-anchor" href="#io&#x4F18;&#x5316;"><i class="fa fa-link" aria-hidden="true"></i></a>1.3. io&#x4F18;&#x5316;</h2>
<pre class="language-"><code class="lang-sh"><span class="token builtin class-name">echo</span> <span class="token number">150</span> <span class="token operator">&gt;</span> /sys/block/sda/device/timeout
<span class="token builtin class-name">echo</span> deadline <span class="token operator">&gt;</span> /sys/block/sdb/queue/scheduler
<span class="token builtin class-name">echo</span> deadline <span class="token operator">&gt;</span> /sys/block/sda/queue/scheduler
<span class="token builtin class-name">echo</span> <span class="token number">50</span><span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span> /sys/block/sdb/queue/nr_requests
/etc/default/irqbalance
<span class="token comment">#Configuration for the irqbalance daemon</span>
<span class="token comment">#Should irqbalance be enabled?</span>
<span class="token assign-left variable">ENABLED</span><span class="token operator">=</span><span class="token string">&quot;1&quot;</span>
<span class="token comment">#Balance the IRQs only once?</span>
<span class="token assign-left variable">ONESHOT</span><span class="token operator">=</span><span class="token string">&quot;0&quot;</span>
<span class="token assign-left variable">IRQBALANCE_BANNED_CPUS</span><span class="token operator">=</span><span class="token string">&quot;ffffffffffffffffffffffff&quot;</span>
</code></pre>
<pre class="language-"><code>Here are some potential optimizations to get the best performance:
Regarding the MegaRAID controller  
    If you are using SSD as data volumes, use LSI MegaRAID Fast Path and tune the OS as described below.  Click here for a KB article with a trial key .
    Use SSD as caching along with disk drives and LSI MegaRAID CacheCade or CacheCade Pro 2.0 Click here for a trial key 
    If using HDD (Hard Disk Drives) enable write back cache (consider using a BBU in the event of unexpected power loss or unclean shutdown)
Linux OS tuning also improves performance for LSI SAS HBAs.
Under Windows and Linux using SSDs:  
    When the volume is created, use write through caching (i.e. write cache will be disabled)
    Use Direct IO (and not Cached IO)
    Use RAID 0 for the highest performance (note: the loss of a single SSD will result in the loss of all data)
    In general, the dual core controllers (e.g. 9265/9285) perform faster than the single controllers (e.g. 9260/9280)
Under Linux (some of these are specific to SSDs, as indicated below):  
    telinit 3   (Shutdown to runlevel 3/kill Xwindows)      
    echo &quot;0&quot; &gt; /sys/block/sda/queue/rotational   (Turn off seek reordering-use with SSDs)
    I/O scheduler     
        To check the current setting: cat /sys/block/sdb/queue/scheduler
        To tune the setting: echo &quot;deadline&quot; &gt; /sys/block/sdb/queue/scheduler (Change to deadline I/O scheduler)
        Repeat for other devices (e.g. sdb, sdc, etc.)
        This setting reverts to the default after a system reboot.  You may want to create a start up script that will automatically run this tuning parameter after every reboot. 
    Turn up block layer queue depth for sda to 975-use with SSDs or use with HDDs if using a single Logical Drive)               
        To check the current setting: cat /sys/block/sda/queue/nr_requests
        To tune the setting: echo &quot;975&quot; &gt; /sys/block/sdb/queue/nr_requests
        Repeat for other devices (e.g. sdb, sdc, etc.)
        This setting reverts to the default after a system reboot.  You may want        to create a start up script that will automatically run this tuning        parameter after every reboot.
     Turn up driver queue depth for sda to 975-use with SSDs or use with HDDs if using a single Logical Drive) 
        To check the current setting: cat /sys/block/sda/device/queue_depth
        To tune the setting: echo &quot;975&quot; &gt; /sys/block/sda/device/queue_depth
        Repeat for other devices (e.g. sdb, sdc, etc.)
        This setting reverts to the default after a system reboot.  You may want        to create a start up script that will automatically run this tuning        parameter after every reboot. 
    echo N &gt; /sys/module/drm_kms_helper/parameters/poll (Turn off kworkd001 CPU eating background kernel thread)
    Assign Affinity Masks - See A008273-110112
    Setup rq_affinity
        To check the current setting: cat /sys/block/sda/queue/rq_affinity
        To tune the setting: echo &quot;0&quot; &gt; /sys/block/sda/queue/rq_affinity
        Repeat for other devices (e.g. sdb, sdc, etc.)
        This setting reverts to the default after a system reboot.  You may want to create a start up script that will automatically run this tuning   parameter after every reboot.
        Newer kernels (e.g. RHEL 6.4) allow this setting to be &apos;2&apos;, which will cause the block layer softirq to run on the exact same CPU that issued the I/O.
</code></pre><h2 id="openssl"><a name="openssl" class="anchor-navigation-ex-anchor" href="#openssl"><i class="fa fa-link" aria-hidden="true"></i></a>1.4. openssl</h2>
<pre class="language-"><code>I&apos;ve tested the RSA2048 performance with this cmd
openssl speed rsa2048 -multi 32 
And intel 2630 got about:  6911, 2650 with 32 core and -multi 32 thread got about 7907.7
runing the same cmd in one of ten machine (2 sockets) on my hand(evb3 maybe) and with option: multi 96 got about 6509.9.
</code></pre><pre class="language-"><code>Today, I try to run openssl speed rsa2048 on ThunderX CRB-1s (ThunderX CPU @ 2.0GHz , 48Cores).
&#x201C;./openssl speed rsa2048 -multi 32&#x201D; test result is: 5505.3
&#x201C;./openssl speed rsa2048 -multi 48&#x201D; test result is: 8104.6
</code></pre><h2 id="ccpi-lattency"><a name="ccpi-lattency" class="anchor-navigation-ex-anchor" href="#ccpi-lattency"><i class="fa fa-link" aria-hidden="true"></i></a>1.5. CCPI lattency</h2>
<p>The following is the CCPI latency #. On our pass 1.x silicon we are running at 6.25Gbps, pass 2.0 aka the production part will be 10Gbps.  You will see latency improvement from 400 cycles to 300 cycles.</p>
<h2 id="specint-2006"><a name="specint-2006" class="anchor-navigation-ex-anchor" href="#specint-2006"><i class="fa fa-link" aria-hidden="true"></i></a>1.6. specint 2006</h2>
<p><img src="img/arm_server_&#x6742;&#x8BB0;_20220918120215.png" alt="">  </p>
<h2 id="kernel-&#x6D4B;&#x8BD5;"><a name="kernel-&#x6D4B;&#x8BD5;" class="anchor-navigation-ex-anchor" href="#kernel-&#x6D4B;&#x8BD5;"><i class="fa fa-link" aria-hidden="true"></i></a>1.7. kernel &#x6D4B;&#x8BD5;</h2>
<ul>
<li>LKP
  Blogbench
  dbench
  Ext4-frags
  Fileio
  ku-latency
  kvm-unit-tests
  nuttcp
  pft</li>
<li>LTP</li>
<li>Trinity</li>
<li>AIM9</li>
<li>XFS Test</li>
<li>unionmount-testsuite</li>
<li>Fsync</li>
<li></li>
</ul>
<h2 id="perf-frontend-backend-stall-from-arm"><a name="perf-frontend-backend-stall-from-arm" class="anchor-navigation-ex-anchor" href="#perf-frontend-backend-stall-from-arm"><i class="fa fa-link" aria-hidden="true"></i></a>1.8. perf frontend backend stall from ARM</h2>
<pre class="language-"><code>Hi Bai,
As we discussed on-site at Alibaba, I think it would be good to backport the patches that add support for the frontend stall and backend stall performance counters.
This was implemented earlier this year by Jan Glauber from Cavium, and appeared in the 4.6 kernel.
As discussed, these counters are very valuable when you need to analyze the root cause of a CPU performance problem, following the top-down methodology (see https://moodle.technion.ac.il/pluginfile.php/560599/mod_resource/content/1/Vtune%20%20-%20Top%20Down%20Performance%20Analysis%20,%20by%20Ahmad%20Yasin.pdf for the paper).
My understanding is that the following commits introduce this support in the main-line linux kernel:
94085fe - Thu, 18 Feb 2016 17:50:12 +0100 (5 months ago)
           arm64: dts: Add Cavium ThunderX specific PMU - Jan Glauber
c210ae8 - Thu, 18 Feb 2016 17:50:14 +0100 (5 months ago)
          arm64: perf: Extend event mask for ARMv8.1 - Jan Glauber
7175f05 - Thu, 18 Feb 2016 17:50:13 +0100 (5 months ago)
          arm64: perf: Enable PMCR long cycle counter bit - Jan Glauber
d0aa2bf - Thu, 18 Feb 2016 17:50:11 +0100 (5 months ago)
          arm64/perf: Add Cavium ThunderX PMU support - Jan Glauber
5f140cc - Thu, 18 Feb 2016 17:50:10 +0100 (5 months ago)
           arm64: perf: Rename Cortex A57 events - Jan Glauber
If the support could be backported to linux kernel 4.2, it means Alibaba could use these counters to more efficiently investigate the root cause of CPU inefficiencies.
</code></pre><h2 id="streamline-from-arm"><a name="streamline-from-arm" class="anchor-navigation-ex-anchor" href="#streamline-from-arm"><i class="fa fa-link" aria-hidden="true"></i></a>1.9. streamline from ARM</h2>
<ul>
<li>DS-5 download
<a href="https://developer.arm.com/products/software-development-tools/ds-5-development-studio/downloads" target="_blank">https://developer.arm.com/products/software-development-tools/ds-5-development-studio/downloads</a></li>
<li>gator source code
<a href="https://github.com/ARM-software/gator" target="_blank">https://github.com/ARM-software/gator</a></li>
<li>protocol
<a href="https://github.com/ARM-software/gator/tree/master/protocol" target="_blank">https://github.com/ARM-software/gator/tree/master/protocol</a></li>
</ul>
<h2 id="qemu&#x5982;&#x4F55;&#x8FDB;&#x5165;monitor&#x547D;&#x4EE4;&#x884C;"><a name="qemu&#x5982;&#x4F55;&#x8FDB;&#x5165;monitor&#x547D;&#x4EE4;&#x884C;" class="anchor-navigation-ex-anchor" href="#qemu&#x5982;&#x4F55;&#x8FDB;&#x5165;monitor&#x547D;&#x4EE4;&#x884C;"><i class="fa fa-link" aria-hidden="true"></i></a>1.10. qemu&#x5982;&#x4F55;&#x8FDB;&#x5165;monitor&#x547D;&#x4EE4;&#x884C;</h2>
<p><code>Crtl+a c</code></p>
<h2 id="&#x66F4;&#x65B0;grub"><a name="&#x66F4;&#x65B0;grub" class="anchor-navigation-ex-anchor" href="#&#x66F4;&#x65B0;grub"><i class="fa fa-link" aria-hidden="true"></i></a>1.11. &#x66F4;&#x65B0;grub</h2>
<pre class="language-"><code>vim /etc/default/grub
grub2-mkconfig  -o /boot/efi/EFI/centos/grub.cfg
reboot
</code></pre><h2 id="docker"><a name="docker" class="anchor-navigation-ex-anchor" href="#docker"><i class="fa fa-link" aria-hidden="true"></i></a>1.12. docker</h2>
<p><a href="https://docs.docker.com/engine/installation/linux/centos/" target="_blank">https://docs.docker.com/engine/installation/linux/centos/</a></p>
<h2 id="kernel-team&#x7684;&#x95EE;&#x9898;"><a name="kernel-team&#x7684;&#x95EE;&#x9898;" class="anchor-navigation-ex-anchor" href="#kernel-team&#x7684;&#x95EE;&#x9898;"><i class="fa fa-link" aria-hidden="true"></i></a>1.13. kernel team&#x7684;&#x95EE;&#x9898;</h2>
<h3 id="&#x95EE;&#x9898;"><a name="&#x95EE;&#x9898;" class="anchor-navigation-ex-anchor" href="#&#x95EE;&#x9898;"><i class="fa fa-link" aria-hidden="true"></i></a>1.13.1. &#x95EE;&#x9898;</h3>
<p>why 100, not 1000&#xFF1F;
why noop, not others?
why 64k, not 4k? performance comparison?</p>
<h3 id="&#x56DE;&#x7B54;"><a name="&#x56DE;&#x7B54;" class="anchor-navigation-ex-anchor" href="#&#x56DE;&#x7B54;"><i class="fa fa-link" aria-hidden="true"></i></a>1.13.2. &#x56DE;&#x7B54;</h3>
<ul>
<li>100hz vs. 1000hz: we see minimal performance difference for most of our applications here.<ul>
<li>We have performed significant testing using both settings, as well as 250hz and 300hz without any issue.</li>
<li>I will direct all future kernels to use 1000hz moving forward, at your preference.</li>
</ul>
</li>
<li>noop is generally best for SSDs, which many customer use often<ul>
<li>However, if your application has a combination of SSDs and HDDs we will gladly switch the default to deadline, which is shown to work well with both disks and all applications. The impact on SSDs is effectively 0, while the improvement with HDDs is significant.</li>
<li>The only consideration is that MySQL is known to have poor performance when using the CFQ scheduler, this is true on all platforms, and is a standard note for MySQL performance.</li>
</ul>
</li>
<li>64k vs 4k: 64k has performance benefits in many applications, 5% on average (though many, even most applications see 0 change).<ul>
<li>However, specifically, 64k is considered the desired default for ARM64, RedHat has specifically asked for 64k to be the standard.</li>
<li>4k works perfectly fine, however. The performance hit isn&#x2019;t very noticeable in most applications.</li>
<li>We would kindly suggest using the default 64k, however, particularly since RedHat and CentOS will be providing 64k based distributions in the future.</li>
</ul>
</li>
<li>We chose a number of configuration options based on our experience, or because they were considered recommend by the ARM ecosystem, however these are only defaults, and we understand your use case may differ.
Please ask if you have any questions at all, we are very eager to customize your kernel such that it may maximize your application performance, while ensuring a minimal impact on your deployment process.</li>
</ul>
<h2 id="pxe&#x8C03;&#x8BD5;"><a name="pxe&#x8C03;&#x8BD5;" class="anchor-navigation-ex-anchor" href="#pxe&#x8C03;&#x8BD5;"><i class="fa fa-link" aria-hidden="true"></i></a>1.14. PXE&#x8C03;&#x8BD5;</h2>
<ul>
<li>PXE&#x9700;&#x8981;&#x914D;DHCP TFTP FTP server.
Thunder&#x673A;&#x5668;&#x5148;&#x662F;&#x901A;&#x8FC7;DHCP&#x83B7;&#x53D6;IP&#x5730;&#x5740;, &#x7136;&#x540E;TFTP&#x4E0B;&#x8F7D;grub.efi, &#x76EE;&#x5F55;&#x5728;/tftpboot&#x4E0B;&#x9762;.</li>
<li>&#x8FD9;&#x4E2A;efi&#x4F1A;&#x5728;&#x677F;&#x5B50;&#x4E0A;&#x8DD1;&#x8D77;&#x6765;, &#x7136;&#x540E;&#x4F1A;&#x4E0B;&#x8F7D;grub.cfg&#x548C;image, initrd&#x7B49;&#x6587;&#x4EF6;, &#x7528;&#x8FD9;&#x4E9B;&#x6587;&#x4EF6;, &#x7CFB;&#x7EDF;&#x5C31;&#x80FD;&#x8FDB;&#x5165;&#x6700;&#x5C0F;&#x5B89;&#x88C5;&#x73AF;&#x5883;(ram os).
&#x8D77;kernel&#x7684;&#x65F6;&#x5019;&#x53EF;&#x4EE5;&#x5728;grub&#x91CC;&#x9762;&#x4F20;&#x53C2;&#x6570;&#x6765;&#x6307;&#x5B9A;ISO&#x7684;&#x4F4D;&#x7F6E;, &#x7528;FTP&#x534F;&#x8BAE;.
&#x8FD9;&#x91CC;&#x9047;&#x5230;&#x7684;&#x95EE;&#x9898;&#x662F;&#x7CFB;&#x7EDF;&#x5361;&#x4F4F;&#x4E86;, &#x6B64;&#x65F6;&#x9700;&#x8981;tcpdump&#x6765;&#x8C03;&#x8BD5;, &#x9700;&#x8981;&#x77E5;&#x9053;&#x673A;&#x5668;&#x7684;mac, &#x6709;&#x5F88;&#x591A;&#x65B9;&#x6CD5;&#x53EF;&#x4EE5;&#x67E5;&#x5230;.
<code>tcpdump -i em1 ether host 02:1f:b7:00:00:00 -vv</code>
&#x4E0B;&#x9762;&#x5C31;&#x53EF;&#x4EE5;&#x88C5;&#x4E86;. &#x7528;text&#x6A21;&#x5F0F;, &#x9009;server with GUI.</li>
<li>&#x7528;BMC&#x53EF;&#x4EE5;&#x770B;&#x8F93;&#x51FA;, &#x5173;&#x952E;&#x662F;&#x7528;<code>which javaws</code>&#x6765;&#x6253;&#x5F00;&#x90A3;&#x4E2A;&#x6587;&#x4EF6;</li>
</ul>
<h2 id="driver&#x8C03;&#x8BD5;&#x624B;&#x6BB5;&#x4E4B;trace"><a name="driver&#x8C03;&#x8BD5;&#x624B;&#x6BB5;&#x4E4B;trace" class="anchor-navigation-ex-anchor" href="#driver&#x8C03;&#x8BD5;&#x624B;&#x6BB5;&#x4E4B;trace"><i class="fa fa-link" aria-hidden="true"></i></a>1.15. driver&#x8C03;&#x8BD5;&#x624B;&#x6BB5;&#x4E4B;trace</h2>
<p>&#x8C03;&#x8BD5;driver&#x7684;&#x65F6;&#x5019;, &#x7ECF;&#x5E38;&#x4F1A;&#x52A0;&#x4E00;&#x4E9B;&#x6253;&#x5370;; &#x800C;&#x5176;&#x5B9E;&#x4F60;&#x60F3;&#x8FC7;&#x6CA1;&#x6709;, &#x4E00;&#x4E9B;&#x6BD4;&#x8F83;&#x6210;&#x719F;&#x7684;&#x7CFB;&#x7EDF;, &#x6BD4;&#x5982;i2c&#x5DF2;&#x7ECF;&#x6709;&#x7CFB;&#x7EDF;&#x6027;&#x7684;&#x8C03;&#x8BD5;&#x6253;&#x5370;&#x4E86;;
&#x5728;&#x81EA;&#x5DF1;&#x52A8;&#x624B;&#x52A0;&#x6253;&#x5370;&#x4E4B;&#x524D;, &#x5148;&#x628A;&#x8FD9;&#x4E9B;&#x88AB;&#x9ED8;&#x8BA4;&#x5173;&#x95ED;&#x7684;&#x8C03;&#x8BD5;&#x6253;&#x5370;&#x6253;&#x5F00;, &#x7ECF;&#x5E38;&#x4F1A;&#x4E8B;&#x534A;&#x529F;&#x500D;, &#x4E0B;&#x9762;&#x4EE5;&#x8C03;&#x8BD5;i2c read&#x4E3A;&#x4F8B;</p>
<ul>
<li>&#x6253;&#x5F00;&#x8C03;&#x8BD5;&#x4FE1;&#x606F;&#x8F93;&#x51FA;
<code>echo 1 &gt; /sys/kernel/debug/tracing/events/i2c/i2c_read/enable</code></li>
<li>&#x67E5;&#x770B;&#x8F93;&#x51FA;
<code>cat /sys/kernel/debug/tracing/trace</code></li>
<li>&#x8FD9;&#x4E9B;debug&#x4FE1;&#x606F;&#x5728;&#x54EA;&#x91CC;? --i2c&#x6846;&#x67B6;&#x4EE3;&#x7801;&#x91CC;&#x5DF2;&#x7ECF;&#x57CB;&#x597D;
<code>trace_i2c_read(...)</code></li>
</ul>
<h2 id="ssh&#x914D;&#x7F6E;&#x6587;&#x4EF6;"><a name="ssh&#x914D;&#x7F6E;&#x6587;&#x4EF6;" class="anchor-navigation-ex-anchor" href="#ssh&#x914D;&#x7F6E;&#x6587;&#x4EF6;"><i class="fa fa-link" aria-hidden="true"></i></a>1.16. ssh&#x914D;&#x7F6E;&#x6587;&#x4EF6;</h2>
<pre class="language-"><code>baiyingjie@mserver-dell ~/.ssh
$ chmod 600 config
$ cat config 
Host ali6
    Hostname 10.97.219.6 
    User root
    IdentityFile ~/.ssh/id_rsa
    ServerAliveInterval 60
Host ali55
    Hostname 10.97.219.55
    User root
    IdentityFile ~/.ssh/id_rsa
    ServerAliveInterval 60
Host rdsgserver
    Hostname 192.168.10.3
    User root
    IdentityFile ~/.ssh/id_rsa
    ProxyCommand ssh -q -W %h:%p rdsgclient
    ServerAliveInterval 60
Host rdsgclient
    Hostname 30.2.47.69
    User root
    IdentityFile ~/.ssh/id_rsa
    ServerAliveInterval 60
</code></pre><h2 id="efi-grub-&#x548C;-grubcfg"><a name="efi-grub-&#x548C;-grubcfg" class="anchor-navigation-ex-anchor" href="#efi-grub-&#x548C;-grubcfg"><i class="fa fa-link" aria-hidden="true"></i></a>1.17. efi grub &#x548C; grub.cfg</h2>
<ul>
<li>&#x8FD9;&#x4E09;&#x4E2A;&#x4E1C;&#x897F;&#x90FD;&#x662F;&#x5B58;&#x5728;&#x7B2C;&#x4E00;&#x4E2A;&#x5206;&#x533A;&#x91CC;&#x9762;&#x7684;, &#x8FD9;&#x662F;&#x4E2A;fat32&#x7684;bootable&#x5206;&#x533A;, &#x597D;&#x50CF;&#x4E13;&#x95E8;&#x7ED9;uefi&#x7528;&#x7684;</li>
<li>&#x8FD9;&#x4E2A;&#x5206;&#x533A;&#x4F1A;mount&#x5230;/boot/efi</li>
<li>&#x6CE8;&#x610F;grub.cfg&#x4E5F;&#x662F;&#x5728;&#x8FD9;&#x4E2A;&#x5206;&#x533A;&#x91CC;&#x9762;</li>
<li>&#x6839;&#x5206;&#x533A;(&#x4E00;&#x822C;&#x662F;&#x7B2C;&#x4E8C;&#x4E2A;&#x5206;&#x533A;, ext4)&#x91CC;&#x9762;&#x4E5F;&#x6709;grub&#x548C;grub2&#x6587;&#x4EF6;&#x5939;, &#x4F46;&#x91CC;&#x9762;&#x8981;&#x4E48;&#x662F;&#x8F6F;&#x94FE;&#x63A5;&#x5230;/boot/efi&#x7684;, &#x8981;&#x4E48;&#x5C31;&#x662F;&#x50CF;&#x80CC;&#x666F;&#x56FE;&#x4E00;&#x6837;&#x7684;&#x4E0D;&#x91CD;&#x8981;&#x6587;&#x4EF6;?</li>
</ul>
<h2 id="&#x51E0;&#x4F55;&#x5E73;&#x5747;&#x6570;&#x548C;&#x7B97;&#x6570;&#x5E73;&#x5747;&#x6570;"><a name="&#x51E0;&#x4F55;&#x5E73;&#x5747;&#x6570;&#x548C;&#x7B97;&#x6570;&#x5E73;&#x5747;&#x6570;" class="anchor-navigation-ex-anchor" href="#&#x51E0;&#x4F55;&#x5E73;&#x5747;&#x6570;&#x548C;&#x7B97;&#x6570;&#x5E73;&#x5747;&#x6570;"><i class="fa fa-link" aria-hidden="true"></i></a>1.18. &#x51E0;&#x4F55;&#x5E73;&#x5747;&#x6570;&#x548C;&#x7B97;&#x6570;&#x5E73;&#x5747;&#x6570;</h2>
<ul>
<li>&#x7B97;&#x6570;&#x5E73;&#x5747;&#x6570;: n&#x4E2A;&#x6570;&#x7684;&#x548C;&#x9664;&#x4EE5;n</li>
<li>&#x51E0;&#x4F55;&#x5E73;&#x5747;&#x6570;&#x5B9A;&#x4E49;: n&#x4E2A;&#x6570;&#x76F8;&#x4E58;&#x518D;&#x5F00;n&#x6B21;&#x65B9;</li>
<li>&#x5E94;&#x7528;&#x573A;&#x666F;:</li>
<li>&#x7B97;&#x6570;&#x5E73;&#x5747;&#x6570;&#x7528;&#x6765;&#x8868;&#x793A;&#x8FD9;n&#x4E2A;&#x6570;&#x7684;&#x548C;&#x7684;&#x5E73;&#x5747;&#x7279;&#x5F81;, &#x610F;&#x5473;&#x7740;&#x4F60;&#x8981;&#x8003;&#x5BDF;&#x7684;&#x6F5C;&#x5728;&#x76EE;&#x6807;&#x662F;&#x4ED6;&#x4EEC;&#x7684;&#x548C;</li>
<li>&#x51E0;&#x4F55;&#x5E73;&#x5747;&#x6570;&#x662F;&#x8FD9;n&#x4E2A;&#x6570;&#x7684;&#x79EF;&#x7684;&#x7279;&#x5F81;, &#x8003;&#x5BDF;&#x7684;&#x6F5C;&#x5728;&#x76EE;&#x6807;&#x662F;&#x4E58;&#x79EF;.</li>
</ul>
<h2 id="kernel&#x8865;&#x4E01;"><a name="kernel&#x8865;&#x4E01;" class="anchor-navigation-ex-anchor" href="#kernel&#x8865;&#x4E01;"><i class="fa fa-link" aria-hidden="true"></i></a>1.19. kernel&#x8865;&#x4E01;</h2>
<pre class="language-"><code>git format-patch 
git apply --check  newpatch.patch
git am --signoff &lt; newpatch.patch
</code></pre><h2 id="&#x7ED9;alibaba&#x63D0;&#x52A8;kernel&#x8865;&#x4E01;&#x7684;&#x8FC7;&#x7A0B;"><a name="&#x7ED9;alibaba&#x63D0;&#x52A8;kernel&#x8865;&#x4E01;&#x7684;&#x8FC7;&#x7A0B;" class="anchor-navigation-ex-anchor" href="#&#x7ED9;alibaba&#x63D0;&#x52A8;kernel&#x8865;&#x4E01;&#x7684;&#x8FC7;&#x7A0B;"><i class="fa fa-link" aria-hidden="true"></i></a>1.20. &#x7ED9;alibaba&#x63D0;&#x52A8;kernel&#x8865;&#x4E01;&#x7684;&#x8FC7;&#x7A0B;</h2>
<ul>
<li>thunder_master&#x57FA;&#x4E8E;linux_4.2, &#x5F00;&#x53D1;&#x4E86;&#x6BD4;&#x5982;500+&#x4E2A;commit</li>
<li>&#x540C;&#x6837;&#x57FA;&#x4E8E;linux_4.2&#x6DFB;&#x52A0;&#x65B0;&#x7684;&#x5206;&#x652F;alibaba_4.2</li>
<li>&#x5728;alibaba_4.2&#x4E0A;, &#x7528;git cherry-pick commitid&#x4ECE;thunder_master&#x4E0A;&#x7684;500+commit&#x91CC;&#x9762;&#x6311;&#x51FA;&#x6765;&#x6709;&#x7528;&#x7684;, &#x6BD4;&#x5982;200&#x4E2A;&#x5DE6;&#x53F3;.
git cherry-pick&#x53EF;&#x4EE5;&#x628A;&#x522B;&#x7684;&#x5206;&#x652F;&#x4E0A;&#x7684;commit&#x5E94;&#x7528;&#x5230;&#x5F53;&#x524D;&#x5206;&#x652F;</li>
<li>&#x7528;alibaba&#x7ED9;&#x7684;centos7.1&#x91CC;&#x9762;&#x7684;&#x5185;&#x6838;&#x6E90;&#x7801;&#x65B0;&#x5EFA;&#x4E00;&#x4E2A;repo</li>
<li>&#x5728;&#x65B0;&#x5EFA;&#x7684;&#x8FD9;&#x4E2A;repo&#x91CC;&#x9762;, git remote add cavium thunder_repo(&#x5C31;&#x662F;&#x521A;&#x624D;&#x90A3;&#x4E2A;)</li>
<li>git fetch cavium &#x628A;cavium repo&#x53D6;&#x4E0B;&#x6765;, &#x6CE8;&#x610F;&#x6B64;&#x65F6;&#x5E76;&#x6CA1;&#x6709;&#x66F4;&#x65B0;&#x5230;&#x5DE5;&#x4F5C;&#x533A;</li>
<li>&#x8FD8;&#x7528;git cherry-pick commitB...commitA&#x5E94;&#x7528;cavium repo alibaba_4.2&#x4E0A;&#x7684;&#x4E24;&#x4E2A;commit B&#x548C;A&#x4E4B;&#x95F4;&#x7684;&#x8865;&#x4E01;. B&#x5C31;&#x662F;linux_4.2, A&#x5C31;&#x662F;&#x6700;&#x65B0;&#x7684;alibaba_4.2; &#x8FD9;&#x91CC;&#x4E0D;&#x7528;merge&#x662F;&#x56E0;&#x4E3A;&#x867D;&#x7136;&#x90FD;&#x662F;&#x57FA;&#x4E8E;4.2, &#x4F46;&#x8FD9;&#x4E24;&#x4E2A;repo&#x6CA1;&#x6709;&#x5171;&#x540C;&#x7684;commit, </li>
<li>&#x7ED9;ali&#x63D0;&#x4F9B;patch&#x7684;&#x65F6;&#x5019;, &#x7528;git format-patch</li>
<li>ali&#x5E94;&#x7528;patch&#x7684;&#x65F6;&#x5019;, &#x53EF;&#x4EE5;git apply</li>
</ul>
<h2 id="&#x542F;&#x52A8;&#x65F6;&#x52A0;&#x6A21;&#x5757;&#x7684;&#x53C2;&#x6570;"><a name="&#x542F;&#x52A8;&#x65F6;&#x52A0;&#x6A21;&#x5757;&#x7684;&#x53C2;&#x6570;" class="anchor-navigation-ex-anchor" href="#&#x542F;&#x52A8;&#x65F6;&#x52A0;&#x6A21;&#x5757;&#x7684;&#x53C2;&#x6570;"><i class="fa fa-link" aria-hidden="true"></i></a>1.21. &#x542F;&#x52A8;&#x65F6;&#x52A0;&#x6A21;&#x5757;&#x7684;&#x53C2;&#x6570;</h2>
<pre class="language-"><code class="lang-shell">root@Tfedora /etc/modprobe.d
<span class="token comment"># cat megaraid_sas.conf </span>
options megaraid_sas <span class="token assign-left variable">msix_disable</span><span class="token operator">=</span><span class="token number">1</span>
</code></pre>
<h2 id="ssd&#x7684;strim&#x662F;&#x4EC0;&#x4E48;&#x4E1C;&#x4E1C;-discard-fstrimdiscard"><a name="ssd&#x7684;strim&#x662F;&#x4EC0;&#x4E48;&#x4E1C;&#x4E1C;-discard-fstrimdiscard" class="anchor-navigation-ex-anchor" href="#ssd&#x7684;strim&#x662F;&#x4EC0;&#x4E48;&#x4E1C;&#x4E1C;-discard-fstrimdiscard"><i class="fa fa-link" aria-hidden="true"></i></a>1.22. ssd&#x7684;strim&#x662F;&#x4EC0;&#x4E48;&#x4E1C;&#x4E1C;? discard? Fstrim/discard</h2>
<pre class="language-"><code>I suspect the reason for this may be SSD garbage collection. The only 
known solution to it that I&apos;m aware of is trim: 
https://en.wikipedia.org/wiki/Trim_%28computing%29
</code></pre><h2 id="&#x8C03;&#x8BD5;rds-tps&#x53D8;&#x4E3A;0&#x7684;&#x95EE;&#x9898;"><a name="&#x8C03;&#x8BD5;rds-tps&#x53D8;&#x4E3A;0&#x7684;&#x95EE;&#x9898;" class="anchor-navigation-ex-anchor" href="#&#x8C03;&#x8BD5;rds-tps&#x53D8;&#x4E3A;0&#x7684;&#x95EE;&#x9898;"><i class="fa fa-link" aria-hidden="true"></i></a>1.23. &#x8C03;&#x8BD5;RDS tps&#x53D8;&#x4E3A;0&#x7684;&#x95EE;&#x9898;</h2>
<pre class="language-"><code>When TPS drops to zero, run this:
gdb -ex &quot;set pagination 0&quot; -ex &quot;thread apply all bt&quot; \
   --batch -p $(pidof mysqld) &gt; pmp.txt
</code></pre><ul>
<li>set pagination 0&#x662F;&#x8BF4;&#x4E0D;&#x8981;&#x5206;&#x9875;, &#x5426;&#x5219;&#x8FD8;&#x8981;&#x63D0;&#x793A;&#x6572;&#x56DE;&#x8F66;&#x7EE7;&#x7EED;</li>
<li>thread apply all bt&#x662F;&#x8BF4;&#x67E5;&#x6240;&#x6709;&#x7EBF;&#x7A0B;&#x7684;&#x8C03;&#x7528;&#x6808;</li>
</ul>
<h2 id="&#x7F51;&#x53E3;&#x8BA8;&#x8BBA;-&#x5173;&#x4E8E;&#x7F51;&#x7EDC;&#x5904;&#x7406;&#x7684;&#x57FA;&#x672C;&#x6D41;&#x7A0B;&#x548C;&#x6982;&#x5FF5;"><a name="&#x7F51;&#x53E3;&#x8BA8;&#x8BBA;-&#x5173;&#x4E8E;&#x7F51;&#x7EDC;&#x5904;&#x7406;&#x7684;&#x57FA;&#x672C;&#x6D41;&#x7A0B;&#x548C;&#x6982;&#x5FF5;" class="anchor-navigation-ex-anchor" href="#&#x7F51;&#x53E3;&#x8BA8;&#x8BBA;-&#x5173;&#x4E8E;&#x7F51;&#x7EDC;&#x5904;&#x7406;&#x7684;&#x57FA;&#x672C;&#x6D41;&#x7A0B;&#x548C;&#x6982;&#x5FF5;"><i class="fa fa-link" aria-hidden="true"></i></a>1.24. &#x7F51;&#x53E3;&#x8BA8;&#x8BBA; &#x5173;&#x4E8E;&#x7F51;&#x7EDC;&#x5904;&#x7406;&#x7684;&#x57FA;&#x672C;&#x6D41;&#x7A0B;&#x548C;&#x6982;&#x5FF5;</h2>
<ul>
<li>&#x5728;&#x5185;&#x6838;&#x6001;&#x7684;&#x6574;&#x4E2A;&#x5305;&#x5904;&#x7406;&#x6D41;&#x7A0B;&#x4E2D;, &#x4E0D;&#x4F1A;&#x5185;&#x5B58;&#x62F7;&#x8D1D;
&#x786C;&#x4EF6;&#x6536;&#x5230;&#x7684;&#x662F;&#x6BD4;&#x7279;&#x6D41;, &#x7136;&#x540E;&#x901A;&#x8FC7;DMA&#x628A;&#x62A5;&#x6587;&#x653E;&#x5728;buffer&#x91CC;(&#x8FD9;&#x4E9B;buffer&#x662F;&#x9A71;&#x52A8;&#x5728;&#x521D;&#x59CB;&#x5316;&#x7684;&#x65F6;&#x5019;&#x6216;&#x8FD0;&#x884C;&#x65F6;&#x5206;&#x914D;&#x597D;&#x7684;, &#x786C;&#x4EF6;&#x770B;&#x5230;&#x7684;&#x662F;&#x6307;&#x9488;, &#x8FD9;&#x4E9B;buffer&#x90FD;&#x662F;&#x7269;&#x7406;&#x5730;&#x5740;&#x8FDE;&#x7EED;&#x7684;), &#x7136;&#x540E;&#x53D1;&#x4E2D;&#x65AD;, &#x4F46;&#x662F;&#x5F80;&#x90A3;&#x4E2A;cpu&#x53D1;&#x5462;? 
&#x8FD9;&#x662F;&#x7531;q&#x51B3;&#x5B9A;&#x7684;. Thunder&#x4E0A;&#x4E00;&#x4E2A;&#x7F51;&#x53E3;&#x8BBE;&#x5907;&#x9ED8;&#x8BA4;&#x662F;8&#x4E2A;q, &#x4F46;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;ethtool -L tx 16 rx 16 eth0&#x6765;&#x914D;. &#x8FD9;&#x91CC;&#x7528;&#x9ED8;&#x8BA4;&#x7684;8&#x4E2A;q&#x6765;&#x5206;&#x6790;: &#x6BCF;&#x4E2A;q&#x7ED1;&#x5B9A;&#x4E00;&#x4E2A;core, &#x4E2D;&#x65AD;&#x5C31;&#x53D1;&#x5230;&#x5BF9;&#x5E94;&#x7684;core&#x4E0A;. &#x7F51;&#x53E3;&#x4E2D;&#x65AD;&#x7684;&#x4E0B;&#x534A;&#x90E8;&#x662F;NAPI, &#x4E5F;&#x662F;&#x5728;&#x540C;&#x4E00;&#x4E2A;core&#x4E0A;, NAPI&#x8D1F;&#x8D23;&#x628A;buffer&#x5904;&#x7406;&#x6210;skb, &#x7136;&#x540E;&#x7B97;hash, &#x5E76;&#x6839;&#x636E;/sys/class/net/neP6p1s0f1/queues/rx-0/rps_cpus&#x6765;&#x51B3;&#x5B9A;&#x628A;&#x8FD9;&#x4E2A;&quot;work&quot;&#x653E;&#x5230;&#x90A3;&#x4E2A;core&#x7684;q(TCP/IP&#x7684;q? &#x6BCF;&#x4E2A;core&#x90FD;&#x6709;&#x4E00;&#x4E2A;)&#x4E0A;.
&#x6CE8;&#x610F;&#x4EE5;&#x4E0A;&#x90FD;&#x6CA1;&#x6709;&#x5185;&#x5B58;&#x62F7;&#x8D1D;.
&#x7136;&#x540E;&#x5C31;&#x662F;&#x90A3;&#x4E2A;core&#x6765;&#x8DD1;TCP/IP&#x534F;&#x8BAE;&#x6808;, &#x8DD1;&#x5B8C;&#x4E86;&#x4EE5;&#x540E;, kernel&#x53D1;&#x73B0;&#x6709;&#x4E00;&#x4E2A;&#x6216;&#x591A;&#x4E2A;socket&#x7684;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#x5728;&#x7B49;&#x5F85;, &#x8FD9;&#x65F6;&#x4F1A;&#x628A;&#x8FD9;&#x4E2A;buffer(&#x6216;&#x8005;&#x53EB;skb&#x597D;&#x4E00;&#x70B9;)&#x62F7;&#x8D1D;&#x5230;&#x7528;&#x6237;&#x6001;, &#x6BCF;&#x4E2A;socket&#x90FD;&#x4F1A;&#x62F7;&#x4E00;&#x904D;.
&#x636E;&#x8BF4;&#x5185;&#x6838;&#x7684;&#x5904;&#x7406;&#x6570;&#x5EA6;&#x662F;1M pps/core.</li>
<li>DPDK&#x662F;&#x5B8C;&#x5168;&#x5728;&#x7528;&#x6237;&#x6001;&#x63A7;&#x5236;&#x786C;&#x4EF6;&#x6536;&#x53D1;&#x5305;
&#x8981;&#x7528;DPDK, &#x8981;&#x5148;unbind&#x9ED8;&#x8BA4;&#x7684;&#x7F51;&#x53E3;driver, &#x5E94;&#x8BE5;&#x662F;&#x901A;&#x8FC7;/proc, &#x6709;&#x4E2A;&#x63A5;&#x53E3;. &#x7136;&#x540E;&#x76F8;&#x5F53;&#x4E8E;&#x628A;PCIE&#x7684;&#x8BBE;&#x5907;assgin&#x7ED9;DPDK.
DPDK run&#x7684;&#x65F6;&#x5019;, &#x4F1A;&#x76F4;&#x63A5;&#x8BBF;&#x95EE;&#x5BF9;&#x5E94;&#x7684;PCIE&#x8BBE;&#x5907;&#x7684;&#x5BC4;&#x5B58;&#x5668;(&#x901A;&#x8FC7;PCIE map)&#x6765;&#x76F4;&#x63A5;&#x63A7;&#x5236;&#x786C;&#x4EF6;; buffer&#x7684;&#x95EE;&#x9898;&#x4E5F;&#x662F;&#x901A;&#x8FC7;map&#x5185;&#x6838;&#x7A7A;&#x95F4;&#x7684;&#x5185;&#x5B58;&#x6765;&#x89E3;&#x51B3;&#x7269;&#x7406;&#x5730;&#x5740;&#x8FDE;&#x7EED;&#x7684;&#x95EE;&#x9898;; &#x6CA1;&#x6709;&#x4E2D;&#x65AD;, &#x5168;&#x662F;polling.
&#x6B64;&#x65F6;&#x5185;&#x6838;&#x662F;&#x770B;&#x4E0D;&#x5230;&#x8FD9;&#x4E2A;&#x7F51;&#x53E3;&#x7684;, ifconfig&#x770B;&#x4E0D;&#x5230;.
DPDK&#x636E;&#x8BF4;~10M pps/core</li>
<li>&#x76EE;&#x524D;&#x6BCF;&#x4E2A;interface&#x6700;&#x5927;&#x652F;&#x6301;96&#x4E2A;q</li>
<li>&#x4E00;&#x4E9B;&#x53C2;&#x8003;&#x6570;&#x636E;<blockquote>
<p>Upstream driver performance(internal: Not ready to share with customers
(This is to give a rough idea  on what would be the max performance on 88xx + pass 2.0 + 2.0 Ghz )
Per core performance:
testpmd: 19.2 mpps/core
l2fwd:  11.8 mpps/core
l3fwd: 9.3 mpps/cor</p>
</blockquote>
</li>
</ul>
<h2 id="&#x7F16;&#x8BD1;&#x6A21;&#x5757;&#x7684;kernel&#x901A;&#x7528;&#x8DEF;&#x5F84;"><a name="&#x7F16;&#x8BD1;&#x6A21;&#x5757;&#x7684;kernel&#x901A;&#x7528;&#x8DEF;&#x5F84;" class="anchor-navigation-ex-anchor" href="#&#x7F16;&#x8BD1;&#x6A21;&#x5757;&#x7684;kernel&#x901A;&#x7528;&#x8DEF;&#x5F84;"><i class="fa fa-link" aria-hidden="true"></i></a>1.25. &#x7F16;&#x8BD1;&#x6A21;&#x5757;&#x7684;kernel&#x901A;&#x7528;&#x8DEF;&#x5F84;</h2>
<p>/lib/modules${kernel}/build&#x662F;&#x8F6F;&#x94FE;&#x63A5;, &#x6307;&#x5411;&#x672C;&#x5730;&#x7F16;&#x8BD1;kernel&#x7684;&#x8DEF;&#x5F84;, &#x6709;&#x4E86;&#x5B83;, &#x6211;&#x4EEC;&#x5728;&#x7F16;&#x8BD1;module&#x7684;&#x65F6;&#x5019;&#x5C31;&#x80FD;&#x65B9;&#x4FBF;&#x7684;&#x627E;&#x5230;kernel&#x7684;&#x6E90;&#x7801;&#x6811;.</p>
<h2 id="&#x901A;&#x8FC7;&#x5176;&#x4ED6;&#x673A;&#x5668;&#x4E0A;&#x5916;&#x7F51;"><a name="&#x901A;&#x8FC7;&#x5176;&#x4ED6;&#x673A;&#x5668;&#x4E0A;&#x5916;&#x7F51;" class="anchor-navigation-ex-anchor" href="#&#x901A;&#x8FC7;&#x5176;&#x4ED6;&#x673A;&#x5668;&#x4E0A;&#x5916;&#x7F51;"><i class="fa fa-link" aria-hidden="true"></i></a>1.26. &#x901A;&#x8FC7;&#x5176;&#x4ED6;&#x673A;&#x5668;&#x4E0A;&#x5916;&#x7F51;</h2>
<p>on 192.168.10.2</p>
<pre class="language-"><code>sysctl -w net.ipv4.ip_forward=1
iptables -t nat -A POSTROUTING -j MASQUERADE -s 192.168.10.0/24 -o enP9p144s0f0
</code></pre><ul>
<li>enP10p88s0f0&#x662F;&#x53EF;&#x4EE5;&#x4E0A;&#x5916;&#x7F51;&#x7684;interface</li>
<li>192.168.10.0/24 &#x662F;&#x5185;&#x7F51;&#x7F51;&#x6BB5;
on 192.168.10.3<pre class="language-"><code>route add default gw 192.168.10.2
echo &quot;nameserver 10.65.0.1&quot; &gt; /etc/resolv.conf
</code></pre></li>
</ul>
<h2 id="&#x89E3;&#x51B3;polkitd&#x7684;&#x95EE;&#x9898;"><a name="&#x89E3;&#x51B3;polkitd&#x7684;&#x95EE;&#x9898;" class="anchor-navigation-ex-anchor" href="#&#x89E3;&#x51B3;polkitd&#x7684;&#x95EE;&#x9898;"><i class="fa fa-link" aria-hidden="true"></i></a>1.27. &#x89E3;&#x51B3;polkitd&#x7684;&#x95EE;&#x9898;</h2>
<pre class="language-"><code class="lang-shell">root@Tfedora /usr/share/dbus-1/system-services
<span class="token comment"># cat org.freedesktop.PolicyKit1.service</span>
<span class="token punctuation">[</span>D-BUS Service<span class="token punctuation">]</span>
<span class="token comment">#Name=org.freedesktop.PolicyKit1</span>
<span class="token comment">#Exec=/usr/lib/polkit-1/polkitd --no-debug</span>
<span class="token comment">#User=root</span>
<span class="token comment">#SystemdService=polkit.service</span>
</code></pre>
<p>or </p>
<pre class="language-"><code>mv org.freedesktop.PolicyKit1.service org.freedesktop.PolicyKit1.service.bak
</code></pre><h2 id="sysbench&#x91CC;&#x9762;&#x968F;&#x673A;&#x51FD;&#x6570;lrand48&#x95EE;&#x9898;"><a name="sysbench&#x91CC;&#x9762;&#x968F;&#x673A;&#x51FD;&#x6570;lrand48&#x95EE;&#x9898;" class="anchor-navigation-ex-anchor" href="#sysbench&#x91CC;&#x9762;&#x968F;&#x673A;&#x51FD;&#x6570;lrand48&#x95EE;&#x9898;"><i class="fa fa-link" aria-hidden="true"></i></a>1.28. sysbench&#x91CC;&#x9762;&#x968F;&#x673A;&#x51FD;&#x6570;lrand48&#x95EE;&#x9898;</h2>
<p>&#x5728;sysbench&#x91CC;&#x9762;&#x7528;&#x4E86;lrand48&#x51FD;&#x6570;, &#x5728;&#x591A;&#x7EBF;&#x7A0B;&#x8DD1;&#x7684;&#x65F6;&#x5019;, &#x5728;thunder&#x4E0A;&#x6709;&#x7684;&#x968F;&#x673A;&#x6570;&#x4F1A;&#x91CD;&#x590D;, &#x6982;&#x7387;&#x5F88;&#x5927;, &#x4F46;x86&#x4E0A;&#x5C31;&#x6CA1;&#x6709;.
man lrand48&#x5F97;&#x77E5;:</p>
<pre class="language-"><code>$ man lrand48
ATTRIBUTES
   Multithreading (see pthreads(7))
       The drand48(), erand48(), lrand48(), nrand48(), mrand48(), jrand48(), srand48(), seed48(), and lcong48() functions record global state information for the random
       number generator, so they are not thread-safe.
</code></pre><ul>
<li>&#x8FD9;&#x4E2A;lrand48&#x4E0D;&#x662F;&#x7EBF;&#x7A0B;&#x5B89;&#x5168;&#x7684;</li>
<li>&#x53EF;&#x4EE5;&#x7528;lrand48_r, &#x8FD9;&#x4E2A;&#x662F;&#x53EF;&#x91CD;&#x5165;&#x7684;</li>
</ul>
<h2 id="ssh-keepalive"><a name="ssh-keepalive" class="anchor-navigation-ex-anchor" href="#ssh-keepalive"><i class="fa fa-link" aria-hidden="true"></i></a>1.29. ssh keepalive</h2>
<p>ssh&#x8FDE;&#x63A5;&#x8D85;&#x65F6;&#x95EE;&#x9898;&#x89E3;&#x51B3;&#x65B9;&#x6848;&#xFF1A;</p>
<ol>
<li>&#x4FEE;&#x6539;server&#x7AEF;&#x7684;etc/ssh/sshd_config
ClientAliveInterval 60 &#xFF03;server&#x6BCF;&#x9694;60&#x79D2;&#x53D1;&#x9001;&#x4E00;&#x6B21;&#x8BF7;&#x6C42;&#x7ED9;client&#xFF0C;&#x7136;&#x540E;client&#x54CD;&#x5E94;&#xFF0C;&#x4ECE;&#x800C;&#x4FDD;&#x6301;&#x8FDE;&#x63A5;
ClientAliveCountMax 3 &#xFF03;server&#x53D1;&#x51FA;&#x8BF7;&#x6C42;&#x540E;&#xFF0C;&#x5BA2;&#x6237;&#x7AEF;&#x6CA1;&#x6709;&#x54CD;&#x5E94;&#x5F97;&#x6B21;&#x6570;&#x8FBE;&#x5230;3&#xFF0C;&#x5C31;&#x81EA;&#x52A8;&#x65AD;&#x5F00;&#x8FDE;&#x63A5;&#xFF0C;&#x6B63;&#x5E38;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;client&#x4E0D;&#x4F1A;&#x4E0D;&#x54CD;&#x5E94;</li>
<li>&#x4FEE;&#x6539;client&#x7AEF;&#x7684;etc/ssh/ssh_config&#x6DFB;&#x52A0;&#x4EE5;&#x4E0B;&#xFF1A;&#xFF08;&#x5728;&#x6CA1;&#x6709;&#x6743;&#x9650;&#x6539;server&#x914D;&#x7F6E;&#x7684;&#x60C5;&#x5F62;&#x4E0B;&#xFF09;
ServerAliveInterval 60 &#xFF03;client&#x6BCF;&#x9694;60&#x79D2;&#x53D1;&#x9001;&#x4E00;&#x6B21;&#x8BF7;&#x6C42;&#x7ED9;server&#xFF0C;&#x7136;&#x540E;server&#x54CD;&#x5E94;&#xFF0C;&#x4ECE;&#x800C;&#x4FDD;&#x6301;&#x8FDE;&#x63A5;
ServerAliveCountMax 3  &#xFF03;client&#x53D1;&#x51FA;&#x8BF7;&#x6C42;&#x540E;&#xFF0C;&#x670D;&#x52A1;&#x5668;&#x7AEF;&#x6CA1;&#x6709;&#x54CD;&#x5E94;&#x5F97;&#x6B21;&#x6570;&#x8FBE;&#x5230;3&#xFF0C;&#x5C31;&#x81EA;&#x52A8;&#x65AD;&#x5F00;&#x8FDE;&#x63A5;&#xFF0C;&#x6B63;&#x5E38;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;server&#x4E0D;&#x4F1A;&#x4E0D;&#x54CD;&#x5E94;</li>
</ol>
<h2 id="git&#x751F;&#x6210;patch"><a name="git&#x751F;&#x6210;patch" class="anchor-navigation-ex-anchor" href="#git&#x751F;&#x6210;patch"><i class="fa fa-link" aria-hidden="true"></i></a>1.30. git&#x751F;&#x6210;patch</h2>
<pre class="language-"><code class="lang-shell">byj@mint ~/repo/git/thunder/RDS/alisql
$ <span class="token function">git</span> <span class="token function">diff</span> cavium_baseline cavium_optimized <span class="token operator">&gt;</span> RDS_Cavium.patch
</code></pre>
<h2 id="&#x6DFB;&#x52A0;&#x548C;&#x5220;&#x9664;&#x7F51;&#x5173;"><a name="&#x6DFB;&#x52A0;&#x548C;&#x5220;&#x9664;&#x7F51;&#x5173;" class="anchor-navigation-ex-anchor" href="#&#x6DFB;&#x52A0;&#x548C;&#x5220;&#x9664;&#x7F51;&#x5173;"><i class="fa fa-link" aria-hidden="true"></i></a>1.31. &#x6DFB;&#x52A0;&#x548C;&#x5220;&#x9664;&#x7F51;&#x5173;</h2>
<pre class="language-"><code class="lang-shell"><span class="token function">ip</span> route show
<span class="token function">ip</span> route <span class="token function">add</span> default via <span class="token number">10.97</span>.219.247 dev eth2
<span class="token function">ip</span> route del <span class="token number">10.0</span>.0.0/8
</code></pre>
<h2 id="&#x4E00;&#x6B21;&#x6027;top"><a name="&#x4E00;&#x6B21;&#x6027;top" class="anchor-navigation-ex-anchor" href="#&#x4E00;&#x6B21;&#x6027;top"><i class="fa fa-link" aria-hidden="true"></i></a>1.32. &#x4E00;&#x6B21;&#x6027;top</h2>
<p>$ ./alldo.sh &apos;top -bn1 | head -15&apos;</p>
<h2 id="coredump"><a name="coredump" class="anchor-navigation-ex-anchor" href="#coredump"><i class="fa fa-link" aria-hidden="true"></i></a>1.33. coredump</h2>
<pre class="language-"><code class="lang-shell">root@ARM ~/src/git/LuaJIT/src
<span class="token comment"># ulimit -c unlimited</span>
root@ARM ~/src/git/LuaJIT/src
<span class="token comment"># ./luajit --version</span>
Segmentation fault <span class="token punctuation">(</span>core dumped<span class="token punctuation">)</span>
root@ARM ~/src/git/LuaJIT/src
<span class="token comment"># ls core.15262 -lh</span>
-rw------- <span class="token number">1</span> root root <span class="token number">1</span>.6M <span class="token number">1</span>&#x6708;  <span class="token number">12</span> <span class="token number">15</span>:17 core.15262
root@ARM ~/src/git/LuaJIT/src
<span class="token comment"># gdb luajit core.15262</span>
</code></pre>
<ul>
<li>&#x9700;&#x8981;&#x5148;&#x662F;&#x80FD;core&#x673A;&#x5236; <code>ulimit -c unlimited</code></li>
<li>&#x9ED8;&#x8BA4;core&#x6587;&#x4EF6;&#x751F;&#x6210;&#x5728;&#x5F53;&#x524D;&#x76EE;&#x5F55;&#x4E0B;</li>
<li>gdb&#x53EF;&#x4EE5;&#x76F4;&#x63A5;debug&#x8FD9;&#x4E2A;core&#x6587;&#x4EF6; <code>gdb program core-file-name</code></li>
</ul>
<h2 id="&#x5728;thunder&#x4E0A;&#x7684;sysdig-&#x597D;&#x50CF;&#x7528;&#x4E0D;&#x8D77;&#x6765;"><a name="&#x5728;thunder&#x4E0A;&#x7684;sysdig-&#x597D;&#x50CF;&#x7528;&#x4E0D;&#x8D77;&#x6765;" class="anchor-navigation-ex-anchor" href="#&#x5728;thunder&#x4E0A;&#x7684;sysdig-&#x597D;&#x50CF;&#x7528;&#x4E0D;&#x8D77;&#x6765;"><i class="fa fa-link" aria-hidden="true"></i></a>1.34. &#x5728;thunder&#x4E0A;&#x7684;sysdig &#x597D;&#x50CF;&#x7528;&#x4E0D;&#x8D77;&#x6765;...</h2>
<pre class="language-"><code>cmake -DUSE_BUNDLED_LUAJIT=OFF ..
</code></pre><h2 id="sysdig&#x521D;&#x4F53;&#x9A8C;"><a name="sysdig&#x521D;&#x4F53;&#x9A8C;" class="anchor-navigation-ex-anchor" href="#sysdig&#x521D;&#x4F53;&#x9A8C;"><i class="fa fa-link" aria-hidden="true"></i></a>1.35. sysdig&#x521D;&#x4F53;&#x9A8C;</h2>
<p>&#x5B89;&#x88C5;: &#x6211;&#x662F;&#x53BB;sysdig&#x5B98;&#x7F51;&#x4E0B;&#x7684;deb&#x5B89;&#x88C5;&#x5305;</p>
<ul>
<li>&#x57FA;&#x672C;&#x4F7F;&#x7528;
sysdig&#x4E0D;&#x52A0;&#x53C2;&#x6570;&#x4F1A;&#x8F93;&#x51FA;&#x7CFB;&#x7EDF;&#x5B9E;&#x65F6;&#x7684;&#x7CFB;&#x7EDF;&#x8C03;&#x7528;, &#x6240;&#x6709;&#x8FDB;&#x7A0B;&#x7684;, &#x611F;&#x89C9;&#x6CA1;&#x4EC0;&#x4E48;&#x5927;&#x7528;.
<code>sudo sysdig proc.name=sshd</code> &#x8FD9;&#x79CD;&#x53EA;&#x89C2;&#x5BDF;&#x4E00;&#x4E2A;&#x8FDB;&#x7A0B;&#x7684;&#x683C;&#x5F0F;&#x53EF;&#x80FD;&#x66F4;&#x6709;&#x7528;&#x4E00;&#x70B9;, &#x4F46;&#x5176;&#x5B9E;&#x548C;strace -p&#x5DEE;&#x4E0D;&#x591A;.
&#x6240;&#x6709;&#x7684;&#x8F93;&#x51FA;&#x53EF;&#x4EE5;&#x5148;&#x5199;&#x5230;&#x6587;&#x4EF6;&#x91CC;, &#x7136;&#x540E;&#x8BFB;&#x51FA;&#x6765;, &#x6BD4;&#x5982;<pre class="language-"><code class="lang-shell">sysdig <span class="token parameter variable">-w</span> mint.scap
sysdig <span class="token parameter variable">-r</span> mint.scap
</code></pre>
</li>
<li>&#x51FF;&#x5B50;
sysdig&#x91CC;&#x9762;&#x6709;&#x4E2A;&#x5F88;&#x6709;&#x610F;&#x601D;&#x7684;&#x65B0;&#x540D;&#x8BCD;chisel(&#x51FF;&#x5B50;), &#x5B83;&#x662F;sysdig&#x7528;&#x6765;&#x5206;&#x6790;&#x4E0A;&#x9762;&#x7684;&#x4E8B;&#x4EF6;&#x6D41;&#x7684;&#x4E00;&#x4E9B;&#x811A;&#x672C;, &#x7528;
<code>sysdig -cl</code>&#x6765;&#x67E5;&#x770B;&#x6240;&#x6709;&#x652F;&#x6301;&#x7684;chisel, &#x6309;app, cpu, net, io, performance&#x7B49;&#x7B49;&#x6765;&#x5206;&#x4E86;&#x597D;&#x51E0;&#x7C7B;
&#x6BD4;&#x5982;<pre class="language-"><code class="lang-shell"><span class="token function">sudo</span> sysdig <span class="token parameter variable">-c</span> topprocs_net &#x663E;&#x793A;&#x6700;&#x5360;&#x7F51;&#x7EDC;&#x7684;&#x7A0B;&#x5E8F;
<span class="token function">sudo</span> sysdig <span class="token parameter variable">-c</span> topprocs_time &#x663E;&#x793A;&#x6700;&#x5360;&#x65F6;&#x95F4;&#x7684;&#x6587;&#x4EF6;
<span class="token function">sudo</span> sysdig <span class="token parameter variable">-c</span> topprocs_file &#x663E;&#x793A;&#x8BFB;&#x5199;&#x6587;&#x4EF6;&#x6700;&#x591A;&#x7684;&#x8FDB;&#x7A0B;
</code></pre>
</li>
<li>&#x5B9E;&#x4F8B;
&#x6211;&#x5728;&#x5C40;&#x57DF;&#x7F51;&#x7528;rsync&#x5728;&#x62F7;&#x8D1D;&#x4E00;&#x4E2A;&#x5927;&#x6587;&#x4EF6;, &#x901F;&#x5EA6;&#x5927;&#x7EA6;11M/s, &#x5728;&#x670D;&#x52A1;&#x7AEF;:
<code>sudo sysdig -c topprocs_file</code> &#x663E;&#x793A;rsync&#x6700;&#x5360;&#x6587;&#x4EF6;&#x64CD;&#x4F5C;, 11M/s
<code>sudo sysdig -c topprocs_net</code> &#x663E;&#x793A;sshd&#x6700;&#x5360;&#x7F51;&#x7EDC;, 11M/s
&#x90A3;&#x4E48;&#x5F88;&#x663E;&#x7136;, rsync&#x8D1F;&#x8D23;&#x8BFB;&#x53D6;&#x6587;&#x4EF6;&#x5185;&#x5BB9;, sshd&#x8D1F;&#x8D23;&#x4F20;&#x8F93;.
<code>sudo sysdig -c fileslower 1</code> &#x663E;&#x793A;IO&#x8C03;&#x7528;&#x5EF6;&#x65F6;&#x8D85;&#x8FC7;1ms&#x7684;
<code>sysdig -i fileslower</code> &#x7528;-i&#x9009;&#x9879;&#x53EF;&#x4EE5;&#x67E5;&#x770B;&#x5982;&#x4F55;&#x4F7F;&#x7528;
<code>sudo sysdig -c spy_users</code> &#x8FD9;&#x4E2A;&#x53EF;&#x4EE5;&#x67E5;&#x770B;&#x7CFB;&#x7EDF;&#x4E2D;&#x6240;&#x6709;&#x7528;&#x6237;&#x7684;&#x64CD;&#x4F5C;
<code>sudo sysdig -A -c spy_ip 192.168.2.13</code> &#x8FD9;&#x4E2A;&#x5389;&#x5BB3;&#x4E86;, &#x53EF;&#x4EE5;&#x68C0;&#x6D4B;&#x548C;192.168.2.13&#x7684;&#x6570;&#x636E;&#x4F20;&#x8F93;. &#x4F46;&#x4F3C;&#x4E4E;ping&#x62A5;&#x6587;&#x6CA1;&#x6CD5;&#x76D1;&#x63A7;. -A&#x7684;&#x610F;&#x601D;&#x662F;ascii&#x65B9;&#x5F0F;&#x663E;&#x793A;
&#x663E;&#x793A;cat&#x6253;&#x5F00;&#x7684;&#x6240;&#x6709;&#x6587;&#x4EF6;&#x7684;&#x540D;&#x79F0;, &#x6CE8;&#x610F;evt.arg.name&#x5C31;&#x8868;&#x793A;&#x8FD9;&#x4E2A;&#x540D;&#x79F0;, -p%&#x662F;&#x6253;&#x5370;&#x683C;&#x5F0F;<pre class="language-"><code class="lang-shell">$ <span class="token function">sudo</span> sysdig -p<span class="token string">&quot;%evt.arg.name&quot;</span> <span class="token assign-left variable">proc.name</span><span class="token operator">=</span>cat and <span class="token assign-left variable">evt.type</span><span class="token operator">=</span>open
/etc/ld.so.cache
/lib/x86_64-linux-gnu/libc.so.6
/usr/lib/locale/locale-archive
/home/byj/tmp/octeon_edac-lmc.c.patch
</code></pre>
&#x6CE8;&#x610F;&#x4E0A;&#x9762;&#x7684;&#x4F8B;&#x5B50;&#x4F7F;&#x7528;&#x4E86;&#x6761;&#x4EF6;, proc.name=&#x548C;evt.type, sysdig&#x652F;&#x6301;&#x7684;&#x6761;&#x4EF6;&#x53EF;&#x4EE5;&#x7528;<code>sysdig -l</code>&#x6765;&#x67E5;&#x770B;
&#x8FC7;&#x6EE4;&#x5668;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x6BD4;&#x8F83;&#x64CD;&#x4F5C;&#x7B26; &#x5982;  (=, !=, &lt;, &lt;=, &gt;, &gt;=, contains) &#x4E14;&#x53EF;&#x4EE5;&#x8054;&#x5408;&#x5E03;&#x5C14;&#x64CD;&#x4F5C;&#x7B26; (and, or and not) &#x8FD8;&#x6709;&#x62EC;&#x53F7;</li>
</ul>
<h2 id="ulimit&#x8FDB;&#x7A0B;&#x6570;&#x9650;&#x5236;"><a name="ulimit&#x8FDB;&#x7A0B;&#x6570;&#x9650;&#x5236;" class="anchor-navigation-ex-anchor" href="#ulimit&#x8FDB;&#x7A0B;&#x6570;&#x9650;&#x5236;"><i class="fa fa-link" aria-hidden="true"></i></a>1.36. ulimit&#x8FDB;&#x7A0B;&#x6570;&#x9650;&#x5236;</h2>
<pre class="language-"><code class="lang-shell"><span class="token function">vim</span> /etc/security/limits.conf
<span class="token function">vim</span> /etc/security/limits.d/20-nproc.conf
</code></pre>
<h2 id="&#x5728;thunder&#x4E0A;&#x505A;&#x76D8;"><a name="&#x5728;thunder&#x4E0A;&#x505A;&#x76D8;" class="anchor-navigation-ex-anchor" href="#&#x5728;thunder&#x4E0A;&#x505A;&#x76D8;"><i class="fa fa-link" aria-hidden="true"></i></a>1.37. &#x5728;thunder&#x4E0A;&#x505A;&#x76D8;</h2>
<pre class="language-"><code class="lang-shell"><span class="token builtin class-name">export</span> <span class="token assign-left variable">THUNDER_ROOT</span><span class="token operator">=</span>/root/src/ThunderX-SDK
lsblk
./create_disk.sh --raw-disk /dev/sdb
</code></pre>
<h2 id="rtc&#x65F6;&#x95F4;"><a name="rtc&#x65F6;&#x95F4;" class="anchor-navigation-ex-anchor" href="#rtc&#x65F6;&#x95F4;"><i class="fa fa-link" aria-hidden="true"></i></a>1.38. rtc&#x65F6;&#x95F4;</h2>
<p><code>date 123010372015</code>
<code>hwclock -s</code> &#x8BFB;rtc&#x5230;&#x7CFB;&#x7EDF;&#x65F6;&#x95F4;
<code>hwclock -w</code> &#x628A;&#x7CFB;&#x7EDF;&#x65F6;&#x95F4;&#x5199;&#x5165;rtc</p>
<h2 id="sata-slow-sync&#x95EE;&#x9898;"><a name="sata-slow-sync&#x95EE;&#x9898;" class="anchor-navigation-ex-anchor" href="#sata-slow-sync&#x95EE;&#x9898;"><i class="fa fa-link" aria-hidden="true"></i></a>1.39. SATA slow sync&#x95EE;&#x9898;</h2>
<ul>
<li>&#x5DE5;&#x5177;: iobench</li>
<li>&#x5173;&#x952E;&#x8BCD;: softirq smp_function_call IPI</li>
<li>&#x5173;&#x4E8E;smp function call, &#x5B83;&#x7684;&#x76EE;&#x7684;&#x662F;<strong>&#x8BA9;&#x53E6;&#x5916;&#x4E00;&#x4E2A;cpu&#x6765;&#x6267;&#x884C;&#x4E00;&#x4E2A;&#x51FD;&#x6570;</strong>
linux/kernel/linux-aarch64/block/blk-softirq.c
&#x6BD4;&#x5982;&#x5728;&#x672C;cpu&#x4E0A;&#x6267;&#x884C;<pre class="language-"><code class="lang-c"><span class="token comment">/*
* Setup and invoke a run of &apos;trigger_softirq&apos; on the given cpu.
*/</span>
<span class="token keyword">static</span> <span class="token keyword">int</span> <span class="token function">raise_blk_irq</span><span class="token punctuation">(</span><span class="token keyword">int</span> cpu<span class="token punctuation">,</span> <span class="token keyword">struct</span> <span class="token class-name">request</span> <span class="token operator">*</span>rq<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">cpu_online</span><span class="token punctuation">(</span>cpu<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token keyword">struct</span> <span class="token class-name">call_single_data</span> <span class="token operator">*</span>data <span class="token operator">=</span> <span class="token operator">&amp;</span>rq<span class="token operator">-&gt;</span>csd<span class="token punctuation">;</span>
data<span class="token operator">-&gt;</span>func <span class="token operator">=</span> trigger_softirq<span class="token punctuation">;</span>
data<span class="token operator">-&gt;</span>info <span class="token operator">=</span> rq<span class="token punctuation">;</span>
data<span class="token operator">-&gt;</span>flags <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token function">smp_call_function_single_async</span><span class="token punctuation">(</span>cpu<span class="token punctuation">,</span> data<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
&#x5B83;&#x7528;IPI(&#x6838;&#x95F4;&#x4E2D;&#x65AD;)&#x6765;&#x901A;&#x77E5;&#x53E6;&#x4E00;&#x4E2A;CPU&#x6765;&#x6267;&#x884C;&#x4E0B;&#x9762;&#x7684;&#x51FD;&#x6570;, &#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#x662F;<pre class="language-"><code class="lang-c"><span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">trigger_softirq</span><span class="token punctuation">(</span><span class="token keyword">void</span> <span class="token operator">*</span>data<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
<span class="token keyword">struct</span> <span class="token class-name">request</span> <span class="token operator">*</span>rq <span class="token operator">=</span> data<span class="token punctuation">;</span>
<span class="token keyword">unsigned</span> <span class="token keyword">long</span> flags<span class="token punctuation">;</span>
<span class="token keyword">struct</span> <span class="token class-name">list_head</span> <span class="token operator">*</span>list<span class="token punctuation">;</span>
<span class="token function">local_irq_save</span><span class="token punctuation">(</span>flags<span class="token punctuation">)</span><span class="token punctuation">;</span>
list <span class="token operator">=</span> <span class="token function">this_cpu_ptr</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>blk_cpu_done<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">list_add_tail</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>rq<span class="token operator">-&gt;</span>ipi_list<span class="token punctuation">,</span> list<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>list<span class="token operator">-&gt;</span>next <span class="token operator">==</span> <span class="token operator">&amp;</span>rq<span class="token operator">-&gt;</span>ipi_list<span class="token punctuation">)</span>
<span class="token function">raise_softirq_irqoff</span><span class="token punctuation">(</span>BLOCK_SOFTIRQ<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">local_irq_restore</span><span class="token punctuation">(</span>flags<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
</li>
</ul>
<h2 id="&#x4F7F;&#x7528;native-gcc&#x7684;&#x53D8;&#x91CF;&#x8BBE;&#x7F6E;"><a name="&#x4F7F;&#x7528;native-gcc&#x7684;&#x53D8;&#x91CF;&#x8BBE;&#x7F6E;" class="anchor-navigation-ex-anchor" href="#&#x4F7F;&#x7528;native-gcc&#x7684;&#x53D8;&#x91CF;&#x8BBE;&#x7F6E;"><i class="fa fa-link" aria-hidden="true"></i></a>1.40. &#x4F7F;&#x7528;native gcc&#x7684;&#x53D8;&#x91CF;&#x8BBE;&#x7F6E;</h2>
<pre class="language-"><code class="lang-shell"><span class="token shebang important">#!/bin/sh</span>
<span class="token builtin class-name">export</span> <span class="token assign-left variable">MY_ROOT_DIR</span><span class="token operator">=</span><span class="token variable"><span class="token variable">`</span><span class="token builtin class-name">pwd</span><span class="token variable">`</span></span>
<span class="token comment">#export PATH=$MY_ROOT_DIR/gcc5-native/bin:$PATH</span>
<span class="token comment">#export LD_LIBRARY_PATH=$MY_ROOT_DIR/gcc5-native/lib64</span>
<span class="token builtin class-name">export</span> <span class="token assign-left variable"><span class="token environment constant">PATH</span></span><span class="token operator">=</span><span class="token variable">$MY_ROOT_DIR</span>/thunderx-tools-414/aarch64-thunderx-linux-gnu/sys-root/usr/bin:<span class="token environment constant">$PATH</span>
<span class="token builtin class-name">export</span> <span class="token assign-left variable">LD_LIBRARY_PATH</span><span class="token operator">=</span><span class="token variable">$MY_ROOT_DIR</span>/thunderx-tools-414/aarch64-thunderx-linux-gnu/sys-root/lib64
</code></pre>
<h2 id="smpaffinity&#x548C;rpscpus"><a name="smpaffinity&#x548C;rpscpus" class="anchor-navigation-ex-anchor" href="#smpaffinity&#x548C;rpscpus"><i class="fa fa-link" aria-hidden="true"></i></a>1.41. smp_affinity&#x548C;rps_cpus</h2>
<p>&#x7B80;&#x5355;&#x7684;&#x8BF4;, &#x4E24;&#x4E2A;&#x90FD;&#x662F;&#x5747;&#x8861;&#x7F51;&#x5361;&#x4E2D;&#x65AD;&#x7684;, &#x533A;&#x522B;&#x4F3C;&#x4E4E;&#x662F;:</p>
<ul>
<li>smp_affinity&#x662F;&#x591A;&#x961F;&#x5217;&#x7F51;&#x5361;&#x591A;&#x4E2D;&#x65AD;&#x60C5;&#x51B5;&#x4E0B;&#x7528;&#x7684;, &#x786C;&#x4EF6;&#x4E2D;&#x65AD;&#x5230;&#x54EA;&#x4E2A;&#x6838;&#x5904;&#x7406;</li>
<li>rps_cpus&#x662F;&#x786C;&#x4EF6;&#x4E2D;&#x65AD;&#x641E;&#x5B8C;&#x4E86;&#x4EE5;&#x540E;, &#x53EF;&#x4EE5;&#x628A;&#x63A5;&#x4E0B;&#x6765;&#x7684;&#x4E0B;&#x534A;&#x90E8;&#x4EA4;&#x7ED9;&#x5176;&#x4ED6;&#x6838;&#x5904;&#x7406;.
&#x5982;&#x679C;&#x4E3A;0, &#x5219;&#x9ED8;&#x8BA4;&#x8FD8;&#x662F;&#x672C;&#x6838;&#x5904;&#x7406;
&#x603B;&#x7ED3;&#x4E0B;&#x6765;, <strong>&#x4E2D;&#x65AD;&#x6765;&#x4E86;, &#x5148;&#x770B;smp_affinity&#x5230;&#x54EA;&#x4E2A;&#x6838;, &#x6B64;&#x65F6;&#x662F;&#x786C;&#x4E2D;&#x65AD;&#x6D41;&#x7A0B;.
&#x786C;&#x4E2D;&#x65AD;&#x5904;&#x7406;&#x5B8C;&#x4E86;, &#x518D;&#x770B;rps_cpus, &#x5206;&#x53D1;&#x5230;&#x54EA;&#x4E2A;&#x6838;&#x4E0A;&#x505A;&#x4E0B;&#x534A;&#x90E8;.</strong></li>
</ul>
<h2 id="mysql&#x8C03;&#x8BD5;&#x65B9;&#x6CD5;&#x8BBA;&#x4E4B;&#x5404;&#x79CD;&#x8C03;&#x8BD5;&#x548C;&#x68C0;&#x6D4B;&#x547D;&#x4EE4;"><a name="mysql&#x8C03;&#x8BD5;&#x65B9;&#x6CD5;&#x8BBA;&#x4E4B;&#x5404;&#x79CD;&#x8C03;&#x8BD5;&#x548C;&#x68C0;&#x6D4B;&#x547D;&#x4EE4;" class="anchor-navigation-ex-anchor" href="#mysql&#x8C03;&#x8BD5;&#x65B9;&#x6CD5;&#x8BBA;&#x4E4B;&#x5404;&#x79CD;&#x8C03;&#x8BD5;&#x548C;&#x68C0;&#x6D4B;&#x547D;&#x4EE4;"><i class="fa fa-link" aria-hidden="true"></i></a>1.42. mysql&#x8C03;&#x8BD5;&#x65B9;&#x6CD5;&#x8BBA;&#x4E4B;&#x5404;&#x79CD;&#x8C03;&#x8BD5;&#x548C;&#x68C0;&#x6D4B;&#x547D;&#x4EE4;</h2>
<p>&#x9996;&#x5148;&#x8981;&#x5BF9;mysql&#x7279;&#x522B;&#x6709;&#x7814;&#x7A76;, &#x5BF9;&#x4EE3;&#x7801;, &#x5404;&#x79CD;&#x9009;&#x9879;, <strong>performance-schema=1</strong>, &#x8FD9;&#x662F;&#x7B2C;&#x4E00;&#x70B9;.
&#x7136;&#x540E;&#x662F;&#x5404;&#x79CD;&#x7CFB;&#x7EDF;&#x5DE5;&#x5177;&#x7684;&#x4F7F;&#x7528;, &#x6BD4;&#x5982;vmstat, mpstat, top, ps, &#x7F51;&#x7EDC;&#x5DE5;&#x5177;&#x7B49;&#x7B49;
<code>mpstat -P ALL</code> &#x67E5;&#x770B;&#x6240;&#x6709;cpu&#x7684;&#x72B6;&#x6001;
<code>vmstat -w</code>
&#x7136;&#x540E;&#x662F;&#x7528;perf&#x6765;&#x5206;&#x6790;hotpot&#x4EE3;&#x7801;
&#x6700;&#x540E;&#x662F;debug&#x4EE3;&#x7801;&#x7684;&#x624B;&#x6BB5;:
&#x6BD4;&#x5982;<code>pstack</code>&#x548C;<code>gdb</code>&#x7684;&#x4F7F;&#x7528;, &#x5982;&#x679C;&#x7A0B;&#x5E8F;&#x8DD1;&#x5230;&#x4E86;&#x4E00;&#x4E2A;&#x6301;&#x7EED;&#x7684;&#x5F02;&#x5E38;&#x72B6;&#x6001;, &#x6BD4;&#x5982;sysbench&#x6D4B;&#x8BD5;&#x7684;&#x65F6;&#x5019;&#x6BCF;&#x79D2;&#x7EDF;&#x8BA1;&#x90FD;&#x662F;0, &#x8FD9;&#x65F6;&#x9700;&#x8981;&#x5148;<code>pstack</code>&#x6765;&#x67E5;&#x8C03;&#x7528;&#x6808;, &#x5728;<code>pstack</code>&#x6267;&#x884C;&#x671F;&#x95F4;, &#x8FD9;&#x4E2A;&#x8FDB;&#x7A0B;&#x7684;&#x6240;&#x6709;&#x7EBF;&#x7A0B;&#x90FD;&#x4F1A;&#x88AB;&#x505C;&#x4F4F;, &#x4ECE;&#x8C03;&#x7528;&#x6808;&#x91CC;&#x9762;&#x67E5;&#x770B;&#x7AEF;&#x502A;. &#x4E0B;&#x4E00;&#x6B65;&#x5C31;&#x662F;&#x7528;<code>gdb -p</code>&#x53BB;&#x8DDF;.</p>
<pre class="language-"><code>pstack -p
strace -p
gdb -p
sysdig
lttng
</code></pre><p>&#x4EE5;&#x4E0A;&#x6240;&#x6709;&#x8FD9;&#x4E9B;&#x90FD;&#x662F;&#x624B;&#x6BB5;, &#x5176;&#x5B9E;&#x771F;&#x6B63;&#x7684;&#x4E1C;&#x897F;&#x662F;, &#x7406;&#x89E3;&#x5185;&#x6838;, &#x7406;&#x89E3;libc, &#x7406;&#x89E3;&#x5E94;&#x7528;, &#x90FD;&#x8981;&#x6DF1;&#x5165;&#x7406;&#x89E3;.</p>
<ul>
<li>vmstat&#x547D;&#x4EE4;
<code>vmstat -w 5 $((3600*3))</code>
3&#x5C0F;&#x65F6;, &#x8F93;&#x51FA;&#x5BF9;&#x9F50;
&#x83B7;&#x53D6;&#x6240;&#x6709;cpu&#x7684;&#x5229;&#x7528;&#x7387;&#x4FE1;&#x606F;
<code>mpstat -P ALL 5 1</code>
<code>iostat -x /dev/sda</code></li>
<li>pstack&#x547D;&#x4EE4;
pstack&#x547D;&#x4EE4;&#x53EF;&#x4EE5;&#x6253;&#x5370;&#x8FDB;&#x7A0B;&#x7684;&#x8C03;&#x7528;&#x6808;. &#x57FA;&#x672C;&#x539F;&#x7406;&#x662F;pstack&#x544A;&#x8BC9;kernel&#x4FDD;&#x5B58;&#x4E00;&#x4E2A;&#x8FD9;&#x4E2A;&#x8FDB;&#x7A0B;&#x7684;&#x6808;&#x5FEB;&#x7167;, &#x7136;&#x540E;show&#x51FA;&#x6765;.</li>
</ul>
<h2 id="mysql&#x6027;&#x80FD;&#x63D0;&#x5347;&#x4E4B;&#x7F51;&#x53E3;&#x4E2D;&#x65AD;"><a name="mysql&#x6027;&#x80FD;&#x63D0;&#x5347;&#x4E4B;&#x7F51;&#x53E3;&#x4E2D;&#x65AD;" class="anchor-navigation-ex-anchor" href="#mysql&#x6027;&#x80FD;&#x63D0;&#x5347;&#x4E4B;&#x7F51;&#x53E3;&#x4E2D;&#x65AD;"><i class="fa fa-link" aria-hidden="true"></i></a>1.43. mysql&#x6027;&#x80FD;&#x63D0;&#x5347;&#x4E4B;&#x7F51;&#x53E3;&#x4E2D;&#x65AD;</h2>
<blockquote>
<p>We don&apos;t have hardware assisted flow director and having more number of queues means interrupts are shared
on many CPUs and mysql threads frequently get context switched. Hence low performance. Right from beginning we
always saw better performance with leaving cores 0-8 aside and pinning mysql to CPUs 9-47 (of node0). 
If possible, can you try one experiment (with below settings) and see if that benefits.
Replace eth0 with whatever interface you are using.</p>
<pre class="language-"><code class="lang-shell"><span class="token builtin class-name">echo</span> <span class="token number">0</span> <span class="token operator">&gt;</span> /sys/class/net/eth0/queues/rx-0/rps_cpus
<span class="token builtin class-name">echo</span> <span class="token number">0</span> <span class="token operator">&gt;</span> /sys/class/net/eth0/queues/rx-1/rps_cpus
<span class="token builtin class-name">echo</span> <span class="token number">0</span> <span class="token operator">&gt;</span> /sys/class/net/eth0/queues/rx-2/rps_cpus
<span class="token builtin class-name">echo</span> <span class="token number">0</span> <span class="token operator">&gt;</span> /sys/class/net/eth0/queues/rx-3/rps_cpus
<span class="token builtin class-name">echo</span> <span class="token number">0</span> <span class="token operator">&gt;</span> /sys/class/net/eth0/queues/rx-4/rps_cpus
<span class="token builtin class-name">echo</span> <span class="token number">0</span> <span class="token operator">&gt;</span> /sys/class/net/eth0/queues/rx-5/rps_cpus
<span class="token builtin class-name">echo</span> <span class="token number">0</span> <span class="token operator">&gt;</span> /sys/class/net/eth0/queues/rx-6/rps_cpus
<span class="token builtin class-name">echo</span> <span class="token number">0</span> <span class="token operator">&gt;</span> /sys/class/net/eth0/queues/rx-7/rps_cpus
<span class="token builtin class-name">echo</span> <span class="token number">32768</span> <span class="token operator">&gt;</span> /proc/sys/net/core/rps_sock_flow_entries
<span class="token builtin class-name">echo</span> <span class="token number">4096</span> <span class="token operator">&gt;</span> /sys/class/net/eth0/queues/rx-0/rps_flow_cnt
<span class="token builtin class-name">echo</span> <span class="token number">4096</span> <span class="token operator">&gt;</span> /sys/class/net/eth0/queues/rx-1/rps_flow_cnt
<span class="token builtin class-name">echo</span> <span class="token number">4096</span> <span class="token operator">&gt;</span> /sys/class/net/eth0/queues/rx-2/rps_flow_cnt
<span class="token builtin class-name">echo</span> <span class="token number">4096</span> <span class="token operator">&gt;</span> /sys/class/net/eth0/queues/rx-3/rps_flow_cnt
<span class="token builtin class-name">echo</span> <span class="token number">4096</span> <span class="token operator">&gt;</span> /sys/class/net/eth0/queues/rx-4/rps_flow_cnt
<span class="token builtin class-name">echo</span> <span class="token number">4096</span> <span class="token operator">&gt;</span> /sys/class/net/eth0/queues/rx-5/rps_flow_cnt
<span class="token builtin class-name">echo</span> <span class="token number">4096</span> <span class="token operator">&gt;</span> /sys/class/net/eth0/queues/rx-6/rps_flow_cnt
<span class="token builtin class-name">echo</span> <span class="token number">4096</span> <span class="token operator">&gt;</span> /sys/class/net/eth0/queues/rx-7/rps_flow_cnt
</code></pre>
</blockquote>
<h2 id="&#x89E3;&#x51B3;sync-flood&#x95EE;&#x9898;"><a name="&#x89E3;&#x51B3;sync-flood&#x95EE;&#x9898;" class="anchor-navigation-ex-anchor" href="#&#x89E3;&#x51B3;sync-flood&#x95EE;&#x9898;"><i class="fa fa-link" aria-hidden="true"></i></a>1.44. &#x89E3;&#x51B3;sync flood&#x95EE;&#x9898;</h2>
<ul>
<li>&#x73B0;&#x8C61;&#x662F;<pre class="language-"><code>[142943.335106] TCP: request_sock_TCP: Possible SYN flooding on port 25616. Sending cookies.  Check SNMP counters.
[143245.955016] TCP: request_sock_TCP: Possible SYN flooding on port 25616. Sending cookies.  Check SNMP counters.
[143397.874323] TCP: request_sock_TCP: Possible SYN flooding on port 25616. Sending cookies.  Check SNMP counters.
[146560.278277] TCP: request_sock_TCP: Possible SYN flooding on port 25616. Sending cookies.  Check SNMP counters.
</code></pre></li>
<li>&#x89E3;&#x51B3;</li>
<li>Set net.ipv4.tcp_max_syn_backlog and net.core.somaxconn to large enough values (I used 4096 for both)</li>
<li>Set back_log in my.cnf to a large enough value (I used 4096)</li>
</ul>
<h2 id="mysql&#x8C03;&#x4F18;&#x4E4B;&#x74F6;&#x9888;&#x5728;&#x54EA;-&#x7406;&#x8BBA;"><a name="mysql&#x8C03;&#x4F18;&#x4E4B;&#x74F6;&#x9888;&#x5728;&#x54EA;-&#x7406;&#x8BBA;" class="anchor-navigation-ex-anchor" href="#mysql&#x8C03;&#x4F18;&#x4E4B;&#x74F6;&#x9888;&#x5728;&#x54EA;-&#x7406;&#x8BBA;"><i class="fa fa-link" aria-hidden="true"></i></a>1.45. mysql&#x8C03;&#x4F18;&#x4E4B;&#x74F6;&#x9888;&#x5728;&#x54EA;? &#x7406;&#x8BBA;</h2>
<p>mysql&#x4E13;&#x5BB6;:Aleksei
Kopytov Alexey <a href="mailto:kaamos@yandex.ru" target="_blank">kaamos@yandex.ru</a>
&#x5728;&#x5347;&#x7EA7;&#x4E86;&#x65B0;&#x7684;kernel&#x5230;4.2&#x4E4B;&#x540E;, throughput&#x4E0B;&#x964D;&#x4E86;, &#x4F46;&#x4E13;&#x5BB6;&#x5728;&#x770B;&#x4E86;mysql&#x7684;&#x81EA;&#x6709;&#x7684;&#x8C03;&#x8BD5;&#x6846;&#x67B6;&#x7684;&#x8F93;&#x51FA;&#x4E4B;&#x540E;, &#x53CD;&#x800C;&#x89C9;&#x5F97;&#x65B0;&#x5185;&#x6838;&#x66F4;&#x597D;.
&#x4E3A;&#x4EC0;&#x4E48;&#x5462;?
&#x4E13;&#x5BB6;&#x4F7F;&#x7528;&#x4E86;&#x4E00;&#x4E2A;&#x5F88;&#x5F62;&#x8C61;&#x7684;&#x6BD4;&#x55BB;:
<em>&#x8FD9;&#x5C31;&#x50CF;&#x662F;&#x516C;&#x8DEF;&#x4E0A;&#x7684;&#x5835;&#x8F66;&#x73B0;&#x8C61;, &#x539F;&#x6765;&#x6709;&#x4E24;&#x4E2A;&#x5730;&#x65B9;&#x6BD4;&#x8F83;&#x7A84;, &#x5927;&#x5BB6;&#x4E00;&#x6B21;&#x901A;&#x8FC7;&#x8FD9;&#x4E24;&#x4E2A;&#x5730;&#x65B9;, &#x8F66;&#x6D41;&#x91CF;&#x8FD8;&#x662F;&#x53EF;&#x4EE5;&#x7684;;
&#x4F46;&#x4E00;&#x65E6;&#x7B2C;&#x4E00;&#x4E2A;&#x7A84;&#x53E3;&#x5B50;&#x53D8;&#x5BBD;&#x4E86;&#x4E4B;&#x540E;, &#x4F1A;&#x6709;&#x66F4;&#x591A;&#x7684;&#x8F66;&#x6765;&#x5230;&#x7B2C;&#x4E8C;&#x4E2A;&#x7A84;&#x53E3;, &#x6B64;&#x65F6;&#x8FD9;&#x91CC;&#x7684;&#x7ADE;&#x4E89;&#x66F4;&#x52A0;&#x6FC0;&#x70C8;, &#x4E92;&#x4E0D;&#x76F8;&#x8BA9;, &#x7ED3;&#x679C;&#x5C31;&#x662F;&#x8F66;&#x6D41;&#x91CF;&#x53CD;&#x800C;&#x4E0B;&#x964D;&#x4E86;.</em></p>
<h2 id="mysql&#x8C03;&#x4F18;&#x4E4B;innodbspinwaitdelay--30"><a name="mysql&#x8C03;&#x4F18;&#x4E4B;innodbspinwaitdelay--30" class="anchor-navigation-ex-anchor" href="#mysql&#x8C03;&#x4F18;&#x4E4B;innodbspinwaitdelay--30"><i class="fa fa-link" aria-hidden="true"></i></a>1.46. mysql&#x8C03;&#x4F18;&#x4E4B;innodb_spin_wait_delay = 30</h2>
<p>&#x5728;&#x7528;&#x4E86;&#x65B0;&#x7684;&#x5185;&#x6838;&#x4E4B;&#x540E;, throughput&#x964D;&#x4F4E;&#x4E86;(50K), &#x4F46;&#x662F;&#x901A;&#x8FC7;&#x4E13;&#x5BB6;&#x7684;&#x53D1;&#x73B0;, mutex&#x8017;&#x65F6;&#x6700;&#x957F;(&#x8FD9;&#x91CC;&#x7684;mutex&#x5DF2;&#x7ECF;&#x662F;&#x7528;&#x6237;&#x6001;&#x7684;spinlock, &#x7528;&#x4E86;atomic&#x7684;&#x4E1C;&#x4E1C;).
&#x5F53;innodb_spin_wait_delay = 100&#x65F6;, throughput&#x63D0;&#x9AD8;&#x4E86;(&#x5230;70K).
&#x8FD9;&#x91CC;&#x8FD9;&#x4E2A;&#x4E1C;&#x897F;&#x7684;&#x542B;&#x4E49;&#x662F;, &#x5F53;&#x7ADE;&#x4E89;&#x4E00;&#x4E2A;&#x9501;&#x7684;&#x65F6;&#x5019;, &#x7A0B;&#x5E8F;&#x5148;spin&#x591A;&#x4E45;, &#x7136;&#x540E;&#x5C31;&#x653E;&#x5F03;CPU&#x8FDB;&#x5165;&#x7761;&#x7720;.
&#x5F53;&#x6838;&#x591A;&#x7684;&#x65F6;&#x5019;, &#x5927;&#x5BB6;&#x5F53;&#x7136;&#x8981;&#x7B49;&#x7684;&#x65F6;&#x95F4;&#x591A;&#x4E9B;.</p>
<h2 id="memcpy&#x548C;strcpy"><a name="memcpy&#x548C;strcpy" class="anchor-navigation-ex-anchor" href="#memcpy&#x548C;strcpy"><i class="fa fa-link" aria-hidden="true"></i></a>1.47. memcpy&#x548C;strcpy</h2>
<p>&#x7406;&#x8BBA;&#x4E0A;, memcpy&#x80AF;&#x5B9A;&#x6BD4;strcpy&#x5FEB;.
&#x4F46;&#x6211;&#x4EEC;&#x5728;&#x8C03;&#x8BD5;translator&#x7684;&#x65F6;&#x5019;, &#x53D1;&#x73B0;strcpy&#x53CD;&#x800C;&#x66F4;&#x5FEB;&#x4E00;&#x70B9;.
&#x4E3A;&#x4EC0;&#x4E48;&#x5462;?
<strong>&#x56E0;&#x4E3A;malloc&#x7684;&#x5BF9;&#x9F50;&#x95EE;&#x9898;!</strong>
&#x4FEE;&#x6539;m_alloc&#x51FD;&#x6570;, &#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#x7684;&#x5165;&#x53C2;size&#x8868;&#x793A;&#x8981;&#x7533;&#x8BF7;&#x591A;&#x5C11;&#x4E2A;&#x5B57;&#x8282;, 
&#x5728;m_alloc&#x51FD;&#x6570;&#x5185;&#x90E8;, &#x628A;&#x8FD9;&#x4E2A;size&#x5F3A;&#x5236;16&#x5B57;&#x8282;&#x5BF9;&#x9F50;,
<code>ullMemSize = (ullMemSize+16)&amp;~0xf;</code>
&#x7ED3;&#x679C;&#x5FEB;&#x5F88;&#x591A;! &#x5BF9;&#x4E00;&#x4E2A;&#x9891;&#x7E41;&#x64CD;&#x4F5C;&#x5B57;&#x7B26;&#x4E32;&#x6216;&#x8005;&#x5185;&#x5B58;&#x7684;&#x5E94;&#x7528;&#x6765;&#x8BF4;, &#x8FD9;&#x70B9;&#x5F71;&#x54CD;&#x81F3;&#x5173;&#x91CD;&#x8981;!</p>
<h2 id="perf&#x8C03;&#x8BD5;&#x5355;&#x8FDB;&#x7A0B;-&#x8C03;&#x7528;&#x6808;"><a name="perf&#x8C03;&#x8BD5;&#x5355;&#x8FDB;&#x7A0B;-&#x8C03;&#x7528;&#x6808;" class="anchor-navigation-ex-anchor" href="#perf&#x8C03;&#x8BD5;&#x5355;&#x8FDB;&#x7A0B;-&#x8C03;&#x7528;&#x6808;"><i class="fa fa-link" aria-hidden="true"></i></a>1.48. perf&#x8C03;&#x8BD5;&#x5355;&#x8FDB;&#x7A0B;, &#x8C03;&#x7528;&#x6808;?</h2>
<p>&#x7528;-g &#x9009;&#x9879;</p>
<h2 id="numactl"><a name="numactl" class="anchor-navigation-ex-anchor" href="#numactl"><i class="fa fa-link" aria-hidden="true"></i></a>1.49. numactl</h2>
<p>numactl&#x53EF;&#x4EE5;&#x63A7;&#x5236;&#x4E00;&#x4E2A;&#x8FDB;&#x7A0B;&#x4EE5;&#x53CA;&#x4ED6;&#x7684;&#x6240;&#x6709;&#x5B50;&#x8FDB;&#x7A0B;&#x7684;numa&#x8FD0;&#x884C;&#x6A21;&#x5F0F;, &#x6BD4;&#x5982;&#x7ED1;&#x5B9A;&#x5230;&#x67D0;&#x4E2A;node&#x4E0A;.</p>
<h2 id="&#x9884;&#x53D6;-prefetch"><a name="&#x9884;&#x53D6;-prefetch" class="anchor-navigation-ex-anchor" href="#&#x9884;&#x53D6;-prefetch"><i class="fa fa-link" aria-hidden="true"></i></a>1.50. &#x9884;&#x53D6; prefetch</h2>
<p>&#x5982;&#x679C; perf&#x53D1;&#x73B0;&#x70ED;&#x70B9;&#x4EE3;&#x7801;&#x5728;ldr xxx, &#x8BF4;&#x660E;&#x5B83;&#x5728;&#x4E0D;&#x65AD;load&#x4EC0;&#x4E48;&#x4E1C;&#x897F;. &#x6B64;&#x65F6;&#x7528;prefetch&#x4F1A;&#x597D;&#x70B9;.</p>
<pre class="language-"><code class="lang-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name function">PRFM</span><span class="token expression"><span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">)</span> <span class="token keyword">asm</span><span class="token punctuation">(</span></span><span class="token string">&quot;prfm pldl1strm, [%x[a], %[off] ]&quot;</span> <span class="token expression"><span class="token operator">:</span> <span class="token operator">:</span> <span class="token punctuation">[</span>a<span class="token punctuation">]</span></span><span class="token string">&quot;r&quot;</span><span class="token expression"><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>off<span class="token punctuation">]</span></span><span class="token string">&quot;i&quot;</span><span class="token expression"><span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token punctuation">)</span></span></span>
<span class="token keyword">float</span> Decoder<span class="token operator">::</span><span class="token function">CalcModelScore</span><span class="token punctuation">(</span> Hypothesis<span class="token operator">*</span> hypo <span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">float</span> score <span class="token operator">=</span> <span class="token number">0.0</span><span class="token punctuation">;</span>
    <span class="token class-name">size_t</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    std<span class="token operator">::</span>vector<span class="token operator">&lt;</span><span class="token keyword">float</span><span class="token operator">&gt;</span> <span class="token operator">&amp;</span>mfw <span class="token operator">=</span> m_model<span class="token operator">-&gt;</span>m_featWeights<span class="token punctuation">;</span>
    std<span class="token operator">::</span>vector<span class="token operator">&lt;</span><span class="token keyword">float</span><span class="token operator">&gt;</span><span class="token operator">::</span>const_iterator mfwi <span class="token operator">=</span> mfw<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">float</span> <span class="token operator">*</span>hmfs <span class="token operator">=</span> hypo<span class="token operator">-&gt;</span>m_featureScoreVec<span class="token punctuation">;</span>
    <span class="token class-name">size_t</span> limit <span class="token operator">=</span> m_model<span class="token operator">-&gt;</span>m_featNumber<span class="token punctuation">;</span>
    <span class="token function">PRFM</span><span class="token punctuation">(</span>hmfs<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">PRFM</span><span class="token punctuation">(</span>hmfs<span class="token punctuation">,</span> <span class="token number">128</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">PRFM</span><span class="token punctuation">(</span>hmfs<span class="token punctuation">,</span> <span class="token number">256</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">PRFM</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token punctuation">(</span><span class="token operator">*</span>mfwi<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">PRFM</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token punctuation">(</span><span class="token operator">*</span>mfwi<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">128</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">PRFM</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token punctuation">(</span><span class="token operator">*</span>mfwi<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">256</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>limit <span class="token operator">&amp;</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        score <span class="token operator">=</span> hmfs<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">*</span> mfw<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
        i<span class="token operator">++</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">if</span> <span class="token expression"><span class="token number">1</span></span></span>
    <span class="token keyword">for</span><span class="token punctuation">(</span> <span class="token punctuation">;</span> i <span class="token operator">&lt;</span> limit<span class="token punctuation">;</span> i<span class="token operator">+=</span><span class="token number">2</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
        score <span class="token operator">+=</span> hmfs<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token operator">*</span>mfwi<span class="token punctuation">;</span>
        mfwi<span class="token operator">++</span><span class="token punctuation">;</span>
        score <span class="token operator">+=</span> hmfs<span class="token punctuation">[</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token operator">*</span>mfwi<span class="token punctuation">;</span>
        mfwi<span class="token operator">++</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">else</span></span>
    <span class="token keyword">for</span><span class="token punctuation">(</span> <span class="token punctuation">;</span> i <span class="token operator">&lt;</span> limit<span class="token punctuation">;</span> i<span class="token operator">+=</span><span class="token number">2</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
        score <span class="token operator">+=</span> hmfs<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">*</span> mfw<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
        score <span class="token operator">+=</span> hmfs<span class="token punctuation">[</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">*</span> mfw<span class="token punctuation">[</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">if</span> <span class="token expression"><span class="token number">0</span></span></span>
    <span class="token keyword">float</span> score <span class="token operator">=</span> <span class="token number">0.0</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token class-name">size_t</span> i <span class="token operator">=</span> <span class="token number">0</span> <span class="token punctuation">;</span> i <span class="token operator">&lt;</span> m_model<span class="token operator">-&gt;</span>m_featNumber<span class="token punctuation">;</span> i<span class="token operator">++</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
        score <span class="token operator">+=</span> hypo<span class="token operator">-&gt;</span>m_featureScoreVec<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">*</span> m_model<span class="token operator">-&gt;</span>m_featWeights<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">endif</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">endif</span></span>
    <span class="token keyword">return</span> score<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<h2 id="gdb&#x8C03;&#x8BD5;&#x591A;&#x8FDB;&#x7A0B;"><a name="gdb&#x8C03;&#x8BD5;&#x591A;&#x8FDB;&#x7A0B;" class="anchor-navigation-ex-anchor" href="#gdb&#x8C03;&#x8BD5;&#x591A;&#x8FDB;&#x7A0B;"><i class="fa fa-link" aria-hidden="true"></i></a>1.51. gdb&#x8C03;&#x8BD5;&#x591A;&#x8FDB;&#x7A0B;</h2>
<p>&#x641C;&#x7D22; gdb follow fork &#x6765;&#x67E5;&#x770B;gdb&#x5173;&#x4E8E;folk&#x7684;&#x9009;&#x9879;.
gdb &#x53EF;&#x4EE5;&#x540C;&#x65F6;&#x8C03;&#x8BD5;&#x51E0;&#x4E2A;&#x8FDB;&#x7A0B;
&#x6BD4;&#x5982;gdb&#x8C03;&#x8BD5;&#x7236;&#x8FDB;&#x7A0B;&#x7684;&#x65F6;&#x5019;, &#x5982;&#x679C;&#x7236;&#x8FDB;&#x7A0B;fork&#x4E86;&#x4E00;&#x6B21;, gdb&#x9ED8;&#x8BA4;&#x7684;&#x884C;&#x4E3A;&#x662F;detach&#x5B50;&#x8FDB;&#x7A0B;, &#x53EA;&#x8DDF;&#x8E2A;&#x7236;&#x8FDB;&#x7A0B;. &#x5982;&#x679C;&#x5B50;&#x8FDB;&#x7A0B;&#x91CC;&#x9762;&#x66FE;&#x7ECF;&#x6253;&#x4E86;&#x65AD;&#x70B9;, &#x5219;&#x5B50;&#x8FDB;&#x7A0B;&#x4F1A;&#x6536;&#x5230;SIGTRAP&#x4FE1;&#x53F7;&#x800C;&#x7EC8;&#x6B62;(&#x5982;&#x679C;&#x6CA1;&#x6709;&#x663E;&#x5F0F;&#x63A5;&#x7BA1;), &#x6709;&#x4E2A;&#x9009;&#x9879;&#x53EF;&#x4EE5;&#x6539;&#x53D8;&#x8FD9;&#x4E2A;&#x9ED8;&#x8BA4;&#x884C;&#x4E3A;, &#x4F7F;gdb&#x53EF;&#x4EE5;&#x4E5F;&#x53EF;&#x4EE5;&#x8DDF;&#x8E2A;&#x5B50;&#x8FDB;&#x7A0B;, &#x4F46;&#x7EDF;&#x4E00;&#x65F6;&#x523B;&#x53EA;&#x80FD;&#x8DDF;&#x8E2A;&#x4E00;&#x4E2A;&#x8FDB;&#x7A0B;, &#x672A;&#x88AB;&#x8DDF;&#x8E2A;&#x7684;&#x8FDB;&#x7A0B;&#x662F;suspended&#x72B6;&#x6001;. </p>
<ul>
<li>inferior &#x9009;&#x62E9;&#x8C03;&#x8BD5;&#x54EA;&#x4E2A;&#x7236;&#x5B50;?&#x8FDB;&#x7A0B;</li>
<li>info source&#x53EF;&#x4EE5;&#x663E;&#x793A;&#x5F53;&#x524D;&#x8C03;&#x8BD5;&#x4F4D;&#x7F6E;&#x7684;&#x6E90;&#x7801;</li>
</ul>
<h2 id="aj-kernel-git&#x6362;remote"><a name="aj-kernel-git&#x6362;remote" class="anchor-navigation-ex-anchor" href="#aj-kernel-git&#x6362;remote"><i class="fa fa-link" aria-hidden="true"></i></a>1.52. aj kernel git&#x6362;remote?</h2>
<p><a href="https://github.com/ajasty-cavium/linux" target="_blank">https://github.com/ajasty-cavium/linux</a>
git clone -b aj-alibaba bill@192.168.137.197:src/linux-aarch64
&#x6362;&#x6210;&#x5B98;&#x7F51;&#x7684;
git remote set-url origin git://cagit1.caveonetworks.com/thunder/sdk/linux-aarch64.git
&#x4E3A;&#x4E86;&#x9632;&#x6B62;&#x6362;&#x4E86;url&#x4EE5;&#x540E;git pull&#x4ECE;&#x65B0;&#x7684;url&#x7684;default branch&#x6765;&#x53D6;&#x4E1C;&#x897F;, &#x56E0;&#x4E3A;git pull&#x662F;fetch&#x8FDC;&#x7A0B;&#x7684;&#x9ED8;&#x8BA4;&#x5206;&#x652F;, &#x5728;merge&#x5230;&#x672C;&#x5730;&#x5206;&#x652F;.
git remote set-branches origin aj-alibaba
git remote set-head origin aj-alibaba</p>
<h2 id="&#x4EA4;&#x53C9;&#x7F16;&#x8BD1;kernel"><a name="&#x4EA4;&#x53C9;&#x7F16;&#x8BD1;kernel" class="anchor-navigation-ex-anchor" href="#&#x4EA4;&#x53C9;&#x7F16;&#x8BD1;kernel"><i class="fa fa-link" aria-hidden="true"></i></a>1.53. &#x4EA4;&#x53C9;&#x7F16;&#x8BD1;kernel</h2>
<pre class="language-"><code class="lang-shell"><span class="token builtin class-name">export</span> <span class="token assign-left variable">ARCH</span><span class="token operator">=</span>arm64
<span class="token builtin class-name">export</span> <span class="token assign-left variable">CROSS_COMPILE</span><span class="token operator">=</span>aarch64-thunderx-linux-gnu-
<span class="token builtin class-name">export</span> <span class="token assign-left variable"><span class="token environment constant">PATH</span></span><span class="token operator">=</span>/home/byj/repo/git/thunder/new/sdk-master.change/tools/bin:<span class="token environment constant">$PATH</span>
<span class="token function">cp</span> alibaba.config .config
<span class="token function">make</span> olddefconfig
<span class="token function">make</span> Image <span class="token parameter variable">-j4</span>
<span class="token function">make</span> modules <span class="token parameter variable">-j4</span>
</code></pre>
<h2 id="pssh&#x53EF;&#x4EE5;&#x5728;&#x591A;&#x4E2A;&#x673A;&#x5668;&#x540C;&#x65F6;&#x6267;&#x884C;&#x547D;&#x4EE4;"><a name="pssh&#x53EF;&#x4EE5;&#x5728;&#x591A;&#x4E2A;&#x673A;&#x5668;&#x540C;&#x65F6;&#x6267;&#x884C;&#x547D;&#x4EE4;" class="anchor-navigation-ex-anchor" href="#pssh&#x53EF;&#x4EE5;&#x5728;&#x591A;&#x4E2A;&#x673A;&#x5668;&#x540C;&#x65F6;&#x6267;&#x884C;&#x547D;&#x4EE4;"><i class="fa fa-link" aria-hidden="true"></i></a>1.54. pssh&#x53EF;&#x4EE5;&#x5728;&#x591A;&#x4E2A;&#x673A;&#x5668;&#x540C;&#x65F6;&#x6267;&#x884C;&#x547D;&#x4EE4;</h2>
<p>pssh&#x53EF;&#x4EE5;&#x505A;&#x4E0B;&#x9762;&#x811A;&#x672C;&#x7684;&#x4E8B;&#x60C5;
apt install pssh
&#x5728;&#x591A;&#x4E2A;&#x670D;&#x52A1;&#x5668;&#x4E0A;&#x540C;&#x65F6;&#x6267;&#x884C;&#x547D;&#x4EE4;&#x7684;&#x811A;&#x672C;
&#x5728;ali&#x6709;10&#x53F0;&#x673A;&#x5668;, &#x7ECF;&#x5E38;&#x8981;&#x540C;&#x65F6;&#x6267;&#x884C;&#x540C;&#x6837;&#x7684;&#x547D;&#x4EE4;. &#x4E00;&#x53F0;&#x4E00;&#x53F0;&#x6765;&#x6267;&#x884C;&#x592A;&#x9EBB;&#x70E6;, &#x6709;&#x6CA1;&#x6709;&#x4E00;&#x4E2A;&#x811A;&#x672C;&#x53EF;&#x4EE5;&#x540C;&#x65F6;&#x6267;&#x884C;&#x5462;?
&#x6709;, &#x7528;&#x5230;&#x4E86;&#x4E0B;&#x9762;&#x7684;ssh&#x514D;&#x5BC6;&#x7801;&#x529F;&#x80FD;, &#x4EE5;&#x53CA;ssh&#x547D;&#x4EE4;&#x53EF;&#x4EE5;&#x540E;&#x9762;&#x8DDF;&#x5B57;&#x7B26;&#x4E32;&#x6765;&#x5728;&#x8FDC;&#x7AEF;&#x673A;&#x5668;&#x4E0A;&#x6267;&#x884C;.
&#x4EE5;&#x53CA;eval</p>
<pre class="language-"><code class="lang-shell"><span class="token shebang important">#! /bin/bash</span>
<span class="token assign-left variable">B</span><span class="token operator">=</span><span class="token string">&quot;<span class="token entity" title="\033">\033</span>[1;37;40m&quot;</span>
<span class="token assign-left variable">N</span><span class="token operator">=</span><span class="token string">&quot;<span class="token entity" title="\033">\033</span>[0m&quot;</span>
<span class="token assign-left variable">atlocal</span><span class="token operator">=</span>F
<span class="token assign-left variable">servers</span><span class="token operator">=</span><span class="token string">&quot;
yingjie@192.168.85.10
byj@localhost
&quot;</span>
<span class="token assign-left variable">cvmservers</span><span class="token operator">=</span><span class="token string">&quot;
root@10.97.219.6
root@10.97.219.55
root@10.97.219.21
root@10.97.219.44
root@10.97.219.50
root@10.97.219.53
root@10.97.219.214
root@10.97.219.13
root@10.97.219.47
root@10.97.219.69
&quot;</span>
<span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token string">&quot;<span class="token variable">$1</span>&quot;</span> <span class="token operator">=</span> <span class="token string">&quot;-l&quot;</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
    <span class="token assign-left variable">atlocal</span><span class="token operator">=</span>T
    <span class="token builtin class-name">shift</span>
<span class="token keyword">fi</span>
<span class="token keyword">for</span> <span class="token for-or-select variable">i</span> <span class="token keyword">in</span> <span class="token variable">$servers</span><span class="token punctuation">;</span> <span class="token keyword">do</span>
    <span class="token assign-left variable">ip</span><span class="token operator">=</span><span class="token variable">${i<span class="token operator">#</span>*@}</span>
    <span class="token builtin class-name">echo</span>
    <span class="token builtin class-name">echo</span> <span class="token parameter variable">-e</span> <span class="token variable">$B</span><span class="token string">&quot;&gt;&gt;&gt;<span class="token variable">$i</span>&quot;</span><span class="token variable">$N</span>
    <span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token string">&quot;<span class="token variable">$atlocal</span>&quot;</span> <span class="token operator">=</span> <span class="token string">&quot;T&quot;</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
        <span class="token builtin class-name">eval</span> <span class="token string">&quot;<span class="token variable">$*</span>&quot;</span>
    <span class="token keyword">else</span>
        <span class="token function">ssh</span> <span class="token variable">$i</span> <span class="token string">&quot;<span class="token variable">$*</span>&quot;</span>
    <span class="token keyword">fi</span>
<span class="token keyword">done</span>
</code></pre>
<p>&#x4F7F;&#x7528;&#x65F6;:</p>
<ol>
<li>&#x8FD9;&#x4E2A;&#x547D;&#x4EE4;&#x8981;&#x5728;10&#x53F0;&#x673A;&#x5668;&#x4E0A;&#x6267;&#x884C;<pre class="language-"><code class="lang-shell">byj@mint ~/repo/git/thunder/new/alibaba
$ ./alldo.sh <span class="token function">ls</span>
</code></pre>
</li>
<li>&#x8FD9;&#x4E2A;&#x547D;&#x4EE4;&#x8981;&#x5728;&#x672C;&#x5730;&#x673A;&#x5668;&#x6267;&#x884C;, &#x4F46;&#x8981;&#x5BF9;&#x6BCF;&#x4E2A;&#x670D;&#x52A1;&#x5668;&#x7684;ip&#x8FDB;&#x884C;&#x67D0;&#x79CD;&#x64CD;&#x4F5C;<pre class="language-"><code class="lang-shell">byj@mint ~/repo/git/thunder/new/alibaba
$ ./alldo.sh <span class="token parameter variable">-l</span> <span class="token function">ping</span> <span class="token punctuation">\</span><span class="token variable">$ip</span>
</code></pre>
&#x6CE8;&#x610F;&#x9700;&#x8981;&#x7528;\&#x6765;&#x8F6C;&#x4E49;$, &#x56E0;&#x4E3A;&#x6211;&#x4EEC;&#x5E0C;&#x671B;$ip&#x4F5C;&#x4E3A;&#x5B57;&#x7B26;&#x4E32;&#x4F20;&#x7ED9;&#x811A;&#x672C;, &#x811A;&#x672C;&#x91CC;&#x9762;&#x7528;<code>eval &quot;$*&quot;</code>&#x6765;&#x6267;&#x884C;. &#x6CE8;&#x610F;, &#x5982;&#x679C;&#x8FD9;&#x91CC;&#x4E0D;&#x7528;eval&#x7684;&#x8BDD;, &#x811A;&#x672C;&#x91CC;&#x9762;&#x7684;$ip&#x662F;&#x4E0D;&#x4F1A;&#x88AB;&#x4F20;&#x9012;&#x5230;&#x547D;&#x4EE4;&#x7684;.
&lt;<shell中的eval学习与应用>&gt;&#x91CC;&#x9762;&#x6709;&#x8BE6;&#x7EC6;&#x7684;eval&#x7684;&#x539F;&#x7406;&#x7684;&#x89E3;&#x91CA;.&#x6211;&#x7684;&#x7406;&#x89E3;&#x662F;:</shell中的eval学习与应用></li>
<li>&#x666E;&#x901A;&#x7684;&quot;$<em>&quot;&#x7684;&#x6267;&#x884C;&#x65B9;&#x6CD5;, &#x5E76;&#x4E0D;&#x662F;&#x5728;&#x6267;&#x884C;&#x6269;&#x5C55;&#x540E;&#x7684;$</em>, &#x800C;&#x662F;&#x7701;&#x7565;&#x4E86;&#x547D;&#x4EE4;&#x89E3;&#x6790;&#x7684;&#x524D;&#x9762;&#x5F88;&#x591A;&#x6B65;&#x9AA4;, &#x6BD4;&#x5982;&#x89E3;&#x6790;&#x7279;&#x6B8A;&#x7B26;&#x53F7;, &#x7BA1;&#x9053;&#x7B26;, &#x5206;&#x53F7;, &#x91CD;&#x5B9A;&#x5411;&#x7B49;.</li>
<li>&#x800C;eval&#x7684;&#x597D;&#x5904;&#x5728;&#x4E8E;, &#x5B83;&#x628A;&#x540E;&#x9762;&#x7684;&#x5B57;&#x7B26;&#x4E32;&#x6309;&#x7167;&#x547D;&#x4EE4;&#x683C;&#x5F0F;&#x91CD;&#x65B0;&#x89E3;&#x6790;&#x4E00;&#x904D;, &#x5B83;&#x7684;&#x6548;&#x679C;&#x76F8;&#x5F53;&#x4E8E;&#x5728;shell&#x7A97;&#x53E3;&#x6572;&#x4E86;&#x4E00;&#x904D;&#x8FD9;&#x4E2A;&#x547D;&#x4EE4;.</li>
<li>&#x81F3;&#x4E8E;&#x4E3A;&#x4EC0;&#x4E48;eval&#x4F1A;&#x7EE7;&#x627F;<code>$ip</code>, &#x6211;&#x8BA4;&#x4E3A;eval&#x662F;&#x5728;&#x5F53;&#x524D;shell&#x8FDB;&#x7A0B;&#x6267;&#x884C;&#x7684;. &#x800C;<code>&quot;$*&quot;</code>&#x4F1A;&#x65B0;&#x5EFA;&#x8FDB;&#x7A0B;&#x6765;&#x6267;&#x884C;. </li>
</ol>
<h2 id="ssh&#x514D;&#x5BC6;&#x7801;&#x767B;&#x5F55;"><a name="ssh&#x514D;&#x5BC6;&#x7801;&#x767B;&#x5F55;" class="anchor-navigation-ex-anchor" href="#ssh&#x514D;&#x5BC6;&#x7801;&#x767B;&#x5F55;"><i class="fa fa-link" aria-hidden="true"></i></a>1.55. ssh&#x514D;&#x5BC6;&#x7801;&#x767B;&#x5F55;</h2>
<p>&quot;&#x516C;&#x79C1;&#x94A5;&quot;&#x8BA4;&#x8BC1;&#x65B9;&#x5F0F;&#x7B80;&#x5355;&#x7684;&#x89E3;&#x91CA;:&#x9996;&#x5148;&#x5728;&#x5BA2;&#x6237;&#x7AEF;&#x4E0A;&#x521B;&#x5EFA;&#x4E00;&#x5BF9;&#x516C;&#x79C1;&#x94A5; &#xFF08;&#x516C;&#x94A5;&#x6587;&#x4EF6;&#xFF1A;~/.ssh/id_rsa.pub&#xFF1B; &#x79C1;&#x94A5;&#x6587;&#x4EF6;&#xFF1A;~/.ssh/id_rsa&#xFF09;&#x3002;&#x7136;&#x540E;&#x628A;&#x516C;&#x94A5;&#x653E;&#x5230;&#x670D;&#x52A1;&#x5668;&#x4E0A;&#xFF08;~/.ssh/authorized_keys&#xFF09;, &#x81EA;&#x5DF1;&#x4FDD;&#x7559;&#x597D;&#x79C1;&#x94A5;.&#x5728;&#x4F7F;&#x7528;ssh&#x767B;&#x5F55;&#x65F6;,ssh&#x7A0B;&#x5E8F;&#x4F1A;&#x53D1;&#x9001;&#x79C1;&#x94A5;&#x53BB;&#x548C;&#x670D;&#x52A1;&#x5668;&#x4E0A;&#x7684;&#x516C;&#x94A5;&#x505A;&#x5339;&#x914D;.&#x5982;&#x679C;&#x5339;&#x914D;&#x6210;&#x529F;&#x5C31;&#x53EF;&#x4EE5;&#x767B;&#x5F55;&#x4E86;&#x3002;
&#x7528;A&#x767B;&#x5F55;B
&#x5728;A&#x4E0A;</p>
<pre class="language-"><code>ssh-keygen -t rsa -P &apos;&apos;
</code></pre><p>&#x5B83;&#x5728;/home/byj/.ssh/&#x4E0B;&#x9762;&#x751F;&#x6210;&#x79C1;&#x94A5;id_rsa&#x548C;&#x516C;&#x94A5;id_rsa.pub
&#x7136;&#x540E;&#x628A;&#x516C;&#x94A5;/home/byj/.ssh/id_rsa.pub&#x5199;&#x5230;B&#x7684;&#x6587;&#x4EF6;~/.ssh/authorized_keys&#x91CC;</p>
<pre class="language-"><code>cat ~/.ssh/id_rsa.pub | ssh yingjie@192.168.85.10 &quot;cat &gt;&gt; ~/.ssh/authorized_keys&quot;
</code></pre><p>&#x9700;&#x8981;&#x7684;&#x8BDD;&#x8981;&#x6539;B&#x4E0A;&#x7684;&#x8BBF;&#x95EE;&#x6743;&#x9650;</p>
<pre class="language-"><code>chmod 700 .ssh; chmod 640 .ssh/authorized_keys
</code></pre><p>&#x7136;&#x540E;&#x5C31;&#x53EF;&#x4EE5;&#x76F4;&#x63A5;&#x4ECE;A&#x767B;&#x5F55;&#x5230;B&#x4E86;</p>
<pre class="language-"><code>ssh yingjie@192.168.85.10
</code></pre><h2 id="ssh&#x8FDC;&#x7A0B;&#x6267;&#x884C;&#x547D;&#x4EE4;"><a name="ssh&#x8FDC;&#x7A0B;&#x6267;&#x884C;&#x547D;&#x4EE4;" class="anchor-navigation-ex-anchor" href="#ssh&#x8FDC;&#x7A0B;&#x6267;&#x884C;&#x547D;&#x4EE4;"><i class="fa fa-link" aria-hidden="true"></i></a>1.56. ssh&#x8FDC;&#x7A0B;&#x6267;&#x884C;&#x547D;&#x4EE4;</h2>
<p>ssh&#x4F1A;&#x63A5;&#x53D7;&#x4E00;&#x4E2A;&#x5B57;&#x7B26;&#x4E32;, &#x767B;&#x5F55;&#x540E;&#x5728;&#x76EE;&#x7684;&#x673A;&#x5668;&#x6267;&#x884C;</p>
<pre class="language-"><code>ssh xxx@xxx &quot;command;next command;next command&quot;
</code></pre><h2 id="cpu-offline-&#x52A8;&#x6001;"><a name="cpu-offline-&#x52A8;&#x6001;" class="anchor-navigation-ex-anchor" href="#cpu-offline-&#x52A8;&#x6001;"><i class="fa fa-link" aria-hidden="true"></i></a>1.57. cpu offline &#x52A8;&#x6001;</h2>
<pre class="language-"><code>#echo 0 &gt; /sys/devices/system/cpu/cpuX/online
cat /proc/cpuinfo | grep nid | wc -l
</code></pre><h2 id="dd&#x539F;&#x7406;-&#x6BCF;&#x4E2A;&#x5B57;&#x8282;&#x90FD;&#x88AB;&#x590D;&#x5236;"><a name="dd&#x539F;&#x7406;-&#x6BCF;&#x4E2A;&#x5B57;&#x8282;&#x90FD;&#x88AB;&#x590D;&#x5236;" class="anchor-navigation-ex-anchor" href="#dd&#x539F;&#x7406;-&#x6BCF;&#x4E2A;&#x5B57;&#x8282;&#x90FD;&#x88AB;&#x590D;&#x5236;"><i class="fa fa-link" aria-hidden="true"></i></a>1.58. dd&#x539F;&#x7406; &#x6BCF;&#x4E2A;&#x5B57;&#x8282;&#x90FD;&#x88AB;&#x590D;&#x5236;</h2>
<pre class="language-"><code>dd if=/dev/sdX of=/dev/sdY bs=512 conv=noerror,sync
</code></pre><blockquote>
<p>This will clone the entire drive, including the MBR (and therefore bootloader), all partitions, UUIDs, and data.
   noerror instructs dd to continue operation, ignoring all read errors. Default behavior for dd is to halt at any error.
   sync fills input blocks with zeroes if there were any read errors, so data offsets stay in sync.
   bs=512 sets the block size to 512 bytes, the &quot;classic&quot; block size for hard drives. If and only if your hard drives have a 4 Kib block size, you may use &quot;4096&quot; instead of &quot;512&quot;. Also, please read the warning below, because there is more to this than just &quot;block sizes&quot; -it also influences how read errors propagate.</p>
</blockquote>
<h2 id="uuid&#x542F;&#x52A8;-&#x4E0D;&#x7528;sda-sdb"><a name="uuid&#x542F;&#x52A8;-&#x4E0D;&#x7528;sda-sdb" class="anchor-navigation-ex-anchor" href="#uuid&#x542F;&#x52A8;-&#x4E0D;&#x7528;sda-sdb"><i class="fa fa-link" aria-hidden="true"></i></a>1.59. UUID&#x542F;&#x52A8; &#x4E0D;&#x7528;sda sdb</h2>
<p>&#x672C;&#x6765;&#x60F3;&#x7528;
<code>root=UUID=xxx</code>&#x6765;&#x6307;&#x5B9A;UUID, &#x4F46;&#x662F;kernel&#x4E0D;&#x8BA4;, &#x7CFB;&#x7EDF;&#x4F1A;&#x4E00;&#x76F4;&#x7B49;&#x5F85;.
&#x8FD9;&#x6837;&#x5199;&#x5C31;OK&#x4E86;:</p>
<pre class="language-"><code>menuentry &apos;Thunder Fedora default Boot&apos; {
    linux /boot/Image root=PARTUUID=5105e002-fe7d-4fc6-8b78-c9fc7cad3d84 console=ttyAMA0,115200n8 earlycon=pl011,0x87e024000000 coherent_pool=16M rootwait rw transparent_hugepage=never
    boot
}
</code></pre><p>&#x6B63;&#x786E;&#x7684;&#x5199;&#x6CD5;&#x662F;:
<code>root=PARTUUID=xxx</code>
&#x8FD9;&#x91CC;&#x9700;&#x8981;&#x8BF4;&#x660E;&#x7684;&#x662F;,UUID&#x548C;PARTUUID&#x662F;&#x4E0D;&#x4E00;&#x6837;&#x7684;, &#x65B0;&#x7248;&#x672C;&#x7684;blkid&#x80FD;&#x591F;show&#x51FA;&#x6765;.
UUID&#x662F;&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;&#x7684;ID, &#x800C;PARTUUID&#x662F;&#x5206;&#x533A;&#x7684;ID.
UUID&#x5728;initrd&#x4E2D;&#x80FD;&#x88AB;&#x8BC6;&#x522B;, &#x800C;PARTUUID&#x5728;kernel&#x5C31;&#x80FD;&#x8BC6;&#x522B;.
&#x4E0B;&#x9762;&#x7684;&#x8BF4;&#x660E;&#x5F88;&#x8BE6;&#x7EC6;</p>
<blockquote>
<p>The parameter you have to pass to boot from UUID is PARTUUID. So it should be root=PARTUUID=666c2eee-193d-42db-a490-4c444342bd4e.
The documentation explains why it&apos;s coming back with unknown-block(0,0):
kernel-parameters.txt:
    root=       [KNL] Root filesystem
            See name_to_dev_t comment in init/do_mounts.c.
init/do_mounts.c:</p>
<pre class="language-"><code class="lang-c"><span class="token comment">/*
 *  Convert a name into device number.  We accept the following variants:
 *
 *  1) device number in hexadecimal represents itself
 *  2) /dev/nfs represents Root_NFS (0xff)
 *  3) /dev/&lt;disk_name&gt; represents the device number of disk
 *  4) /dev/&lt;disk_name&gt;&lt;decimal&gt; represents the device number
 *         of partition - device number of disk plus the partition number
 *  5) /dev/&lt;disk_name&gt;p&lt;decimal&gt; - same as the above, that form is
 *     used when disk name of partitioned disk ends on a digit.
 *  6) PARTUUID=00112233-4455-6677-8899-AABBCCDDEEFF representing the
 *     unique id of a partition if the partition table provides it.
 *     The UUID may be either an EFI/GPT UUID, or refer to an MSDOS
 *     partition using the format SSSSSSSS-PP, where SSSSSSSS is a zero-
 *     filled hex representation of the 32-bit &quot;NT disk signature&quot;, and PP
 *     is a zero-filled hex representation of the 1-based partition number.
 *  7) PARTUUID=&lt;UUID&gt;/PARTNROFF=&lt;int&gt; to select a partition in relation to
 *     a partition with a known unique id.
 *
 *  If name doesn&apos;t have fall into the categories above, we return (0,0).
 *  block_class is used to check if something is a disk name. If the disk
 *  name contains slashes, the device name has them replaced with
 *  bangs.
 */</span>
</code></pre>
<p>So I guess that the real answer is that the kernel does not support root=UUID, only root=PARTUUID. If you want to use a filesystem UUID, I guess you need an initramfs that can handle mounting filesystems by UUID.
Just to clarify UUIDs are the only reliable way for the kernel to identify hard drives. There are two types: UUID, which is stored in the filesystem and is not available to the kernel at boot-time, and PARTUUID, which is stored in the partition table and IS available at boot time. So you have to use
root=PARTUUID=SSSSSSSS-PP
as /dev/sd?? can change with devices plugged/unplugged.
Don&apos;t forget to capitalize the hexadecimal number SSSSSSSS-PP you get from blkid!
The more easy to use
root=LABEL=
root=UUID=
only work with an initramfs that fetches these identifiers.
So, if you use a non-empty initramfs, you can have all three! With an empty initramfs, you only have PARTUUID.</p>
</blockquote>
<h2 id="&#x91CD;&#x505A;fedora"><a name="&#x91CD;&#x505A;fedora" class="anchor-navigation-ex-anchor" href="#&#x91CD;&#x505A;fedora"><i class="fa fa-link" aria-hidden="true"></i></a>1.60. &#x91CD;&#x505A;fedora</h2>
<p>&#x9700;&#x8981;root</p>
<pre class="language-"><code class="lang-shell"><span class="token builtin class-name">cd</span> /home/byj/repo/git/thunder/new/sdk-master
<span class="token builtin class-name">.</span> env-setup <span class="token assign-left variable">BOARD_TYPE</span><span class="token operator">=</span>crb-2s
<span class="token builtin class-name">cd</span> /home/byj/repo/git/thunder/new/sdk-master/host/bin
./create_disk.sh --raw-disk /dev/sdc
<span class="token builtin class-name">cd</span> /home/byj/repo/git/thunder/new/fs
<span class="token function">mount</span> /dev/sdc2 mnt
<span class="token builtin class-name">cd</span> mnt
<span class="token function">tar</span> xvf <span class="token punctuation">..</span>/fedora-with-native-kernel-repo-gcc-update-to-20150423-factory.tar.bz2
<span class="token builtin class-name">cd</span> <span class="token punctuation">..</span>
<span class="token function">umount</span> mnt
<span class="token builtin class-name">cd</span> /home/byj/repo/git/thunder/new/sdk-master/host/bin
./create_disk.sh --install-grub2 /dev/sdc1 /dev/sdc2 /boot
./create_disk.sh --install-modules /dev/sdc2
</code></pre>
<h2 id="fedora&#x7F51;&#x53E3;&#x914D;&#x7F6E;"><a name="fedora&#x7F51;&#x53E3;&#x914D;&#x7F6E;" class="anchor-navigation-ex-anchor" href="#fedora&#x7F51;&#x53E3;&#x914D;&#x7F6E;"><i class="fa fa-link" aria-hidden="true"></i></a>1.61. fedora&#x7F51;&#x53E3;&#x914D;&#x7F6E;</h2>
<ul>
<li>&#x9759;&#x6001;IP<pre class="language-"><code class="lang-shell">root@ARM /etc
<span class="token comment"># cat ./sysconfig/network-scripts/ifcfg-enP2p1s0f1</span>
<span class="token assign-left variable">DEVICE</span><span class="token operator">=</span>enP2p1s0f1
<span class="token assign-left variable">USERCTL</span><span class="token operator">=</span>no
<span class="token assign-left variable">ONBOOT</span><span class="token operator">=</span>yes
<span class="token assign-left variable">BOOTPROTO</span><span class="token operator">=</span>none
<span class="token assign-left variable">USERCTL</span><span class="token operator">=</span>no
<span class="token assign-left variable">IPADDR</span><span class="token operator">=</span><span class="token number">10.97</span>.219.47
<span class="token assign-left variable">NETMASK</span><span class="token operator">=</span><span class="token number">255.255</span>.255.0
<span class="token assign-left variable">GATEWAY</span><span class="token operator">=</span><span class="token number">10.97</span>.219.247
<span class="token assign-left variable">DNS1</span><span class="token operator">=</span><span class="token number">10.137</span>.59.1
</code></pre>
</li>
<li>bond<pre class="language-"><code class="lang-shell">root@ARM /etc/sysconfig/network-scripts
<span class="token comment"># cat ifcfg-bond0 </span>
<span class="token assign-left variable">DEVICE</span><span class="token operator">=</span>bond0
<span class="token assign-left variable">ONBOOT</span><span class="token operator">=</span>no
<span class="token assign-left variable">BOOTPROTO</span><span class="token operator">=</span>none
<span class="token assign-left variable">USERCTL</span><span class="token operator">=</span>no
<span class="token assign-left variable">BONDING_OPTS</span><span class="token operator">=</span><span class="token string">&quot;mode=4 miimon=100 xmit_hash_policy=1&quot;</span>
root@ARM /etc/sysconfig/network-scripts
<span class="token comment"># cat ifcfg-enP6p1s0f1 </span>
<span class="token assign-left variable">DEVICE</span><span class="token operator">=</span>enP6p1s0f1
<span class="token assign-left variable">USERCTL</span><span class="token operator">=</span>no
<span class="token assign-left variable">ONBOOT</span><span class="token operator">=</span>no
<span class="token assign-left variable">BOOTPROTO</span><span class="token operator">=</span>none
</code></pre>
</li>
</ul>
<h2 id="&#x67E5;&#x770B;10&#x53F0;&#x7CFB;&#x7EDF;&#x662F;&#x5426;online"><a name="&#x67E5;&#x770B;10&#x53F0;&#x7CFB;&#x7EDF;&#x662F;&#x5426;online" class="anchor-navigation-ex-anchor" href="#&#x67E5;&#x770B;10&#x53F0;&#x7CFB;&#x7EDF;&#x662F;&#x5426;online"><i class="fa fa-link" aria-hidden="true"></i></a>1.62. &#x67E5;&#x770B;10&#x53F0;&#x7CFB;&#x7EDF;&#x662F;&#x5426;online</h2>
<pre class="language-"><code class="lang-shell">$ <span class="token function">cat</span> macip.table <span class="token operator">|</span> <span class="token function">cut</span> <span class="token parameter variable">-d</span> <span class="token string">&apos; &apos;</span> <span class="token parameter variable">-f2</span> <span class="token operator">|</span> <span class="token function">xargs</span> <span class="token parameter variable">-i</span> <span class="token function">ping</span> <span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token parameter variable">-c</span> <span class="token number">3</span> <span class="token operator">|</span> <span class="token function">egrep</span> <span class="token parameter variable">-i</span> <span class="token string">&quot;statistics|transmitted&quot;</span>
</code></pre>
<h2 id="check-cpld-&#x7248;&#x672C;"><a name="check-cpld-&#x7248;&#x672C;" class="anchor-navigation-ex-anchor" href="#check-cpld-&#x7248;&#x672C;"><i class="fa fa-link" aria-hidden="true"></i></a>1.63. check cpld &#x7248;&#x672C;</h2>
<pre class="language-"><code class="lang-shell">/usr/local/bin/cpldaccess --get-data 0x29
</code></pre>
<h2 id="&#x5199;mac&#x5730;&#x5740;"><a name="&#x5199;mac&#x5730;&#x5740;" class="anchor-navigation-ex-anchor" href="#&#x5199;mac&#x5730;&#x5740;"><i class="fa fa-link" aria-hidden="true"></i></a>1.64. &#x5199;mac&#x5730;&#x5740;</h2>
<ol>
<li>Enter UEFI shell.</li>
<li>setvar N0ETH0 -guid A70B59ED-6228-4883-BBF0-5FD91C14EFF6 -bs -rt -nv =0x123456789abc02</li>
<li>setvar N1ETH0 -guid A70B59ED-6228-4883-BBF0-5FD91C14EFF6 -bs -rt -nv =0x123456789abc01</li>
</ol>
<h2 id="&#x7F16;&#x8BD1;gcc"><a name="&#x7F16;&#x8BD1;gcc" class="anchor-navigation-ex-anchor" href="#&#x7F16;&#x8BD1;gcc"><i class="fa fa-link" aria-hidden="true"></i></a>1.65. &#x7F16;&#x8BD1;gcc</h2>
<ul>
<li>&#x9700;&#x8981;&#x5148;&#x88C5;&#x4E00;&#x4E9B;&#x4F9D;&#x8D56;&#x5305;<pre class="language-"><code class="lang-shell">yum <span class="token function">install</span> gcc-c++ texi2html
yum <span class="token function">install</span> texi2html <span class="token parameter variable">-y</span>
yum <span class="token function">install</span> <span class="token function">vim</span>
yum <span class="token function">install</span> makeinfo
yum <span class="token function">install</span> texinfo
yum <span class="token function">install</span> <span class="token function">make</span>
yum <span class="token function">install</span> termcap
yum <span class="token function">install</span> ncurses
yum <span class="token function">install</span> m4
yum <span class="token function">install</span> flex bison <span class="token parameter variable">-y</span>
yum <span class="token function">install</span> ncurses-devel.aarch64
yum <span class="token function">install</span> gmp
yum <span class="token function">install</span> gmp-devel
yum <span class="token function">install</span> mpfr-devel mpc-dev <span class="token parameter variable">-y</span>
yum <span class="token function">install</span> mpc-devel <span class="token parameter variable">-y</span>
yum <span class="token function">install</span> gmpc-devel.aarch64
yum <span class="token function">install</span> mpc.aarch64
yum <span class="token function">install</span> libmpc-devel.aarch64
</code></pre>
</li>
<li>&#x7F16;&#x8BD1;gcc<pre class="language-"><code class="lang-shell"><span class="token assign-left variable">INSTALL_DIR</span><span class="token operator">=</span><span class="token variable">${<span class="token environment constant">HOME</span>}</span>/gcc5-native
<span class="token function">rm</span> <span class="token parameter variable">-Rf</span> <span class="token variable">${INSTALL_DIR}</span>
<span class="token builtin class-name">cd</span> binutils
<span class="token function">rm</span> <span class="token parameter variable">-Rf</span> objdir
<span class="token function">mkdir</span> objdir
<span class="token builtin class-name">cd</span> objdir
<span class="token punctuation">..</span>/configure --disable-libsanitizer <span class="token parameter variable">--prefix</span><span class="token operator">=</span><span class="token variable">${INSTALL_DIR}</span> --with-cpu<span class="token operator">=</span>thunderx --enable-languages<span class="token operator">=</span>c,c++,fortran --disable-werror
<span class="token function">make</span> <span class="token parameter variable">-j48</span>
<span class="token function">make</span> <span class="token function">install</span>
<span class="token builtin class-name">cd</span> <span class="token punctuation">..</span>/<span class="token punctuation">..</span>/
<span class="token builtin class-name">cd</span> gcc
<span class="token function">rm</span> <span class="token parameter variable">-Rf</span> objdir
<span class="token function">mkdir</span> objdir
<span class="token builtin class-name">cd</span> objdir
<span class="token punctuation">..</span>/configure --disable-libsanitizer <span class="token parameter variable">--prefix</span><span class="token operator">=</span><span class="token variable">${INSTALL_DIR}</span> --with-cpu<span class="token operator">=</span>thunderx --enable-languages<span class="token operator">=</span>c,c++,fortran --disable-werror
<span class="token function">make</span> <span class="token parameter variable">-j48</span>
<span class="token function">make</span> <span class="token function">install</span>
<span class="token builtin class-name">cd</span> <span class="token punctuation">..</span>/<span class="token punctuation">..</span>/
</code></pre>
</li>
</ul>
<h2 id="96&#x4E2A;&#x6838;&#x7684;&#x5F02;&#x5E38;&#x95EE;&#x9898;"><a name="96&#x4E2A;&#x6838;&#x7684;&#x5F02;&#x5E38;&#x95EE;&#x9898;" class="anchor-navigation-ex-anchor" href="#96&#x4E2A;&#x6838;&#x7684;&#x5F02;&#x5E38;&#x95EE;&#x9898;"><i class="fa fa-link" aria-hidden="true"></i></a>1.66. 96&#x4E2A;&#x6838;&#x7684;&#x5F02;&#x5E38;&#x95EE;&#x9898;</h2>
<p>&#x73B0;&#x8C61;&#x662F;96&#x4E2A;&#x6838;&#x8DD1;ODPS&#x7684;&#x65F6;&#x5019;, &#x4F1A;&#x6709;96&#x4E2A;worker, &#x5176;&#x4E2D;&#x6709;&#x4E00;&#x4E24;&#x4E2A;worker&#x4F1A;&#x6302;&#x6389;.
&#x5F02;&#x5E38;&#x6253;&#x5370;&#x663E;&#x793A;&#x662F;&#x8BBF;&#x95EE;0&#x5730;&#x5740;&#x5F02;&#x5E38;, &#x6B64;&#x65F6;&#x7684;&#x91CD;&#x8981;&#x7279;&#x5F81;&#x662F;PC&#x4E3A;0;
&#x4E3A;&#x4EC0;&#x4E48;PC&#x90FD;&#x4E3A;0&#x4E86;&#x5462;? &#x8C01;&#x8E29;&#x4E86;&#x5185;&#x5B58;&#x5417;?
&#x8FD9;&#x4E2A;&#x95EE;&#x9898;&#x6211;&#x4EEC;&#x540E;&#x9762;&#x518D;&#x8BAE;, &#x6211;&#x4EEC;&#x5148;&#x8981;&#x5F04;&#x6E05;&#x695A;&#x53E6;&#x5916;&#x4E00;&#x4E2A;&#x95EE;&#x9898;, &#x6211;&#x4EEC;&#x4E0D;&#x77E5;&#x9053;&#x54EA;&#x4E2A;worker&#x4F1A;&#x6302;&#x6389;, &#x600E;&#x4E48;&#x8C03;&#x8BD5;?
&#x9996;&#x5148;, &#x90A3;&#x4E2A;&#x5F02;&#x5E38;&#x6253;&#x5370;&#x80FD;&#x63D0;&#x4F9B;&#x5F88;&#x591A;&#x4FE1;&#x606F;, &#x6BD4;&#x5982;pc&#x4E3A;0, &#x4F46;lr&#x6307;&#x9488;&#x4E0D;&#x4E3A;0, &#x901A;&#x8FC7;&#x8FD9;&#x4E2A;&#x6307;&#x9488;, &#x53EF;&#x4EE5;&#x627E;&#x5230;bug&#x5728;&#x4EE3;&#x7801;&#x91CC;&#x5927;&#x81F4;&#x7684;&#x4F4D;&#x7F6E;.
dmesg | tail -30
&#x7136;&#x540E;, &#x901A;&#x8FC7;&#x6765;&#x8C03;&#x8BD5;. &#x5927;&#x725B;&#x7684;&#x529E;&#x6CD5;&#x662F;, &#x6253;&#x5F00;core dump&#x529F;&#x80FD;, &#x8FD9;&#x6837;&#x5F53;&#x67D0;&#x4E2A;worker&#x6302;&#x6389;&#x7684;&#x65F6;&#x5019;, &#x4F1A;&#x4EA7;&#x751F;core&#x6587;&#x4EF6;.
&#x8FD9;&#x91CC;&#x6211;&#x628A;&#x7528;&#x5230;&#x7684;&#x547D;&#x4EE4;&#x5927;&#x7EA6;&#x5217;&#x4EE5;&#x4E0B;:</p>
<pre class="language-"><code>thread apply all bt
info sharedlibrary
info thread
thread 84
up
p $x1 //&#x6253;&#x5370;&#x5BC4;&#x5B58;&#x5668;x1
p/x *((long ***)($29+32))
</code></pre><p>&#x901A;&#x8FC7;&#x5206;&#x6790;bug&#x9644;&#x8FD1;&#x7684;&#x6C47;&#x7F16;&#x4EE3;&#x7801;, &#x5927;&#x4F53;&#x8109;&#x7EDC;&#x5982;&#x4E0B;:
&#x6700;&#x7EC8;, &#x7A0B;&#x5E8F;&#x662F;&#x8981;&#x8C03;&#x7528;&#x4E00;&#x4E2A;&#x7C7B;&#x7684;&#x6210;&#x5458;&#x51FD;&#x6570;:
someclass-&gt;run()
&#x8FD9;&#x5C31;&#x9700;&#x8981;&#x5148;&#x627E;&#x5230;someclass&#x7684;&#x6307;&#x9488;, &#x7136;&#x540E;&#x627E;&#x5230;run&#x7684;&#x5730;&#x5740;;
&#x4F46;&#x662F;&#x8FD9;&#x4E2A;&#x5730;&#x5740;&#x662F;0, &#x5BFC;&#x81F4;pc&#x8DF3;&#x5230;0&#x53BB;&#x6267;&#x884C;.
&#x4E3A;&#x4EC0;&#x4E48;&#x662F;0&#x5462;?
&#x6700;&#x540E;&#x5206;&#x6790;&#x5230;&#x9501;&#x7684;&#x95EE;&#x9898;.
&#x4E00;&#x822C;&#x9501;&#x7684;&#x6D41;&#x7A0B;&#x662F;&#x8FD9;&#x6837;&#x7684;</p>
<pre class="language-"><code>lock(v)
modify(something)
unlock(v)
</code></pre><p>&#x8FD9;&#x4E2A;&#x95EE;&#x9898;&#x51FA;&#x73B0;&#x7684;&#x80CC;&#x666F;&#x662F;:
<strong>Thunder&#x6709;&#x4E2A;write buffer, &#x4F1A;&#x505A;merge, &#x5BFC;&#x81F4;&#x5185;&#x5B58;&#x5199;&#x662F;out of order&#x7684;.</strong>
&#x9501;&#x7684;&#x672C;&#x8D28;&#x662F;&#x4ECE;0(&#x53EF;&#x83B7;&#x53D6;&#x9501;) &#x5230;1(&#x5360;&#x6709;&#x9501;) &#x518D;&#x5230;0(&#x91CA;&#x653E;&#x9501;, &#x6B64;&#x65F6;&#x522B;&#x4EBA;&#x53EF;&#x4EE5;&#x83B7;&#x53D6;&#x9501;)
&#x800C;&#x6309;&#x7167;&#x4E0A;&#x9762;&#x4E0A;&#x9501;&#x7684;&#x6D41;&#x7A0B;, &#x8FD9;&#x4E09;&#x53E5;&#x7684;&#x6267;&#x884C;&#x987A;&#x5E8F;&#x662F;</p>
<pre class="language-"><code>lock=1
some_var=any
lock=0
</code></pre><p>&#x56E0;&#x4E3A;&#x6211;&#x4EEC;&#x6709;write buffer, &#x6240;&#x4EE5;&#x6709;&#x53EF;&#x80FD;lock=1 &#x548C;lock=0&#x88AB;merge&#x4E86;, &#x51C6;&#x786E;&#x7684;&#x8BF4;, lock=1&#x8FDB;&#x5165;
write buffer&#x505A;&#x4E3A;entry 0, &#x7136;&#x540E;&#x4FEE;&#x6539;&#x88AB;&#x4FDD;&#x62A4;&#x7684;&#x53D8;&#x91CF;some_var &#x505A;&#x4E3A;entry1, &#x800C;lock=0&#x8FDB;&#x5165;write buffer&#x7684;&#x65F6;&#x5019;, &#x5B83;&#x53EF;&#x80FD;&#x88AB;
merge&#x5230;entry0, &#x5BFC;&#x81F4;lock&#x4ECE;0&#x5230;1&#x518D;0&#x7684;&#x8FC7;&#x7A0B;&#x5728;wirte buffer&#x91CC;&#x53EA;&#x6709;0.
&#x4ECE;&#x5916;&#x9762;&#x7684;&#x6838;&#x770B;&#x8D77;&#x6765;, &#x8FD9;&#x4E2A;&#x9501;&#x4E00;&#x76F4;&#x90FD;&#x662F;0. &#x6240;&#x4EE5;&#x522B;&#x4EBA;&#x4E5F;&#x5728;&#x6539;&#x90A3;&#x4E2A;&#x5173;&#x952E;&#x53D8;&#x91CF;, &#x5BFC;&#x81F4;&#x95EE;&#x9898;.
&#x89E3;&#x51B3;&#x529E;&#x6CD5;&#x662F;, &#x5728;unlock&#x4E4B;&#x524D;&#x52A0;<code>mb()</code>, memory barriar</p>
<pre class="language-"><code>lock(v)
modify(something)
--&#x5728;&#x8FD9;&#x91CC;&#x52A0;mb(), &#x5BF9;ARM&#x6765;&#x8BF4;&#x662F;DMB&#x6307;&#x4EE4;.
unlock(v)
</code></pre><p>&#x539F;&#x6765;&#x7684;&#x4EE3;&#x7801;&#x662F;&#x8FD9;&#x6837;&#x7684;&#xFF1A;</p>
<pre class="language-"><code>easy/src/include/easy_atomic.h
easy_atomic_barrier() {__asm__ (&quot;&quot; ::: &quot;memory&quot;);}
easy_trylock(lock)  (*(lock) == 0 &amp;&amp; easy_atomic_cmp_set(lock, 0, 1))
easy_unlock(lock)   {__asm__ (&quot;&quot; ::: &quot;memory&quot;); *(lock) = 0;}
</code></pre><p>&#x65B0;&#x7684;&#x4EE3;&#x7801;:</p>
<pre class="language-"><code>easy/src/include/easy_atomic.h
easy_atomic_barrier() {__asm__ (&quot;dmb ish&quot; ::: &quot;memory&quot;);}
easy_trylock(lock)  (*(lock) == 0 &amp;&amp; easy_atomic_cmp_set(lock, 0, 1))
easy_unlock(lock)   {__asm__ (&quot;dmb ish&quot; ::: &quot;memory&quot;); *(lock) = 0;}
</code></pre><p>[byj]&#x6CE8;:gcc4.9.2&#x63D0;&#x4F9B;&#x8FD9;&#x4E2A;&#x51FD;&#x6570;
<code>void __atomic_thread_fence (int memmodel)</code>
&#x53CD;&#x6C47;&#x7F16;&#x4E5F;&#x662F;:dmb ish</p>
<pre class="language-"><code>0000000000000000 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>foo</span><span class="token punctuation">&gt;</span></span>:
   0:   d5033bbf        dmb     ish
   4:   d65f03c0        ret
</code></pre><h2 id="&#x5173;&#x4E8E;rpscpus"><a name="&#x5173;&#x4E8E;rpscpus" class="anchor-navigation-ex-anchor" href="#&#x5173;&#x4E8E;rpscpus"><i class="fa fa-link" aria-hidden="true"></i></a>1.67. &#x5173;&#x4E8E;rps_cpus</h2>
<p>&#x6211;&#x4EEC;&#x7684;&#x7CFB;&#x7EDF;&#x91CC;&#x9ED8;&#x8BA4;&#x662F;&#x628A;rps_cpus&#x6253;&#x5F00;&#x4E86;, &#x8FD9;&#x6837;&#x7684;&#x597D;&#x5904;&#x662F;&#x5BF9;&#x7F51;&#x53E3;&#x7684;&#x4E00;&#x4E2A;queue&#x6765;&#x8BF4;, 
&#x786C;&#x4EF6;&#x4E2D;&#x65AD;&#x5230;&#x4E00;&#x4E2A;CPU, &#x4F46;&#x662F;&#x53EF;&#x4EE5;&#x7528;&#x51E0;&#x4E2A;CPU&#x6765;&#x5904;&#x7406;&#x63A5;&#x4E0B;&#x6765;&#x7684;&#x8F6F;&#x4E2D;&#x65AD;(&#x5E94;&#x8BE5;&#x662F;&#x5728;&#x8DD1;linux&#x7F51;&#x7EDC;&#x534F;&#x8BAE;&#x6808;)
&#x6211;&#x4EEC;vnic&#x6709;8&#x4E2A;queue, &#x7ED1;&#x5B9A;&#x5230;1~8&#x53F7;core&#x6765;&#x5904;&#x7406;&#x786C;&#x4E2D;&#x65AD;, &#x5982;&#x679C;&#x4E0D;&#x6253;&#x5F00;rps_cpu, &#x90A3;&#x5C31;&#x53EA;&#x6709;&#x8FD9;8&#x4E2A;CPU&#x6765;&#x8DD1;&#x63A5;&#x4E0B;&#x6765;&#x7684;&#x8F6F;&#x4E2D;&#x65AD;;
&#x800C;&#x5982;&#x679C;&#x6253;&#x5F00;&#x4E86;rps_cpus, &#x90A3;&#x63A5;&#x4E0B;&#x6765;&#x7684;&#x8F6F;&#x4E2D;&#x65AD;&#x53EF;&#x80FD;&#x8DD1;&#x5728;&#x6240;&#x6709;&#x7684;CPU&#x4E0A;(&#x6709;&#x4E2A;mask&#x6765;&#x7BA1;&#x7684;). &#x6B64;&#x65F6;&#x89C2;&#x5BDF;&#x5230;&#x7684;&#x73B0;&#x8C61;&#x662F;, &#x7528;top&#x6765;&#x770B;,
si&#x8FD9;&#x4E00;&#x9879;&#x5728;&#x6240;&#x6709;CPU&#x4E0A;&#x90FD;&#x6709;&#x503C;.
&#x800C;&#x6211;&#x4EEC;&#x5728;&#x6D4B;&#x8BD5;mysql&#x65F6;, &#x91C7;&#x7528;&#x7684;&#x7B56;&#x7565;&#x662F;&#x5173;&#x95ED;rps_cpu, &#x4E3A;&#x4EC0;&#x4E48;&#x5462;?
&#x56E0;&#x4E3A;&#x6211;&#x4EEC;&#x53D1;&#x73B0;, &#x6D4B;mysql&#x65F6;, &#x7CFB;&#x7EDF;&#x7684;&#x8D1F;&#x8F7D;&#x5E76;&#x4E0D;&#x9AD8;, &#x7F51;&#x7EDC;&#x8D1F;&#x8F7D;&#x4E5F;&#x4E0D;&#x9AD8;.
&#x6B64;&#x65F6;8&#x4E2A;CPU&#x5904;&#x7406;&#x7F51;&#x7EDC;&#x5C31;&#x8DB3;&#x591F;&#x4E86;, &#x5176;&#x4ED6;core&#x90FD;&#x8DD1;mysql. 
&#x6240;&#x4EE5;&#x6211;&#x4EEC;&#x4E0D;&#x9700;&#x8981;&#x628A;si&#x90FD;&#x5206;&#x5230;&#x6240;&#x6709;core&#x4E0A;&#x6765;&#x8DD1;, &#x8FD9;&#x6837;&#x53CD;&#x800C;&#x4F1A;&#x5F71;&#x54CD;mysql, &#x6BD4;&#x5982;&#x5BFC;&#x81F4;cache miss&#x5347;&#x9AD8;.
<code>echo 0 &gt; /sys/class/net/eth4/queues/rx-0/rps_cpus</code>
&#x5728;&#x6D4B;&#x8BD5;ODPS&#x7684;&#x65F6;&#x5019;, &#x7F51;&#x7EDC;&#x6027;&#x80FD;&#x5F88;&#x5DEE;, 10G&#x7684;&#x63A5;&#x53E3;&#x53EA;&#x6709;2G&#x5DE6;&#x53F3;&#x7684;&#x5E26;&#x5BBD;.
&#x5728;&#x8C03;&#x8BD5;&#x7684;&#x65F6;&#x5019;&#x53D1;&#x73B0;, rps_cpus&#x662F;&#x5168;f</p>
<pre class="language-"><code>cd /sys/class/net/neP6p1s0f1/queues/rx-0
cat rps_cpus
ffffffff,fffdffff,ffffffff
</code></pre><p>&#x8FD9;&#x91CC;&#x5C31;&#x6709;&#x4E2A;&#x95EE;&#x9898;, &#x8FD9;&#x4E2A;&#x662F;2&#x4E2A;node&#x7684;&#x7CFB;&#x7EDF;, &#x8FD9;&#x91CC;&#x628A;&#x6240;&#x6709;cpu&#x7684;rps&#x90FD;&#x6253;&#x5F00;&#x4E86;, &#x90A3;&#x4E48;&#x4F1A;&#x6709;&#x5F88;&#x5927;&#x53EF;&#x80FD;&#x662F;node1&#x6765;&#x5904;&#x7406;node0&#x7684;&#x8F6F;&#x4E2D;&#x65AD;,
&#x8FD9;&#x6837;&#x6548;&#x7387;&#x4F4E;.
&#x6240;&#x4EE5;&#x8981;&#x8FD9;&#x6837;&#x6539;: enP6p1s0f1&#x662F;node1&#x7684;&#x63A5;&#x53E3;
<code>echo ffffffff,fffd0000,00000000 &gt; /sys/class/net/neP6p1s0f1/queues/rx-0/rps_cpus</code></p>
<h2 id="xpscpu"><a name="xpscpu" class="anchor-navigation-ex-anchor" href="#xpscpu"><i class="fa fa-link" aria-hidden="true"></i></a>1.68. xps_cpu</h2>
<p>&#x5BF9;&#x5E94;&#x7684;, &#x6709;&#x4E2A;xps_cpu&#x7684;&#x4E1C;&#x4E1C;.
&#x6211;&#x7406;&#x89E3;, CPU&#x53D1;&#x5305;, &#x90A3;&#x4E48;&#x6B64;&#x65F6;CPU&#x662F;&#x56FA;&#x5B9A;&#x7684;, &#x4E0B;&#x9762;&#x5C31;&#x662F;&#x9009;&#x62E9;&#x5F80;&#x90A3;&#x4E2A;q&#x91CC;&#x9762;&#x53D1;, &#x8FD9;&#x4E2A;q&#x4E00;&#x822C;&#x662F;hash&#x6765;&#x7684;, &#x8FD9;&#x5C31;&#x5BFC;&#x81F4;&#x4E86;&#x4ECE;&#x5168;&#x5C40;&#x6765;&#x770B;, CPU&#x548C;q&#x662F;&#x591A;&#x5BF9;&#x591A;&#x7684;&#x5173;&#x7CFB;, &#x800C;xps_cpu&#x662F;&#x4E00;&#x4E2A;&#x5BF9;&#x6BCF;&#x4E2A;q&#x7684;&#x4E00;&#x4E2A;CPU set&#x7684;&#x9650;&#x5236;, &#x4E5F;&#x5C31;&#x662F;&#x8BF4;, &#x4E00;&#x4E2A;q, &#x53EA;&#x80FD;&#x5BF9;&#x5E94;&#x8FD9;&#x4E2A;set&#x91CC;&#x9762;&#x7684;CPU, &#x8981;&#x83B7;&#x5F97;&#x66F4;&#x597D;&#x7684;&#x5C40;&#x90E8;&#x6027;, &#x4E2A;&#x4EBA;&#x89C9;&#x5F97;&#x53EF;&#x4EE5;&#x4E00;&#x5BF9;&#x4E00;.
&#x8FD9;&#x4E2A;patch&#x4E3B;&#x8981;&#x662F;&#x9488;&#x5BF9;&#x591A;&#x961F;&#x5217;&#x7684;&#x7F51;&#x5361;&#x53D1;&#x9001;&#x65F6;&#x7684;&#x4F18;&#x5316;&#xFF0C;&#x5F53;&#x53D1;&#x9001;&#x4E00;&#x4E2A;&#x6570;&#x636E;&#x5305;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x5B83;&#x4F1A;&#x6839;&#x636E;cpu&#x6765;&#x9009;&#x62E9;&#x5BF9;&#x5E94;&#x7684;&#x961F;&#x5217;&#xFF0C;&#x800C;&#x8FD9;&#x4E2A;cpu map&#x53EF;&#x4EE5;&#x901A;&#x8FC7;sysctl&#x6765;&#x8BBE;&#x7F6E;&#xFF1A;
<code>/sys/class/net/eth<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>n</span><span class="token punctuation">&gt;</span></span>/queues/tx-<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>n</span><span class="token punctuation">&gt;</span></span>/xps_cpus</code>
&#x8FD9;&#x91CC;xps_cpus&#x662F;&#x4E00;&#x4E2A;cpu&#x63A9;&#x7801;&#xFF0C;&#x8868;&#x793A;&#x5F53;&#x524D;&#x961F;&#x5217;&#x5BF9;&#x5E94;&#x7684;cpu&#x3002;
&#x800C;xps&#x4E3B;&#x8981;&#x5C31;&#x662F;&#x63D0;&#x9AD8;&#x591A;&#x5BF9;&#x5217;&#x4E0B;&#x7684;&#x6570;&#x636E;&#x5305;&#x53D1;&#x9001;&#x541E;&#x5410;&#x91CF;&#xFF0C;&#x5177;&#x4F53;&#x6765;&#x8BF4;&#x5C31;&#x662F;&#x63D0;&#x9AD8;&#x4E86;&#x53D1;&#x9001;&#x6570;&#x636E;&#x7684;&#x5C40;&#x90E8;&#x6027;&#x3002;&#x6309;&#x7167;&#x4F5C;&#x8005;&#x7684;benchmark&#xFF0C;&#x80FD;&#x591F;&#x63D0;&#x9AD8;20%.
&#x539F;&#x7406;&#x5F88;&#x7B80;&#x5355;&#xFF0C;&#x5C31;&#x662F;&#x6839;&#x636E;&#x5F53;&#x524D;skb&#x5BF9;&#x5E94;&#x7684;hash&#x503C;(&#x5982;&#x679C;&#x5F53;&#x524D;socket&#x6709;hash&#xFF0C;&#x90A3;&#x4E48;&#x5C31;&#x4F7F;&#x7528;&#x5F53;&#x524D;socket&#x7684;)&#x6765;&#x6563;&#x5217;&#x5230;xps_cpus&#x8FD9;&#x4E2A;&#x63A9;&#x7801;&#x6240; &#x8BBE;&#x7F6E;&#x7684;cpu&#x4E0A;&#xFF0C;&#x4E5F;&#x5C31;&#x662F;cpu&#x548C;&#x961F;&#x5217;&#x662F;&#x4E00;&#x4E2A;1&#x5BF9;1&#xFF0C;&#x6216;&#x8005;1&#x5BF9;&#x591A;&#x7684;&#x5173;&#x7CFB;&#xFF0C;&#x8FD9;&#x6837;&#x4E00;&#x4E2A;&#x961F;&#x5217;&#x53EA;&#x53EF;&#x80FD;&#x5BF9;&#x5E94;&#x4E00;&#x4E2A;cpu&#xFF0C;&#x4ECE;&#x800C;&#x63D0;&#x9AD8;&#x4E86;&#x4F20;&#x8F93;&#x7ED3;&#x6784;&#x7684;&#x5C40;&#x90E8;&#x6027;&#x3002;
&#x6CA1;&#x6709;xps&#x4E4B;&#x524D;&#x7684;&#x505A;&#x6CD5;&#x662F;&#x8FD9;&#x6837;&#x7684;&#xFF0C;&#x5F53;&#x524D;&#x7684;cpu&#x6839;&#x636E;&#x4E00;&#x4E2A;skb&#x7684;4&#x5143;&#x7EC4;hash&#x6765;&#x9009;&#x62E9;&#x961F;&#x5217;&#x53D1;&#x9001;&#x6570;&#x636E;&#xFF0C;&#x4E5F;&#x5C31;&#x662F;&#x8BF4;cpu&#x548C;&#x961F;&#x5217;&#x662F;&#x4E00;&#x4E2A;&#x591A;&#x5BF9;&#x591A;&#x7684;&#x5173;&#x7CFB;&#xFF0C;&#x800C;&#x8FD9;&#x6837;&#x81EA;&#x7136;&#x5C31;&#x4F1A;&#x5BFC;&#x81F4;&#x4F20;&#x8F93;&#x7ED3;&#x6784;&#x7684;cache line bouncing&#x3002;</p>
<h2 id="&#x7F51;&#x7EDC;&#x65F6;&#x95F4;"><a name="&#x7F51;&#x7EDC;&#x65F6;&#x95F4;" class="anchor-navigation-ex-anchor" href="#&#x7F51;&#x7EDC;&#x65F6;&#x95F4;"><i class="fa fa-link" aria-hidden="true"></i></a>1.69. &#x7F51;&#x7EDC;&#x65F6;&#x95F4;</h2>
<pre class="language-"><code>ntpdate <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ntp&#x670D;&#x52A1;&#x5668;&#x7684;ip</span><span class="token punctuation">&gt;</span></span>
ntpdate s2g.time.edu.cn
</code></pre><h2 id="irq&#x7ED1;&#x5B9A;"><a name="irq&#x7ED1;&#x5B9A;" class="anchor-navigation-ex-anchor" href="#irq&#x7ED1;&#x5B9A;"><i class="fa fa-link" aria-hidden="true"></i></a>1.70. irq&#x7ED1;&#x5B9A;</h2>
<pre class="language-"><code class="lang-shell">irq_set_affinity<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">#(eth, irq, desired_core)</span>
<span class="token punctuation">{</span>
    <span class="token assign-left variable">DEV</span><span class="token operator">=</span><span class="token string">&quot;<span class="token variable">$1</span>&quot;</span>
    <span class="token assign-left variable">IRQ</span><span class="token operator">=</span><span class="token string">&quot;<span class="token variable">$2</span>&quot;</span>
    <span class="token assign-left variable">VEC</span><span class="token operator">=</span><span class="token string">&quot;<span class="token variable">$3</span>&quot;</span>
    <span class="token assign-left variable">MASK_FILL</span><span class="token operator">=</span><span class="token string">&quot;&quot;</span>
    <span class="token assign-left variable">MASK_ZERO</span><span class="token operator">=</span><span class="token string">&quot;00000000&quot;</span>
    <span class="token builtin class-name">let</span> <span class="token string">&quot;IDX = <span class="token variable">$VEC</span> / 32&quot;</span>
    <span class="token keyword">for</span> <span class="token variable"><span class="token punctuation">((</span>i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span> i<span class="token operator">&lt;=</span>$IDX<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">))</span></span>
    <span class="token keyword">do</span>
        <span class="token assign-left variable">MASK_FILL</span><span class="token operator">=</span><span class="token string">&quot;<span class="token variable">${MASK_FILL}</span>,<span class="token variable">${MASK_ZERO}</span>&quot;</span>
    <span class="token keyword">done</span>
    <span class="token builtin class-name">let</span> <span class="token string">&quot;VEC -= 32 * <span class="token variable">$IDX</span>&quot;</span>
    <span class="token assign-left variable">MASK_TMP</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$((</span><span class="token number">1</span><span class="token operator">&lt;&lt;</span>$VEC<span class="token variable">))</span></span>
    <span class="token assign-left variable">MASK</span><span class="token operator">=</span><span class="token variable"><span class="token variable">`</span><span class="token builtin class-name">printf</span> <span class="token string">&quot;%X%s&quot;</span> $MASK_TMP $MASK_FILL<span class="token variable">`</span></span>
    <span class="token builtin class-name">printf</span> <span class="token string">&quot;%s mask=%s for /proc/irq/%d/smp_affinity<span class="token entity" title="\n">\n</span>&quot;</span> <span class="token variable">$DEV</span> <span class="token variable">$MASK</span> <span class="token variable">$IRQ</span>
    <span class="token builtin class-name">printf</span> <span class="token string">&quot;%s&quot;</span> <span class="token variable">$MASK</span> <span class="token operator">&gt;</span> /proc/irq/<span class="token variable">$IRQ</span>/smp_affinity
<span class="token punctuation">}</span>
</code></pre>
<p>&#x4F7F;&#x7528;&#x65F6;, &#x6BD4;&#x5982;&#x5BF9;&#x7B2C;161&#x53F7;&#x4E2D;&#x65AD;, &#x7ED1;&#x5B9A;&#x5230;core95&#x4E0A;, &#x6B64;&#x65F6;eth0&#x6CA1;&#x7528;</p>
<pre class="language-"><code>$ irq_set_affinity eth0 161 95
eth0 mask=80000000,00000000,00000000 for /proc/irq/161/smp_affinity
</code></pre><pre class="language-"><code class="lang-shell">q_set_affinity<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">#(eth, queue_num, desired_core)</span>
<span class="token punctuation">{</span>
    <span class="token assign-left variable">DEV</span><span class="token operator">=</span><span class="token string">&quot;<span class="token variable">$1</span>&quot;</span>
    <span class="token assign-left variable">QUE</span><span class="token operator">=</span><span class="token string">&quot;<span class="token variable">$2</span>&quot;</span>
    <span class="token assign-left variable">VEC</span><span class="token operator">=</span><span class="token string">&quot;<span class="token variable">$3</span>&quot;</span>
    <span class="token assign-left variable">MASK_FILL</span><span class="token operator">=</span><span class="token string">&quot;&quot;</span>
    <span class="token assign-left variable">MASK_ZERO</span><span class="token operator">=</span><span class="token string">&quot;00000000&quot;</span>
    <span class="token builtin class-name">let</span> <span class="token string">&quot;IDX = <span class="token variable">$VEC</span> / 32&quot;</span>
    <span class="token keyword">for</span> <span class="token variable"><span class="token punctuation">((</span>i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span> i<span class="token operator">&lt;=</span>$IDX<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">))</span></span>
    <span class="token keyword">do</span>
        <span class="token assign-left variable">MASK_FILL</span><span class="token operator">=</span><span class="token string">&quot;<span class="token variable">${MASK_FILL}</span>,<span class="token variable">${MASK_ZERO}</span>&quot;</span>
    <span class="token keyword">done</span>
    <span class="token builtin class-name">let</span> <span class="token string">&quot;VEC -= 32 * <span class="token variable">$IDX</span>&quot;</span>
    <span class="token assign-left variable">MASK_TMP</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$((</span><span class="token number">1</span><span class="token operator">&lt;&lt;</span>$VEC<span class="token variable">))</span></span>
    <span class="token assign-left variable">MASK</span><span class="token operator">=</span><span class="token variable"><span class="token variable">`</span><span class="token builtin class-name">printf</span> <span class="token string">&quot;%X%s&quot;</span> $MASK_TMP $MASK_FILL<span class="token variable">`</span></span>
    <span class="token assign-left variable">IRQ</span><span class="token operator">=</span><span class="token variable"><span class="token variable">`</span><span class="token function">cat</span> /proc/interrupts <span class="token operator">|</span> <span class="token function">grep</span> <span class="token parameter variable">-i</span> $DEV-TxRx-$QUE <span class="token operator">|</span> <span class="token function">cut</span>  -d:  <span class="token parameter variable">-f1</span> <span class="token operator">|</span> <span class="token function">sed</span> <span class="token string">&quot;s/ //g&quot;</span><span class="token variable">`</span></span>
    <span class="token builtin class-name">printf</span> <span class="token string">&quot;%s mask=%s for /proc/irq/%d/smp_affinity<span class="token entity" title="\n">\n</span>&quot;</span> <span class="token variable">$DEV</span> <span class="token variable">$MASK</span> <span class="token variable">$IRQ</span>
    <span class="token comment"># printf &quot;%s&quot; $MASK &gt; /proc/irq/$IRQ/smp_affinity</span>
<span class="token punctuation">}</span>
</code></pre>
<p>&#x4F7F;&#x7528;&#x65F6;, &#x5BF9;eth9&#x7684;&#x7B2C;15&#x4E2A;q&#x7ED1;&#x5B9A;&#x5230;core35&#x4E0A;</p>
<pre class="language-"><code>$ q_set_affinity eth9 15 35
eth9 mask=8,00000000 for /proc/irq/125/smp_affinity
</code></pre><h2 id="tubo&#x9519;&#x8BEF;&#x5206;&#x6790;"><a name="tubo&#x9519;&#x8BEF;&#x5206;&#x6790;" class="anchor-navigation-ex-anchor" href="#tubo&#x9519;&#x8BEF;&#x5206;&#x6790;"><i class="fa fa-link" aria-hidden="true"></i></a>1.71. tubo&#x9519;&#x8BEF;&#x5206;&#x6790;</h2>
<p>tubo[85270]: unhandled level 1 translation fault (11) at 0xffffff1c000bc8, esr 0x92000005
<img src="index_files/844610781.png" alt=""></p>
<pre class="language-"><code>&gt;&gt;&gt; dr(0x92000005,[31,26],25,[24,0])
[31-26]
Bin: 100100
Dec: 36
Hex: 0x24
[25]
Bin: 1
Dec: 1
Hex: 0x1
[24-0]
Bin: 0000000000000000000000101
Dec: 5
Hex: 0x5
</code></pre><p>&#x6240;&#x4EE5;:
EC:100100
<img src="index_files/209020211.png" alt="">
IL: 1
<img src="index_files/1903998965.png" alt="">
ISS:0000000000000000000000101
<img src="index_files/1957893511.png" alt="">
<img src="index_files/292573462.png" alt="">
<img src="index_files/1441135134.png" alt="">
<strong>&#x8BE6;&#x7EC6;&#x89E3;&#x91CA;</strong>:
arm64&#x4F53;&#x7CFB;&#x89C4;&#x5B9A;&#x7684;&#x865A;&#x62DF;&#x5730;&#x5740;&#x6709;&#x4E09;&#x79CD;:39bit 42bit 48bit(numa&#x7528;)
&#x6240;&#x4EE5;&#x6700;&#x9AD8;&#x51E0;&#x4F4D;&#x8FD8;&#x6709;&#x7A7A;&#x4F59;, arm&#x89C4;&#x5B9A;&#x6700;&#x9AD8;8&#x4F4D;&#x53EF;&#x4EE5;&#x7528;&#x4F5C;tag, &#x786C;&#x4EF6;&#x5728;&#x5730;&#x5740;&#x7FFB;&#x8BD1;&#x7684;&#x65F6;&#x5019;&#x4F1A;&#x5FFD;&#x7565;&#x6389;tag.
&#x4F46;&#x8FD9;&#x91CC;&#x53D1;&#x751F;&#x7684;&#x60C5;&#x51B5;&#x662F;:
ali&#x81EA;&#x5DF1;&#x5199;&#x7684;&#x4EE3;&#x7801;&#x91CC;&#x9762;, &#x624B;&#x52A8;&#x4FEE;&#x6539;?(&#x589E;&#x52A0;&#x7136;&#x540E;&#x5220;&#x9664;)tag, &#x4F46;&#x8FD9;&#x4E2A;tag&#x662F;16&#x4F4D;&#x7684;.
&#x8FD9;&#x4E2A;&#x662F;&#x7528;&#x6237;&#x6001;&#x4EE3;&#x7801;, &#x7528;&#x6237;&#x6001;&#x7684;&#x5730;&#x5740;&#x7A7A;&#x95F4;&#x662F;<code>0x0000_0000_0000_0000</code>&#x5230;<code>0x0000_ffff_ffff_ffff</code>
&#x6BD4;&#x5982;&#x539F;&#x6765;&#x7684;&#x5730;&#x5740;&#x662F;0x0000_fxxx_xxxx_xxxx, &#x5728;&#x53BB;&#x6389;tag&#x7684;&#x65F6;&#x5019;, &#x4EE3;&#x7801;&#x91CC;&#x9762;?&#x4F1A;&#x505A;&#x6700;&#x9AD8;&#x4F4D;&#x7684;&#x7B26;&#x53F7;&#x6269;&#x5C55;,
&#x5BFC;&#x81F4;&#x6269;&#x5C55;&#x5230;&#x5185;&#x6838;&#x7A7A;&#x95F4;?0xffff_fxxx_xxxx_xxxx
&#x6700;&#x540E;&#x7684;&#x4FEE;&#x6539;&#x65B9;&#x6848;&#x662F;&#x6700;&#x9AD8;16&#x4F4D;&#x5F3A;&#x5236;&#x586B;0</p>
<h2 id="ethtool&#x53EF;&#x4EE5;&#x914D;&#x7F6E;&#x9A71;&#x52A8;"><a name="ethtool&#x53EF;&#x4EE5;&#x914D;&#x7F6E;&#x9A71;&#x52A8;" class="anchor-navigation-ex-anchor" href="#ethtool&#x53EF;&#x4EE5;&#x914D;&#x7F6E;&#x9A71;&#x52A8;"><i class="fa fa-link" aria-hidden="true"></i></a>1.72. ethtool&#x53EF;&#x4EE5;&#x914D;&#x7F6E;&#x9A71;&#x52A8;</h2>
<p>&#x8FD9;&#x4E2A;&#x628A;eth3&#x7684;q&#x8BBE;&#x4E3A;8&#x4E2A;
<code>ethtool eth3 -L combined 8</code>
&#x7528;&#x5C0F;l&#x53EF;&#x4EE5;&#x67E5;&#x5F53;&#x524D;&#x7684;&#x914D;&#x7F6E;</p>
<pre class="language-"><code>[root@cavium tmp]# ethtool -l eth8
Channel parameters for eth8:
Pre-set maximums:
RX:             0
TX:             0
Other:          1
Combined:       63
Current hardware settings:
RX:             0
TX:             0
Other:          1
Combined:       16
</code></pre><h2 id="&#x4E3A;&#x4EC0;&#x4E48;ulimit--n&#x7684;&#x503C;&#x4E0D;&#x80FD;&#x6539;"><a name="&#x4E3A;&#x4EC0;&#x4E48;ulimit--n&#x7684;&#x503C;&#x4E0D;&#x80FD;&#x6539;" class="anchor-navigation-ex-anchor" href="#&#x4E3A;&#x4EC0;&#x4E48;ulimit--n&#x7684;&#x503C;&#x4E0D;&#x80FD;&#x6539;"><i class="fa fa-link" aria-hidden="true"></i></a>1.73. &#x4E3A;&#x4EC0;&#x4E48;ulimit -n&#x7684;&#x503C;&#x4E0D;&#x80FD;&#x6539;?</h2>
<ol>
<li>&#x4FEE;&#x6539;file-max
<code>echo  6553560 &gt; /proc/sys/fs/file-max</code>
<code>sysctl -w &quot;fs.file-max=34166&quot;</code>&#xFF0C;&#x524D;&#x9762;2&#x79CD;&#x91CD;&#x542F;&#x673A;&#x5668;&#x540E;&#x4F1A;&#x6062;&#x590D;&#x4E3A;&#x9ED8;&#x8BA4;&#x503C;
&#x6216;<code>vim /etc/sysctl.conf</code>, &#x52A0;&#x5165;&#x4EE5;&#x4E0B;&#x5185;&#x5BB9;, &#x91CD;&#x542F;&#x751F;&#x6548;
<code>fs.file-max = 6553560</code></li>
<li>&#x4FEE;&#x6539;ulimit&#x7684;open file&#xFF0C;&#x7CFB;&#x7EDF;&#x9ED8;&#x8BA4;&#x7684;ulimit&#x5BF9;&#x6587;&#x4EF6;&#x6253;&#x5F00;&#x6570;&#x91CF;&#x7684;&#x9650;&#x5236;&#x662F;1024
<code>ulimit -HSn 102400</code> &#x8FD9;&#x53EA;&#x662F;&#x5728;&#x5F53;&#x524D;&#x7EC8;&#x7AEF;&#x6709;&#x6548;&#xFF0C;&#x9000;&#x51FA;&#x4E4B;&#x540E;&#xFF0C;open files&#x53C8;&#x53D8;&#x4E3A;&#x9ED8;&#x8BA4;&#x503C;&#x3002;&#x5F53;&#x7136;&#x4E5F;&#x53EF;&#x4EE5;&#x5199;&#x5230;/etc/profile&#x4E2D;&#xFF0C;&#x56E0;&#x4E3A;&#x6BCF;&#x6B21;&#x767B;&#x5F55;&#x7EC8;&#x7AEF;&#x65F6;&#xFF0C;&#x90FD;&#x4F1A;&#x81EA;&#x52A8;&#x6267;&#x884C;/etc/profile
&#x6216;<code>vim /etc/security/limits.conf</code> &#x52A0;&#x5165;&#x4EE5;&#x4E0B;&#x914D;&#x7F6E;&#xFF0C;&#x91CD;&#x542F;&#x5373;&#x53EF;&#x751F;&#x6548;
```</li>
<li>soft    noproc 65535</li>
<li>hard    noproc 65535</li>
<li>soft    nofile 65535</li>
<li>hard    nofile 65535
```</li>
</ol>
<h2 id="atomic&#x89E3;&#x51B3;mysql&#x5D29;&#x6E83;&#x95EE;&#x9898;-weak-order"><a name="atomic&#x89E3;&#x51B3;mysql&#x5D29;&#x6E83;&#x95EE;&#x9898;-weak-order" class="anchor-navigation-ex-anchor" href="#atomic&#x89E3;&#x51B3;mysql&#x5D29;&#x6E83;&#x95EE;&#x9898;-weak-order"><i class="fa fa-link" aria-hidden="true"></i></a>1.74. atomic&#x89E3;&#x51B3;mysql&#x5D29;&#x6E83;&#x95EE;&#x9898;, weak order</h2>
<p>&#x4FEE;&#x6539;&#x539F;&#x5B50;&#x9501;&#xFF1A;
&#x6B63;&#x786E;&#x7684;&#x4FEE;&#x6539;&#x539F;&#x5B50;&#x9501;&#x65B9;&#x6CD5;</p>
<pre class="language-"><code class="lang-c">vim storage<span class="token operator">/</span>innobase<span class="token operator">/</span>include<span class="token operator">/</span>os0sync<span class="token punctuation">.</span>h
<span class="token macro property"><span class="token directive-hash">#</span> <span class="token directive keyword">define</span> <span class="token macro-name function">os_atomic_test_and_set_byte</span><span class="token expression"><span class="token punctuation">(</span>ptr<span class="token punctuation">,</span> new_val<span class="token punctuation">)</span> </span><span class="token punctuation">\</span>
        <span class="token expression"><span class="token function">__atomic_exchange_n</span> <span class="token punctuation">(</span>ptr<span class="token punctuation">,</span>new_val<span class="token punctuation">,</span> __ATOMIC_ACQ_REL<span class="token punctuation">)</span></span></span>
        <span class="token comment">/*__sync_lock_test_and_set(ptr, (byte) new_val)*/</span>
<span class="token macro property"><span class="token directive-hash">#</span> <span class="token directive keyword">define</span> <span class="token macro-name function">os_atomic_test_and_set_ulint</span><span class="token expression"><span class="token punctuation">(</span>ptr<span class="token punctuation">,</span> new_val<span class="token punctuation">)</span> </span><span class="token punctuation">\</span>
        <span class="token expression"><span class="token function">__atomic_exchange_n</span> <span class="token punctuation">(</span>ptr<span class="token punctuation">,</span>new_val<span class="token punctuation">,</span> __ATOMIC_ACQ_REL<span class="token punctuation">)</span></span></span>
        <span class="token comment">/*__sync_lock_test_and_set(ptr, new_val)*/</span>
vim <span class="token punctuation">.</span><span class="token operator">/</span>include<span class="token operator">/</span>atomic<span class="token operator">/</span>gcc_builtins<span class="token punctuation">.</span>h
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name function">make_atomic_fas_body</span><span class="token expression"><span class="token punctuation">(</span>S<span class="token punctuation">)</span>                     </span><span class="token punctuation">\</span>
  <span class="token expression">v<span class="token operator">=</span> <span class="token function">__atomic_exchange_n</span> <span class="token punctuation">(</span>a<span class="token punctuation">,</span>v<span class="token punctuation">,</span> __ATOMIC_ACQ_REL<span class="token punctuation">)</span><span class="token punctuation">;</span></span></span>
<span class="token comment">/*  v= __sync_lock_test_and_set(a, v);*/</span>
</code></pre>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="as_title_arm_server.html" class="navigation navigation-prev " aria-label="Previous page: ARM server">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="as_title_embedded.html" class="navigation navigation-next " aria-label="Next page: 嵌入式系统开发调试">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Arm server 杂记","level":"1.7.1","depth":2,"next":{"title":"嵌入式系统开发调试","level":"1.8","depth":1,"path":"notes/as_title_embedded.md","ref":"notes/as_title_embedded.md","articles":[{"title":"嵌入式调试杂记","level":"1.8.1","depth":2,"path":"notes/embedded_debugging.md","ref":"notes/embedded_debugging.md","articles":[]},{"title":"uboot杂记","level":"1.8.2","depth":2,"path":"notes/uboot_杂记.md","ref":"notes/uboot_杂记.md","articles":[]},{"title":"buildroot杂记","level":"1.8.3","depth":2,"path":"notes/buildroot_杂记.md","ref":"notes/buildroot_杂记.md","articles":[]},{"title":"升级GCC7.3问题解决","level":"1.8.4","depth":2,"path":"notes/toolchain_升级gcc问题解决.md","ref":"notes/toolchain_升级gcc问题解决.md","articles":[]},{"title":"kernel bug异常打印分析","level":"1.8.5","depth":2,"path":"notes/kernel_异常打印分析实例.md","ref":"notes/kernel_异常打印分析实例.md","articles":[]}]},"previous":{"title":"ARM server","level":"1.7","depth":1,"path":"notes/as_title_arm_server.md","ref":"notes/as_title_arm_server.md","articles":[{"title":"Arm server 杂记","level":"1.7.1","depth":2,"path":"notes/arm_server_杂记.md","ref":"notes/arm_server_杂记.md","articles":[]}]},"dir":"ltr"},"config":{"plugins":["-livereload","-sharing","-lunr","-search","search-plus","-highlight","theme-comscore","prism","code","chapter-fold","github","splitter","wide-page","hide-navigation-buttons","anchor-navigation-ex","sequence","mermaid-gb3"],"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"pluginsConfig":{"chapter-fold":{},"prism":{"css":["prismjs/themes/prism.css"],"ignore":["mermaid","sequence"]},"sequence":{"theme":"simple"},"github":{"url":"https://github.com/Bai-Yingjie/Bai-Yingjie.github.io"},"splitter":{},"wide-page":{},"code":{"copyButtons":true},"fontsettings":{"theme":"white","family":"sans","size":2},"hide-navigation-buttons":{},"mermaid-gb3":{},"anchor-navigation-ex":{"mode":"float","pageTop":{"level1Icon":"","level2Icon":"","level3Icon":"","showLevelIcon":false},"isRewritePageTitle":true,"showLevel":true,"tocLevel1Icon":"fa fa-hand-o-right","tocLevel2Icon":"fa fa-hand-o-right","tocLevel3Icon":"fa fa-hand-o-right","showGoTop":true,"isShowTocTitleIcon":true,"printLog":false,"multipleH1":true,"associatedWithSummary":true,"float":{"floatIcon":"fa fa-navicon","level1Icon":"","level2Icon":"","level3Icon":"","showLevelIcon":false}},"theme-comscore":{},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false},"search-plus":{}},"theme":"default","author":"Bai Yingjie","pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"variables":{},"title":"My Notes","language":"zh-hans","gitbook":"*"},"file":{"path":"notes/arm_server_杂记.md","mtime":"2022-10-19T16:19:35.492Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2022-10-19T16:20:37.911Z"},"basePath":"..","book":{"language":""}});
        });
    </script>
</div>

        
    
    <script src="../gitbook/gitbook.js"></script>
    <script src="../gitbook/theme.js"></script>
    
        
        <script src="../gitbook/gitbook-plugin-search-plus/jquery.mark.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search-plus/search.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-code/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-chapter-fold/chapter-fold.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-github/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-splitter/splitter.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-mermaid-gb3/book/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-theme-comscore/test.js"></script>
        
    

    <script src="../gitbook/gitbook-plugin-mermaid-gb3/mermaid/mermaid.min.js"></script>

    </body>
</html>

